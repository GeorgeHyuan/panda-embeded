(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-aacd0ec4","chunk-5e415814","chunk-2d207b0b"],{"025b":function(e,t,a){},"03be":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("dialog-container",{attrs:{title:"全部审核",width:"400px",height:"400px",visible:e.visible,submitLoading:e.submitLoading,appendBody:!0,confirmText:"确认"},on:{"update:visible":function(t){e.visible=t},closed:e.handleClosed,closeDialog:e.close,comfirmDialog:e.comfirmDialog}},[a("div",{staticClass:"dialog-box"},[a("el-form",{ref:"ruleForm",staticClass:"d2-form d2-form-check",attrs:{"label-position":"right",model:e.formInline,"label-width":"90px"}},[a("el-col",{staticClass:"rules",attrs:{span:24}},[a("el-form-item",{attrs:{label:"审核结果"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formInline.tag,callback:function(t){e.$set(e.formInline,"tag",t)},expression:"formInline.tag"}},e._l(e.shenheOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("el-col",{staticClass:"rules",attrs:{span:24}},[a("el-form-item",{attrs:{label:"审核意见"}},[a("el-input",{attrs:{type:"textarea",rows:4,placeholder:"审核结果修正"},model:{value:e.formInline.remark,callback:function(t){e.$set(e.formInline,"remark",t)},expression:"formInline.remark"}})],1)],1)],1)],1)])},i=[],l=a("f732"),s={components:{},data:function(){return{visible:!1,submitLoading:!1,formInline:{tag:"1",remark:""},shenheOptions:[{value:"1",label:"正常"},{value:"0",label:"异常"}],data:[]}},computed:{},mounted:function(){},methods:{open:function(e){this.data=e,this.formInline={tag:"1",remark:""},this.init()},close:function(){this.visible=!1},handleClosed:function(){var e=this;this.$nextTick((function(){e.$refs.ruleForm.resetFields()}))},init:function(){this.visible=!0},comfirmDialog:function(){var e=this;this.submitLoading=!0;var t=JSON.parse(JSON.stringify(this.formInline)),a=[];this.data.map((function(e){a.push({id:e.id,tag:t.tag,remark:t.remark,recordsId:e.recordsId})})),l["a"].updateRecordItemStatus(a).then((function(t){var a=t.code;"0"===a&&(e.visible=!1,e.$emit("getappList"),e.$message.success("操作成功"))})).catch((function(e){console.log(e)})).finally((function(){e.submitLoading=!1}))}}},o=s,r=a("2877"),c=Object(r["a"])(o,n,i,!1,null,null,null);t["default"]=c.exports},"5acf":function(e,t,a){"use strict";a("025b")},6209:function(e,t,a){},6477:function(e,t,a){"use strict";t["a"]={data:function(){var e=this,t=this;return{selectDate:null,pickerOptions0:{disabledDate:function(e){var a=e.getTime(),n=new Date(new Date((new Date).toLocaleDateString()).getTime()+864e5-1);if(t.selectDate){var i=(new Date).getFullYear(),l=(new Date).getMonth()+1,s=new Date(i+"-"+l+"-01 00:00:00").getTime();return t.selectDate.getMonth()+1===Number(l)?a>n||a<s:t.selectDate.getMonth()+1!==e.getMonth()+1}return a>n},onPick:function(t){!t.maxDate&&t.minDate?e.selectDate=t.minDate:e.selectDate=null}}}}}},"7ba6":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("d2-container",[a("template",{slot:"header"},[a("el-breadcrumb",[a("el-breadcrumb-item",[e._v("当前位置")]),a("el-breadcrumb-item",[e._v("智能巡检")]),a("el-breadcrumb-item",{attrs:{to:{path:"/refresh"}}},[e._v("巡检记录")]),a("el-button",{staticClass:"stopClass",attrs:{size:"mini",title:"返回",type:"primary"},on:{click:e.back}},[e._v("返回")])],1)],1),a("d2-card",{staticClass:"box-card d2-mr"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("巡检任务信息")])]),a("div",{staticClass:"tongji"},[a("ul",[a("li",[a("span",[e._v("任务名称")]),e._v(" :\n                "),a("span",[e._v(e._s(e.formInline.name))])]),a("li",[a("span",[e._v("开始时间")]),e._v(" :\n                "),a("span",[e._v(e._s(e.formInline.startTime))])]),a("li",[a("span",[e._v("结束时间")]),e._v(" :\n                "),a("span",[e._v(e._s(e.formInline.endTime))])]),a("li",[a("span",[e._v("总测点")]),e._v(" :\n                "),a("span",[e._v(e._s(e.formInline.inspectPointTotal||0))])]),a("li",[a("span",[e._v("已巡视")]),e._v(" :\n                "),a("span",[e._v(e._s(e.formInline.inspectPointChecked||0))])]),a("li",[a("span",[e._v("正常")]),e._v(" :\n                "),a("span",[e._v(e._s((e.formInline.inspectPointChecked||0)-(e.formInline.inspectPointAbnormal||0)))])]),a("li",[a("span",[e._v("异常")]),e._v(" :\n                "),a("span",[e._v(e._s(e.formInline.inspectPointAbnormal||0))])])])])]),a("d2-card",{staticClass:"box-card d2-mr d2-mt"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("巡检记录列表")])]),a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"图形模式",name:"img"}},[a("div",{staticClass:"topo-content",staticStyle:{"margin-right":"10px"}},[a("div",{staticClass:"blockDiv"},e._l(e.data,(function(t,n){return a("div",{key:n,class:"block block9"},[a("div",{staticClass:"arrowsStyle"},[a("div",{staticClass:"player-tool-top"},[a("span",{staticClass:"player-tool-time"},[e._v(e._s(t.name))]),a("span",{staticClass:"player-tool-time",staticStyle:{float:"right"}},[e._v(e._s(t.algoServiceName))])]),a("div",{staticStyle:{width:"100%",height:"100%"}},[a("canvasImg",{attrs:{fontSize:"12",picUrl:t.resultPic||"",resultMark:t.resultMark?JSON.parse(t.resultMark):[]}})],1),a("div",{staticClass:"mo",on:{click:function(a){return e.imgOpenFun({item:t,index:n})}}},[a("div",{class:"mo-name mo-name-"+t.resultValue},[e._v(e._s("0"===t.resultValue?"异常":"正常"))])]),a("div",{staticClass:"player-tool"},[a("span",{staticClass:"player-tool-time"},[e._v(e._s(t.rawName)+" ")]),a("span",{staticClass:"player-tool-time"},[e._v("算法结果："+e._s("0"===t.resultValue?"异常":"正常")+" ")]),a("span",{staticClass:"player-tool-time"},[e._v("审核结果："+e._s(t.tag?"0"===t.tag?"异常":"正常":"未审核")+" ")]),a("span",{staticClass:"d2-fr player-tool-text"},[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.historyFun(t,n)}}},[e._v("审核")])],1),a("span",{staticClass:"d2-fr player-tool-text"},[a("i",{staticClass:"el-icon-success el-icon-success-zdy",on:{click:function(a){return e.zhengchangFun(t,n)}}})]),a("span",{staticClass:"d2-fr player-tool-text"},[a("i",{staticClass:"el-icon-warning el-icon-warning-zdy",on:{click:function(a){return e.historyFun(t,n,"异常")}}})])])])])})),0)])]),a("el-tab-pane",{attrs:{label:"列表模式",name:"table"}},[a("d2-crud",{ref:"d2Crud",attrs:{columns:e.columns,data:e.data,loading:e.loading,options:e.options,"row-handle":e.rowHandle},on:{imgOpenFun:e.imgOpenFun,checkOpenFun:e.checkOpenFun}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("el-form",{staticClass:"d2-form",attrs:{"label-position":"right",inline:!0,"label-width":"90px"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-row",[a("el-col",{attrs:{span:16}},[a("el-row",{attrs:{gutter:10}},[a("el-form-item",{attrs:{label:"子任务名称:"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入子任务名称"},model:{value:e.appname,callback:function(t){e.appname=t},expression:"appname"}})],1),a("el-form-item",{attrs:{"label-width":"0px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.puery}},[e._v("查询")])],1)],1)],1),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"d2-form-fr"},[a("el-form-item",[a("el-button",{attrs:{type:"warning",icon:"fa fa-download"},on:{click:e.addOpen}},[e._v("导出列表")])],1),a("el-form-item",[a("el-button",{attrs:{type:"warning",icon:"el-icon-s-check"},on:{click:e.shenheAll}},[e._v("全部审核")])],1)],1)])],1)],1)],1)])],1)],1),a("el-pagination",{attrs:{"current-page":e.pagination.currentPage,"page-size":e.pagination.size,layout:"prev, pager, next, jumper, total",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.paginationCurrentChange,"update:currentPage":function(t){return e.$set(e.pagination,"currentPage",t)},"update:current-page":function(t){return e.$set(e.pagination,"currentPage",t)}}})],1),a("shenheOpen",{ref:"shenheOpen",on:{getappList:e.getappList}}),a("shenheAllOpen",{ref:"shenheAllOpen",on:{getappList:e.getappList}}),a("imgOpen",{ref:"imgOpen"})],2)},i=[],l=a("9951"),s=a("a237"),o=a("6477"),r=a("5661"),c=a("03be"),u=a("cbe7"),p=a("f732"),d=a("d6a8"),m=a("fa20"),v={name:"app-manage",components:{shenheOpen:r["default"],canvasImg:d["a"],shenheAllOpen:c["default"],imgOpen:m["default"]},mixins:[o["a"],l["a"],s["default"]],data:function(){return{submitLoading:!1,ids:[],appname:"",taskType:"",taskState:[1],time:"",activeName:"img",formInline:{}}},computed:{},created:function(){this.getappList(),this.getInit()},methods:{handleClick:function(){this.getappList()},handleSizeChange:function(e){this.pagination.size=e},paginationCurrentChange:function(e){this.pagination.currentPage=e,this.getappList()},puery:function(){this.pagination.currentPage=1,this.getappList()},handleSelectionChange:function(e){this.ids=e},getappList:function(){var e=this;this.data=[],this.loading=!0;var t={recordsId:this.$route.params.num,name:this.appname,current:this.pagination.currentPage,size:this.pagination.pageSize};u["a"].getRecordItemPage(t).then((function(t){e.data=t.data.records,e.pagination.total=t.data.total})).catch((function(e){console.log(e)})).finally((function(){e.loading=!1}))},deleteapp:function(){if(0===this.ids.length)this.$message({message:"还没有选择操作应用，请勾选一条数据再进行操作",type:"warning"});else{var e=[];this.ids.map((function(t){e.push(t.id)})),this.removeApi(e)}},removeRow:function(e){var t=e.row,a=[];a.push(t.id),this.removeApi(a)},removeApi:function(e){var t=this;this.$confirm("此操作将永久删除数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){u["a"].batchDelete(e.join(",")).then((function(e){var a=e.code;"0"===a&&(t.$message({type:"success",message:"删除成功!"}),t.getappList())})).catch((function(){}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},editOpen:function(e){var t=e.row;this.$refs.editOpen.open(t.id)},addOpen:function(){var e=this;this.submitLoading=!0,u["a"].recordExportForExcel().then((function(t){var a=new Blob([t],{type:"application/msexcel;charset=UTF-8"}),n=window.URL.createObjectURL(a),i=document.createElement("a");i.style.display="none",i.href=n,i.setAttribute("download","巡检记录.xls"),document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(n),e.$message({type:"success",message:"导出成功!"})})).finally((function(){e.submitLoading=!1})).catch((function(){e.submitLoading=!1}))},download:function(){},historyFun:function(e,t,a){this.$refs.shenheOpen.open(e,t,this.data,a)},zhengchangFun:function(e,t){var a=this,n={tag:"1",remark:""},i=JSON.parse(JSON.stringify(n));i.id=e.id;var l=[];l.push(i),p["a"].updateRecordItemStatus(l).then((function(e){var t=e.code;"0"===t&&(a.visible=!1,a.getappList(),a.$message.success("操作成功"))})).catch((function(e){console.log(e)})).finally((function(){a.submitLoading=!1}))},imgOpenFun:function(e){e.row;var t=e.index;this.$refs.imgOpen.open(this.data,t)},getInit:function(e,t){var a=this;u["a"].getRecordById(this.$route.params.num).then((function(e){var t=e.code;"0"===t&&(a.formInline=e.data)}))},checkOpenFun:function(e){var t=e.row,a=e.index;this.$refs.shenheOpen.open(t,a,this.data)},shenheAll:function(){this.$refs.shenheAllOpen.open(this.data)},back:function(){this.$router.go(-1)}}},f=v,h=(a("5acf"),a("cd3c"),a("2877")),g=Object(h["a"])(f,n,i,!1,null,"caabec42",null);t["default"]=g.exports},9951:function(e,t,a){"use strict";t["a"]={data:function(){return{implementOptions:[{value:1,label:"立即"},{value:2,label:"定时"},{value:3,label:"周期"}],taskStateOptions:[{value:6,label:"手动停止"},{value:5,label:"等待执行"},{value:4,label:"正在执行"},{value:3,label:"任务暂停"},{value:2,label:"异常终止"},{value:1,label:"已完成"}],taskTypeOptions:[{value:"1",label:"例行巡视"},{value:"2",label:"特殊巡视"},{value:"3",label:"专项巡视"},{value:"4",label:"自定义巡视"}],timeOptions:[{value:"1",label:"每天"},{value:"2",label:"每周"},{value:"3",label:"每月"}],monthOptions:[{value:"1",label:"1"},{value:"2",label:"2"},{value:"3",label:"3"},{value:"4",label:"4"},{value:"5",label:"5"},{value:"6",label:"6"},{value:"7",label:"7"},{value:"8",label:"8"},{value:"9",label:"9"},{value:"10",label:"10"},{value:"11",label:"11"},{value:"12",label:"12"},{value:"13",label:"13"},{value:"14",label:"14"},{value:"15",label:"15"},{value:"16",label:"16"},{value:"17",label:"17"},{value:"18",label:"18"},{value:"19",label:"19"},{value:"20",label:"20"},{value:"21",label:"21"},{value:"22",label:"22"},{value:"23",label:"23"},{value:"24",label:"24"},{value:"25",label:"25"},{value:"26",label:"26"},{value:"27",label:"27"},{value:"28",label:"28"},{value:"29",label:"29"},{value:"30",label:"30"},{value:"31",label:"31"}],weekOptions:[{value:"1",label:"周一"},{value:"2",label:"周二"},{value:"3",label:"周三"},{value:"4",label:"周四"},{value:"5",label:"周五"},{value:"6",label:"周六"},{value:"7",label:"周日"}],warningOptions:[{value:1,label:"是"},{value:0,label:"否"}],addrFormat:{"power-infra-gloves-detection":"未带手套","helmet-classify":"未带安全帽"}}}}},"9b22":function(e,t,a){},a237:function(e,t,a){"use strict";a.r(t),t["default"]={data:function(){this.$createElement;return{data:[],columns:[{title:"序号",key:"",width:60,formatter:function(e,t,a,n){return n+1}},{title:"子任务名称",key:"name",showOverflowTooltip:!0},{title:"摄像头",key:"rawName",showOverflowTooltip:!0},{title:"开始时间",key:"startTime",width:160,showOverflowTooltip:!0},{title:"结束时间",key:"endTime",width:160,showOverflowTooltip:!0},{title:"算法名称",key:"algoServiceName",showOverflowTooltip:!0},{title:"审核状态",key:"tag",width:80,showOverflowTooltip:!0,component:{render:function(e,t){return"1"===t.tag?e("el-tag",{attrs:{type:"success"}},["正常"]):"0"===t.tag?e("el-tag",{attrs:{type:"danger"}},["异常"]):void 0}}},{title:"分析结果",key:"resultValue",showOverflowTooltip:!0,component:{render:function(e,t){var a="";return t.resultMark&&JSON.parse(t.resultMark).map((function(e){a=e.tagName||"",e.properties&&e.properties.map((function(e,t){var n=e.sceneName+e.sceneValueName;a+="\n"+n}))})),"1"===t.resultValue&&"3"===t.desc?e("el-tag",{attrs:{type:"success"}},["正常"]):"0"===t.resultValue?e("el-tag",{attrs:{type:"danger"}},[a||"异常"]):e("el-tag",{attrs:{type:"primary"}},["--"])}}}],loading:!1,pagination:{currentPage:1,pageSize:9,total:0},rowHandle:{width:100,custom:[{emit:"imgOpenFun",text:"查看图片",size:"mini",type:"primary",icon:"el-icon-picture-outline-round",circle:!0,disabled:function(e,t){return!t.resultPic}},{emit:"checkOpenFun",text:"审核",size:"mini",type:"warning",icon:"el-icon-s-check",circle:!0}]},options:{stripe:!0,height:"calc(100vh - 473px)",border:!0}}}}},cbe7:function(e,t,a){"use strict";var n=a("9bd2"),i=VUE_APP_API_STATION;t["a"]={getRecordList:function(e){return Object(n["a"])({url:"".concat(i,"/inspection/record/getRecordList"),method:"post",data:e})},getRecordItemPage:function(e){return Object(n["a"])({url:"".concat(i,"/evt/list/").concat(e.current,"/").concat(e.size),method:"get"})},getRecordItemList:function(e){return Object(n["a"])({url:"".concat(i,"/inspection/recordItem/getRecordItemList"),method:"post",data:e})},getRecordExecutorPage:function(e){return Object(n["a"])({url:"".concat(i,"/inspection/recordExecutor/getRecordExecutorPage"),method:"post",data:e})},getRecordById:function(e){return Object(n["a"])({url:"".concat(i,"/inspection/record/getRecordById/").concat(e),method:"post"})},getModelCount:function(e){return Object(n["a"])({url:"".concat(i,"/getModelCount"),method:"get"})},getEvtCount:function(e){return Object(n["a"])({url:"".concat(i,"/evt/getEvtCount"),method:"get"})},getRealHumTmp:function(){return Object(n["a"])({url:"".concat(i,"/real/getRealHumTmp"),method:"get"})}}},cd3c:function(e,t,a){"use strict";a("6209")},fa20:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("dialog-container",{attrs:{title:"任务详情",width:"1200px",height:"400px",visible:e.visible,appendBody:!0,confirmText:"确认","show-footer":!1},on:{"update:visible":function(t){e.visible=t},closed:e.handleClosed,closeDialog:e.close,comfirmDialog:e.comfirmDialog}},[a("div",{staticClass:"dialog-box"},[a("div",{staticStyle:{width:"1140px",height:"600px"}},[a("el-carousel",{ref:"carousel",attrs:{trigger:"click",height:"600px",interval:1e5,"indicator-position":"none","initial-index":e.imgIndex}},e._l(e.imgData,(function(t,n){return a("el-carousel-item",{key:n},[a("el-row",{staticClass:"d2-mb",attrs:{gutter:10}},[a("ul",[a("el-col",{attrs:{span:6}},[a("li",[a("span",[e._v("任务名称")]),e._v(" :\n                  "),a("span",[e._v(e._s(t.name))])])]),a("el-col",{attrs:{span:6}},[a("li",[a("span",[e._v("摄像头")]),e._v(" :\n                  "),a("span",[e._v(e._s(t.rawName))])])]),a("el-col",{attrs:{span:6}},[a("li",[a("span",[e._v("开始时间")]),e._v(" :\n                  "),a("span",[e._v(e._s(t.startTime))])])]),a("el-col",{attrs:{span:6}},[a("li",[a("span",[e._v("结束时间")]),e._v(" :\n                  "),a("span",[e._v(e._s(t.endTime))])])]),a("el-col",{attrs:{span:6}},[a("li",[a("span",[e._v("算法名称")]),e._v(" :\n                  "),a("span",[e._v(e._s(t.algoServiceName))])])]),a("el-col",{attrs:{span:18}},[a("li",[a("span",[e._v("巡检结果")]),e._v(" :\n                  "),"合格"===e.formatValue(t)?a("span",[e._v(e._s(e.formatValue(t)))]):a("div",{staticClass:"result"},e._l(e.formatValue(t),(function(t,n){return a("ul",{key:n},e._l(t.properties,(function(n,i){return a("li",{key:n.id},[a("span",[e._v(e._s(n.sceneName))]),a("span",[e._v(e._s("("+n.sceneValueName+")")+e._s(i+1===t.properties.length?"":"，"))])])})),0)})),0)])])],1)]),e.visible?a("canvasImg",{attrs:{picUrl:t.resultPic||"",resultMark:t.resultMark?JSON.parse(t.resultMark):[]}}):e._e()],1)})),1)],1)])])},i=[],l=a("d6a8"),s={components:{canvasImg:l["a"]},data:function(){return{visible:!1,imgData:[],imgIndex:0}},computed:{},mounted:function(){},methods:{open:function(e,t){var a=this;this.imgData=e,this.$nextTick((function(){setTimeout((function(){a.$refs.carousel.setActiveItem(t)}),0)})),this.visible=!0},close:function(){this.visible=!1},formatValue:function(e){return e.resultMark?(console.log(JSON.parse(e.resultMark),8888888),JSON.parse(e.resultMark)):"合格"},handleClosed:function(){},init:function(){},comfirmDialog:function(){}}},o=s,r=(a("fdaf"),a("2877")),c=Object(r["a"])(o,n,i,!1,null,"2eccdf92",null);t["default"]=c.exports},fdaf:function(e,t,a){"use strict";a("9b22")}}]);