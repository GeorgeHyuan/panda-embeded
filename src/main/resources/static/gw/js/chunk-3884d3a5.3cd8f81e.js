(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3884d3a5","chunk-770e4619"],{"0cb5":function(t,e,i){"use strict";i("897e")},"190e":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.errorData.length>0?i("el-carousel",{attrs:{height:"height: 100%;",interval:4e3}},t._l(t.errorData,(function(e,a){return i("el-carousel-item",{key:a,staticClass:"carousel-item-sty",staticStyle:{width:"100%"}},t._l(e,(function(e){return i("div",{key:e.id,staticClass:"eventimg-info"},[i("canvas-img",{attrs:{fontSize:"14",itemData:e,picUrl:e.resultPhoto||"",resultMark:e.remark?JSON.parse(e.remark):[]}}),i("div",{staticClass:"event-detail"},[i("span",{staticStyle:{float:"left"}},[t._v(t._s(e.resultTime))]),i("span",{staticStyle:{float:"right"},on:{click:function(i){return t.viewBigpicture(e)}}},[t._v("查看详情")])])],1)})),0)})),1):i("no-data"),i("big-image",{ref:"bigImage"})],1)},n=[],s=i("2f62"),r=i("8e01"),o=i("d6a8"),l=i("1946");function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function u(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){d(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function d(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var f={components:{NoData:r["a"],CanvasImg:o["a"],BigImage:l["default"]},props:["eventData"],data:function(){return{imgUrl:i("c92f9"),showViewer:!1,srcList:[],scroll:!1,page:0,visible:!1,distinguishResult:null}},computed:u(u({},Object(s["c"])("d2admin",{devTreeNode:"tree/devTreeNode"})),{},{devId:function(){return this.devTreeNode.id},errorData:function(){var t=this.erweiArr(4,this.eventData);return t}}),methods:{cardRefresh:function(){},getData:function(t){},erweiArr:function(t,e){var i=[];return e.forEach((function(e,a){var n=Math.floor(a/t);i[n]||(i[n]=[]),i[n].push(e)})),i},viewBigpicture:function(t){this.$emit("emitViewBigpicture",t)},closeViewer:function(){this.showViewer=!1},handleDetail:function(t){this.distinguishResult=t.resultValue,this.imgUrl=t.url,this.visible=!0},handleClosed:function(){this.visible=!1},handleScroll:function(t){var e=t.deltaY>0?"down":"up";this.scroll&&("up"===e?this.page++:this.page--,this.getEventList())},getEventList:function(){},enter:function(){this.scroll=!0},leave:function(){this.scroll=!1}},mounted:function(){window.addEventListener("mousewheel",this.handleScroll)}},h=f,p=(i("4cde"),i("2877")),g=Object(p["a"])(h,a,n,!1,null,"14a04a67",null);e["default"]=g.exports},1946:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("dialog-container",{staticClass:"insert-detail",attrs:{showFooter:!1,title:"图片详情",width:"1000px",visible:t.visible,appendBody:!0,top:"9vh"},on:{"update:visible":function(e){t.visible=e},closed:t.handleClosed}},[i("div",{staticClass:"height: 50vh;"},[i("div",{staticClass:"result-sty"},[i("span",{staticStyle:{"margin-right":"15px"}},[t._v("识别结果纠错: ")]),i("el-radio-group",{on:{change:t.handleResult},model:{value:t.distinguishResult,callback:function(e){t.distinguishResult=e},expression:"distinguishResult"}},[i("el-radio",{attrs:{label:1}},[t._v("正常")]),i("el-radio",{attrs:{label:0}},[t._v("异常")])],1)],1),t.visible?i("canvas-img",{attrs:{fontSize:"24",picUrl:t.item.resultPhoto||"",resultMark:t.item.remark?JSON.parse(t.item.remark):[]},on:{canvasClick:function(e){return t.viewBigpicture(t.item.resultPhoto)}}}):t._e()],1)])},n=[],s=i("d6a8"),r=i("3709"),o={components:{CanvasImg:s["a"]},data:function(){return{visible:!1,item:null,distinguishResult:null}},methods:{open:function(t){this.distinguishResult=Number(t.personCheck),this.item=t,this.visible=!0},handleResult:function(){var t=this;if(this.item&&this.item.id){var e={id:this.item.id,personCheck:this.distinguishResult};r["a"].confirmResult(e).then((function(e){!0===e.data&&t.$message({type:"success",message:"修正成功"}),t.$emit("emitLookHistoryInfo"),t.$emit("emitUpdateData")})).finally((function(){}))}else this.$message({type:"warning",message:"请等待识别结果"})},handleClosed:function(){this.item=null}}},l=o,c=(i("9260"),i("2877")),u=Object(c["a"])(l,a,n,!1,null,"a20d07a0",null);e["default"]=u.exports},"34d1":function(t,e,i){},"4cde":function(t,e,i){"use strict";i("d759")},5018:function(t,e,i){"use strict";i("e757")},"615f":function(t,e,i){},"80f1":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("d2-card",{ref:"historyInfo",staticClass:"box-card history-info",staticStyle:{height:"100%"},on:{cardRefresh:t.cardRefresh}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("i",{staticClass:"fa fa-history"}),i("span",[t._v("历史信息")])]),i("div",{staticStyle:{height:"calc(50vh - 195px)",width:"100%"}},[i("div",{staticStyle:{overflow:"hidden"}},[i("div",{staticClass:"date-sty"},[i("div",{staticClass:"picker-sty"},[i("el-date-pick",{on:{changeTime:t.changeTime}})],1),i("el-button",{staticStyle:{"vertical-align":"middle"},attrs:{type:"primary"},on:{click:t.checkLookHistory}},[t._v("查询")])],1),i("div",{staticClass:"button-sty"},[i("el-button",{attrs:{type:"primary"},on:{click:t.handleHistoryDetail}},[t._v("历史信息")]),i("el-button",{attrs:{type:"primary"},on:{click:t.handleErrorInfo}},[t._v("异常信息")])],1)]),t.showContent&&t.historyData.length>0?i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"history-img-info",attrs:{"element-loading-text":"数据加载中","element-loading-spinner":"el-icon-loading"}},[i("el-carousel",{attrs:{height:"height: calc(50vh - 200px);",interval:4e3}},t._l(t.historyData,(function(e,a){return i("el-carousel-item",{key:a},[i("el-timeline",t._l(e,(function(e,a){return i("el-timeline-item",{key:a+""+e.resultTime,attrs:{icon:e.icon,type:e.type,color:e.color,size:e.size,timestamp:e.resultTime}},[i("div",{staticClass:"div-style"},[i("canvas-img",{attrs:{fontSize:"14",itemData:e,picUrl:e.resultPhoto||"",resultMark:e.remark?JSON.parse(e.remark):[]},on:{canvasClick:t.viewBigpicture}})],1)])})),1)],1)})),1)],1):t.showContent&&0===t.historyData.lenght?i("no-data"):t._e(),!t.showContent&&t.historyData.length>0?i("event-info",{attrs:{eventData:t.historyData},on:{emitViewBigpicture:t.viewBigpicture}}):t._e()],1),i("big-image",{ref:"bigImage",on:{emitLookHistoryInfo:t.checkLookHistory}})],1)},n=[],s=i("c81e"),r=i("2f62"),o=i("190e"),l=i("3709"),c=i("8e01"),u=i("d6a8"),d=i("1946");function f(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function h(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?f(Object(i),!0).forEach((function(e){p(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):f(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function p(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var g={components:{ElDatePick:s["a"],EventInfo:o["default"],NoData:c["a"],CanvasImg:u["a"],BigImage:d["default"]},data:function(){return{imgUrl:i("c92f9"),showViewer:!1,srcList:[],showContent:!0,valueTime:["",""],lookType:1,historyData:[],loading:!1}},computed:h(h({},Object(r["c"])("d2admin",{devTreeNode:"tree/devTreeNode"})),{},{devId:function(){return this.devTreeNode.id}}),watch:{devId:function(t,e){t&&this.lookHistoryInfo()}},methods:{cardRefresh:function(){},changeTime:function(t){this.valueTime=t||["",""]},checkLookHistory:function(){this.lookHistoryInfo()},dataDetail:function(){},lookHistoryInfo:function(){var t=this;this.loading=!1;var e={spaceVarId:this.devId,startTime:this.valueTime[0],endTime:this.valueTime[1],resultValue:1===this.lookType?null:0};this.historyData=[],l["a"].inspectSingleHst(e).then((function(e){if(1===t.lookType){var i=e.data;i.map((function(t){0===t.resultValue?(t.color="#f00",t.size="large"):(t.size="large",t.type="primary")})),t.historyData=t.erweiArr(4,i)}else 0===t.lookType&&(t.historyData=e.data)})).finally((function(){t.loading=!1}))},viewBigpicture:function(t){this.$refs.bigImage.open(t)},closeViewer:function(){this.showViewer=!1},handleHistoryDetail:function(){this.lookType=1,this.showContent=!0,this.lookHistoryInfo()},handleErrorInfo:function(){this.lookType=0,this.showContent=!1,this.lookHistoryInfo()},erweiArr:function(t,e){var i=[];e.forEach((function(e,a){var n=Math.floor(a/t);i[n]||(i[n]=[]),i[n].push(e)}));var a=[],n=i.length;return i.forEach((function(t,e){e+1<=n-1&&t.push(i[e+1][0]),a.push(t)})),a}},mounted:function(){}},v=g,m=(i("87d6"),i("2877")),y=Object(m["a"])(v,a,n,!1,null,null,null);e["default"]=y.exports},"87d6":function(t,e,i){"use strict";i("615f")},"897e":function(t,e,i){},"8e01":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:[1===t.flag?"no-data2":2===t.flag?"no-data3":3===t.flag?"no-data4":4===t.flag?"no-data5":5===t.flag?"no-data6":6===t.flag?"no-data7":"no-data"]},[t._v("\n  暂无数据\n")])},n=[],s={props:{flag:Number}},r=s,o=(i("bd36"),i("2877")),l=Object(o["a"])(r,a,n,!1,null,null,null);e["a"]=l.exports},"915f":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-row",{attrs:{gutter:10}},[i("el-col",{staticStyle:{"padding-right":"20px"},attrs:{span:24,md:15}},[i("runtime-video",{ref:"runtimeVideo"})],1),i("el-col",{attrs:{span:24,md:9}},[i("d2-card",{staticClass:"box-card d2-mb",staticStyle:{height:"100%"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("i",{staticClass:"fa fa-info-circle"}),i("span",[t._v("识别信息")])]),i("div",{staticStyle:{height:"calc(50vh - 155px)",width:"100%","overflow-y":"auto"}},[i("el-row",{staticClass:"el-row-margin",attrs:{gutter:10}},[i("el-col",{staticStyle:{padding:"0"},attrs:{span:24,md:13}},[i("div",{staticClass:"basic-sty"},[i("span",[t._v("设备名称:")]),i("span",[t._v(t._s(this.devTreeNode.spaceName||"暂无"))])]),i("div",{staticClass:"basic-sty"},[i("span",[t._v("巡检目标:")]),i("span",[t._v(t._s(this.devTreeNode.name||"暂无"))])]),i("div",{staticClass:"basic-sty"},[i("span",[t._v("识别结果:")]),t.resultList.length>0?i("div",{staticClass:"div-result"},t._l(t.resultList,(function(e,a){return i("ul",{key:a},t._l(e.properties,(function(e){return i("li",{key:e.id},[i("span",[t._v(t._s(e.sceneName))]),i("span",[t._v(t._s("("+e.sceneValueName+")"))])])})),0)})),0):i("span",[t._v("--")])]),i("div",{staticClass:"basic-sty"},[i("span",[t._v("识别结果纠错:")]),i("el-radio-group",{on:{change:t.handleResult},model:{value:t.distinguishResult,callback:function(e){t.distinguishResult=e},expression:"distinguishResult"}},[i("el-radio",{attrs:{label:1,disabled:t.radioDisabled}},[t._v("正常")]),i("el-radio",{attrs:{label:0,disabled:t.radioDisabled}},[t._v("异常")])],1)],1),i("el-button",{attrs:{type:"primary",loading:t.loginLoading,disabled:t.startDisabled},on:{click:t.startDistinguish}},[t._v("开始识别")])],1),i("el-col",{staticStyle:{padding:"0"},attrs:{span:24,md:11}},[i("div",{staticClass:"distinguish-img"},[i("canvas-img",{key:t.content&&t.content.id,staticStyle:{cursor:"pointer"},attrs:{fontSize:"14",itemData:t.content,picUrl:t.content.resultPhoto||"",resultMark:t.content.remark?JSON.parse(t.content.remark):[]},on:{canvasClick:t.viewBigpicture}})],1)])],1)],1)])],1)],1),i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:24,md:24}},[i("history-info",{ref:"historyInfo"})],1)],1),i("big-image",{ref:"bigImage",on:{emitUpdateData:t.getNewData}})],1)},n=[],s=i("1c36"),r=i("80f1"),o=i("2f62"),l=i("3709"),c=i("d6a8"),u=i("1946");function d(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function f(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?d(Object(i),!0).forEach((function(e){h(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):d(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function h(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var p={components:{RuntimeVideo:s["default"],HistoryInfo:r["default"],CanvasImg:c["a"],BigImage:u["default"]},data:function(){return{keyName:"HistoryInfo",tabPosition:"top",resultValue:2,resultList:[],distinguishResult:null,confirData:null,timer:null,startDisabled:!0,radioDisabled:!0,oldTime:"",curTime:"",content:{},loginLoading:!1}},computed:f(f({},Object(o["c"])("d2admin",{devTreeNode:"tree/devTreeNode"})),{},{devId:function(){return this.devTreeNode.id}}),watch:{devId:function(t,e){t&&(this.confirData={},this.content={},this.radioDisabled=!0,this.startDisabled=!1,this.distinguishResult=null,this.getNewData())}},methods:{startDistinguish:function(){var t=this;if(this.loginLoading=!0,this.distinguishResult=null,this.startDisabled=!0,this.devId){var e={spaceVarId:this.devId,nodeType:this.devTreeNode.nodeType,rawId:this.devTreeNode.rawId,spaceId:this.devTreeNode.spaceId};l["a"].startIdentificate(e).then((function(e){e&&e.data&&(1===e.data.status?(t.confirData=e.data,t.$message({type:"success",message:"识别成功"}),t.radioDisabled=!1,t.getNewData(),t.$refs.historyInfo.lookHistoryInfo()):0===e.data.status&&(t.radioDisabled=!0,t.$message({type:"error",message:"识别失败"})))})).finally((function(){t.startDisabled=!1,t.loginLoading=!1}))}else this.$message({type:"warning",message:"请选择识别点位"})},viewBigpicture:function(t){this.$refs.bigImage.open(t)},handleResult:function(){var t=this;if(this.confirData&&this.confirData.id){var e={id:this.confirData.id,personCheck:this.distinguishResult};l["a"].confirmResult(e).then((function(e){!0===e.data&&t.$message({type:"success",message:"修正成功"}),t.radioDisabled=!0,t.getNewData()})).finally((function(){}))}else this.$message({type:"warning",message:"请等待识别结果"})},getNewData:function(){var t=this,e={spaceVarId:this.devId,startTime:"",endTime:"",resultValue:null};l["a"].inspectSingleHst(e).then((function(e){t.content=e.data[0],e.data[0]&&e.data[0].remark?t.resultList=JSON.parse(e.data[0].remark):t.resultList=[],t.distinguishResult=Number(e.data[0]&&e.data[0].personCheck)})).finally((function(){t.loading=!1}))},errorData:function(t){var e="";return t.remark&&JSON.parse(t.remark).map((function(t){e=t.tagName||"",t.properties&&t.properties.map((function(t,i){var a=t.sceneName+t.sceneValueName;e+="\n"+a}))})),e}},beforeDestroy:function(){clearInterval(this.timer)}},g=p,v=(i("0cb5"),i("5018"),i("2877")),m=Object(v["a"])(g,a,n,!1,null,"3596b9c4",null);e["default"]=m.exports},9260:function(t,e,i){"use strict";i("b4a0")},b4a0:function(t,e,i){},bd36:function(t,e,i){"use strict";i("34d1")},c92f9:function(t,e,i){t.exports=i.p+"img/dev.51961090.png"},d759:function(t,e,i){},e757:function(t,e,i){}}]);