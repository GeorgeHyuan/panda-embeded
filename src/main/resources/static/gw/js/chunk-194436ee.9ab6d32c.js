(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-194436ee","chunk-7253d69a","chunk-4dd8f1e1"],{"000e":function(t,e,a){},"0798":function(t,e,a){},"0c8d":function(t,e,a){"use strict";a("0798")},"373a":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("fullCalendar",{ref:"fullCalendar",on:{setDate:t.setDate}}),t.ganttState?a("div",{ref:"gantt2",staticClass:"left-container"}):t._e()],1)},c=[],o=a("6bfb"),i=(a("dfda"),a("e982")),s=a("cbe7"),l=a("9951"),r=a("e1e5"),u=a("7658"),d=a("6f62"),p={name:"gantt",components:{fullCalendar:i["default"]},mixins:[l["a"]],props:{time:{type:String,default:""}},data:function(){return{tasks:{data:[]},ganttState:!1,ws:null}},watch:{time:function(){this.initData(this.time)}},methods:{ganttInit:function(){var t=this;o["gantt"].config.readonly=!0,o["gantt"].config.show_grid=!0,o["gantt"].config.grid_width="1000",o["gantt"].config.scroll_on_click=!0,o["gantt"].config.columns=[{name:"name",label:"任务名字",align:"center",tree:!1,width:"240"},{name:"type",label:"任务类型",tree:!1,width:"120",align:"center",template:function(e){var a="";return t.taskTypeOptions.forEach((function(t){e.type===t.value&&(a=t.label)})),a}},{name:"startTime",align:"center",label:"开始时间",tree:!1,width:"154"},{name:"status",label:"任务状态",align:"center",template:function(e){var a="";return t.taskStateOptions.forEach((function(t){e.status===t.value&&(a=t.label)})),'<span style="color:'.concat(e.color,';">').concat(a,"</span>")}},{name:"text",label:"任务进度",tree:!1,width:"60",align:"center",template:function(t){return(t.inspectPointChecked||0)+"/"+t.inspectPointTotal}},{name:"inspectPointTotal",label:"总任务数",align:"center",tree:!1,width:"60"},{name:"text",label:"操作",align:"center",width:"290",template:function(t){var e=4===t.status,a=3===t.status,n=3===t.status||4===t.status,c=2===t.status||1===t.status||6===t.status,o={};return o.id=t.idStr,o.inspectTaskIdStr=t.inspectTaskIdStr,'<span class="'.concat(a?"durationks ganttText ganttTextks":"noClassgantt noClassganttks",'" data-obj=').concat(JSON.stringify(o),'>继续</span>\n            <span class="').concat(e?"durationzt ganttText ganttTextzt":"noClassgantt noClassganttzt",'"  data-obj=').concat(JSON.stringify(o),'>暂停</span>\n            <span class="').concat(c?"durationzx ganttText ganttTextzx":"noClassgantt noClassganttzx",'"  data-obj=').concat(JSON.stringify(o),'>执行</span>\n            <span class="').concat(n?"durationzz ganttText ganttTextzz":"noClassgantt noClassganttzz",'"  data-obj=').concat(JSON.stringify(o),">终止</span>")}}],o["gantt"].config.duration_unit="minute",o["gantt"].config.date_format="%Y-%m-%d %H:%i:%s",o["gantt"].config.start_date=new Date(this.time+" 00:00:00"),o["gantt"].config.end_date=new Date(this.time+" 23:59:59"),o["gantt"].config.step=2,o["gantt"].config.scales=[{unit:"minute",step:5,format:"%H:%i:%s"}],o["gantt"].config.task_height=28,o["gantt"].config.scale_height=45,o["gantt"].config.row_height=36,o["gantt"].config.min_column_width=80,o["gantt"].templates.task_text=function(t,e,a){return(100*a.progress).toFixed(2)+"%"},o["gantt"].plugins({tooltip:!0}),o["gantt"].templates.show_tooltip=!0,o["gantt"].templates.tooltip_text=function(t,e,a){var n=Object(d["b"])(new Date(a.startTime).getTime()+60*a.duration*1e3);return"<div>\n                <span>开始时间：</span><span>".concat(a.startTime,"</span><br/>\n                <span>预计时间：</span><span>").concat(n,".000</span><br/>\n                <span>实际时间：</span><span>").concat(a.endTime||"--","</span><br/>\n                <span>任务名称：</span><span>").concat(a.name,"</span><br/>\n                <span>任务进度：</span><span>").concat((a.inspectPointChecked||0)+"/"+a.inspectPointTotal,"</span>\n              </div>")},o["gantt"].templates.task_class=function(t,e,a){return 0===a.$level?"firstLevelTask":"secondLevelTask"},o["gantt"].init(this.$refs.gantt2)},initData:function(t,e){var a=this;this.tasks.data=[];var n={statusList:[],startTime:this.time+" 00:00:00",startTimeEnd:this.time+" 23:59:59"};s["a"].getRecordList(n).then((function(t){t.data.map((function(t){t.start_date=Object(d["b"])(t.startTime),t.id=t.idStr;var e="",n="";5===t.status?(e="#E6A23C99",n="#E6A23C"):4===t.status?(e="#67C23A99",n="#67C23A"):3===t.status?(e="#90939999",n="#909399"):2===t.status?(e="#F56C6C99",n="#F56C6C"):1!==t.status&&6!==t.status||(e="#8EBBF8",n="#409EFF"),t.color=e,t.borderColor=n,t.progress=(t.inspectPointChecked||0)/(t.inspectPointTotal||0),t.duration=t.desc,a.tasks.data.push(t)}))})).finally((function(){a.tasks.data.length>0?a.$nextTick((function(){$(".gantt_grid_data")[0].children[0].click()})):a.$emit("taskClick",""),a.ganttInit(),o["gantt"].parse(a.tasks),a.durationFun()}))},webSocketInitData:function(t,e){var a=this;this.tasks.data=[],t.map((function(t){t.start_date=t.startTime,t.id=t.idStr;var e="",n="";5===t.status?(e="#E6A23C99",n="#E6A23C"):4===t.status?(e="#67C23A99",n="#67C23A"):3===t.status?(e="#90939999",n="#909399"):2===t.status?(e="#F56C6C99",n="#F56C6C"):1!==t.status&&6!==t.status||(e="#8EBBF8",n="#409EFF"),t.color=e,t.borderColor=n,t.progress=(t.inspectPointChecked||0)/(t.inspectPointTotal||0),t.duration=t.desc,a.tasks.data.push(t)})),"定时器"===e?this.$emit("taskClick","","定时器"):this.tasks.data.length>0?this.$emit("taskClick",this.tasks.data[0].id):this.$emit("taskClick",""),o["gantt"].parse(this.tasks),this.durationFun()},setDate:function(t){this.time=t},task_zhanting:function(t){var e=this;this.$confirm("此操作将暂停任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){u["a"].pauseTask(JSON.parse(t.currentTarget.getAttribute("data-obj")).id).then((function(t){var a=t.code;"0"===a&&(e.$message({type:"success",message:"暂停成功!"}),e.initData(e.time))})).catch((function(){})).finally((function(){}))})).catch((function(){e.$message({type:"info",message:"已取消暂停"}),e.durationFun()}))},task_kaishi:function(t){var e=this;this.$confirm("此操作将开始任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){u["a"].restartTask(JSON.parse(t.currentTarget.getAttribute("data-obj")).id).then((function(t){var a=t.code;"0"===a&&(e.$message({type:"success",message:"开始成功!"}),e.initData(e.time))})).catch((function(){})).finally((function(){}))})).catch((function(){e.$message({type:"info",message:"已取消开始"}),e.durationFun()}))},task_zhongzhi:function(t){var e=this;this.$confirm("此操作将终止任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){u["a"].stopTask(JSON.parse(t.currentTarget.getAttribute("data-obj")).id).then((function(t){var a=t.code;"0"===a&&(e.$message({type:"success",message:"终止成功!"}),e.initData(e.time))})).catch((function(){})).finally((function(){}))})).catch((function(){e.$message({type:"info",message:"已取消终止"}),e.durationFun()}))},task_zhixing:function(t){var e=this;this.$confirm("此操作将立即执行任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a={execType:1,id:JSON.parse(t.currentTarget.getAttribute("data-obj")).inspectTaskIdStr};r["a"].startTask(a).then((function(t){var a=t.code;"0"===a&&(e.$message({type:"success",message:"执行成功!"}),e.initData(e.time))})).catch((function(){})).finally((function(){}))})).catch((function(){e.$message({type:"info",message:"已取消执行"}),e.durationFun()}))},durationFun:function(){var t=this;this.$nextTick((function(){$(".durationzt").unbind(),$(".durationzt").on("click",(function(e){t.task_zhanting(e)})),$(".durationzz").unbind(),$(".durationzz").on("click",(function(e){t.task_zhongzhi(e)})),$(".durationzx").unbind(),$(".durationzx").on("click",(function(e){t.task_zhixing(e)})),$(".durationks").unbind(),$(".durationks").on("click",(function(e){t.task_kaishi(e)}))}))},monthOpen:function(){this.$refs.fullCalendar.open()},WebSocketTest:function(){var t=this;"WebSocket"in window?(console.log("您的浏览器支持 WebSocket!"),this.ws=new WebSocket(VUE_SOCKET_URL+"/echo/syl"+(new Date).getTime()),this.ws.onopen=function(){console.log("数据发送中...")},this.ws.onmessage=function(e){console.log("数据已接收..."),t.time===Object(d["d"])("d")&&(console.log("webSocketInitData"),t.webSocketInitData(JSON.parse(e.data),"定时器"))},this.ws.onclose=function(t){console.log("连接已关闭...")}):console.log("您的浏览器不支持 WebSocket!")}},mounted:function(){var t=this;setTimeout((function(){t.ganttInit(),t.initData(t.time),o["gantt"].attachEvent("onTaskClick",(function(e,a){return t.$emit("taskClick",e),t.durationFun(),!0})),t.WebSocketTest()}),200)},created:function(){this.ganttState=!0,o["gantt"].clearAll(),o["gantt"].close()},beforeDestroy:function(){this.ganttState=!1,o["gantt"].clearAll(),clearInterval(this.times),this.ws.close()}},f=p,g=(a("f2fa"),a("77f3"),a("2877")),h=Object(g["a"])(f,n,c,!1,null,"b16cb246",null);e["default"]=h.exports},7658:function(t,e,a){"use strict";var n=a("9bd2"),c=VUE_APP_API_LIVE,o=VUE_APP_API_STATION,i=VUE_APP_API;e["a"]={ptzcontrollerStart:function(t){return Object(n["a"])({url:"".concat(o,"/camera/ptzcontrollerStart"),method:"post",data:t})},ptzcontrollerStop:function(t){return Object(n["a"])({url:"".concat(o,"/camera/ptzcontrollerStop"),method:"post",data:t})},getBasicsBySpaceIdAndType:function(t){return Object(n["a"])({url:"".concat(o,"/station/video/getBasicsBySpaceIdAndType"),method:"post",data:t})},getOrganizeSpaceIds:function(t){return Object(n["a"])({url:"".concat(o,"/station/video/getOrganizeSpaceIds"),method:"post",params:t})},getPageVideo:function(t){var e=t.data;return Object(n["a"])({url:"".concat(o,"/station/video/getBasicsBySpaceIdAndType?spaceId=").concat(e.spaceId,"&type=assistance_camera"),method:"get"})},startPlay:function(t){var e=t.data;return Object(n["a"])({url:"".concat(c,"/").concat(e.room,"/").concat(e.channel,"/startPlay"),method:"get"})},stopPlay:function(t){var e=t.data;return Object(n["a"])({url:"".concat(c,"/").concat(e.room,"/").concat(e.channel,"/stopPlay"),method:"get"})},ptzStart:function(t){var e=t.data;return Object(n["a"])({url:"".concat(o,"/common/sipPtzCmd?idAndChild=").concat(e.idAndChild,"&ptzcmd=").concat(e.direct),method:"get"})},eventMediaUpload:function(t){var e=t.data;return Object(n["a"])({url:"".concat(c,"/").concat(e.deviceId,"/").concat(e.evtId,"/").concat(e.protocol,"/").concat(e.type,"/eventMediaUpload"),method:"get"})},movePresetByAli:function(t){return Object(n["a"])({url:"".concat(o,"/camera/movePreset"),method:"post",data:{id:t.cameraId,presetToken:t.point}})},snapShot:function(t){return Object(n["a"])({url:"".concat(i,"/camera/snapShot"),method:"post",data:t})},getDataPointDetailYx:function(t){return Object(n["a"])({url:"".concat(i,"/device/space/queryDgtByRawId"),method:"post",data:t})},getDataPointDetailYc:function(t){return Object(n["a"])({url:"".concat(i,"/device/space/queryAnalogByRawId"),method:"post",data:t})},cameraStatus:function(t){return Object(n["a"])({url:"".concat(i,"/real/cameraStatus"),method:"post",params:t})},pauseTask:function(t){return Object(n["a"])({url:"".concat(o,"/camera/").concat(t,"/pauseTask"),method:"post"})},restartTask:function(t){return Object(n["a"])({url:"".concat(o,"/camera/").concat(t,"/restartTask"),method:"post"})},stopTask:function(t){return Object(n["a"])({url:"".concat(o,"/camera/").concat(t,"/stopTask"),method:"post"})},queryChannel:function(){return Object(n["a"])({url:"".concat(i,"/srs/queryChannel"),method:"get"})},querySession:function(){return Object(n["a"])({url:"".concat(i,"/srs/querySession"),method:"get"})},sip_invite:function(t){return Object(n["a"])({url:"".concat(VUE_APP_API_LIVE_KONG,"?action=sip_invite&id=").concat(t.id,"&chid=").concat(t.chid),method:"get"})},snapShotAndExcuteBase:function(t){return Object(n["a"])({url:"".concat(o,"/camera/snapShotAndExcuteBase"),method:"post",data:t})}}},"77f3":function(t,e,a){"use strict";a("a047")},9951:function(t,e,a){"use strict";e["a"]={data:function(){return{implementOptions:[{value:1,label:"立即"},{value:2,label:"定时"},{value:3,label:"周期"}],taskStateOptions:[{value:6,label:"手动停止"},{value:5,label:"等待执行"},{value:4,label:"正在执行"},{value:3,label:"任务暂停"},{value:2,label:"异常终止"},{value:1,label:"已完成"}],taskTypeOptions:[{value:"1",label:"例行巡视"},{value:"2",label:"特殊巡视"},{value:"3",label:"专项巡视"},{value:"4",label:"自定义巡视"}],timeOptions:[{value:"1",label:"每天"},{value:"2",label:"每周"},{value:"3",label:"每月"}],monthOptions:[{value:"1",label:"1"},{value:"2",label:"2"},{value:"3",label:"3"},{value:"4",label:"4"},{value:"5",label:"5"},{value:"6",label:"6"},{value:"7",label:"7"},{value:"8",label:"8"},{value:"9",label:"9"},{value:"10",label:"10"},{value:"11",label:"11"},{value:"12",label:"12"},{value:"13",label:"13"},{value:"14",label:"14"},{value:"15",label:"15"},{value:"16",label:"16"},{value:"17",label:"17"},{value:"18",label:"18"},{value:"19",label:"19"},{value:"20",label:"20"},{value:"21",label:"21"},{value:"22",label:"22"},{value:"23",label:"23"},{value:"24",label:"24"},{value:"25",label:"25"},{value:"26",label:"26"},{value:"27",label:"27"},{value:"28",label:"28"},{value:"29",label:"29"},{value:"30",label:"30"},{value:"31",label:"31"}],weekOptions:[{value:"1",label:"周一"},{value:"2",label:"周二"},{value:"3",label:"周三"},{value:"4",label:"周四"},{value:"5",label:"周五"},{value:"6",label:"周六"},{value:"7",label:"周日"}],warningOptions:[{value:1,label:"是"},{value:0,label:"否"}],addrFormat:{"power-infra-gloves-detection":"未带手套","helmet-classify":"未带安全帽"}}}}},a047:function(t,e,a){},cbe7:function(t,e,a){"use strict";var n=a("9bd2"),c=VUE_APP_API_STATION;e["a"]={getRecordList:function(t){return Object(n["a"])({url:"".concat(c,"/inspection/record/getRecordList"),method:"post",data:t})},getRecordItemPage:function(t){return Object(n["a"])({url:"".concat(c,"/evt/list/").concat(t.current,"/").concat(t.size),method:"get"})},getRecordItemList:function(t){return Object(n["a"])({url:"".concat(c,"/inspection/recordItem/getRecordItemList"),method:"post",data:t})},getRecordExecutorPage:function(t){return Object(n["a"])({url:"".concat(c,"/inspection/recordExecutor/getRecordExecutorPage"),method:"post",data:t})},getRecordById:function(t){return Object(n["a"])({url:"".concat(c,"/inspection/record/getRecordById/").concat(t),method:"post"})},getModelCount:function(t){return Object(n["a"])({url:"".concat(c,"/getModelCount"),method:"get"})},getEvtCount:function(t){return Object(n["a"])({url:"".concat(c,"/evt/getEvtCount"),method:"get"})},getRealHumTmp:function(){return Object(n["a"])({url:"".concat(c,"/real/getRealHumTmp"),method:"get"})}}},dfda:function(t,e,a){},e1e5:function(t,e,a){"use strict";var n=a("9bd2"),c=VUE_APP_API,o=VUE_APP_API_STATION;e["a"]={nodeGetById:function(t){return Object(n["a"])({url:"".concat(c,"/device/space/getById/").concat(t),method:"get"})},deleteInspectTaskById:function(t){return Object(n["a"])({url:"".concat(o,"/inspection/task/deleteInspectTaskById/").concat(t),method:"delete"})},saveInspectTask:function(t){return Object(n["a"])({url:"".concat(o,"/inspection/task/saveInspectTask"),method:"post",data:t})},updateInspectTask:function(t){return Object(n["a"])({url:"".concat(o,"/inspection/task/updateInspectTask"),method:"put",data:t})},getPageInspectTask:function(t){return Object(n["a"])({url:"".concat(o,"/inspection/task/getPageInspectTask"),method:"post",data:t})},getInspectTaskById:function(t){return Object(n["a"])({url:"".concat(o,"/inspection/task/getInspectTaskById"),method:"post",data:t})},startTask:function(t){return Object(n["a"])({url:"".concat(o,"/inspection/record/startTask"),method:"post",data:t})},getCameraPoint:function(t){return Object(n["a"])({url:"".concat(c,"/device/space/getInspectionPointById"),method:"post",params:t})},getCameraPointType:function(t){return Object(n["a"])({url:"".concat(c,"/device/space/getInspectionPointById?id=").concat(t.id,"&nodeTypeList=").concat(t.nodeTypeList[0],"&nodeTypeList=").concat(t.nodeTypeList[1]),method:"post"})},getCalendar:function(t){return Object(n["a"])({url:"".concat(o,"/inspection/task/getCalendar"),method:"post",data:t})},getYear:function(t){return Object(n["a"])({url:"".concat(o,"/inspection/task/getYear"),method:"post",data:t})}}},e982:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("dialog-container",{attrs:{title:"月计划查看",width:"1200px",height:"400px",visible:t.visible,submitLoading:t.submitLoading,"show-footer":!1},on:{"update:visible":function(e){t.visible=e},closed:t.handleClosed,closeDialog:t.close,comfirmDialog:t.comfirmDialog}},[a("div",{staticClass:"dialog-box"},[a("full-calendar",{ref:"calendar",staticClass:"calendar",attrs:{config:t.calendarConfig,events:t.calendarEvents},on:{"event-selected":t.eventClick,"day-click":t.dayClick}})],1)])},c=[],o=a("25cc"),i=(a("fa91"),a("cbe7")),s=a("6f62"),l={components:{FullCalendar:o["a"]},mixins:[],data:function(){var t=this;return{visible:!1,submitLoading:!1,defaultDate:Object(s["d"])("d"),calendarConfig:{firstDay:1,weekNumberCalculation:"ISO",weekends:!0,locale:"zh-cn",defaultView:"month",defaultDate:Object(s["d"])("d"),height:786,fixedWeekCount:!0,showNonCurrentDates:!1,allDaySlot:!1,eventStartEditable:!1,eventDurationEditable:!1,events:function(e,a,n,c){t.defaultDate=Object(s["c"])(e),t.initData(),c(t.calendarEvents)},header:{left:"",center:"title",right:"prevYear,prev,today,next,nextYear"},buttonText:{today:"当月"}},calendarEvents:[]}},watch:{defaultDate:function(t){}},computed:{},mounted:function(){},methods:{open:function(t,e){this.init()},close:function(){this.visible=!1},handleClosed:function(){this.$nextTick((function(){}))},init:function(){this.visible=!0},initData:function(){var t=this;this.calendarEvents=[];var e={statusList:[1,2,3,4,5],startTime:this.defaultDate.split("-")[0]+"-"+this.defaultDate.split("-")[1]+"-01 00:00:00",startTimeEnd:this.defaultDate.split("-")[0]+"-"+this.defaultDate.split("-")[1]+"-"+Object(s["a"])(this.defaultDate.split("-")[0],this.defaultDate.split("-")[1])+" 23:59:59"};i["a"].getRecordList(e).then((function(e){e.data.map((function(e){e.title=e.name,5===e.status?(e.backgroundColor="#E6A23C",e.borderColor="#E6A23C"):4===e.status?(e.backgroundColor="#67C23A",e.borderColor="#67C23A"):3===e.status?(e.backgroundColor="#909399",e.borderColor="#909399"):2===e.status?(e.backgroundColor="#F56C6C",e.borderColor="#F56C6C"):1!==e.status&&6!==e.status||(e.backgroundColor="#409EFF",e.borderColor="#409EFF"),e.url="",e.textColor="#fff",e.start=e.startTime,e.startDay=e.startTime.split(" ")[0];var a=0;t.calendarEvents.map((function(t){t.startDay===e.startDay&&a++})),a<5&&t.calendarEvents.push(e)}))})).catch((function(t){console.log(t)})).finally((function(){}))},eventClick:function(t){this.$emit("setDate",t.startDay),this.close()},dayClick:function(t,e,a){this.$emit("setDate",Object(s["c"])(t._i)),this.close()},comfirmDialog:function(){}}},r=l,u=(a("0c8d"),a("2877")),d=Object(u["a"])(r,n,c,!1,null,null,null);e["default"]=d.exports},f2fa:function(t,e,a){"use strict";a("000e")}}]);