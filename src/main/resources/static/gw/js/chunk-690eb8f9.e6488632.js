(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-690eb8f9","chunk-2d0d094a","chunk-2d209511"],{"0f89":function(e,t,a){},1435:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("dialog-container",{attrs:{title:"任务执行",width:"800px",height:"400px",visible:e.visible,submitLoading:e.submitLoading,confirmText:"确定",showFooter:!1},on:{"update:visible":function(t){e.visible=t},closed:e.handleClosed,closeDialog:e.close,comfirmDialog:e.comfirmDialog}},[a("div",{staticClass:"dialog-box"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:24}},[a("el-form",{ref:"ruleForm",staticClass:"d2-form d2-form-check",attrs:{"label-position":"right",model:e.formInline,rules:e.rules,"label-width":"90px"}},[a("el-col",{staticClass:"rules",attrs:{span:24}},[a("el-form-item",{attrs:{label:"任务名称",prop:"name"}},[a("el-input",{attrs:{disabled:""},model:{value:e.formInline.name,callback:function(t){e.$set(e.formInline,"name",t)},expression:"formInline.name"}})],1)],1),a("el-col",{staticClass:"rules",attrs:{span:24}},[a("el-form-item",{attrs:{label:"任务类型",prop:"type"}},[a("el-select",{attrs:{disabled:"",clearable:"",placeholder:"请选择"},model:{value:e.formInline.type,callback:function(t){e.$set(e.formInline,"type",t)},expression:"formInline.type"}},e._l(e.taskTypeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("el-col",{staticClass:"rules",attrs:{span:24}},[a("el-form-item",{attrs:{label:"执行方式",prop:"execType"}},[a("el-select",{attrs:{disabled:"",clearable:"",placeholder:"请选择"},on:{change:e.implementChange},model:{value:e.formInline.execType,callback:function(t){e.$set(e.formInline,"execType",t)},expression:"formInline.execType"}},e._l(e.implementOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),3===e.formInline.execType?a("div",[e._l(e.timeStrData,(function(t,i){return[a("el-tag",{key:i+"tag",staticClass:"tagClass"},[e._v(e._s(t.timeType+" "+t.time+" "+t.htime))])]})),e._l(e.timesData,(function(t,i){return[a("el-form",{key:i+"key",staticClass:"demo-form-inline",attrs:{inline:!0,"label-width":"0px",model:e.timesData[i]}},[a("el-form-item",{staticClass:"timeTypeSelect",attrs:{label:"开始时间","label-width":"95px"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.timesData[i].timeType,callback:function(t){e.$set(e.timesData[i],"timeType",t)},expression:"timesData[index].timeType"}},e._l(e.timeOptions,(function(e){return a("el-option",{key:e.value+"timeOptions"+i,attrs:{label:e.label,value:e.value}})})),1)],1),"2"===e.timesData[i].timeType?a("el-form-item",{staticClass:"timeSelect"},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.timesData[i].time,callback:function(t){e.$set(e.timesData[i],"time",t)},expression:"timesData[index].time"}},e._l(e.weekOptions,(function(e){return a("el-option",{key:e.value+"weekOptions"+i,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"3"===e.timesData[i].timeType?a("el-form-item",{staticClass:"timeSelect"},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.timesData[i].time,callback:function(t){e.$set(e.timesData[i],"time",t)},expression:"timesData[index].time"}},e._l(e.monthOptions,(function(e){return a("el-option",{key:e.value+"monthOptions"+i,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),a("el-form-item",{staticClass:"htimeSelect"},[a("el-time-select",{attrs:{clearable:!1,"picker-options":{start:"00:00",step:"00:01",end:"23:59"},placeholder:"选择时间"},model:{value:e.timesData[i].htime,callback:function(t){e.$set(e.timesData[i],"htime",t)},expression:"timesData[index].htime"}})],1),3===e.formInline.execType?a("el-form-item",{staticClass:"timeAdd"},[a("el-button",{attrs:{type:"primary",circle:"",icon:"fa fa-plus"},on:{click:e.addTime}})],1):e._e(),3===e.formInline.execType?a("el-form-item",{staticClass:"timedelete"},[a("el-button",{attrs:{type:"danger",circle:"",icon:"fa fa-trash"},on:{click:function(t){return e.removeTime(i)}}})],1):e._e()],1)]}))],2):e._e(),2===e.formInline.execType?a("div",[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,"label-width":"95px",model:e.execForm}},[a("el-form-item",{attrs:{label:"执行方式",prop:"execType"}},[a("el-date-picker",{attrs:{type:"datetime",clearable:!1,placeholder:"选择日期时间",align:"right","picker-options":e.pickerOptions},model:{value:e.execForm.execDate,callback:function(t){e.$set(e.execForm,"execDate",t)},expression:"execForm.execDate"}})],1)],1)],1):e._e()],1)],1)],1),a("div",{staticClass:"btn-group"},[3===e.formInline.execType?a("el-button",{attrs:{icon:"fa fa-floppy-o",type:"primary",size:"medium",loading:e.submitLoading},on:{click:e.addTime}},[e._v("新增周期")]):e._e(),a("el-button",{attrs:{size:"medium"},on:{click:e.close}},[e._v("取消")]),a("el-button",{attrs:{icon:"fa fa-floppy-o",type:"primary",size:"medium",loading:e.submitLoading},on:{click:e.comfirmDialog}},[e._v(e._s(3===e.formInline.execType?"执行并保存":"执行"))])],1)])},n=[],r=a("e1e5"),s=a("9951"),o=a("f0b0"),l=a("6f62"),c=a("2f62");function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){m(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function m(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var p={components:{},mixins:[s["a"]],data:function(){return{visible:!1,submitLoading:!1,formInline:{execType:null,name:"",type:null},rules:{name:[{required:!0,message:"请输入任务名称",trigger:"blur"},{validator:o["a"],trigger:"blur"},{max:64,message:"最大长度64 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择任务类型",trigger:"blur"}],execType:[{required:!0,message:"请选择执行方式",trigger:"blur"}]},rulesTime:{timeType:[{required:!0,message:"请选择时间类型",trigger:"blur"}],time:[{required:!0,message:"请选择时间",trigger:"blur"}],htime:[{required:!0,message:"请选择时分",trigger:"blur"}]},loading:!1,timesData:[{timeType:"1",time:"",htime:"00:00"}],timeStrData:[],execForm:{execDate:""},pickerOptions:{shortcuts:[{text:"一小时后",onClick:function(e){e.$emit("pick",new Date+36e5)}},{text:"明天",onClick:function(e){var t=new Date;t.setTime(t.getTime()+864e5),e.$emit("pick",t)}},{text:"一周后",onClick:function(e){var t=new Date;t.setTime(t.getTime()+6048e5),e.$emit("pick",t)}}],disabledDate:function(e){var t=e.getTime(),a=(new Date).getTime()-864e5;return t<a}}}},computed:u(u({},Object(c["c"])("d2admin",{treeNode:"tree/treeNode"})),{},{deviceId:function(){var e=this.treeNode.id;return e}}),watch:{stepTimeNum:function(e){this.$set(this.formInline,"desc",e)}},mounted:function(){},methods:{open:function(e,t){var a=this;this.$set(this.formInline,"type",e.type),this.$set(this.formInline,"name",e.name),this.$set(this.formInline,"id",e.id),this.$set(this.formInline,"execType",t),this.timesData=[],1===this.formInline.execType||(2===this.formInline.execType?this.execForm.execDate=(new Date).getTime()+6e4:3===this.formInline.execType&&(this.timeStrData=[],e.url&&(this.timesData=JSON.parse(e.url),this.timeStrData=[],this.timesData.map((function(e){var t={timeType:"",time:"",htime:""};t.time=e.time,t.htime=e.htime,"1"===e.timeType?t.timeType="每日":"2"===e.timeType?(t.timeType="每周",t.time="周"+e.time):(t.timeType="每月",t.time=e.time+"号"),a.timeStrData.push(t)}))))),this.init()},close:function(){this.visible=!1},handleClosed:function(){var e=this;this.$nextTick((function(){e.$refs.ruleForm.resetFields()}))},init:function(){this.visible=!0},addTime:function(){this.timesData.push({timeType:"1",time:"",htime:"01:00"})},removeTime:function(e){this.$delete(this.timesData,e)},implementChange:function(e){this.timesData=1===e?[]:[{timeType:"1",time:"",htime:"00:00"}]},comfirmDialog:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;e.apiFun()}))},apiFun:function(){var e=this;this.submitLoading=!0;var t=JSON.parse(JSON.stringify(this.formInline));t.execTime=this.timesData,t.url=this.timesData,t.execDate=Object(l["b"])(this.execForm.execDate),r["a"].startTask(t).then((function(t){var a=t.code;"0"===a&&(e.$message.success("任务已下发"),e.$emit("getappList"),e.$emit("monthInit"),e.visible=!1)})).finally((function(){e.submitLoading=!1}))}}},f=p,h=(a("a62e"),a("85b4"),a("2877")),v=Object(h["a"])(f,i,n,!1,null,"4dcdad08",null);t["default"]=v.exports},"1d51":function(e,t,a){},"4c12":function(e,t,a){},"510c":function(e,t,a){"use strict";a("1d51")},6477:function(e,t,a){"use strict";t["a"]={data:function(){var e=this,t=this;return{selectDate:null,pickerOptions0:{disabledDate:function(e){var a=e.getTime(),i=new Date(new Date((new Date).toLocaleDateString()).getTime()+864e5-1);if(t.selectDate){var n=(new Date).getFullYear(),r=(new Date).getMonth()+1,s=new Date(n+"-"+r+"-01 00:00:00").getTime();return t.selectDate.getMonth()+1===Number(r)?a>i||a<s:t.selectDate.getMonth()+1!==e.getMonth()+1}return a>i},onPick:function(t){!t.maxDate&&t.minDate?e.selectDate=t.minDate:e.selectDate=null}}}}}},"691b":function(e,t,a){"use strict";a.r(t),t["default"]={data:function(){var e=this;return{data:[],columns:[{title:"序号",key:"",width:60,formatter:function(t,a,i,n){return(e.pagination.currentPage-1)*e.pagination.pageSize+(n+1)}},{title:"任务名称",key:"name",showOverflowTooltip:!0},{title:"任务类型",key:"type",showOverflowTooltip:!0,formatter:function(t,a,i,n){var r="";return e.taskTypeOptions.forEach((function(e){i===e.value&&(r=e.label)})),r}},{title:"创建时间",key:"createTime",showOverflowTooltip:!0},{title:"总巡检点位",width:120,key:"inspectPointTotal",showOverflowTooltip:!0}],loading:!1,pagination:{currentPage:1,pageSize:20,total:0},rowHandle:{fixed:"right",width:420,custom:[{emit:"detailsOpen",text:"详情",size:"mini",type:"primary"},{emit:"startTask",text:"立即",size:"mini",type:"warning"},{emit:"startTask2",text:"定时",size:"mini",type:"warning"},{emit:"startTask3",text:"周期",size:"mini",type:"warning"},{emit:"editFun",text:"编辑",size:"mini",type:"warning"},{emit:"removeFun",text:"删除",size:"mini",type:"danger"}]},options:{stripe:!0,height:"calc(100vh - 371px)",border:!0}}}}},"714d":function(e,t,a){},"747e":function(e,t,a){"use strict";a("faff")},"7a93":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("d2-container",[a("template",{slot:"header"},[a("el-breadcrumb",[a("el-breadcrumb-item",[e._v("当前位置")]),a("el-breadcrumb-item",[e._v("智能巡检")]),a("el-breadcrumb-item",{attrs:{to:{path:"/refresh"}}},[e._v("任务管理")])],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("d2-card",{staticClass:"box-card d2-mr"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("i",{staticClass:"fa fa-map"}),a("span",[e._v("巡视方案")])]),a("d2-crud",{ref:"d2Crud",attrs:{columns:e.columns,data:e.data,"selection-row":"",loading:e.loading,options:e.options,pagination:e.pagination,"row-handle":e.rowHandle},on:{editFun:e.editOpen,detailsOpen:e.detailsOpen,startTask:e.startTask,startTask2:e.startTask2,startTask3:e.startTask3,removeFun:e.removeRow,"selection-change":e.handleSelectionChange,"pagination-current-change":e.paginationCurrentChange}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("el-form",{staticClass:"d2-form",attrs:{"label-position":"right",inline:!0,"label-width":"80px"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-row",[a("el-col",{attrs:{span:17,xl:18}},[a("el-row",{attrs:{gutter:10}},[a("el-form-item",{attrs:{label:"任务名称:"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入任务名称"},model:{value:e.appname,callback:function(t){e.appname=t},expression:"appname"}})],1),a("el-form-item",{attrs:{label:"任务类型:"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.taskType,callback:function(t){e.taskType=t},expression:"taskType"}},e._l(e.taskTypeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"创建时间:"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至",clearable:!0,"default-time":["00:00:00","23:59:59"],"picker-options":e.pickerOptions0,"start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}})],1),a("el-form-item",{attrs:{"label-width":"0px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.puery}},[e._v("查询")])],1)],1)],1),a("el-col",{attrs:{span:7,xl:6}},[a("div",{staticClass:"d2-form-fr"},[a("el-form-item",[a("el-button",{staticClass:"d2-fr d2-ml",attrs:{type:"primary",icon:"fa fa-plus"},on:{click:e.addOpen}},[e._v("新增")]),a("el-button",{staticClass:"d2-fr",attrs:{type:"danger",icon:"fa fa-trash"},on:{click:e.deleteapp}},[e._v("删除")]),a("el-button",{staticClass:"d2-fr d2-mt",attrs:{type:"primary",icon:"el-icon-setting"},on:{click:e.settingOpen}},[e._v("功能完善")])],1)],1)])],1)],1)],1)])],1)],1),a("el-col",{attrs:{span:12}},[a("d2-card",{staticClass:"box-card d2-mr",attrs:{showRightBtn:!1}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("i",{staticClass:"fa fa-tasks"}),a("span",[e._v("任务安排")]),a("div",{staticClass:"d2-card-button-group right-btn"},[a("el-radio-group",{attrs:{size:"mini"},model:{value:e.view,callback:function(t){e.view=t},expression:"view"}},[a("el-radio-button",{attrs:{label:"year"}},[e._v("年历")]),a("el-radio-button",{attrs:{label:"month"}},[e._v("月历")])],1)],1)]),"year"===e.view?a("year-calendar",{staticStyle:{height:"calc(100vh - 247px)"},attrs:{data:e.yearData},on:{clickEvent:e.clickEvent,clickMonth:e.clickMonth,switchYear:e.switchYear,yearInit:e.yearInit}}):e._e(),"month"===e.view?a("full-calendar",{ref:"monthRes"}):e._e()],1)],1)],1),a("addOpen",{ref:"addOpen",on:{getappList:e.getappList}}),a("implement",{ref:"implement",on:{getappList:e.getappList,monthInit:e.monthAndYearInit}}),a("maintenanceArea",{ref:"maintenanceArea"})],2)},n=[],r=a("9951"),s=a("6477"),o=a("691b"),l=a("b236"),c=a("e581"),d=a("e1e5"),u=a("83f4"),m=a("1435"),p=a("6f62"),f={name:"app-manage",components:{addOpen:l["default"],maintenanceArea:c["default"],FullCalendar:u["default"],implement:m["default"]},mixins:[s["a"],r["a"],o["default"]],data:function(){return{ids:[],appname:"",taskState:"",taskType:null,time:[],startTaskLoading:!1,view:"month",yearData:[],year:Object(p["d"])("y"),yuanshiYear:Object(p["d"])("y")}},computed:{},watch:{view:function(e){"month"===e?this.monthInit():this.yearInit()}},created:function(){this.getappList()},methods:{paginationCurrentChange:function(e){this.pagination.currentPage=e,this.getappList()},puery:function(){this.pagination.currentPage=1,this.getappList()},handleSelectionChange:function(e){this.ids=e},getappList:function(){var e=this;this.loading=!0;var t={current:this.pagination.currentPage,size:this.pagination.pageSize,name:this.appname,type:this.taskType||null,createTimeBegain:this.time[0]||null,createTimeEnd:this.time[1]||null};d["a"].getPageInspectTask(t).then((function(t){e.data=t.data.records,e.pagination.total=t.data.total})).catch((function(e){console.log(e)})).finally((function(){e.loading=!1}))},deleteapp:function(){if(0===this.ids.length)this.$message({message:"还没有选择操作应用，请勾选一条数据再进行操作",type:"warning"});else{var e=[];this.ids.map((function(t){e.push(t.id)})),this.removeApi(e)}},removeRow:function(e){var t=e.row,a=[];a.push(t.id),this.removeApi(a)},removeApi:function(e){var t=this;this.$confirm("此操作将永久删除数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){d["a"].deleteInspectTaskById(e[0]).then((function(e){var a=e.code;if("0"===a&&!0===e.data)t.$message({type:"success",message:"删除成功!"}),t.getappList();else{var i="";t.taskStateOptions.forEach((function(t){e.data===t.value&&(i=t.label)})),console.log(i),t.$message({type:"success",message:"失败原因："+i})}})).catch((function(){}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},editOpen:function(e){var t=e.row;this.$refs.addOpen.open("edit",t)},addOpen:function(){this.$refs.addOpen.open("add")},settingOpen:function(){this.$refs.maintenanceArea.open()},detailsOpen:function(e){var t=e.row;this.$refs.addOpen.open("details",t)},startTask:function(e){var t=e.row;this.$refs.implement.open(t,1)},startTask2:function(e){var t=e.row;this.$refs.implement.open(t,2)},startTask3:function(e){var t=e.row;this.$refs.implement.open(t,3)},clickEvent:function(e){console.log(e,"event")},clickMonth:function(e){console.log(e,"month")},switchYear:function(e){this.year=e,this.yearInit(),console.log(e,"year")},monthAndYearInit:function(){var e=this;"year"===this.view?this.yearInit():this.$nextTick((function(){e.$refs.monthRes.initData()}))},monthInit:function(){var e=this;this.$nextTick((function(){e.$refs.monthRes.initData()}))},yearInit:function(){var e=this;this.calendarEvents=[];var t="",a=2;console.log(this.year,this.yuanshiYear),this.year===this.yuanshiYear?(t=Object(p["b"])(new Date),a=2):(t=this.year+"-01-01",a=new Date(String(this.year)).getTime()>(new Date).getTime()?3:1);var i={dateStr:t,type:a};d["a"].getYear(i).then((function(t){e.yearData=[];for(var a=0;a<12;a++){var i="";i=a+1<10?"0"+String(a+1):String(a+1),e.yearData.push({month:i,data:[]})}t.data.map((function(t){var a=t.time.split("-")[1];t.array.map((function(e){"例行巡视"===e.name?e.status=0:"专项巡视"===e.name?e.status=1:"特殊巡视"===e.name?e.status=2:"自定义巡视"===e.name&&(e.status=3),e.name=e.name+" "+e.total}));var i=t.array;e.yearData.map((function(e){e.month===a&&(e.data=i)}))})),console.log(e.yearData,"this.yearData")})).catch((function(e){console.log(e)})).finally((function(){}))}}},h=f,v=(a("510c"),a("2877")),g=Object(v["a"])(h,i,n,!1,null,"0a4bc166",null);t["default"]=g.exports},"83f4":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("full-calendar",{ref:"calendar",staticClass:"calendar",attrs:{config:e.calendarConfig,events:e.calendarEvents},on:{"event-selected":e.eventClick,"day-click":e.dayClick}}),a("titleOpen",{ref:"titleOpen"})],1)},n=[],r=a("25cc"),s=(a("fa91"),a("e1e5")),o=a("f4dc"),l=a("6f62"),c={components:{FullCalendar:r["a"],titleOpen:o["default"]},mixins:[],data:function(){var e=this;return{yuanshiDate:Object(l["d"])("m"),defaultDate:Object(l["d"])("d"),calendarConfig:{firstDay:1,weekNumberCalculation:"ISO",weekends:!0,locale:"zh-cn",defaultView:"month",defaultDate:Object(l["d"])("d"),height:786,fixedWeekCount:!0,showNonCurrentDates:!1,allDaySlot:!1,eventStartEditable:!1,eventDurationEditable:!1,events:function(t,a,i,n){e.defaultDate=Object(l["c"])(t),e.initData(),n(e.calendarEvents)},header:{left:"",center:"title",right:"prevYear,prev,today,next,nextYear"},buttonText:{today:"当月"}},calendarEvents:[],data:[]}},watch:{defaultDate:function(e){}},computed:{},mounted:function(){},methods:{open:function(e,t){this.init()},close:function(){this.visible=!1},handleClosed:function(){this.$nextTick((function(){}))},init:function(){this.visible=!0},initData:function(){var e=this;this.calendarEvents=[];var t="",a=2;console.log(this.defaultDate,this.yuanshiDate),this.defaultDate.split("-")[0]+"-"+this.defaultDate.split("-")[1]===this.yuanshiDate?(t=Object(l["b"])(new Date),a=2):(t=this.defaultDate+" 00:00:00",a=new Date(this.defaultDate).getTime()>(new Date).getTime()?3:1);var i={dateStr:t,type:a};s["a"].getCalendar(i).then((function(t){t.data.map((function(t){t.title=t.name,5===t.type?(t.backgroundColor="#E6A23C",t.borderColor="#E6A23C"):4===t.type?(t.backgroundColor="#67C23A",t.borderColor="#67C23A"):3===t.type?(t.backgroundColor="#909399",t.borderColor="#909399"):2===t.type?(t.backgroundColor="#F56C6C",t.borderColor="#F56C6C"):1!==t.type&&6!==t.type||(t.backgroundColor="#409EFF",t.borderColor="#409EFF"),t.url="",t.textColor="#fff",t.start=t.dateStr,t.startDay=t.dateStr.split(" ")[0];var a=0;e.calendarEvents.map((function(e){e.startDay===t.startDay&&a++})),a<5&&e.calendarEvents.push(t)})),e.data=t.data})).catch((function(e){console.log(e)})).finally((function(){}))},eventClick:function(e){console.log(e,".....");var t=[];this.data.map((function(a){e.startDay===a.dateStr.split(" ")[0]&&t.push(a)})),this.$refs.titleOpen.open(t,e.startDay)},dayClick:function(e,t,a){},comfirmDialog:function(){}}},d=c,u=(a("8f57"),a("2877")),m=Object(u["a"])(d,i,n,!1,null,null,null);t["default"]=m.exports},"85b4":function(e,t,a){"use strict";a("4c12")},"8f57":function(e,t,a){"use strict";a("714d")},a62e:function(e,t,a){"use strict";a("0f89")},a914:function(e,t,a){"use strict";a.r(t),t["default"]={data:function(){this.$createElement;var e=this;return{data:[],columns:[{title:"序号",key:"",width:60,formatter:function(e,t,a,i){return i+1}},{title:"任务名称",key:"name",showOverflowTooltip:!0},{title:"执行时间",key:"dateStr",showOverflowTooltip:!0},{title:"任务状态",key:"type",showOverflowTooltip:!0,component:{render:function(t,a){var i="";return e.taskStateOptions.forEach((function(e){a.type===e.value&&(i=e.label)})),t("span",{style:"color:".concat(a.backgroundColor)},[i])}}}],loading:!1,options:{stripe:!0,height:"calc(100vh - 308px)",border:!0}}}}},e581:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("dialog-container",{attrs:{title:"检修区设置",width:"800px",height:"400px",visible:e.visible,submitLoading:e.submitLoading,confirmText:"确定","show-footer":!0},on:{"update:visible":function(t){e.visible=t},closed:e.handleClosed,closeDialog:e.close,comfirmDialog:e.comfirmDialog}},[a("div",{staticClass:"dialog-box"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("d2-card",{staticClass:"box-card",attrs:{showRightRefreshBtn:!1,showRightMaxBtn:!1}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("请选择检修区点位")])]),e.visible?a("el-tree",e._b({ref:"treeDevice",staticClass:"d2-tree-main",staticStyle:{height:"486px","overflow-y":"auto","overflow-x":"hidden"},attrs:{"node-key":"id",load:e.loadNode,data:e.primaryData,lazy:"",props:e.defaultProps,"expand-on-click-node":!1,"render-content":e.renderContent,"highlight-current":""},on:{"node-click":e.handleNodeClickDevice}},"el-tree",e.$attrs,!1)):e._e()],1)],1),a("el-col",{attrs:{span:12}},[a("d2-card",{staticClass:"box-card",attrs:{showRightRefreshBtn:!1,showRightMaxBtn:!1}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("已选检修区点位列表")])]),e.visible?a("el-tree",{ref:"treeltxj",staticClass:"d2-tree-main",staticStyle:{height:"486px","overflow-y":"auto","overflow-x":"hidden"},attrs:{"node-key":"id",data:e.ltxjData,props:e.defaultPropsDv,"render-content":e.renderContentLtxj,"highlight-current":""}}):e._e()],1)],1)],1)],1)])},n=[],r=a("e1e5"),s=a("9951"),o=a("2f62");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){d(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function d(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var u={components:{},mixins:[s["a"]],data:function(){return{visible:!1,submitLoading:!1,loading:!1,treeData:[],primaryData:[{name:"primary"}],defaultProps:{children:"children",label:"name",id:"id",isLeaf:"leaf"},defaultPropsDv:{label:"varName",id:"varId"},ltxjData:[],treeClickCount:0,isSelectList:[]}},computed:c(c({},Object(o["c"])("d2admin",{treeNode:"tree/treeNode"})),{},{deviceId:function(){var e=this.treeNode.id;return e}}),watch:{},mounted:function(){},methods:{open:function(){this.isSelectList=[],this.init()},close:function(){this.visible=!1},handleClosed:function(){var e=this;this.$nextTick((function(){e.$refs.ruleForm.resetFields(),e.ltxjData=[]}))},init:function(){this.visible=!0},renderContent:function(e,t){var a=t.node,i=t.data,n=(t.store,"");return i.isSelect&&(n="el-icon-check"),e("span",{class:"custom-tree-node",attrs:{id:"node"+i.id}},[e("span",[e("i",{class:n,style:"color: #4EC752;float: left;margin-right: 5px;font-size: 16px;font-weight: 700;"}),e("i",{class:i.icon?"treeIcon "+i.icon:""}),a.label])])},renderContentLtxj:function(e,t){var a=this,i=t.node,n=t.data;t.store;return"details"===this.pageType?e("span",{class:"custom-tree-node"},[e("span",[n.spaceName+n.varName])]):e("span",{class:"custom-tree-node"},[e("span",[n.spaceName+n.varName]),e("span",[e("el-button",{attrs:{size:"mini",type:"text"},class:"custom-tree-node-remove-btn",style:"position: absolute;right:52px;",on:{click:function(){return a.remove(i,n)}}},["删除"])])])},remove:function(e,t){var a=this,i=e.parent,n=i.data.children||i.data,r=n.findIndex((function(e){return e.id===t.varId}));n.splice(r,1),this.isSelectList.map((function(e){e.id===t.spaceId&&a.loadNode(e.node,e.resolve)}))},handleNodeClickDevice:function(e,t,a){var i=this;this.NodeObjDevice=e,t.data.icon?this.rawDetails="":(this.treeClickCount+=1,setTimeout((function(){2===i.treeClickCount&&(i.treeClickCount=0,i.relation(t)),i.treeClickCount=0}),300))},relation:function(e){this.ltxjData.push({spaceName:e.parent.data.name,spaceId:e.parent.data.id,varName:e.data.name,varId:e.data.id,rawVarId:e.data.rawId,stepTime:e.data.stepTime,cameraType:e.data.nodeType}),this.$set(this.NodeObjDevice,"isSelect",!0)},loadNode:function(e,t){var a=this;0===e.level?r["a"].nodeGetById(this.deviceId).then((function(e){var i=a.hasChild([e.data]);return t(i)})):this.$nextTick((function(){r["a"].getCameraPointType({id:e.data.id,nodeTypeList:["assistance_camera_speed","assistance_camera_yuntai"]}).then((function(i){var n=i.data.spaceDgtVos||[],r=i.data.spaceAnalogVos||[],s=i.data.spaceVoList||[],o=n.concat(r).concat(s),l=a.hasChild(o);return a.ltxjData.map((function(e){l.map((function(t){return e.varId===t.id&&(t.isSelect=!0),t}))})),e.childNodes=null,e.data.children=null,a.isSelectList.push({node:e,resolve:t,id:e.data.id}),t(l)})).finally((function(){a.loading=!1}))}))},hasChild:function(e){return e&&0!==e.length?(e.forEach((function(t,a){e[a].leaf=!e[a].hasChild})),e):[]},comfirmDialog:function(){this.apiFun()},apiFun:function(){this.visible=!1}}},m=u,p=(a("747e"),a("2877")),f=Object(p["a"])(m,i,n,!1,null,"4a636cae",null);t["default"]=f.exports},f4dc:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("dialog-container",{attrs:{title:e.title,width:"800px",height:"400px",visible:e.visible,"show-footer":!1},on:{"update:visible":function(t){e.visible=t},closed:e.handleClosed,closeDialog:e.close,comfirmDialog:e.comfirmDialog}},[a("div",{staticClass:"dialog-box"},[a("el-row",{attrs:{gutter:10}},[a("d2-crud",{ref:"d2Crud",attrs:{columns:e.columns,data:e.data,loading:e.loading,options:e.options}})],1)],1)])},n=[],r=a("9951"),s=a("a914"),o={components:{},mixins:[r["a"],s["default"]],data:function(){return{visible:!1,title:"title"}},computed:{},watch:{},mounted:function(){},methods:{open:function(e,t){this.data=e,this.title=t,this.init()},close:function(){this.visible=!1},handleClosed:function(){},init:function(){this.visible=!0},comfirmDialog:function(){this.visible=!1}}},l=o,c=a("2877"),d=Object(c["a"])(l,i,n,!1,null,null,null);t["default"]=d.exports},faff:function(e,t,a){}}]);