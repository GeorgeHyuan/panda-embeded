(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-37c9df66"],{"2d9c":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("dialog-container",{staticClass:"bangdian",attrs:{visible:t.visible,width:"80%",topHeight:"7vh",title:t.obj.title+"详情",showFooter:!1},on:{"update:visible":function(e){t.visible=e},closed:t.handleClosed}},[a("div",{staticClass:"dianhao-xiangqing"},[a("span",[t._v("名称: "+t._s(t.value.name))]),a("span",[t._v("值: "+t._s(t.value.value))]),a("span",[t._v("时间: "+t._s(t.value.timestamp))])]),a("el-row",{staticClass:"d2-mb",attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form",{ref:"gridForm",staticClass:"d2-form",attrs:{"label-position":"right",model:t.formInline,"label-width":"80px"}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"选择时间:"}},[a("el-date-pick",{on:{changeTime:t.changeTime}})],1)],1),a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{type:"primary"},on:{click:t.handleSearch}},[t._v("查询")])],1)],1)],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadData,expression:"loadData"}],attrs:{"element-loading-text":"数据加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 1)"}},[t.showEcharts?a("chart",{staticStyle:{height:"300px",width:"100%"},attrs:{options:t.dataOptions,"auto-resize":!0},on:{click:t.getImage}}):a("no-data",{staticStyle:{height:"300px"}})],1)],1),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"img-sty video-image-top"},[t.imgSrc?a("img",{attrs:{src:t.imgSrc,alt:""}}):a("div",{staticStyle:{width:"100%",height:"100%","text-align":"center","line-height":"300px"}},[t._v("暂无图片")])])])],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"video-image-top"},[a("d2-alarm",{ref:"d2Alarm",attrs:{height:"calc(50vh - 180px)",page:"powerEnvironment"}})],1)]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"video-image-top",staticStyle:{width:"70%",float:"left",position:"relative"},attrs:{id:"player-video-kunag"}},[a("div",{staticClass:"tou-kuang",on:{click:t.videoPlayer,dblclick:t.clickFullScreen}}),a("player",{ref:"player",staticClass:"dplayer",attrs:{url:t.url,widthStyle:"100%",index:-1,heightStyle:"100%"}})],1),a("div",{staticClass:"video-image-top",staticStyle:{width:"30%",float:"left"}},[a("contory",{staticStyle:{height:"100%",width:"100%"},attrs:{active_item:t.active_item}})],1)])],1)],1)},n=[],r=a("6c51"),o={columns:[{title:"序号",width:60,key:"indexOf",showOverflowTooltip:!0},{title:"时间",width:180,key:"timestamp",showOverflowTooltip:!0},{title:"事件分类",key:"evtClassDesc",width:120,showOverflowTooltip:!0},{title:"事件类型",key:"evtTypeDesc",width:80,showOverflowTooltip:!0},{title:"所属线路",key:"lineName",showOverflowTooltip:!0},{title:"所属站所",key:"roomName",showOverflowTooltip:!0},{title:"设备名称",key:"spaceName",showOverflowTooltip:!0,formatter:function(t,e,a,i){var n=(t&&t.priamryNmae||"")+(a||"");return n}},{title:"事件详情",key:"evtDesc",width:220,showOverflowTooltip:!0,formatter:function(t,e,a,i){var n=(t&&t.varName?t.varName+",":"")+(a||"");return n}},{title:"状态",width:70,key:"evtStatus",component:{render:function(t,e){return"0"===e.evtStatus?t("el-tag",{attrs:{type:"danger"}},["未处理"]):"1"===e.evtStatus?t("el-tag",{attrs:{type:"success"}},["已处理"]):"2"===e.evtStatus?t("el-tag",{attrs:{type:"success"}},["处理中"]):void 0}}}],data:[],load:!1,disabledPrevNext:{disabledPrev:!0,disabledNext:!1},layout:"prev, pager, next",number:0,totalNumber:{total1:0,total2:1e3},options:{stripe:!0,height:"25vh",border:!0},pagination:{currentPage:1,pageSize:10,total:0}},l=o,c=a("2f62"),s=a("8e01"),u=a("a645"),d=a("868c"),m=a("fa2f"),h=a("3709"),p=a("1224"),f=a("7658"),g=a("f5b2"),v=a("c276");function b(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function y(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?b(Object(a),!0).forEach((function(e){w(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function w(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var O={components:{noData:s["a"],player:d["a"],D2Alarm:m["a"],contory:p["default"]},data:function(){return y({imgSrc:"",url:"",row:null,rawId:"",basicInfo:[],addrSrc:"",active_item:{},visible:!1,isClick:!0,isClose:!0,firstPlayer:0,showEcharts:!1,obj:{title:"历史曲线对比",ids:[],type:"1"},yuzhi:[],loadData:!1,formInline:{time:[Object(r["f"])(new Date)+"-01 00:00:00",Object(r["a"])(new Date)]},chartsData:[]},l)},computed:y(y({},Object(c["c"])("d2admin",{themeActiveSetting:"theme/activeSetting"})),{},{value:function(){var t="",e=0,a="",i="";return this.obj.dianhao&&(t=this.obj.dianhao.name||"",e=this.obj.dianhao.value&&this.obj.dianhao.value.toFixed(2)||0,a=this.obj.dianhao.unit||"",i=this.obj.dianhao.timestamp||this.obj.dianhao.updateTime||""),{name:t,value:e+a,timestamp:i}},dataOptions:function(){var t="#93b5e2",e=this,a=[],i={symbol:"none",name:"阈值",silent:!0,data:this.yuzhi},n=[];if(this.chartsData){var o=this.chartsData;this.chartsData.forEach((function(t){n.push(t.currentTime)})),a.push({name:this.titleData[0].spaceName&&this.titleData[0].spaceName+this.titleData[0].name||this.titleData[0].name,type:"line",showSymbol:!1,step:"2"===this.obj.type&&"end",hoverAnimation:!1,data:o,markLine:"2"===this.obj.type?{}:i})}else a.push({name:"",type:"line",step:"2"===e.obj.type&&"end",showSymbol:!1,hoverAnimation:!1,data:[]});var l={grid:{left:"5%",right:"10%",bottom:"8%",containLabel:!0,borderColor:t},tooltip:{trigger:"axis",formatter:function(t){var a="";return t.forEach((function(t){var i="1"===e.obj.type?Number(t.data.value).toFixed(2):Number(t.data.value);a+=t.axisValue+"<br/>"+t.marker+t.seriesName+": "+i})),a}},dataZoom:[{type:"inside",xAxisIndex:[0],start:0,end:100,filterMode:"none"}],xAxis:{type:"category",splitLine:{show:!1},data:n,axisLine:{lineStyle:{color:t}},axisLabel:{textStyle:{color:"#93B5E2"},formatter:function(t){var e=Object(r["g"])(t).slice(11,19)+"\n"+Object(r["g"])(t).slice(0,10);return e}}},yAxis:{type:"value",minInterval:1,nameTextStyle:{color:t,align:"top",fontSize:16,fontWeight:"normal"},axisLabel:{textStyle:{color:"#93B5E2"}},axisLine:{lineStyle:{color:t}},splitLine:{show:!0,lineStyle:{type:"dashed",color:t}}},legend:{type:"scroll",data:name,textStyle:{color:t}},series:a};return l}}),methods:{changeTime:function(t){this.formInline.time=t},open:function(t){var e=this;console.log(t,112222222),this.row=t,this.visible=!0,this.showEcharts=!1,this.obj=t,this.formInline.time=[Object(r["f"])(new Date)+"-01 00:00:00",Object(r["a"])(new Date)],this.titleData=t.data,this.dataByCurve(),this.$nextTick((function(){setTimeout((function(){e.getVideoInfo(),e.getEventList()}),0)}))},handleClosed:function(){this.$refs.player&&this.$refs.player.clearRtc(),this.visible=!1,this.pagination={currentPage:1,pageSize:10,total:0},this.data=[],this.firstPlayer=0},handleSearch:function(){this.formInline.time&&(this.idStr=null,this.dataByCurve())},dataByCurve:function(){var t=this;this.loadData=!0;var e=this.formInline.time,a={varId:this.obj.ids[0],timestampBegin:(e&&e[0])+".000"||!1,timestampEnd:(e&&e[1])+".000"||!1,group:this.obj.type};this.chartsData=[],u["a"].getVarValueInformation(a).then((function(e){if(e&&e.data){if(t.showEcharts=!0,t.chartsData=e.data.data,!e.data.yuzhi)return;var a=[];e.data.yuzhi.forEach((function(t){a.push(Number(t))})),a.sort((function(t,e){return t-e})),a.forEach((function(e){t.yuzhi.push({silent:!0,label:{position:"end",formatter:"阈值("+e+")",color:"red",fontSize:14},lineStyle:{type:"dashed",color:"red"},name:"阈值",yAxis:e})}))}})).finally((function(){t.loadData=!1}))},getVideoInfo:function(){var t=this,e=this.row.ids[0],a=null;"1"===this.row.type?a=f["a"].getDataPointDetailYc:"2"===this.row.type&&(a=f["a"].getDataPointDetailYx),a({id:e}).then((function(e){var a=e.data[0].rawId;t.getVideoStatus(a),h["a"].basicInfo({rawId:a,type:1}).then((function(e){if(e&&e.data){t.basicInfo=e.data,t.basicInfo.map((function(e){"devNum"===e.url?t.channel=e.name:"channelNum"===e.url?t.addId=e.name:"id"===e.url&&(t.active_item.nodeId=e.name)}));var a="webrtc://".concat(serverIp_app_live,"/live/").concat(t.channel,"@").concat(t.addId);a!==t.addrSrc&&(t.addrSrc=a),t.active_item.live="".concat(t.channel,"@").concat(t.addId)}}))}))},clickFullScreen:function(){var t=this,e=document.getElementById("player-video-kunag");this.isClose?(this.isClick=!1,Object(g["a"])(e)):(this.isClick=!1,Object(g["b"])(e)),setTimeout((function(){t.isClick=!0}),400)},videoPlayer:function(){var t=this;0===this.firstPlayer&&setTimeout((function(){t.isClick&&setTimeout((function(){t.$refs.player.playerInitWatchCarousel(t.addrSrc),t.firstPlayer+=1}),0)}),300)},goPreset:function(t,e){u["a"].querySpaceIns({id:t}).then((function(t){if(t&&t.data.length){var a={cameraId:e,point:t.data[0].token};f["a"].movePresetByAli(a).then((function(t){}))}}))},getVideoStatus:function(t){var e={id:t};f["a"].cameraStatus(e).then((function(t){console.log(t,"是否有任务执行>>>")}))},getEventList:function(){var t=this,e={varId:this.row.ids[0]};this.$nextTick((function(){t.$refs.d2Alarm.getData(e)}))},getImage:function(t){t.data.url?this.imgSrc=VUE_APP_IMAGE+escape(t.data.url)+"&secretSalt="+v["a"].cookies.get("token"):this.imgSrc=""}},mounted:function(){var t=this;window.onresize=function(){t.isClose=!t.isClose}}},S=O,j=(a("e550"),a("2877")),x=Object(j["a"])(S,i,n,!1,null,null,null);e["a"]=x.exports},"34d1":function(t,e,a){},"8e01":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:[1===t.flag?"no-data2":2===t.flag?"no-data3":3===t.flag?"no-data4":4===t.flag?"no-data5":5===t.flag?"no-data6":6===t.flag?"no-data7":"no-data"]},[t._v("\n  暂无数据\n")])},n=[],r={props:{flag:Number}},o=r,l=(a("bd36"),a("2877")),c=Object(l["a"])(o,i,n,!1,null,null,null);e["a"]=c.exports},a645:function(t,e,a){"use strict";var i=a("9bd2");function n(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function r(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?n(Object(a),!0).forEach((function(e){o(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function o(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var l=VUE_APP_API;e["a"]={queryPanoramicDisplayAnalogForm:function(t){return Object(i["a"])({url:"".concat(l,"/realMonitor/queryPanoramicDisplayAnalogForm"),method:"post",data:t})},queryPanoramicDisplayDgtForm:function(t){return Object(i["a"])({url:"".concat(l,"/realMonitor/queryPanoramicDisplayDgtForm"),method:"post",data:t})},getVarNamesValue:function(t){return Object(i["a"])({url:"".concat(l,"/real/getVarNamesValue"),method:"post",data:t})},getAllClassify:function(){return Object(i["a"])({url:"".concat(l,"/realMonitor/getAllClassify"),method:"get"})},selectNodeType:function(t){return Object(i["a"])({url:"".concat(l,"/realMonitor/selectNodeType"),method:"get",params:t})},getRealClassifiedOfSpace:function(t){return Object(i["a"])({url:"".concat(l,"/realMonitor/getRealClassifiedOfSpace"),method:"get",params:t})},getRealgetAlarmTempl:function(t){return Object(i["a"])({url:"".concat(l,"/realMonitor/getRealgetAlarmTempl"),method:"get",params:t})},getSpaceBasicBySpaceUuid:function(t){var e=t.data;return Object(i["a"])({url:"".concat(l,"/space/getSpaceBasicBySpaceUuid"),method:"post",params:e})},spaceList:function(t){var e=t.data;return Object(i["a"])({url:"".concat(l,"/his/dataByCurve"),method:"post",data:r({},e)})},getSpaceBasicAndSpaceGroup:function(t){return Object(i["a"])({url:"".concat(l,"/evt/getSpaceBasicAndSpaceGroup/").concat(t),method:"get"})},getAllSpacePoint:function(t){return Object(i["a"])({url:"".concat(l,"/evt/getAllSpacePoint/").concat(t,"/1"),method:"get"})},tempAlarmCount:function(t){var e=t.data;return console.log(2132132132,213213),Object(i["a"])({url:"".concat(l,"/totalViem/tempAlarmCount"),method:"post",params:r({},e)})},alarmRule:function(t){var e=t.data;return console.log(2132132132,213213),Object(i["a"])({url:"".concat(l,"/totalViem/alarmRule"),method:"post",params:r({},e)})},manufactureSelectAll:function(){return Object(i["a"])({url:"".concat(l,"/manufacture/queryAll"),method:"get",data:{}})},getVarValueInformation:function(t){return Object(i["a"])({url:"".concat(l,"/real/getVarValueInformation"),method:"post",data:t})}}},bd36:function(t,e,a){"use strict";a("34d1")},c1d5:function(t,e,a){},e550:function(t,e,a){"use strict";a("c1d5")},f5b2:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return n}));var i=function(t){t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()},n=function(t){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}}}]);