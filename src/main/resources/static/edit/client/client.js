/*
 * client.js - v0.3.5
 * Compiled Sun Sep 22 2019 21:35:04 GMT+0800 (GMT+08:00)
 * Copyright (c) 2019 www.hightopo.com
 */

var hteditor=function(){"use strict";function c(c,p,Q){Q.style.cursor="ew-resize";var r=Q.innerHTML.charAt(0),i=p.querySelector("input.color_"+r),n=function(p){p.preventDefault();var Q=("A"===r?parseFloat(i.value):parseInt(i.value))||0,n=ht.Default.getClientPoint(p).x,y=function(p){p.preventDefault();var y=ht.Default.getClientPoint(p).x-n,X=void 0;"A"===r?(X=Q+.01*y,X>1&&(X=1),X<0&&(X=0),i.value=X.toFixed(2)):(X=Q+1*y,X>255&&(X=255),X<0&&(X=0),i.value=X),c.updateInputChange()};window.addEventListener("mousemove",y,!1),window.addEventListener("touchmove",y,!1);var X=function(c){c.preventDefault(),window.removeEventListener("mousemove",y,!1),window.removeEventListener("touchmove",y,!1),window.removeEventListener("mouseup",X,!1),window.removeEventListener("touchend",X,!1)};window.addEventListener("mouseup",X,!1),window.addEventListener("touchend",X,!1)};Q.addEventListener("mousedown",n,!1),Q.addEventListener("touchstart",n,!1)}function p(c){var p=new RegExp("(^|&)"+c+"=([^&]*)(&|$)"),Q=window.location.search.substr(1).match(p);return null!=Q?decodeURIComponent(Q[2]):null}function Q(c){return ht.Default.clone(c)}function r(c){return parseFloat(c.toFixed(ht.Default.numberDigits))}function i(c,p){if(null!=c)return p||!Jp.config.traceMissingI18n||Jp.customStrings[c]||Jp.strings[c]||console.log("i18n missing:["+c+"]"),p?Jp.customStrings[c]||Jp.strings[c]:Jp.customStrings[c]||Jp.strings[c]||c}function n(c,p){var Q=c.indexOf(p);Q>=0&&c.splice(Q,1)}function y(c){return ht.Default.isEmptyObject(c)}function X(c){return c?Ic(c)?c:c.__ht__||c.toString():""}function W(c){var p=X(c),Q=p.indexOf("{")+1,r=p.lastIndexOf("}");for(p=p.substring(Q,r);p.startsWith("\n");)p=p.substr(1);for(;p.endsWith("\n");)p=p.substring(0,p.length-1);return p}function Z(c){var p=c.indexOf("function");if(c&&!(p<0)){var Q=void 0,r=c.indexOf("{")+1,i=c.lastIndexOf("}"),n=c.indexOf("(")+1,y=c.indexOf(")");return r&&i&&n&&y&&(Q=new Function(c.substring(n,y),c.substring(r,i)),Q.__ht__=c.substr(p)),Q}}function o(c,p){if("s"===c)return function(c){return c.s(p)};if("a"===c)return function(c){return c.a(p)};if("p"===c){var Q=ht.Default.getter(p);return function(c){if(c[Q])return c[Q]()}}}function l(c,p){if("s"===c)return function(c,Q){return c.s(p,Q)};if("a"===c)return function(c,Q){return c.a(p,Q)};if("p"===c){var Q=ht.Default.setter(p);return function(c,p){if(c[Q])return c[Q](p)}}}function j(c){return 37===c.keyCode}function E(c){return 38===c.keyCode}function m(c){return 39===c.keyCode}function f(c){return 40===c.keyCode}function I(c){return 13===c.keyCode}function G(c){return 27===c.keyCode}function e(c){return ht.Default.isDelete(c)}function P(c){return ht.Default.isLeftButton(c)}function d(c){return ht.Default.isDoubleClick(c)}function R(c,p){ht.Default.startDragging(c,p)}function t(c){return ht.Default.getClientPoint(c)}function b(c){return ht.Default.getTargetElement(c)}function Y(c){return ht.Default.getPagePoint(c)}function s(){return ht.Default.getWindowInfo()}function h(c,p){return ht.Default.getDistance(c,p)}function F(){return ht.Default.unionPoint.apply(this,arguments)}function B(c){return ht.Default.getImageMap()[c]?(delete ht.Default.getImageMap()[c],!0):!!ht.Default.getCompTypeMap()[c]&&(delete ht.Default.getCompTypeMap()[c],!0)}function D(c,p,Q){return ht.Default.getPosition(c,p,Q)}function U(c,p){return ht.Default.stringify(c,p)}function a(c){return ht.Default.parse(c)}function _(c){if(!c)return"";var p=c.lastIndexOf(".");return-1===p?c:c.substr(0,p)}function w(c){return c=c.replace(/^.*[\\\/]/,""),_(c)}function L(c,p,Q,r,i){ht.Default.layout(c,p,Q,r,i)}function H(c,p,Q,r){ht.Default.setCanvas(c,p,Q,r)}function O(c){ht.Default.removeHTML(c)}function M(c,p,Q){ht.Default.xhrLoad(c,p,Q)}function K(c){return ht.Default.isShiftDown(c)}function u(c){return ht.Default.isCtrlDown(c)}function x(c,p){return ht.Default.createView(c,p)}function q(c){return ht.Default.createCanvas(c)}function z(c,p){return ht.Default.createDiv(p,c)}function V(c,p){return ht.Default.unionRect(c,p)}function T(c,p,Q,r,i,n,y,X,W,Z){return ht.Default.drawText(c,p,Q,r,i,n,y,X,W,Z)}function A(c,p,Q,r,i,n,y,X,W,Z){ht.Default.drawStretchImage(c,p,Q,r,i,n,y,X,W,Z)}function N(c,p,Q,r,i,n,y){ht.Default.drawBorder(c,p,Q,r,i,n,y)}function S(c,p,Q,r,i,n){var y=c.getContext("2d");return y.save(),p=p||0,Q=Q||0,r=r||1,n=n||ht.Default.devicePixelRatio,y.translate(p*n,Q*n),r*=n,1!==r&&y.scale(r,r),i&&(y.beginPath(),y.rect(i.x,i.y,i.width,i.height),y.clip(),y.clearRect(i.x,i.y,i.width,i.height)),y}function v(c,p){var Q=c.prototype,r=ht.Default.getMSMap();for(var i in p)r[i]&&r.hasOwnProperty(i)?r[i](Q,p):Q[i]=p[i]}function g(c,p){p[c._id]=c,c.eachChild(function(c){p[c._id]=c,g(c,p)})}function k(c){ht.Default.preventDefault(c)}function J(c){return/^displays/.test(c)}function C(c){return/^symbols/.test(c)}function cc(c){return/^components/.test(c)}function pc(c){return/^scenes/.test(c)}function Qc(c){return/^models/.test(c)}function rc(c){return/^assets/.test(c)}function ic(c){return/\.(png|jpg|gif|jpeg|bmp|svg)$/i.test(c)}function nc(c){return/\.json$/i.test(c)}function yc(c){return/\.mp3$/i.test(c)}function Xc(c){return/\.mp4$/i.test(c)}function Wc(c){return/\.svg$/i.test(c)}function Zc(c){return/\.dxf$/i.test(c)}function oc(c){return/\.obj$/i.test(c)}function lc(c){return/\.mtl$/i.test(c)}function jc(c){return/\.ttf$/i.test(c)}function Ec(c){return/\.otf$/i.test(c)}function mc(c){return/\.js$/i.test(c)}function fc(c){return c.substring(0,c.length-5)+".png"}function Ic(c){return"string"==typeof c||c instanceof String}function Gc(c){return c&&"object"==typeof c}function ec(c){return"function"==typeof c}function Pc(c){return c instanceof Array}function dc(c,p){var Q=c.getPosition().x,r=c.getPosition().y,i=c.getWidth(),n=c.getHeight(),y=[Q-i*c.getAnchor().x,r-n*c.getAnchor().y,i,n];Bc(p,"rect",c.a("rect"),y,void 0)}function Rc(c,p){var Q=c.getRotation();Bc(p,"rotation",c.a("rotation"),Q,0)}function tc(c,p){var Q=c.getAnchor().x,r=c.a("anchorX");Bc(p,"anchorX",r,Q,.5),Q=c.getAnchor().y,r=c.a("anchorY"),Bc(p,"anchorY",r,Q,.5)}function bc(c,p){var Q=c.getScale().x,r=c.a("scaleX");Bc(p,"scaleX",r,Q,1),Q=c.getScale().y,r=c.a("scaleY"),Bc(p,"scaleY",r,Q,1)}function Yc(c,p){var Q=c.isClosePath();Bc(p,"closePath",c.a("closePath"),Q,!1)}function sc(c,p,r,i,n){4===arguments.length&&(n=ht.Style[r]);var y=Q(c.s(r));Bc(p,i,c.a(r),y,n)}function hc(c,p){var Q=c.getDisplayName();Bc(p,"displayName",c.a("displayName"),Q,void 0)}function Fc(c,p){if(Pc(c)&&Pc(p)){if(c.length===p.length){for(var Q=0;Q<c.length;Q++)if(!Fc(c[Q],p[Q]))return!1;return!0}return!1}if(Gc(c)&&Gc(p)){var r=Object.keys(c);if(r.length===Object.keys(p).length){for(var i=0;i<r.length;i++){var n=r[i];if(!Fc(c[n],p[n]))return!1}return!0}return!1}return c===p}function Bc(c,p,Q,r,i){Q?c[p]={func:Q,value:r}:Fc(r,i)||void 0===r||(c[p]=r)}function Dc(c,p,Q,r){ac(c,"2d.visible",p.visible),ac(c,"2d.selectable",p.selectable),ac(c,"2d.movable",p.movable),ac(c,"2d.editable",p.editable),ac(c,"pixelPerfect",p.pixelPerfect,!1),ac(c,"opacity",p.opacity,1),ac(c,"clip.percentage",p.clipPercentage,1),ac(c,"clip.direction",p.clipDirection,"top"),ac(c,"layout.h",p.layoutH),ac(c,"layout.v",p.layoutV),ac(c,"prefix",p.prefix),ac(c,"state",p.state),c instanceof ht.Text||(ac(c,"shadow",p.shadow,!1),ac(c,"select.color",p.shadowColor,ht.Color.highlight),ac(c,"shadow.blur",p.shadowBlur,6),ac(c,"shadow.offset.x",p.shadowOffsetX,3),ac(c,"shadow.offset.y",p.shadowOffsetY,3)),_c(c,p),$c(c,p),Lc(c,p),wc(c,p),c instanceof ht.Shape&&!p.rect||Oc(c,p,Q,r);var i=Op.customProperties.comp;i&&i.length&&i.forEach(function(Q){ac(c,Q.property,p[Q.property],Q.defaultValue)}),Cp.forEach(function(Q){c.a(Q,p[Q])}),c.a("renderHTML",p.renderHTML)}function Uc(c,p){sc(c,p,"2d.visible","visible"),sc(c,p,"2d.selectable","selectable"),sc(c,p,"2d.movable","movable"),sc(c,p,"2d.editable","editable"),sc(c,p,"pixelPerfect","pixelPerfect",!1),sc(c,p,"opacity","opacity",1),sc(c,p,"clip.percentage","clipPercentage",1),sc(c,p,"clip.direction","clipDirection","top"),sc(c,p,"layout.h","layoutH"),sc(c,p,"layout.v","layoutV"),sc(c,p,"prefix","prefix"),sc(c,p,"state","state"),c instanceof ht.Text||(sc(c,p,"shadow","shadow",!1),sc(c,p,"select.color","shadowColor",ht.Color.highlight),sc(c,p,"shadow.blur","shadowBlur",6),sc(c,p,"shadow.offset.x","shadowOffsetX",3),sc(c,p,"shadow.offset.y","shadowOffsetY",3)),hc(c,p),tc(c,p),bc(c,p),Rc(c,p),c instanceof ht.Shape&&!c.a("rect")||dc(c,p);var Q=Op.customProperties.comp,r=!!Op.saveCompCustomPropertyDefaultValue;Q&&Q.length&&Q.forEach(function(Q){r?sc(c,p,Q.property,Q.property):sc(c,p,Q.property,Q.property,Q.defaultValue)}),Cp.forEach(function(Q){c.a(Q)&&(p[Q]=c.a(Q))}),c.a("renderHTML")&&(p.renderHTML=c.a("renderHTML"))}function ac(c,p,r,i){3===arguments.length&&(i=ht.Style[p]);var n=Mc(r);void 0===n&&(n=i),c.s(p,Q(n)),c.a(p,Kc(r))}function _c(c,p){c.setDisplayName(Mc(p.displayName),void 0),c.a("displayName",Kc(p.displayName))}function wc(c,p){c.setRotation(Mc(p.rotation,0)),c.a("rotation",Kc(p.rotation))}function $c(c,p){var Q=Mc(p.anchorX,.5),r=Mc(p.anchorY,.5);.5===Q&&.5===r||c.setAnchor(Q,r),c.a("anchorX",Kc(p.anchorX)),c.a("anchorY",Kc(p.anchorY))}function Lc(c,p){var Q=Mc(p.scaleX,1),r=Mc(p.scaleY,1);c.setScale(Q,r),c.a("scaleX",Kc(p.scaleX)),c.a("scaleY",Kc(p.scaleY))}function Hc(c,p){c.setClosePath(Mc(p.closePath,!1)),c.a("closePath",Kc(p.closePath))}function Oc(c,p,Q,r){var i=Mc(p.rect),n=Mc(p.relative);i||(i=[0,0,Q,r],n=!1);var y=i.length;if(4===y)i={x:i[0],y:i[1],width:i[2],height:i[3]},n&&(i.x*=Q,i.y*=r,i.width*=Q,i.height*=r);else if(3===y){var X=i[0];i={width:i[1],height:i[2]},n&&(i.width*=Q,i.height*=r),"object"==typeof X?X.length&&(X={x:X[0],y:X[1]}):X=D(X,{x:0,y:0,width:Q,height:r},i),i.x=X.x-i.width*c.getAnchor().x,i.y=X.y-i.height*c.getAnchor().y}var W=Mc(p.offsetX);W&&(i.x+=W),W=Mc(p.offsetY),W&&(i.y+=W),i.width<0||i.height<0?c.p(i.x,i.y):c.setRect(i),c.a("rect",Kc(p.rect))}function Mc(c,p){var Q=void 0;return Q=Gc(c)&&c.func?c.value:c,void 0===Q&&(Q=p),Q}function Kc(c){if(Gc(c)&&c.func)return c.func}function uc(c){if(Pc(c)){for(var p=new ht.List,Q=c.length,r=0;r<Q;r+=2)p.add({x:c[r],y:c[r+1]});c=p}return c}function xc(c){if(c instanceof ht.List&&(c=c.toArray()),Pc(c)){for(var p=[],Q=0;Q<c.length;Q++){var r=c[Q];p.push(r.x,r.y)}c=p}return c}function qc(c){return{width:16,height:16,comps:[{type:function(p,Q,r,i,n){var y=ht.Default.getImage(c.graphView.getImage(i));if(y&&y.snapshotURL)(y=ht.Default.getImage(y.snapshotURL))&&A(p,y,"uniform",Q.x,Q.y,Q.width,Q.height,i,n);else{var X=y&&y.boundExtend?i.getRect():c.graphView.getDataUIBounds(i);if(X&&X.width&&X.height){p.save();var W=Math.min(1,16/Math.max(X.width,X.height));p.translate(-X.x*W+(16-X.width*W)/2,-X.y*W+(16-X.height*W)/2),p.scale(W,W),c.graphView.drawData(p,i),p.restore()}}}}]}}function zc(c,p){var Q=c.graphView.getEdgeInfo(p);if(!Q)return IQ;var r=Q.edgeTypeInfo,i=void 0,n=void 0;if(!Q.type||Q.points){Q.sourcePoint.x,Q.sourcePoint.y,Q.targetPoint.x,Q.targetPoint.y;Q.type?(i=new ht.List(Q.sourcePoint),i.addAll(Q.points),i.add(Q.targetPoint),n=Q.segments):Q.looped?(i=eQ,n=PQ):i=Q.center?[Q.c1,Q.sourcePoint,Q.targetPoint,Q.c2]:[Q.sourcePoint,Q.targetPoint]}else r&&(i=r.points,n=r.segments);var y=F(i);if(y&&(y.width||y.height)){var X=Math.max(1,Math.max(y.width,y.height)/16),W=[],Z=(16-y.width/X)/2,o=(16-y.height/X)/2;i instanceof ht.List&&(i=i.toArray()),i.forEach(function(c){W.push((c.x-y.x)/X+Z,(c.y-y.y)/X+o)});var l=n?n.toArray():null;return{width:16,height:16,comps:[{type:"shape",points:W,segments:l,borderWidth:1,borderColor:Q.color,borderCap:Q.cap,borderJoin:Q.join}]}}return IQ}function Vc(c){var p=F(c.getPoints());if(p&&(p.width||p.height)){var Q=Math.max(1,Math.max(p.width,p.height)/16),r=[],i=(16-p.width/Q)/2,n=(16-p.height/Q)/2;c.getPoints().each(function(c){r.push((c.x-p.x)/Q+i,(c.y-p.y)/Q+n)});var y=c.getSegments()?c.getSegments().toArray():null;return{width:16,height:16,comps:[{type:"shape",points:r,segments:y,rotation:c.getRotation(),background:c.s("shape.background"),repeatImage:c.s("shape.repeat.image"),borderWidth:c.s("shape.border.width")?1:0,borderColor:c.s("shape.border.color"),borderCap:c.s("shape.border.cap"),borderJoin:c.s("shape.border.join"),gradient:c.s("shape.gradient"),gradientColor:c.s("shape.gradient.color"),closePath:c.isClosePath()}]}}return IQ}function Tc(c){return ht.Default.isInput(c)}function Ac(c,p){var Q=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Q.nullable,n=void 0===r||r,y=Q.trim,X=void 0!==y&&y,W=Q.cancellable,Z=void 0===W||W,o=Q.width,l=void 0===o?300:o,j=Q.height,E=void 0===j?120:j,m=Q.maxLength,f=void 0===m?-1:m,I=Q.checkFunc,G=void 0===I?void 0:I,e=arguments[3],P=new gp;P.addRow([{id:"input",textField:{text:p}}],[.1]);var d=new vp,R=[],t=null,b=null;t=function(){var c=P.v("input");return X&&c&&c.trim(),!1!==n||c?f>0&&c&&c.length>f?void Nc(null,i("editor.inputmax"),function(){}):G&&!(c=G(c))?void Nc(null,i("editor.invalidinput"),function(){}):(e(c,"ok"),void d.hide()):void Nc(null,i("editor.inputempty"),function(){})},R.push({label:i("editor.ok"),action:t}),Z&&(b=function(){e(p,"cancel"),d.hide()},R.push({label:i("editor.cancel"),action:b})),d.setConfig({title:c,draggable:!0,width:l,height:E,contentPadding:10,content:P,buttons:R,buttonsAlign:"right"}),d.$49$=b,d.$48$=t,d.show(),P.getViewById("input").getElement()._ignore=!0,P.getViewById("input").setFocus()}function Nc(c,p,Q,r){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:300,y=[],X=void 0,W=void 0;Q&&(X=function(){Z.hide(),Q()},y.push({label:i("editor.ok"),action:X})),r&&(W=function(){Z.hide(),r()},y.push({label:i("editor.cancel"),action:W}));var Z=new vp({title:c||i("editor.prompt"),contentPadding:20,width:n,draggable:!0,content:'<p style="color: '+ht.Default.labelColor+'">'+p+"</p>",buttons:y});Z.$49$=W||X,Z.$48$=X,Z.show()}function Sc(c,p,Q,r){var i={unfocusable:!0,id:c,toolTip:p},n=ht.Default.getImage(Q),y=n?n.width:16,X=n?n.height:16;return i.icon={width:y+8,height:X+8,fitSize:!!n&&n.fitSize,comps:[{type:"rect",background:{func:function(c,p){return p.getCurrentItem()===i?Jp.config.color_hover:null}},rect:[0,0,y+8,X+8]},{type:"image",name:Q,color:{func:function(c,p){return r&&r()?Jp.config.color_select:Jp.config.color_dark}},rect:[4,4,y,X]}]},i}function vc(c,p){var Q=ht.Default.createDiv(!0);return Q.style.font=ht.Default.labelFont,Q.style.color=ht.Default.labelColor,Q.style.paddingLeft="4px",Q.style.lineHeight=ht.Default.widgetRowHeight+"px",Q.style.whiteSpace="nowrap",Q.innerHTML=c,p&&(Q.style.textAlign=p),Q}function gc(c,p,Q,r){var i=new ht.widget.Button;return i.setLabel(c),i.setLabelColor(ht.Default.labelColor),i.setLabelSelectColor(Jp.config.color_select),i.setIcon(Q),i.setBackground(null),i.setBorderColor(null),r&&(i.onClicked=r),p&&(i.setToolTip(p),i.enableToolTip()),i.getCurrentBackground=function(){return this._hover||this.isPressed()?Jp.config.color_hover:null},i.getCurrentBorderColor=function(){return this.isSelected()?Jp.config.color_select:null},i.getView().addEventListener("mouseenter",function(){i.isDisabled()||(i._hover=!0,i.iv())},!1),i.getView().addEventListener("mouseleave",function(){i.isDisabled()||(i._hover=!1,i.iv())},!1),i}function kc(c,p){var Q=ht.Default.getImage(c);if(!Q)throw c;var r={width:Q.width,height:Q.height,fitSize:Q.fitSize,comps:[{type:"image",name:c,color:{func:function(){return p&&p()?Jp.config.color_select:Jp.config.color_dark}}}]},i=c+".state";return ht.Default.setImage(i,r),i}function Jc(c,p,Q){var r=new FileReader;r.onloadend=function(c){p(c.target.result)},Q?r.readAsDataURL(c):r.readAsText(c)}function Cc(c,p){if(p){p===document.body&&(document.title=i("editor.title"),document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%"),p.appendChild(c.getView());var Q=c.getView().style;Q.left="0px",Q.top="0px",setInterval(function(){if(c.getView()!==(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)){var r=void 0,i=void 0;p===document.body?(r=document.documentElement.clientWidth,window.innerWidth&&window.innerWidth<r&&(r=window.innerWidth),i=document.documentElement.clientHeight,window.innerHeight&&window.innerHeight<i&&(i=window.innerHeight)):(r=p.clientWidth,i=p.clientHeight),r===c._oldWidth&&i===c._oldHeight||(c._oldWidth=r,c._oldHeight=i,Q.width=r+"px",Q.height=i+"px",c.iv())}},500)}}function cp(c){if(c)for(var p=0;p<c.length;p++)null==c[p]&&(c[p]=0)}function pp(c){if(c)for(var p=ht.Color.chart,Q=0;Q<c.length;Q++)null==c[Q]&&(c[Q]=p[Q%p.length])}function Qp(c,p){p=void 0===p?c?c.length:0:p;for(var Q=new Array(p),r=0;r<p;r++)Q[r]=c?c[r]:void 0;return Q}function rp(c){if(c instanceof ht.graph.GraphView){var p=c.getContentRect(),Q=Math.max(p.width,p.height),r=Math.min(1,Jp.config.imageSize/Q);return Q<3&&(r=Jp.config.imageSize/Q),c.toDataURL(void 0,void 0,r)}if(c instanceof ht.graph3d.Graph3dView){var i=c.getWidth(),n=c.getHeight(),y=Math.max(i,n),X=Math.min(1,Jp.config.imageSize/y);y<3&&(X=Jp.config.imageSize/y),i=Math.floor(i*X),n=Math.floor(n*X);return c.toCanvas(c.dm().getBackground(),i,n).toDataURL("image/png",1)}var W=ht.Default.getImage(c),Z=Math.max(W.width,W.height),o=Math.min(1,Jp.config.imageSize/Z);return ht.Default.toCanvas(c,W.width*o,W.height*o).toDataURL("image/png",1)}function ip(c,p,Q){if(c instanceof Array)for(var r=0,i=c.length;r<i;r++)ip(c[r],p,Q);else if(c instanceof Object)for(var n in c)if(c.hasOwnProperty(n)){var y=c[n];if(!Gc(y))continue;if(Ic(y.func)&&jQ.test(y.func)){var X=y.func.slice(5);p&&void 0===p[X]&&(p[X]=n),Q&&void 0===Q[X]&&(Q[X]=y.value)}else ip(y,p,Q)}}function np(){return new(ht.Default.getClass(Jp.config.codeEditorClass)||kp)}function yp(){var c=arguments[0];if(!c)return"";for(var p=1;p<arguments.length;p++)c=c.replace("{"+(p-1)+"}",arguments[p]);return c}function Xp(c,p){p.forEach(function(p){c.push(Q(p))})}function Wp(c){var p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ht.Shape,r=void 0,i=void 0,n=void 0,y=void 0,X=void 0,W=void 0,Z=[],o=[];c.forEach(function(c){Xp(Z,c.getPoints());var p=c.getSegments();if(p)p=p.toArray();else{p=[1];for(var l=1,j=c.getPoints().size();l<j;l++)p.push(2)}c.isClosePath()&&p.push(5),o.push.apply(o,p),r||(r=c.dm(),i=c.getThickness(),n=c.getElevation(),y=c.getTall(),X=Q(c.getStyleMap()),W=Q(c.getAnchor3d())),c.removeFromDataModel()});var l=new p;l.setPoints(Z),l.setSegments(o),l.setThickness(i),l.setElevation(n),l.setTall(y),l.setAnchor3d(W),l.s(X),r.add(l),r.sm().ss(l)}function Zp(c){var p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ht.Shape,r=c.dm(),i=c.getSegments();if(i){var n=[],y=c.getPoints(),X=void 0,W=void 0,Z=0;i.forEach(function(c){switch(c){case 1:X=[c],W=[Q(y.get(Z++))],n.push({segments:X,points:W});break;case 2:X.push(c),W.push(Q(y.get(Z++)));break;case 3:X.push(c),W.push(Q(y.get(Z++))),W.push(Q(y.get(Z++)));break;case 4:X.push(c),W.push(Q(y.get(Z++))),W.push(Q(y.get(Z++))),W.push(Q(y.get(Z++)));break;case 5:X.push(c)}});var o=c.getThickness(),l=c.getElevation(),j=c.getTall(),E=Q(c.getStyleMap()),m=Q(c.getAnchor3d()),f=[];n.forEach(function(c){var Q=new p;Q.setPoints(c.points),Q.setSegments(c.segments),Q.setThickness(o),Q.setElevation(l),Q.setTall(j),Q.setAnchor3d(m),Q.s(E),r.add(Q),f.push(Q)}),r.sm().ss(f),c.removeFromDataModel()}}function op(c){for(var p=0,Q=c.length;p<Q;p++)if(!(c.get(p)instanceof ht.Shape))return!1;return!0}function lp(c){var p={clazz:this.getClass(),name:this.getName(),displayName:this.getDisplayName(),toolTip:this.getToolTip(),tag:this.getTag(),icon:this.getIcon(),layer:this.getLayer(),parent:c.$58$(this.getParent()),a:{},s:{},dataBindings:this.getDataBindings()?U(this.getDataBindings()):null},r=this.getStyleMap();for(var i in r)p.s[i]=Q(this.s(i));var n=this.getAttrObject();for(var y in n)p.a[y]=Q(this.a(y));return p}function jp(c,p){var r=new c.clazz;if(Jp.config.cloneName&&r.setName(c.name),Jp.config.cloneDisplayName&&r.setDisplayName(c.displayName),Jp.config.cloneToolTip&&r.setToolTip(c.toolTip),Jp.config.cloneTag&&r.setTag(c.tag),Jp.config.cloneIcon&&r.setIcon(c.icon),Jp.config.cloneLayer&&r.setLayer(c.layer),Jp.config.cloneStyle)for(var i in c.s)r.s(i,Q(c.s[i]));if(Jp.config.cloneAttr)for(var n in c.a)r.a(n,Q(c.a[n]));return Jp.config.cloneDataBindings&&c.dataBindings&&r.setDataBindings(a(c.dataBindings)),r}function Ep(c,p,Q){var r=Jp.config.cloneParent?p.$50$(c.parent,Q):void 0;this.setParent(r||p.getCurrentSubGraph())}function mp(c){var p=lp.call(this,c);return p.rotation=this.getRotation(),p.position=this.p(),p.size={width:this._width,height:this._height},p.scale=this.getScale(),p.anchor=this.getAnchor(),p.image=this.getImage(),p.host=c.$58$(this.getHost()),p}function fp(c,p){var Q=jp(c,p);return Jp.config.cloneRotation&&Q.setRotation(c.rotation),Jp.config.clonePosition&&Q.setPosition(c.position),Jp.config.cloneSize&&Q.setSize(c.size),Jp.config.cloneScale&&Q.setScale(c.scale),.5===c.anchor.x&&.5===c.anchor.y||Jp.config.cloneAnchor&&Q.setAnchor(c.anchor),Jp.config.cloneImage&&Q.setImage(c.image),Q}function Ip(c,p,Q){Ep.call(this,c,p,Q),Jp.config.cloneHost&&this.setHost(p.$50$(c.host,Q))}function Gp(c){var p=lp.call(this,c);return p.source=c.$58$(this.getSource()),p.target=c.$58$(this.getTarget()),p}function ep(c,p){return jp(c,p)}function Pp(c,p,Q){Ep.call(this,c,p,Q),Jp.config.cloneSource&&this.setSource(p.$50$(c.source,Q)),Jp.config.cloneTarget&&this.setTarget(p.$50$(c.target,Q))}function dp(c){var p=mp.call(this,c);return p.expanded=this.isExpanded(),p}function Rp(c,p){var Q=fp(c,p);return Jp.config.cloneExpanded&&Q.setExpanded(c.expanded),Q}function tp(c){var p=mp.call(this,c);return p.points=Q(this.getPoints()),p.segments=Q(this.getSegments()),p.thickness=this.getThickness(),p.closePath=this.isClosePath(),p}function bp(c,p){var r=fp(c,p);return Jp.config.clonePoints&&r.setPoints(Q(c.points)),Jp.config.cloneSegments&&r.setSegments(Q(c.segments)),Jp.config.cloneThickness&&r.setThickness(c.thickness),Jp.config.cloneClosePath&&r.setClosePath(c.closePath),r}function Yp(c){var p=mp.call(this,c);return p.clickThroughEnabled=this.isClickThroughEnabled(),p.syncSize=this.isSyncSize(),p}function sp(c,p){var Q=fp(c,p);return Jp.config.cloneClickThroughEnabled&&Q.setClickThroughEnabled(c.clickThroughEnabled),Jp.config.cloneSyncSize&&Q.setSyncSize(c.syncSize),Q}function hp(c){var p=Yp.call(this,c);return p.ref=this.getRef(),p}function Fp(c,p){var Q=sp(c,p);return Jp.config.cloneRef&&Q.setRef(c.ref),Q}function Bp(c){if(!(c instanceof ht.Node))return null;if(c instanceof ht.Group||c instanceof ht.Grid||c instanceof ht.Block)return null;var p=void 0;if(c instanceof sQ)p={type:"clip",points:Q(c.getPoints()),segments:Q(c.getSegments()),closePath:c.isClosePath()};else if(c instanceof hQ)p={type:"restore"};else if(c instanceof ht.Shape)p={type:"shape",points:Q(c.getPoints()),segments:Q(c.getSegments()),closePath:c.isClosePath()};else if(c instanceof ht.Text)p={type:"text",text:c.s("text"),align:c.s("text.align"),vAlign:c.s("text.vAlign"),color:c.s("text.color"),font:c.s("text.font"),shadow:c.s("text.shadow"),shadowColor:c.s("text.shadow.color"),shadowBlur:c.s("text.shadow.blur"),shadowOffsetX:c.s("text.shadow.offset.x"),shadowOffsetY:c.s("text.shadow.offset.y")};else if(c instanceof ht.Node){var r=c.s("shape");r?(p={type:"node_shape",shape:c.s("shape")},"rect"===r?p.depth=c.s("shape.depth"):"roundRect"===r?p.polygonSide=c.s("shape.corner.radius"):"polygon"===r?p.polygonSide=c.s("shape.polygon.side"):"arc"===r&&(p.arcFrom=c.s("shape.arc.from"),p.arcTo=c.s("shape.arc.to"),p.arcClose=c.s("shape.arc.close"),p.arcOval=c.s("shape.arc.oval"))):c.getImage()&&(p={type:"node_image",image:c.getImage(),stretch:c.s("image.stretch"),color:c.s("body.color")})}return p&&(p.visible=c.s("2d.visible"),p.displayName=c.getDisplayName(),p.x=c.getPosition().x,p.y=c.getPosition().y,p.anchorX=c.getAnchor().x,p.anchorY=c.getAnchor().y,p.scaleX=c.getScale().x,p.scaleY=c.getScale().y,p.rotation=c.getRotation(),p.width=c._width,p.height=c._height,p.opacity=c.s("opacity"),"shape"!==p.type&&"node_shape"!==p.type||(p.background=c.s("shape.background"),p.repeatImage=c.s("shape.repeat.image"),p.borderWidth=c.s("shape.border.width"),p.borderColor=c.s("shape.border.color"),p.border3d=c.s("shape.border.3d"),p.border3dColor=c.s("shape.border.3d.color"),p.border3dAccuracy=c.s("shape.border.3d.accuracy"),p.borderCap=c.s("shape.border.cap"),p.borderJoin=c.s("shape.border.join"),p.borderPattern=c.s("shape.border.pattern"),p.gradient=c.s("shape.gradient"),p.gradientColor=c.s("shape.gradient.color"),p.dash=c.s("shape.dash"),p.dashPattern=c.s("shape.dash.pattern"),p.dashOffset=c.s("shape.dash.offset"),p.dashColor=c.s("shape.dash.color"),p.dashWidth=c.s("shape.dash.width"),p.dash3d=c.s("shape.dash.3d"),p.dash3dColor=c.s("shape.dash.3d.color"),p.dash3dAccuracy=c.s("shape.dash.3d.accuracy"),p.fillRule=c.s("shape.fill.rule"),p.fillClipDirection=c.s("shape.fill.clip.direction"),p.fillClipPercentage=c.s("shape.fill.clip.percentage"),p.gradientPack=Q(c.s("shape.gradient.pack")),p.borderWidthAbsolute=c.s("shape.border.width.absolute"))),p}function Dp(c,p){var r=void 0;if("clip"===c.type)p&&(r=new sQ,r.s("type","clip"),r.setPoints(c.points),r.setSegments(c.segments));else if("restore"===c.type)p&&(r=new hQ,r.s("type","restore"));else if("shape"===c.type)r=p?new tQ:new ht.Shape,r.s("type","shape"),r.setPoints(c.points),r.setSegments(c.segments),r.setClosePath(c.closePath);else if("node_shape"===c.type){r=p?new RQ:new ht.Node;var i=c.shape;r.s("shape",i),"rect"===i?r.s("shape.depth",c.depth):"roundRect"===i?r.s("shape.corner.radius",c.polygonSide):"polygon"===i?r.s("shape.polygon.side",c.polygonSide):"arc"===i&&(r.s("shape.arc.from",c.arcFrom),r.s("shape.arc.to",c.arcTo),r.s("shape.arc.close",c.arcClose),r.s("shape.arc.oval",c.arcOval))}else"node_image"===c.type?(p?(r=new bQ,r.s("type","image"),r.s("image",c.image)):(r=new ht.Node,r.setImage(c.image)),r.s("body.color",c.color)):"text"===c.type&&(r=p?new YQ:new ht.Text,r.s("type","text"),r.s("text",c.text),r.s("text.align",c.align),r.s("text.vAlign",c.vAlign),r.s("text.color",c.color),r.s("text.font",c.font),r.s("text.shadow",c.shadow),r.s("text.shadow.color",c.shadowColor),r.s("text.shadow.blur",c.shadowBlur),r.s("text.shadow.offset.x",c.shadowOffsetX),r.s("text.shadow.offset.y",c.shadowOffsetY));return r?(r.s("2d.visible",c.visible),r.setDisplayName(c.displayName),r.setPosition(c.x,c.y),.5===c.anchorX&&.5===c.anchorY||r.setAnchor(c.anchorX,c.anchorY),r.setScale(c.scaleX,c.scaleY),r.setRotation(c.rotation),r.setSize(c.width,c.height),r.s("opacity",c.opacity),"shape"!==c.type&&"node_shape"!==c.type||(r.s("shape.background",c.background),r.s("shape.repeat.image",c.repeatImage),r.s("shape.border.width",c.borderWidth),r.s("shape.border.color",c.borderColor),r.s("shape.border.3d",c.border3d),r.s("shape.border.3d.color",c.border3dColor),r.s("shape.border.3d.accuracy",c.border3dAccuracy),r.s("shape.border.cap",c.borderCap),r.s("shape.border.join",c.borderJoin),r.s("shape.border.pattern",c.borderPattern),r.s("shape.gradient",c.gradient),r.s("shape.gradient.color",c.gradientColor),r.s("shape.dash",c.dash),r.s("shape.dash.pattern",c.dashPattern),r.s("shape.dash.offset",c.dashOffset),r.s("shape.dash.color",c.dashColor),r.s("shape.dash.width",c.dashWidth),r.s("shape.dash.3d",c.dash3d),r.s("shape.dash.3d.color",c.dash3dColor),r.s("shape.dash.3d.accuracy",c.dash3dAccuracy),r.s("shape.fill.rule",c.fillRule),r.s("shape.fill.clip.direction",c.fillClipDirection),r.s("shape.fill.clip.percentage",c.fillClipPercentage),r.s("shape.gradient.pack",Q(c.gradientPack)),r.s("shape.border.width.absolute",c.borderWidthAbsolute)),r):null}function Up(c,p){var Q=void 0,r=p?p.dm:null,i=r?r.a("width"):100,n=r?r.a("height"):100,y=Mc(c.type);if(Ic(y)){var X=Rr[y];X?Q=new X(c,i,n):nc(y)&&(Q=new ir(c,i,n))}else Q=new dr(c,i,n);return Q&&p&&p.addData(Q,!0),Q}function ap(c,p){c.s("chart.series")||c.s("chart.series",[]);var Q=c.s("chart.series");Q[0]||(Q[0]={});var r=Q[0];return r.values||(r.values=[]),r.colors||(r.colors=[]),r[p]}function _p(c,p){return Mc(ap(c,p))}function wp(c,p){return Kc(ap(c,p))}function $p(){var c=Jp.config.customProperties.display;c&&c.length&&c.forEach(function(c){var p=(c.accessType||"a")+":"+c.property;GQ.display[p]=!0}),c=Jp.config.customProperties.data,c&&c.length&&c.forEach(function(c){var p=(c.accessType||"a")+":"+c.property;GQ.data[p]=!0}),c=Jp.config.customProperties.symbol,c&&c.length&&c.forEach(function(c){GQ.symbol[c.property]=!0}),c=Jp.config.customProperties.comp,c&&c.length&&c.forEach(function(c){GQ.comp[c.property]=!0}),c=Jp.config.customProperties.scene,c&&c.length&&c.forEach(function(c){var p=(c.accessType||"a")+":"+c.property;GQ.scene[p]=!0}),(c=Jp.config.customProperties.data3d)&&c.length&&c.forEach(function(c){var p=(c.accessType||"a")+":"+c.property;GQ.data3d[p]=!0})}function Lp(){var c=Jp.config,p=Jp.consts,Q=function(p,Q){void 0===c.valueTypes[p]&&(Q.name="editor.valuetype."+p.toLowerCase(),c.valueTypes[p]=Q)};Q("String",{type:"string"}),Q("Image",{type:"image"}),Q("URL",{type:"url"}),Q("Multiline",{type:"multiline",rows:1}),Q("Font",{type:"font"}),Q("Angle",{type:"number",angle:!0}),Q("Int",{type:"int",step:1}),Q("PositiveNumber",{type:"number",step:1,min:0}),Q("Number",{type:"number",step:1}),Q("Color",{type:"color"}),Q("Boolean",{type:"boolean"}),Q("Function",{type:"function"}),Q("Object",{type:"object"}),Q("ObjectArray",{type:"objectArray",rows:3}),Q("StringArray",{type:"stringArray",rows:3}),Q("NumberArray",{type:"numberArray",rows:3}),Q("ColorArray",{type:"colorArray",rows:3}),Q("Opacity",{type:"number",min:0,max:1,step:.01}),Q("Percentage",{type:"number",min:0,max:1,step:.01}),Q("Gradient",{type:"enum",values:c.gradients,icons:c.gradientIcons,dropDownWidth:140}),Q("FillRule",{type:"enum",values:p.fillRules,labels:p.fillRuleLabels}),Q("ClipDirection",{type:"enum",values:p.clipDirections,labels:p.clipDirectionLabels}),Q("CapStyle",{type:"enum",values:p.caps,labels:p.capLabels}),Q("JoinStyle",{type:"enum",values:p.joins,labels:p.joinLabels}),Q("Align",{type:"enum",values:p.aligns,labels:p.alignLabels}),Q("VAlign",{type:"enum",values:p.vAligns,labels:p.vAlignLabels}),Q("Stretch",{type:"enum",values:p.stretchs,labels:p.stretchLabels}),Q("Direction",{type:"enum",values:p.directions,labels:p.directionLabels}),Q("Orientation",{type:"enum",values:p.orientations,labels:p.orientationLabels}),Q("ColumnChart",{type:"enum",values:p.columnChartTypes,labels:p.columnChartTypeLabels}),p.valueTypes=[],p.valueTypeLabels=[];for(var r in Jp.config.valueTypes)!function(c){var Q=Jp.config.valueTypes[c];Q.type&&(p.valueTypes.push(c),p.valueTypeLabels.push(i(Q.name)||i(c)),"enum"===Q.type&&Q.i18nLabels&&!Q.labels&&(Q.labels=[],Q.i18nLabels.forEach(function(c){Q.labels.push(i(c))})))}(r)}function Hp(){var c=Jp.consts={};c.edgeTypes=[void 0,"points"].concat(Object.keys(ht.Default.getEdgeTypeMap())),c.aligns=["left","center","right"],c.alignLabels=[i("editor.align.left"),i("editor.align.center"),i("editor.align.right")],c.vAligns=["top","middle","bottom"],c.vAlignLabels=[i("editor.valign.top"),i("editor.valign.middle"),i("editor.valign.bottom")],c.stretchs=["fill","uniform","centerUniform"],c.stretchLabels=[i("editor.stretch.fill"),i("editor.stretch.uniform"),i("editor.stretch.centeruniform")],c.fillRules=["nonzero","evenodd"],c.fillRuleLabels=[i("editor.nonzero"),i("editor.evenodd")],c.clipDirections=["top","bottom","left","right"],c.clipDirectionLabels=[i("editor.clipdirection.top"),i("editor.clipdirection.bottom"),i("editor.clipdirection.left"),i("editor.clipdirection.right")],c.caps=["butt","round","square"],c.capLabels=[i("editor.cap.butt"),i("editor.cap.round"),i("editor.cap.square")],c.joins=["bevel","round","miter"],c.joinLabels=[i("editor.join.bevel"),i("editor.join.round"),i("editor.join.miter")],c.directions=["h","v"],c.directionLabels=[i("editor.direction.h"),i("editor.direction.v")],c.orientations=["top","right","bottom","left"],
c.orientationLabels=[i("editor.orientation.top"),i("editor.orientation.right"),i("editor.orientation.bottom"),i("editor.orientation.left")],c.columnChartTypes=["columnChart","stackedColumnChart","percentageColumnChart"],c.columnChartTypeLabels=[i("editor.columncharttype.columnchart"),i("editor.columncharttype.stackedcolumnchart"),i("editor.columncharttype.percentagecolumnchart")],c.gradients=Jp.config.gradients,c.shapes=[void 0,"rect","circle","oval","roundRect","star","pentagram","triangle","hexagon","pentagon","diamond","rightTriangle","parallelogram","trapezoid","polygon","arc"],c.shapeLabels=[],c.shapeIcons=[],c.shapes.forEach(function(p){p?(c.shapeLabels.push(i("editor.comptype."+p.toLowerCase())),c.shapeIcons.push({width:16,height:16,comps:[{type:p,rect:[2,4,12,8],borderWidth:1,borderColor:Jp.config.color_dark}]})):(c.shapeLabels.push(""),c.shapeIcons.push({width:16,height:16,comps:[]}))}),c.selectTypes=["shadow","rect","circle","oval","roundRect"],c.selectTypeLabels=[],c.selectTypeIcons=[],c.selectTypes.forEach(function(p){"shadow"===p?(c.selectTypeLabels.push(i("editor.shadow")),c.selectTypeIcons.push({width:16,height:16,comps:[]})):(c.selectTypeLabels.push(i("editor.comptype."+p.toLowerCase())),c.selectTypeIcons.push({width:16,height:16,comps:[{type:p,rect:[2,4,12,8],borderWidth:1,borderColor:Jp.config.color_dark}]}))}),c.displayConnectActionTypes=Jp.config.displayConnectActionTypes,c.displayConnectActionTypeLabels=[],c.displayConnectActionTypes.forEach(function(p){var Q=p?p.toLowerCase():"none";c.displayConnectActionTypeLabels.push(i("editor.connectactiontype."+Q,!0)||i(p))}),c.symbolConnectActionTypes=Jp.config.symbolConnectActionTypes,c.symbolConnectActionTypeLabels=[],c.symbolConnectActionTypes.forEach(function(p){var Q=p?p.toLowerCase():"none";c.symbolConnectActionTypeLabels.push(i("editor.connectactiontype."+Q,!0)||i(p))}),c.vLayoutValues=[void 0,"top","bottom","topbottom","center","scale"],c.vLayoutLabels=[i("editor.layout.none"),i("editor.layout.top"),i("editor.layout.bottom"),i("editor.layout.topbottom"),i("editor.layout.center"),i("editor.layout.scale")],c.hLayoutValues=[void 0,"left","right","leftright","center","scale"],c.hLayoutLabels=[i("editor.layout.none"),i("editor.layout.left"),i("editor.layout.right"),i("editor.layout.leftright"),i("editor.layout.center"),i("editor.layout.scale")],c.fullscreenValues=[void 0,"fill","uniform"],c.fullscreenLabels=[i("editor.layout.none"),i("editor.stretch.fill"),i("editor.stretch.uniform")],c.fullscreenLockValues=[!1,"h","v"],c.fullscreenLockLabels=[i("editor.layout.none"),i("editor.direction.h"),i("editor.direction.v")]}String.prototype.startsWith||(String.prototype.startsWith=function(c,p){return p=p||0,this.substr(p,c.length)===c}),String.prototype.endsWith||(String.prototype.endsWith=function(c,p){var Q=this.toString();("number"!=typeof p||!isFinite(p)||Math.floor(p)!==p||p>Q.length)&&(p=Q.length),p-=c.length;var r=Q.lastIndexOf(c,p);return-1!==r&&r===p});var Op=window.hteditor_config||{},Mp=function(c,p){void 0===Op[c]&&(Op[c]=p)};Mp("color_select","#45C4F9"),Mp("color_select_dark","#39B0E4"),Mp("color_pane","#FCFCFC"),Mp("color_pane_dark","#F7F7F7"),Mp("color_line","#E4E4E4"),Mp("color_dark","#2C2C2C"),Mp("color_light","white"),Mp("color_data_border","#979797"),Mp("color_data_background","#D8D8D8"),Mp("color_transparent","rgba(70,70,70,0.4)"),Mp("color_disabled","#8C8C8C"),Mp("color_guide","red"),Mp("color_hover","rgba(184,184,184,0.18)"),Mp("color_mask","rgba(84,110,125,0.30)");var Kp=function(){var c=navigator.userAgent;return c.indexOf("compatible")>-1&&c.indexOf("MSIE")>-1||c.indexOf("Trident")>-1&&c.indexOf("rv:11.0")>-1}();if(Mp("logEditorInfo",!0),Mp("host",window.location.hostname),Mp("port",window.location.port),Mp("locale","en"),Mp("serviceClass",void 0),Mp("maxUndoRedoSteps",200),Mp("inspectorTitleHeight",void 0),Mp("inspectorTitleBackground",void 0),Mp("smallFont","10px arial, sans-serif"),Mp("boldFont","bold 12px arial, sans-serif"),Mp("leftSplitViewPosition",240),Mp("rightSplitViewPosition",-300),Mp("mainSplitViewPosition",-370),Mp("explorerSplitViewPosition",.4),Mp("requestDelay",100),Mp("imageSize",256),Mp("fileSize",50),Mp("maxFileSize",200),Mp("dragImageSize",50),Mp("dragImageOpacity",.7),Mp("animate",!0),Mp("fitPadding",20),Mp("fitContentForDisplayView",!0),Mp("fitContentForSymbolView",!0),Mp("rulerSize",16),Mp("edgeLoop",!0),Mp("pasteOffset",5),Mp("continuousLayout",!0),Mp("maxZoom",50),Mp("minZoom",.01),Mp("detailFilter",{}),Mp("compactFilter",{}),Mp("customProperties",{}),Mp("rulerEnabled",!0),Mp("gridEnabled",!1),Mp("displayGridBlockSize",40),Mp("displayGridThickLinesEvery",10),Mp("displayGridThickColor","rgb(191, 191, 191)"),Mp("displayGridLightColor","rgba(191, 191, 191, 0.4)"),Mp("displayGridAngle",Math.PI/2),Mp("displayGridRotation",0),Mp("displayGridZoomThreshold",.25),Mp("displayGridAlignmentGuideColor",Op.color_guide),Mp("symbolGridBlockSize",1),Mp("symbolGridThickLinesEvery",20),Mp("symbolGridThickColor","rgb(191, 191, 191)"),Mp("symbolGridLightColor","rgba(191, 191, 191, 0.2)"),Mp("symbolGridAngle",Math.PI/2),Mp("symbolGridRotation",0),Mp("symbolGridZoomThreshold",.25),Mp("symbolGridAlignmentGuideColor",Op.color_guide),Mp("maxStringLength",1e6),Mp("maxFileNameLength",100),Mp("traceMissingI18n",!1),Mp("container",void 0),Mp("continuousCreating",!1),Mp("valueTypes",{}),Mp("indent",100),Mp("indent2","64+0.005"),Mp("clearDataBindingsBeforeImporting",!0),Mp("insertDisplayViewAsRefGraph",!1),Mp("displayPreviewURL","display.html"),Mp("symbolPreviewURL","symbol.html"),Mp("removeFileByKeyboardEnabled",!1),Mp("locateFileEnabled",!0),Mp("promptBeforeClosing",!0),Mp("displaysVisible",!0),Mp("symbolsVisible",!0),Mp("componentsVisible",!0),Mp("scenesVisible",!1),Mp("modelsVisible",!1),Mp("assetsVisible",!0),Mp("displaysEditable",!0),Mp("symbolsEditable",!0),Mp("componentsEditable",!0),Mp("scenesEditable",!0),Mp("modelsEditable",!0),Mp("assetsEditable",!0),Mp("settingDefaultValueBeforeSaving",!1),Mp("svgSegments",20),Mp("svgWaitingTime",600),Mp("importConfirm",!0),Mp("newIfFailToOpen",!0),Mp("dataBindings",{}),Mp("dataBindingsForSymbol",{}),Mp("useCodeEditor",!Kp),Mp("codeEditorClass",void 0),Mp("fontPreview","Hightopo"),Mp("checkForFileChanges",!0),Mp("checkForFileChangesInterval",3e3),Mp("rotateAsClock",!1),Mp("cloneAttr",!0),Mp("cloneStyle",!0),Mp("cloneName",!0),Mp("cloneDisplayName",!0),Mp("cloneToolTip",!0),Mp("cloneTag",!1),Mp("cloneIcon",!0),Mp("cloneLayer",!0),Mp("cloneParent",!0),Mp("cloneDataBindings",!0),Mp("cloneSource",!0),Mp("cloneTarget",!0),Mp("cloneExpanded",!0),Mp("cloneClickThroughEnabled",!0),Mp("cloneSyncSize",!0),Mp("cloneRef",!0),Mp("clonePoints",!0),Mp("cloneSegments",!0),Mp("cloneThickness",!0),Mp("cloneClosePath",!0),Mp("cloneRotation",!0),Mp("clonePosition",!0),Mp("cloneSize",!0),Mp("cloneScale",!0),Mp("cloneAnchor",!0),Mp("cloneImage",!0),Mp("cloneHost",!0),Mp("isOpenable",null),Mp("dialogTitleBackground",null),Mp("componentViewSize",{width:700,height:500}),Mp("eventViewSize",{width:560,height:400}),Mp("fontViewSize",{width:500,height:400}),Mp("functionViewSize",{width:500,height:400}),Mp("objectViewSize",{width:500,height:400}),Mp("textViewSize",{width:500,height:400}),Mp("attachPointsViewSize",{width:700,height:500}),Mp("drawAccordionTitle",null),Mp("accordionMutex",!1),Mp("importDataBindingsButtonVisible",!0),Mp("saveSymbolCustomPropertyDefaultValue",!1),Mp("saveCompCustomPropertyDefaultValue",!1),Mp("deleteFileConfirm",!0),Mp("mixMaskAndBackground",!0),Mp("hoverGuideVisible",!0),Mp("anchorVisible",!0),Mp("connectGuideVisible",!0),Mp("guideLineVisible",!0),Mp("moveDummyThreshold",32),Mp("smartGuideThreshold",8),Mp("cadToDisplayBoundingType","Standard"),Mp("cadToSymbolBoundingType","Reset"),Mp("promptForMovingFile",!1),Mp("displayTreeVisibleFunc",null),Mp("symbolListVisibleFunc",null),Mp("onElementCreated",null),Mp("createFileTreeSortFunc",function(c){var p=c.explorer.rootDir,Q=p+"/ht",r=p+"/htdesign";return function(p,i){var n=p.url,y=i.url;return n===y?0:n===Q?-1:y===Q?1:n===r?-1:y===r?1:ht.Default.sortFunc(c.getLabel(p),c.getLabel(i))}}),Mp("explorerMode","treeList"),Mp("filterDisplayViewEnabled",!1),Mp("filterSymbolViewEnabled",!1),Mp("customAttachPointsColumns",null),Mp("isCopyCompsWhenNewState",!0),Mp("codeEditorTheme",null),Mp("isDataBound",function(c,p,Q){var r=c.getDataBindings();return r&&r[p]&&r[p][Q]}),Mp("checkFileName",function(c,p){return!!c&&(!!(c=c.trim())&&(!/[!@?#$%^&*\/]/.test(c)&&c))}),Mp("paletteColors",[["rgb(51,153,255)","#60ACFC","#32D3EB","rgb(93,217,174)","rgb(125,195,125)","rgb(255,235,195)","rgb(226,250,87)"],["#FEB64D","#FF7C7C","rgb(241,125,164)","rgb(204,104,166)","rgb(135,144,204)","rgb(145,115,205)","rgb(124,145,155)"],["rgb(48,242,120)","rgb(0,199,7)","rgb(242,83,75)","rgb(212,0,0)","rgb(240,225,19)","rgb(247,247,247)","rgb(61,61,61)"]]),Mp("gradients",[null,"linear.southwest","linear.southeast","linear.northwest","linear.northeast","linear.north","linear.south","linear.west","linear.east","radial.center","radial.southwest","radial.southeast","radial.northwest","radial.northeast","radial.north","radial.south","radial.west","radial.east","spread.horizontal","spread.vertical","spread.diagonal","spread.antidiagonal","spread.north","spread.south","spread.west","spread.east"]),Op.gradientIcons||(Op.gradientIcons=[],Op.gradients.forEach(function(c){c?Op.gradientIcons.push({width:20,height:14,comps:[{type:"rect",rect:[0,0,20,14],gradient:c,gradientColor:Op.color_line,background:Op.color_dark}]}):Op.gradientIcons.push({width:20,height:14,comps:[]})})),Mp("fontList",["SimSun","NSimSun","FangSong","KaiTi","FangSong_GB2312","Microsoft YaHei","cursive","monospace","serif","sans-serif","fantasy","Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Bookman Old Style","Bradley Hand ITC","Century","Century Gothic","Comic Sans MS","Courier","Courier New","Georgia","Gentium","Impact","King","Lucida Console","Lalit","Modena","Monotype Corsiva","Papyrus","Tahoma","TeX","Times","Times New Roman","Trebuchet MS","Verdana","Verona","PingFangSC-Thin"]),Mp("expandedTitles",{}),["TitleBasic","TitleCustom","TitleBackground","TitleBorder","TitleText","TitleImage","TitleNode","TitleGroupBasic","TitleEdgeBasic","TitleArc","TitleDataBinding","TitleComponent","TitleShapeBackground","TitleShapeBorder","TitleGroupTitle","TitleEditingPoint","TitleChart","TitleLayout","TitleNodeLayout"].forEach(function(c){null==Op.expandedTitles[c]&&(Op.expandedTitles[c]=!0)}),ht.Default.handleUnfoundImage=function(c,p){return ht.Default.getImage("editor.unknown")},Mp("displayConnectActionType",null),Mp("symbolConnectActionType",null),Mp("displayConnectActionTypes",[null,"copyStyle","host","parent"]),Mp("symbolConnectActionTypes",[null,"copyStyle"]),Mp("appendDisplayConnectActionTypes",null),Mp("appendSymbolConnectActionTypes",null),Mp("appendConnectActions",null),Mp("connectActions",{copyStyle:{action:function(c,p,r){if(r){var i=r.getStyleMap();for(var n in i)"shape"!==n&&"label"!==n&&"label2"!==n&&"note"!==n&&"note2"!==n&&"text"!==n&&p.s(n,Q(i[n]))}},extraInfo:{visible:function(c){return!0}}},host:{action:function(c,p,Q){p instanceof ht.Node&&Q instanceof ht.Node&&p.setHost(Q)},extraInfo:{delete:{visible:function(c){return c.sm().ld()instanceof ht.Node&&c.sm().ld().getHost()},action:function(c,p){p instanceof ht.Node&&p.setHost(void 0)}},visible:function(c){return c.sm().ld()instanceof ht.Node}}},parent:{action:function(c,p,Q){Q&&p.setParent(Q)},extraInfo:{delete:{visible:function(c){return c.sm().ld().getParent()},action:function(c,p){p.setParent(void 0)}},visible:function(c){return!0}}}}),Op.appendDisplayConnectActionTypes&&Op.appendDisplayConnectActionTypes.forEach(function(c){Op.displayConnectActionTypes.push(c)}),Op.appendSymbolConnectActionTypes&&Op.appendSymbolConnectActionTypes.forEach(function(c){Op.symbolConnectActionTypes.push(c)}),Op.appendConnectActions)for(var up in Op.appendConnectActions)Op.connectActions[up]=Op.appendConnectActions[up];for(var xp in Op.connectActions){var qp=Op.connectActions[xp];ht.Default.setConnectAction(xp,qp.action,qp.extraInfo)}var zp=ht.Default.getToolTipDiv();zp.style.color=Op.color_dark,zp.style.background=Op.color_pane,ht.widget.ColorPicker.prototype._paletteColors=Op.paletteColors,ht.graph.GraphView.prototype._scrollBarColor=Op.color_transparent,ht.graph.GraphView.prototype._rectSelectBackground=Op.color_transparent,ht.graph.GraphView.prototype._rectSelectBorderColor=Op.color_select,ht.graph.GraphView.prototype.isLabelVisible=function(){return!0},ht.widget.ListView.prototype._scrollBarColor=Op.color_transparent,ht.widget.TreeView.prototype._scrollBarColor=Op.color_transparent,ht.widget.TableView.prototype._scrollBarColor=Op.color_transparent,ht.widget.TreeTableView.prototype._scrollBarColor=Op.color_transparent,ht.widget.PropertyView.prototype._scrollBarColor=Op.color_transparent,ht.widget.FormPane.prototype._scrollBarColor=Op.color_transparent,ht.widget.SplitView.prototype._dividerBackground=Op.color_line,ht.widget.SplitView.prototype._continuousLayout=Op.continuousLayout,ht.widget.ListView.prototype._selectBackground=Op.color_select,ht.widget.TreeView.prototype._selectBackground=Op.color_select,ht.widget.TableView.prototype._selectBackground=Op.color_select,ht.widget.TreeTableView.prototype._selectBackground=Op.color_select,ht.widget.TableHeader.prototype._columnLineColor=Op.color_line,ht.widget.TableHeader.prototype._insertColor=Op.color_select_dark,ht.widget.TableView.prototype._columnLineColor=Op.color_line,ht.widget.Toolbar.prototype._separatorColor=Op.color_line,ht.widget.Toolbar.prototype._itemGap=4,ht.widget.Button.prototype._labelColor=Op.color_light,ht.widget.Button.prototype._borderColor=null,ht.widget.Button.prototype._background=Op.color_select,ht.widget.Button.prototype._selectBackground=Op.color_select_dark,ht.widget.CheckBox.prototype._pressBackground=Op.color_pane_dark,ht.widget.ComboBox.prototype._selectBackground=Op.color_select,ht.widget.TabView.prototype._insertColor=Op.color_select_dark,ht.widget.TabView.prototype._selectWidth=0,ht.widget.TabView.prototype._selectBackground=Op.color_select,ht.widget.TabView.prototype._tabBackground=Op.color_dark;var Vp=ht.widget.TabView.prototype.drawTab;ht.widget.TabView.prototype.drawTab=function(c,p,Q,r,i,n,y){return y=p==this.getCurrentTab()?Op.color_select:Op.color_dark,Vp.call(this,c,p,Q,r,i,n,y)},ht.widget.FormPane.prototype._hPadding=4,ht.widget.FormPane.prototype._vPadding=4,ht.widget.FormPane.prototype._hGap=4,ht.widget.FormPane.prototype._vGap=4,ht.widget.Slider.prototype._background=Op.color_dark,ht.widget.Slider.prototype._leftBackground=Op.color_select,ht.widget.Slider.prototype._button={width:14,height:14,comps:[{type:"circle",rect:[0,0,14,14],borderWidth:1,borderColor:Op.color_dark,background:Op.color_pane_dark}]},ht.widget.ComboBox.prototype._dropDownIcon=ht.widget.MultiComboBox.prototype._dropDownIcon={width:16,height:16,comps:[{type:"shape",points:[13,6,8,12,3,6],segments:[1,2,2],borderWidth:1,borderColor:Op.color_dark}]},ht.Default.comboBoxBorderColor=Op.color_line,ht.Default.textFieldBorderColor=Op.color_line,ht.Default.contextMenuHoverBackground=Op.color_select,ht.Default.contextMenuSeparatorColor=Op.color_line,ht.Default.dialogTitleBackground=Op.dialogTitleBackground||Op.color_dark,ht.Default.dialogButtonBackground=Op.color_select,ht.Default.dialogButtonSelectBackground=Op.color_select_dark,ht.Default.dialogHeaderBackground=Op.color_pane_dark,ht.Default.toolbarBackground=Op.color_pane_dark,ht.Default.tableHeaderBackground=Op.color_pane_dark,ht.Default.contextMenuLabelFont=ht.Default.labelFont,ht.Default.contextMenuBorderRadius=0,ht.Default.contextMenuBorderColor=Op.color_line,ht.Default.contextMenuSubmenuMark=">&nbsp;",ht.Default.contextMenuCheckIcon={width:16,height:16,comps:[{type:"shape",points:[13,3,7,12,4,8],borderWidth:1,borderColor:Op.color_dark}]},ht.Default.setImage("radioOn",{width:16,height:16,comps:[{type:"circle",rect:[2,2,12,12],borderWidth:1,borderColor:ht.Color.widgetIconBorder,background:"#FFF"},{type:"circle",rect:[4,4,8,8],background:Op.color_select}]}),ht.Default.setImage("expandIcon",{width:16,height:16,comps:[{type:"shape",points:[13,6,8,12,3,6],segments:[1,2,2],borderWidth:1,borderColor:Op.color_dark}]}),ht.Default.setImage("collapseIcon",{width:16,height:16,comps:[{type:"shape",points:[6,3,12,8,6,13],segments:[1,2,2],borderWidth:1,borderColor:Op.color_dark}]}),ht.widget.TreeView.prototype._expandIcon="expandIcon",ht.widget.TreeView.prototype._collapseIcon="collapseIcon",ht.widget.TreeTableView.prototype._expandIcon="expandIcon",ht.widget.TreeTableView.prototype._collapseIcon="collapseIcon",ht.widget.TextField.prototype.setEditable=ht.widget.TextArea.prototype.setEditable=function(c){var p=this._element;c?(p.removeAttribute("readonly"),p.style.color=ht.Default.labelColor):(p.setAttribute("readonly",!0),p.style.color=Op.color_disabled)},ht.Default.onElementCreated=function(c){("INPUT"===c.tagName&&"button"!==c.type||"TEXTAREA"===c.tagName)&&(c.style.border=Op.color_line+" solid 1px",c.style.outline=0,c.style.padding="2px","TEXTAREA"===c.tagName&&(c.style.whiteSpace="pre",c.setAttribute("spellcheck","false")),c.addEventListener("focus",function(p){c.oldBorder=c.style.border,c.style.border=Op.color_select+" solid 1px","INPUT"===c.tagName&&requestAnimationFrame(function(){c.select()}),"TEXTAREA"===c.tagName&&(c.style.zIndex="1")},!1),c.addEventListener("blur",function(p){c.style.border=c.oldBorder,"TEXTAREA"===c.tagName&&(c.style.zIndex="")},!1),Op.onElementCreated&&Op.onElementCreated(c))},ht.Default.onWidgetColorPickerCreated=function(p){for(var Q=Op.color_line+" solid 1px",r=p.getView(),i=r.querySelectorAll(".colorPalette"),n=0;n<i.length;n++)i[n].style.border=Q;r.querySelector(".satval").style.border=Q,r.querySelector(".hue_image").style.border=Q,r.querySelector(".preview").style.border=Q,i=r.querySelectorAll('input[type="button"]');for(var y=0;y<i.length;y++){var X=i[y];X.style.border=Q,X.style.background="none",X.style.outline="none",X.style.width="30px",X.addEventListener("mouseover",function(c){c.target.style.background=Op.color_hover},!1),X.addEventListener("mouseout",function(){event.target.style.background="none"},!1)}i=r.querySelectorAll("span");for(var W=0;W<i.length;W++)c(p,r,i[W])},ht.Default.handleUnfoundImage=function(c,p){return ht.Default.getImage("editor.unknown")},Op.configStudio&&Op.configStudio();var Tp=(function(){function c(c){this.value=c}function p(p){function Q(c,p){return new Promise(function(Q,i){var X={key:c,arg:p,resolve:Q,reject:i,next:null};y?y=y.next=X:(n=y=X,r(c,p))})}function r(Q,n){try{var y=p[Q](n),X=y.value;X instanceof c?Promise.resolve(X.value).then(function(c){r("next",c)},function(c){r("throw",c)}):i(y.done?"return":"normal",y.value)}catch(c){i("throw",c)}}function i(c,p){switch(c){case"return":n.resolve({value:p,done:!0});break;case"throw":n.reject(p);break;default:n.resolve({value:p,done:!1})}n=n.next,n?r(n.key,n.arg):y=null}var n,y;this._invoke=Q,"function"!=typeof p.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(p.prototype[Symbol.asyncIterator]=function(){return this}),p.prototype.next=function(c){return this._invoke("next",c)},p.prototype.throw=function(c){return this._invoke("throw",c)},p.prototype.return=function(c){return this._invoke("return",c)}}(),function(c,p){if(!(c instanceof p))throw new TypeError("Cannot call a class as a function")}),Ap=function(){function c(c,p){for(var Q=0;Q<p.length;Q++){var r=p[Q];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(c,r.key,r)}}return function(p,Q,r){return Q&&c(p.prototype,Q),r&&c(p,r),p}}(),Np=function(c,p){if("function"!=typeof p&&null!==p)throw new TypeError("Super expression must either be null or a function, not "+typeof p);c.prototype=Object.create(p&&p.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(c,p):c.__proto__=p)},Sp=function(c,p){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!p||"object"!=typeof p&&"function"!=typeof p?c:p},vp=function(c){function p(Q){return Tp(this,p),Sp(this,c.call(this,Q))}return Np(p,c),p.prototype.onShown=function(){fQ.push(this)},p.prototype.onHidden=function(){n(fQ,this)},p}(ht.widget.Dialog),gp=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this,Q));return r.getView().style.background=Jp.config.color_pane,r}return Np(p,c),p.prototype.addLine=function(){this.addRow([],[.1],1.01,{background:Jp.config.color_line})},p.prototype.addTitle=function(c){var p=[{element:c,font:Jp.config.boldFont}],Q={background:Jp.config.color_pane_dark};this.addRow(p,[.1],null,Q)},p.prototype.getRowIndex=function(c){return this.getRows().indexOf(c)},p}(ht.widget.FormPane),kp=function(){function c(p){Tp(this,c);var Q=this._view=document.createElement("div"),r=this._editableLayer=document.createElement("div"),i=r.style;this.config=p,this._editable=!0,i.backgroundColor=ht.Default.disabledBackground||"rgba( 255, 255, 255, 0.3)",i.position="absolute",i.cursor="not-allow",i.top=0,i.right=0,i.bottom=0,i.left=0,i.pointerEvents="none",Jp.config.useCodeEditor||(this._monacoEditor=new ht.widget.TextArea,this._view=this._monacoEditor.getView(),p&&p.value&&this._monacoEditor.setValue(p.value)),Q.style.position="absolute"}return c.prototype.getView=function(){return this._view},c.prototype.setValue=function(c){void 0!==c&&null!==c||(c=""),this.monacoEditor&&this.monacoEditor.setValue(c)},c.prototype.getValue=function(){return this.monacoEditor&&this.monacoEditor.getValue()},c.prototype.layout=function(){this.monacoEditor&&(this.monacoEditor.layout(),this.isEditable()||this.getView().appendChild(this._editableLayer))},c.prototype.invalidate=function(){this.layoutLater()},c.prototype.iv=function(){this.invalidate()},c.prototype.layoutLater=function(c){var p=this;setTimeout(function(){p.layout()},c||300)},c.prototype.setEditable=function(c){var p=this;if(this._monacoEditor instanceof ht.widget.TextArea)return void this._monacoEditor.setEditable(c);if(this._editable!==c){this._timer&&(clearTimeout(this._timer),delete this._timer);var Q=this._editableLayer;c?Q.parentNode&&Q.parentNode.removeChild(Q):this._timer=setTimeout(function(){delete p._timer,p.getView().appendChild(Q)},10),this._editable=c,this._monacoEditor&&this._monacoEditor.updateOptions({readOnly:!c})}},c.prototype.isEditable=function(){return this._monacoEditor instanceof ht.widget.TextArea?this._monacoEditor.isEditable():this._editable},Ap(c,[{key:"monacoEditor",get:function(){return!this._monacoEditor&&window.monaco&&(this._monacoEditor=monaco.editor.create(this._view,this.config||{value:"",language:"javascript",theme:Jp.config.codeEditorTheme,readOnly:!this._editable,minimap:{enabled:!1}})),this._monacoEditor}}]),c}(),Jp={strings:{},customStrings:{},config:Op},Cp=["onClick","onDoubleClick","onContextMenu","onDown","onUp","onMove","onEnter","onHover","onLeave","onBeginDrag","onDrag","onEndDrag","onScroll"],cQ="unknow",pQ="root",QQ="dir",rQ="asset",iQ="symbol",nQ="display",yQ="component",XQ="model",WQ="scene",ZQ="tile",oQ="list",lQ="accordion",jQ=/^attr@/,EQ=/firefox/.test(window.navigator.userAgent.toLowerCase()),mQ=/safari/.test(window.navigator.userAgent.toLowerCase()),fQ=[],IQ={width:16,height:16,comps:[]},GQ={display:{},symbol:{},data:{},comp:{},scene:{},data3d:{}},eQ=new ht.List([{x:50,y:75},{x:25,y:75},{x:25,y:25},{x:75,y:25},{x:75,y:75},{x:65,y:60},{x:75,y:75},{x:85,y:60}]),PQ=new ht.List([1,2,2,2,2,2,1,2]);ht.Default.setImage("check",{width:16,height:16,comps:[{type:"border",rect:[1,1,14,14],width:1,color:Jp.config.color_line},{type:"shape",points:[13,3,7,12,4,8],borderWidth:2,borderColor:{func:function(c,p){return c&&p&&p.getRowSize&&p.isSelected&&p.isSelected(c)?Jp.config.color_line:Jp.config.color_select}}}]}),ht.Default.setImage("uncheck",{width:16,height:16,comps:[{type:"border",rect:[1,1,14,14],width:1,color:Jp.config.color_line}]}),ht.Default.setImage("text_icon",{width:16,height:16,comps:[{type:"shape",points:[3,14,8,2,13,14,5,9,11,9],segments:[1,2,2,1,2],borderColor:Jp.config.color_dark,borderWidth:1}]}),ht.Default.setImage("refGraph_icon",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:Jp.config.color_dark,rotation:.7854,points:[12.90381,7.59615,12.90381,7.59615,12.90381,4.61619,12.90381,3.59619,12.90381,2.57619,11.72047,1.59619,10.40381,1.59619,9.08714,1.59619,7.90381,2.61619,7.90381,3.59619,7.90381,4.35799,7.90381,7.59615,7.90381,7.59615,7.90381,7.59615,7.90381,9.59619,10.40381,9.59619],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Jp.config.color_dark,rotation:-2.35619,points:[8.21091,12.28904,8.21091,12.28904,8.21091,9.30909,8.21091,8.28909,8.21091,7.26909,7.02758,6.28909,5.71091,6.28909,4.39425,6.28909,3.21091,7.30909,3.21091,8.28909,3.21091,9.05088,3.21091,12.28904,3.21091,12.28904,3.21091,12.28904,3.21091,14.28909,5.71091,14.28909],segments:[1,4,4,4,4,4]}]}),ht.Default.setImage("editor.unknown",{width:200,height:200,comps:[{type:"roundRect",background:"rgb(247,247,247)",borderColor:"#979797",cornerRadius:20,selectable:!1,rect:[0,0,200,200]},{type:"shape",background:"rgba(255,170,79,0.63)",borderColor:"rgb(124,145,155)",points:[35.92101,125.8927,70.22338,97.87611,96.05685,117.16025,108.79166,106.08902,115.70485,111.45559,92.40971,145.02116,35.92101,145.02116,35.92101,130.19911]},{type:"shape",background:"rgba(255,170,79,0.63)",borderColor:"rgb(124,145,155)",points:[143.94195,74.95345,121.52647,95.32915,136.08054,112.06633,115.341,146.63224,166.86461,146.63224,166.86461,103.69774]},{type:"shape",borderWidth:4,borderColor:"rgb(124,145,155)",displayName:"\u4e0d\u89c4\u5219\u56fe\u5f62",closePath:!0,points:[86.52393,81.40417,110.5868,43.51795,35.32634,43.51795,35.32634,146.93709,93.17962,146.93709,117.24248,111.09877,86.52393,81.40417]},{type:"shape",borderWidth:4,borderColor:"rgb(124,145,155)",closePath:!0,points:[105.77896,81.40417,129.84183,43.51795,168.08039,43.51795,168.08039,146.93709,112.43465,146.93709,136.49752,111.09877,105.77896,81.40417]},{type:"shape",borderWidth:4,borderColor:"rgb(124,145,155)",points:[35.92101,126.00861,70.52846,96.60621,95.13328,116.95012,108.45973,104.311]},{type:"shape",borderWidth:4,borderColor:"rgb(124,145,155)",points:[122.25418,94.2376,144.08528,74.22575,168.32002,106.08902]},{type:"oval",background:"#FF7C7C",borderWidth:4,borderColor:"rgb(124,145,155)",rect:[56.57448,66.67972,14,14]}]}),ht.Default.setImage("editor.root",{width:30,height:30,fitSize:!0,comps:[{type:"shape",points:[23,8,8,23],segments:[1,2],borderWidth:1,borderColor:"white"}]}),ht.Default.setImage("editor.display",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:Jp.config.color_light,rect:[6,1,4,4.00837]},{type:"circle",borderWidth:1,borderColor:Jp.config.color_light,rect:[11,10.99163,4,4.00837]},{type:"shape",borderWidth:1,borderColor:Jp.config.color_light,points:[2.98235,11.0795,2.98235,8,7.89475,8,7.89475,5.00837,7.89475,8,13,8,13,11]},{type:"circle",borderWidth:1,borderColor:Jp.config.color_light,rect:[1,10.99163,4,4.00837]}]}),ht.Default.setImage("editor.symbol",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:Jp.config.color_light,rect:[0,2,10,8]},{type:"rect",borderWidth:1,borderColor:Jp.config.color_light,rect:[5,6,10,8]}]}),ht.Default.setImage("editor.filter",{background:"rgb(130,130,130)",width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",closePath:!0,points:[2,1.5,14,1.5,9.50949,5.5,9.50949,9.5,13,9.5,9.50949,9.5,9.50949,11.5,12,11.5,9.50949,11.5,9.50949,14.5,6.5335,12.5,6.5335,5.5,2,1.5]}]}),ht.Default.setImage("editor.bind",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"white",borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:"white",borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}]}),ht.Default.setImage("editor.unbind",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:.7854,points:[13.49999,7.03553,13.49999,7.03553,13.49999,5.05554,13.49999,4.03553,13.49999,3.01553,12.31666,2.03553,10.99999,2.03553,9.68333,2.03553,8.49999,3.05553,8.49999,4.03553,8.49999,5.01553,8.49999,7.03553,8.49999,7.03553],segments:[1,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:3.92699,points:[7.28554,13.25761,7.28554,13.25761,7.28554,11.27761,7.28554,10.2576,7.28554,9.23761,6.1022,8.25761,4.78554,8.25761,3.46887,8.25761,2.28554,9.2776,2.28554,10.2576,2.28554,11.2376,2.28554,13.25761,2.28554,13.25761],segments:[1,4,4,4,4]}]}),ht.Default.setImage("editor.dircollapsed",{background:"rgb(179,179,179)",width:16,height:16,comps:[{type:"shape",background:"rgb(255,204,153)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[14.5,14.5,.5,14.5,.5,1.50001,6.5,1.50001,7.5,3.50001,14.5,3.50001,14.5,14.5]},{type:"shape",background:"rgb(255,227,199)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[.5,5.50001,14.5,5.50001,14.5,14.50001,.5,14.50001,.5,5.50001]}]}),ht.Default.setImage("editor.direxpanded",{background:"rgb(179,179,179)",width:16,height:16,comps:[{type:"shape",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(51,153,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[2.35891,10.47175,3.3125,6.30284,15.5,6.30284,13.625,14.5,.5,14.5,.5,1.5,6.125,1.5,7.0625,3.2289,12.6875,3.2289,12.6875,6.30284]}]}),ht.Default.setImage("editor.dir",{background:"rgb(227,227,227)",width:20,height:20,fitSize:!0,comps:[{type:"shape",background:"#FFCC99",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",points:[19,4,19,18,1,18,1,2,8.71429,2,10,4,19,4]},{type:"rect",shadow:!0,shadowColor:"rgba(0,0,0,0.4)",shadowBlur:2,shadowOffsetX:0,shadowOffsetY:1,background:"rgb(255,255,255)",borderColor:"#979797",rotation:6.28319,rect:[2.98273,5.998,13.98346,9.99004]},{type:"shape",background:"rgba(255,255,153,0.3)",borderColor:"rgb(255,255,255)",borderCap:"round",points:[18,9,18,17,2,17,2,9,18,9]},{type:"rect",shadowColor:"rgb(0,0,0)",shadowBlur:2,shadowOffsetX:0,shadowOffsetY:1,background:"rgb(232,230,230)",borderColor:"#979797",rotation:6.28319,rect:[4,7,11.98532,1.06039]}]}),ht.Default.setImage("editor.dxf",{width:64,height:64,fitSize:!0,comps:[{type:"shape",shadowColor:"#1ABC9C",background:"#000000",points:[25.13334,60.62742,20.38001,60.62742,20.11302,60.62742,19.89504,60.41688,19.89504,60.15453,19.89504,43.31796,19.89504,43.05561,20.11302,42.84507,20.38001,42.84507,25.13334,42.84507,30.66329,42.84507,33.35167,45.67873,33.35167,51.50916,33.35167,57.47593,30.51009,60.62742,25.13334,60.62742,25.13334,60.62742,23.32783,57.5939,25.03463,57.5939,28.43349,57.5939,29.82018,55.90554,29.82018,51.77117,29.82018,47.64415,28.35946,45.88193,24.93627,45.88193,23.32783,45.88193,23.32783,57.5939,23.32783,57.5939],segments:[1,2,4,2,4,2,4,4,2,1,2,4,4,2,2,2]},{type:"shape",shadowColor:"#1ABC9C",background:"#000000",
points:[48.10416,60.62742,45.1488,60.62742,44.97846,60.62742,44.82286,60.54254,44.73581,60.40217,40.95446,54.3465,37.26771,60.39482,37.1786,60.53886,37.01957,60.62776,36.84889,60.62776,34.01657,60.62776,33.84041,60.62776,33.67761,60.53552,33.59227,60.38379,33.50693,60.2324,33.51275,60.04759,33.60735,59.89987,39.05608,51.53522,33.90312,43.56961,33.80853,43.42557,33.8027,43.24076,33.88804,43.08937,33.97338,42.93797,34.13618,42.8454,34.31235,42.8454,37.31706,42.8454,37.4874,42.8454,37.64677,42.93396,37.73382,43.078,41.14399,48.68284,44.48219,43.08168,44.56924,42.93396,44.72861,42.84507,44.90272,42.84507,47.73299,42.84507,47.91121,42.84507,48.074,42.93731,48.15729,43.08903,48.24434,43.24042,48.2368,43.42524,48.14221,43.56928,43.03826,51.48342,48.51339,59.89987,48.60798,60.04759,48.61552,60.2324,48.52847,60.38379,48.44518,60.53485,48.28238,60.62742,48.10416,60.62742,48.10416,60.62742],segments:[1,2,4,2,2,4,2,4,4,2,2,4,4,2,4,2,2,4,2,4,4,2,2,4,4,2]},{type:"shape",shadowColor:"#1ABC9C",background:"#000000",points:[53.17006,60.62742,50.68081,60.62742,50.41177,60.62742,50.19585,60.41688,50.19585,60.15453,50.19585,43.31796,50.19585,43.05561,50.41177,42.84507,50.68081,42.84507,60.09288,42.84507,60.36192,42.84507,60.57784,43.05561,60.57784,43.31796,60.57784,45.40904,60.57784,45.67138,60.36192,45.88193,60.09288,45.88193,53.65537,45.88193,53.65537,50.62587,59.22886,50.62587,59.4979,50.62587,59.71382,50.83642,59.71382,51.09876,59.71382,53.18984,59.71382,53.45219,59.4979,53.66273,59.22886,53.66273,53.65537,53.66273,53.65537,60.1542,53.65537,60.41688,53.43911,60.62742,53.17006,60.62742,53.17006,60.62742],segments:[1,2,4,2,4,2,4,2,4,2,2,2,4,2,4,2,2,4,2]},{type:"shape",shadowColor:"#1ABC9C",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]}]}),ht.Default.setImage("editor.obj",{width:64,height:64,fitSize:!0,attachStyle:"close",comps:[{type:"shape",background:"rgb(0,0,0)",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#000000",borderWidth:.5,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[31.21904,47.49025,32.38182,48.81914,33.04627,50.64637,33.04627,52.80583,33.04627,54.96528,32.38182,56.79251,31.21904,58.12141,29.89014,59.4503,28.22903,60.28086,26.06957,60.28086,23.91012,60.28086,22.249,59.61642,20.9201,58.12141,19.75732,56.79251,19.09287,54.96528,19.09287,52.80583,19.09287,50.64637,19.59121,48.81914,20.9201,47.49025,22.08289,45.99524,23.91012,45.33079,26.06957,45.33079,28.22903,45.33079,30.05626,45.99524,31.21904,47.49025,22.58122,48.81914,21.75066,49.81582,21.41844,51.14471,21.41844,52.80583,21.41844,54.46695,21.75066,55.79584,22.58122,56.79251,23.41178,57.78919,24.57456,58.28752,26.06957,58.28752,27.56458,58.28752,28.72736,57.78919,29.55792,56.79251,30.38848,55.79584,30.7207,54.46695,30.7207,52.80583,30.7207,51.14471,30.22237,49.81582,29.55792,48.81914,28.72736,47.82247,27.56458,47.32414,26.06957,47.32414,24.57456,47.32414,23.41178,47.82247,22.58122,48.81914],segments:[1,4,4,4,4,4,4,4,4,5,1,4,4,4,4,4,4,4,4,5]},{type:"shape",background:"#000000",borderWidth:.5,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[41.68409,45.66302,43.01298,45.66302,44.17577,45.99524,45.00633,46.65969,45.83689,47.32414,46.16911,48.1547,46.16911,49.31748,46.16911,50.14804,46.003,50.81249,45.50466,51.31082,45.17244,51.80916,44.50799,52.30749,43.84354,52.47361,44.84021,52.63972,45.50466,52.97194,46.003,53.63639,46.50133,54.13472,46.66745,54.96528,46.66745,55.96195,46.66745,57.45696,46.16911,58.45363,45.17244,59.11808,44.34188,59.61642,43.1791,59.94864,41.68409,59.94864,35.20573,59.94864,35.20573,45.66302,41.68409,45.66302,37.36518,51.64305,41.18575,51.64305,42.18242,51.64305,42.84687,51.47693,43.34521,51.14471,43.84354,50.81249,44.00966,50.14804,44.00966,49.48359,44.00966,48.81914,43.84354,48.32081,43.34521,47.98858,42.84687,47.65636,42.18242,47.49025,41.18575,47.49025,37.36518,47.49025,37.36518,51.64305,37.36518,58.12141,41.35186,58.12141,42.34854,58.12141,43.01298,57.9553,43.51132,57.62307,44.17577,57.29085,44.50799,56.6264,44.50799,55.79584,44.50799,54.96528,44.17577,54.30084,43.67743,53.96861,43.1791,53.63639,42.34854,53.47028,41.35186,53.47028,37.19907,53.47028,37.19907,58.12141],segments:[1,4,4,4,4,4,4,4,4,2,2,2,5,1,2,4,4,4,4,2,2,5,1,2,4,4,4,4,2,2,5]},{type:"shape",background:"#000000",borderWidth:.5,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[56.80027,45.66302,56.80027,55.29751,56.80027,56.95863,56.46805,58.12141,55.8036,58.95197,54.97304,59.78253,53.81026,60.28086,52.14914,60.28086,50.65413,60.28086,49.65746,59.94864,48.99301,59.11808,48.16245,58.28752,47.83023,57.29085,47.83023,55.79584,47.83023,55.29751,49.98968,55.29751,49.98968,55.79584,49.98968,57.45696,50.65413,58.28752,52.14914,58.28752,52.9797,58.28752,53.64414,57.9553,53.97637,57.62307,54.30859,57.12474,54.4747,56.46029,54.4747,55.29751,54.4747,45.66302,56.80027,45.66302],segments:[1,2,4,4,4,4,2,2,2,4,4,4,2,2,5]}]}),ht.Default.setImage("editor.mtl",{width:64,height:64,fitSize:!0,attachStyle:"close",comps:[{type:"shape",background:"rgb(0,0,0)",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#000000",borderWidth:.5,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[21.55794,45.99697,26.66087,57.7337,26.66087,57.7337,31.7638,45.99697,34.31526,45.99697,34.31526,60.62536,32.10399,60.62536,32.10399,50.24941,32.10399,50.24941,27.68146,60.62536,25.81038,60.62536,21.38785,50.24941,21.38785,50.24941,21.38785,60.62536,19.00648,60.62536,19.00648,45.99697,21.55794,45.99697],segments:[1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,5]},{type:"shape",background:"#000000",borderWidth:.5,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[48.09317,45.99697,48.09317,47.86804,43.16034,47.86804,43.16034,60.45527,40.94907,60.45527,40.94907,47.86804,36.01624,47.86804,36.01624,45.99697,48.09317,45.99697],segments:[1,2,2,2,2,2,2,2,2,5]},{type:"shape",background:"#000000",borderWidth:.5,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[52.00541,45.99697,52.00541,58.58419,60,58.58419,60,60.45527,49.79414,60.45527,49.79414,45.82687,52.00541,45.82687],segments:[1,2,2,2,2,2,2,5]}]}),ht.Default.setImage("editor.ttf",{width:64,height:64,fitSize:!0,comps:[{type:"shape",background:"#000000",points:[53.17006,60.62742,50.68081,60.62742,50.41177,60.62742,50.19585,60.41688,50.19585,60.15453,50.19585,43.31796,50.19585,43.05561,50.41177,42.84507,50.68081,42.84507,60.09288,42.84507,60.36192,42.84507,60.57784,43.05561,60.57784,43.31796,60.57784,45.40904,60.57784,45.67138,60.36192,45.88193,60.09288,45.88193,53.65537,45.88193,53.65537,50.62587,59.22886,50.62587,59.4979,50.62587,59.71382,50.83642,59.71382,51.09876,59.71382,53.18984,59.71382,53.45219,59.4979,53.66273,59.22886,53.66273,53.65537,53.66273,53.65537,60.1542,53.65537,60.41688,53.43911,60.62742,53.17006,60.62742,53.17006,60.62742],segments:[1,2,4,2,4,2,4,2,4,2,2,2,4,2,4,2,2,4,2]},{type:"shape",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#000000",points:[41.52931,60.62742,39.04006,60.62742,38.77102,60.62742,38.5551,60.41688,38.5551,60.15453,38.5551,42.84507,46.88507,42.84507,47.15411,42.84507,47.37003,43.05561,47.37003,43.31796,47.37003,45.40904,47.37003,45.67138,47.15411,45.88193,46.88507,45.88193,42.01462,45.88193,42.01462,60.1542,42.01462,60.41688,41.79836,60.62742,41.52931,60.62742,41.52931,60.62742],segments:[1,2,4,2,2,4,2,4,2,2,4,2]},{type:"shape",background:"#000000",rotation:3.14159,points:[33.91988,42.84507,39.07014,42.84507,39.33918,42.84507,39.5551,43.05561,39.5551,43.31796,39.5551,45.40904,39.5551,45.67138,39.33918,45.88193,39.07014,45.88193,33.91988,45.88193],segments:[1,2,4,2,4,2]},{type:"shape",background:"#000000",points:[25.11617,60.62742,22.62692,60.62742,22.35788,60.62742,22.14196,60.41688,22.14196,60.15453,22.14196,42.84507,30.47192,42.84507,30.74096,42.84507,30.95688,43.05561,30.95688,43.31796,30.95688,45.40904,30.95688,45.67138,30.74096,45.88193,30.47192,45.88193,25.60148,45.88193,25.60148,60.1542,25.60148,60.41688,25.38522,60.62742,25.11617,60.62742,25.11617,60.62742],segments:[1,2,4,2,2,4,2,4,2,2,4,2]},{type:"shape",background:"#000000",rotation:3.14159,points:[17.50673,42.84507,22.657,42.84507,22.92604,42.84507,23.14196,43.05561,23.14196,43.31796,23.14196,45.40904,23.14196,45.67138,22.92604,45.88193,22.657,45.88193,17.50673,45.88193],segments:[1,2,4,2,4,2]}]}),ht.Default.setImage("editor.otf",{width:64,height:64,fitSize:!0,comps:[{type:"shape",background:"#000000",points:[53.17006,60.62742,50.68081,60.62742,50.41177,60.62742,50.19585,60.41688,50.19585,60.15453,50.19585,43.31796,50.19585,43.05561,50.41177,42.84507,50.68081,42.84507,60.09288,42.84507,60.36192,42.84507,60.57784,43.05561,60.57784,43.31796,60.57784,45.40904,60.57784,45.67138,60.36192,45.88193,60.09288,45.88193,53.65537,45.88193,53.65537,50.62587,59.22886,50.62587,59.4979,50.62587,59.71382,50.83642,59.71382,51.09876,59.71382,53.18984,59.71382,53.45219,59.4979,53.66273,59.22886,53.66273,53.65537,53.66273,53.65537,60.1542,53.65537,60.41688,53.43911,60.62742,53.17006,60.62742,53.17006,60.62742],segments:[1,2,4,2,4,2,4,2,4,2,2,2,4,2,4,2,2,4,2]},{type:"shape",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#000000",points:[41.52931,60.62742,39.04006,60.62742,38.77102,60.62742,38.5551,60.41688,38.5551,60.15453,38.5551,42.84507,46.88507,42.84507,47.15411,42.84507,47.37003,43.05561,47.37003,43.31796,47.37003,45.40904,47.37003,45.67138,47.15411,45.88193,46.88507,45.88193,42.01462,45.88193,42.01462,60.1542,42.01462,60.41688,41.79836,60.62742,41.52931,60.62742,41.52931,60.62742],segments:[1,2,4,2,2,4,2,4,2,2,4,2]},{type:"shape",background:"#000000",rotation:3.14159,points:[33.91988,42.84507,39.07014,42.84507,39.33918,42.84507,39.5551,43.05561,39.5551,43.31796,39.5551,45.40904,39.5551,45.67138,39.33918,45.88193,39.07014,45.88193,33.91988,45.88193],segments:[1,2,4,2,4,2]},{type:"oval",borderWidth:3.3,borderColor:"rgb(0,0,0)",rect:[18.97543,44.76232,11.82189,13.94784]}]}),ht.Default.setImage("editor.js",{width:64,height:64,fitSize:!0,comps:[{type:"shape",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"text",text:{func:"attr@name",value:"JS"},align:"center",font:"bold 24px Arial Rounded MT Bold",rect:[17.50673,40.58187,46.49327,23.41813]}]}),ht.Default.setImage("editor.sound",{width:64,height:64,fitSize:!0,comps:[{type:"shape",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#231815",points:[29.93506,40.65719,29.93506,52.11129,29.99768,52.17391,38.01482,58.31199,38.01482,53.06642,38.01482,39.70982,38.01482,34.45641,29.93506,40.65719,29.93506,40.65719,29.93506,40.65719,29.93506,40.65719,44.44257,36.03797,44.44257,36.03797,43.87107,35.70912,43.69881,34.9732,44.02766,34.40163,44.37211,33.84573,45.10803,33.65787,45.66393,33.99448,47.80131,35.26287,49.59417,37.09491,50.81553,39.2714,52.01338,41.37743,52.71019,43.80448,52.71019,46.38028,52.71019,48.95608,52.01338,51.38313,50.81553,53.48924,49.59417,55.65789,47.80131,57.49777,45.66393,58.77392,45.10803,59.1262,44.37211,58.93834,44.02766,58.35901,43.69881,57.79528,43.87107,57.05152,44.44257,56.7305,46.24326,55.65789,47.71518,54.13119,48.7486,52.32266,49.73508,50.57675,50.30665,48.55685,50.30665,46.38812,50.30665,44.23514,49.72724,42.19948,48.7486,40.46141,47.71518,38.63721,46.23542,37.10275,44.44257,36.03797,44.44257,36.03797,44.44257,36.03797,28.49449,40.89991,28.49449,40.89991,23.62472,40.89991,23.62472,51.86073,28.49449,51.86073,28.49449,40.89991,28.49449,40.89991,28.49449,40.89991,28.80767,38.51197,28.80767,38.51197,38.42189,31.14469,38.64118,30.96459,38.91517,30.86286,39.21267,30.86286,39.88597,30.86286,40.41052,31.38741,40.41052,32.05287,40.41052,39.70982,40.41052,39.97605,41.53008,40.43014,42.47745,41.16606,43.21337,42.09776,44.14506,43.28777,44.7088,44.76753,44.7088,46.38812,44.7088,48.00879,44.1529,49.50414,43.21337,50.67856,42.50096,51.61017,41.53008,52.33834,40.41052,52.80027,40.41052,53.07426,40.41052,60.72336,40.41052,60.99743,40.32439,61.24015,40.1678,61.45936,39.76073,61.97607,39.01698,62.07788,38.50019,61.67073,28.82334,54.25651,22.46606,54.25651,22.43471,54.25651,21.77708,54.25651,21.23686,53.72412,21.23686,53.06642,21.23686,39.73333,21.23686,39.70982,21.23686,39.04435,21.76924,38.51197,22.43471,38.51197,28.80767,38.51197,28.80767,38.51197,28.80767,38.51197,40.40269,41.5497,40.40269,41.5497,40.40269,51.21878,41.06823,50.85858,41.62405,50.37322,42.08598,49.79381,42.8219,48.86219,43.26039,47.6721,43.26039,46.38812,43.26039,45.11197,42.81414,43.92196,42.08598,42.98243,41.62405,42.39526,41.06039,41.90982,40.40269,41.5497,40.40269,41.5497,40.40269,41.5497],segments:[1,2,2,2,2,2,2,2,2,2,2,1,2,4,4,4,4,4,4,4,4,4,4,4,4,2,2,1,2,2,2,2,2,2,2,1,2,2,4,4,2,2,4,4,4,4,2,2,4,4,2,2,2,4,2,2,4,2,2,2,1,2,2,4,4,4,4,2,2]}]}),ht.Default.setImage("editor.video",{width:64,height:64,fitSize:!0,comps:[{type:"shape",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#231815",points:[34.79567,39.50193,35.8771,39.50193,36.86394,39.06777,37.56645,38.36518,38.28485,37.63888,38.7269,36.65212,38.7269,35.57851,38.7269,34.497,38.28485,33.51024,37.56645,32.80765,36.86394,32.08933,35.86927,31.6472,34.79567,31.6472,33.70626,31.6472,32.7274,32.08933,32.0169,32.80765,31.30641,33.51024,30.86435,34.497,30.86435,35.57851,30.86435,36.65212,31.30641,37.63888,32.0169,38.36518,32.7274,39.05987,33.71416,39.50193,34.79567,39.50193,34.79567,39.50193,34.79567,39.50193,33.03527,33.81021,33.03527,33.81021,33.47733,33.36816,34.10098,33.08399,34.79567,33.08399,35.48246,33.08399,36.0982,33.36816,36.54816,33.81021,36.99022,34.26807,37.27438,34.88382,37.27438,35.57061,37.27438,36.2574,36.99022,36.87315,36.54816,37.33101,36.0982,37.76524,35.48246,38.0494,34.79567,38.0494,34.10098,38.0494,33.47733,37.76524,33.03527,37.33101,32.59314,36.87315,32.31687,36.2574,32.31687,35.57061,32.31687,34.88382,32.59314,34.27598,33.03527,33.81021,33.03527,33.81021,33.03527,33.81021,38.719,42.35963,38.719,42.35963,39.05848,43.38583,39.77688,44.19107,40.6768,44.64103,42.60298,45.61989,44.97913,44.84625,45.95008,42.92007,46.40794,42.02015,46.53422,40.94655,46.17901,39.92027,45.86323,38.89408,45.14484,38.08884,44.23702,37.63888,43.33711,37.18892,42.2714,37.06264,41.24513,37.40995,40.21894,37.74943,39.39789,38.46775,38.95583,39.35984,38.49007,40.25185,38.3796,41.32546,38.719,42.35963,38.719,42.35963,38.719,42.35963,40.24257,40.02292,40.24257,40.02292,40.53471,39.44669,41.04781,38.99665,41.68726,38.77563,42.33454,38.5704,43.02923,38.64144,43.58184,38.93351,44.15808,39.22558,44.60803,39.72295,44.82124,40.38604,45.03436,41.03339,44.96332,41.70438,44.67907,42.28851,44.06341,43.50428,42.55557,43.98577,41.33198,43.3543,40.77937,43.07005,40.30578,42.56486,40.10048,41.9175,39.87945,41.25442,39.9663,40.58343,40.24257,40.02292,40.24257,40.02292,40.24257,40.02292,40.13209,46.26716,40.13209,46.26716,39.16114,46.10935,38.09543,46.33828,37.21915,46.96976,36.34286,47.61711,35.80606,48.54073,35.65607,49.5354,35.65607,49.5354,35.50608,50.53006,35.71929,51.57996,36.35076,52.46415,36.98231,53.33245,37.89803,53.86926,38.89269,54.02714,38.9243,54.02714,41.04781,54.38235,43.08447,52.8904,43.42395,50.76689,43.42395,50.75899,43.56604,49.76433,43.34501,48.71435,42.71346,47.84604,42.06618,46.96976,41.14256,46.42505,40.13209,46.26716,40.13209,46.26716,40.13209,46.26716,39.14533,52.60623,39.14533,52.60623,39.12953,52.59833,38.49797,52.49568,37.91384,52.1641,37.51912,51.61157,37.1244,51.05896,36.97441,50.38798,37.07706,49.75642,37.17181,49.13278,37.51912,48.54073,38.07172,48.13021,38.62433,47.73549,39.30322,47.60131,39.93469,47.69606,40.55044,47.79081,41.15046,48.13021,41.5451,48.69072,41.94772,49.24333,42.08981,49.91431,41.98724,50.53796,41.77403,51.87993,40.4794,52.81936,39.14533,52.60623,39.14533,52.60623,39.14533,52.60623,49.24984,57.84791,49.24984,57.84791,41.37939,57.84791,46.82629,55.31388,50.46553,49.76433,50.46553,43.63056,50.46553,39.30453,48.70514,35.38909,45.86323,32.54719,43.03714,29.72109,39.12162,27.9607,34.79567,27.9607,26.1594,27.9607,19.12572,34.99437,19.12572,43.63056,19.12572,47.94079,20.88612,51.87993,23.71222,54.69813,26.54622,57.54003,30.46963,59.30043,34.79567,59.30043,35.20611,59.30043,35.29296,59.30043,49.24984,59.30043,49.64456,59.30043,49.96816,58.96893,49.96816,58.57421,49.96816,58.17158,49.64456,57.84791,49.24984,57.84791,49.24984,57.84791,49.24984,57.84791,34.79567,56.88485,34.79567,56.88485,31.13271,56.88485,27.81723,55.39282,25.42528,53.00087,23.01761,50.5853,21.54138,47.28553,21.54138,43.62266,21.54138,36.34425,27.51725,30.36837,34.79567,30.36837,38.45064,30.36837,41.77403,31.8525,44.15808,34.25227,46.56583,36.64422,48.04206,39.96769,48.04206,43.62266,48.04206,47.28553,46.55793,50.6011,44.16598,53.00087,41.68726,55.48757,38.30856,56.88485,34.79567,56.88485,34.79567,56.88485,34.79567,56.88485,28.91446,44.64103,28.91446,44.64103,29.80655,44.18317,30.54067,43.38583,30.86435,42.35173,31.19593,41.32546,31.08538,40.25976,30.63542,39.35984,29.67237,37.44156,27.25672,36.66002,25.35424,37.63888,23.42015,38.62564,22.64651,41.00178,23.62545,42.92007,24.07541,43.81998,24.88057,44.53838,25.90684,44.86206,26.94884,45.20146,28.02245,45.09889,28.91446,44.64103,28.91446,44.64103,28.91446,44.64103,26.3647,43.51211,26.3647,43.51211,25.71735,43.29108,25.20425,42.82532,24.91218,42.28069,24.29643,41.0492,24.79373,39.54136,26.00942,38.92561,27.22519,38.30986,28.73294,38.79143,29.34869,40.02292,29.63286,40.59134,29.7118,41.25442,29.50658,41.90178,29.28555,42.54905,28.81979,43.06215,28.27509,43.34639,27.69877,43.63056,27.01198,43.71741,26.3647,43.51211,26.3647,43.51211,26.3647,43.51211,29.44344,46.26716,29.44344,46.26716,27.31195,46.59874,25.85153,48.61178,26.17521,50.72738,26.17521,50.75899,26.33309,51.75365,26.8778,52.69308,27.73828,53.32455,28.59876,53.9561,29.66447,54.17713,30.62752,54.02714,30.66703,54.01924,32.80634,53.67194,34.25886,51.66681,33.92728,49.52749,33.60361,47.39609,31.58275,45.94356,29.44344,46.26716,29.44344,46.26716,29.44344,46.26716,32.50637,49.75642,32.50637,49.75642,32.7274,51.1063,31.80378,52.39303,30.44593,52.60623,30.4223,52.61413,29.79865,52.7009,29.13557,52.55091,28.59086,52.14837,28.04616,51.75365,27.69877,51.15371,27.5962,50.53006,27.5962,50.50635,27.3909,49.17229,28.33032,47.90128,29.66447,47.69606,31.00644,47.48293,32.29317,48.40655,32.50637,49.75642,32.50637,49.75642,32.50637,49.75642,32.50637,49.75642,37.44808,43.63056,37.44808,43.63056,37.44808,42.89644,37.1481,42.22537,36.67444,41.75171,36.18497,41.27022,35.52189,40.96235,34.79567,40.96235,34.06147,40.96235,33.39048,41.27022,32.90891,41.75171,32.43525,42.23328,32.14318,42.89644,32.14318,43.63056,32.14318,44.36469,32.43525,45.02785,32.90891,45.50933,33.39838,45.983,34.06147,46.28297,34.79567,46.28297,36.25609,46.28297,37.44808,45.08308,37.44808,43.63056,37.44808,43.63056,37.44808,43.63056,34.79567,44.83835,34.79567,44.83835,34.45619,44.83835,34.14831,44.71207,33.93519,44.49104,33.71416,44.28574,33.5878,43.96997,33.5878,43.63846,33.5878,43.31479,33.71416,42.99901,33.93519,42.77798,34.14831,42.56486,34.45619,42.42277,34.79567,42.42277,35.11927,42.42277,35.42714,42.55695,35.64817,42.77798,35.86927,42.99901,36.01136,43.31479,36.01136,43.63846,36.01136,44.30155,35.46665,44.83835,34.79567,44.83835,34.79567,44.83835,34.79567,44.83835],segments:[1,4,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,4,2,2,1,2,4,4,2,4,4,2,4,2,4,4,2,2,1,2,2,4,4,4,4,4,4,4,2,2,1,2,2,4,4,4,4,4,4,2,2,2,4,4,2,2,1,2,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,2,2,1,2,4,2,4,4,2,4,4,2,2,1,2,4,2,4,4,2,4,4,2,2,2,1,2,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,4,2,2]}]}),ht.Default.setImage("editor.flipx",{width:16,height:16,comps:[{type:"shape",points:[8,1,8,14],segments:[1,2],borderWidth:1,borderColor:Jp.config.color_dark},{type:"shape",points:[6,3,6,13,2,13],background:Jp.config.color_dark},{type:"shape",points:[10,3,10,13,14,13],background:Jp.config.color_select}]}),ht.Default.setImage("editor.flipy",{width:16,height:16,comps:[{type:"shape",points:[2,8,15,8],segments:[1,2],borderWidth:1,borderColor:Jp.config.color_dark},{type:"shape",points:[3,6,13,6,3,2],background:Jp.config.color_dark},{type:"shape",points:[3,10,13,10,3,14],background:Jp.config.color_select}]}),ht.Default.setImage("editor.resetsize",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"white",points:[8,1,8,6,6,3,8,1,10,3,8,10,8,15,6,13,8,15,10,13,1,8,6,8,3,6,1,8,3,10,10,8,15,8,13,6,15,8,13,10],segments:[1,2,1,2,2,1,2,1,2,2,1,2,1,2,2,1,2,1,2,2]}]}),ht.Default.setImage("editor.func",{width:16,height:16,comps:[{type:"border",rect:[0,0,16,16],width:1,color:"#E4E4E4"},{type:"text",rect:[0,0,16,16],text:"F",align:"center",color:"black"}]}),ht.Default.setImage("editor.comp",{fitSize:!0,comps:[{type:{func:function(c){return c.compType},isSafeFunc:!0}}]}),ht.Default.setImage("editor.oops",{width:128,height:128,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(61,61,61)",rect:[21.53429,22.96531,88.8981,74.69064]},{type:"shape",background:"rgb(237,237,237)",borderColor:"#979797",points:[34.08079,87.52544,34.08079,87.52544,59.57908,97.75645,77.79215,90.58303,96.00522,83.40961,106.8249,68.87436,109.71641,51.69689,109.71641,51.69689,117.89865,74.48774,101.34821,87.52544,84.79777,100.56314,59.50721,102.27801,46.42474,94.29524],segments:[1,4,4,4,4]},{type:"arc",background:"rgb(196,185,185)",borderColor:"rgb(61,61,61)",arcTo:0,arcOval:!0,rotation:3.14159,rect:[32.3979,36.49467,28.49791,18.12387]},{type:"arc",background:"rgb(196,185,185)",borderColor:"rgb(61,61,61)",arcTo:0,arcOval:!0,rotation:3.14159,rect:[68.95508,36.49467,28.49791,18.12387]},{type:"shape",background:"rgb(149,224,245)",borderColor:"#979797",points:[39.9814,51.13901,39.9814,51.13901,32.00842,57.90113,30.56723,66.4088,29.12604,74.91647,34.21664,85.16969,34.21664,85.16969,39.0516,89.44677,39.0516,89.44677,36.05169,79.68945,37.3999,70.48443,38.74811,61.27941,44.44444,52.62669,44.44444,52.62669,39.9814,51.13901,39.9814,51.13901],segments:[1,4,4,2,4,4,2,2]},{type:"shape",background:"rgb(149,224,245)",borderColor:"#979797",scaleX:-1,points:[97.67259,49.56003,97.67259,49.56003,89.6996,57.90113,88.25841,66.4088,86.81722,74.91647,91.8398,85.99598,91.8398,85.99598,96.74279,89.44677,96.74279,89.44677,93.74288,79.68945,95.09109,70.48443,96.4393,61.27941,102.44264,50.50641,102.44264,50.50641,97.67259,49.56003],segments:[1,4,4,2,4,4,2]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[59.61377,32.055,59.61377,32.055,61.61221,36.91182,59.19747,38.71578,56.78274,40.51974,34.08079,42.18493,34.08079,42.18493],segments:[1,4,4]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",scaleX:-1,points:[94.48806,32.055,94.48806,32.055,96.4865,36.91182,94.07177,38.71578,91.65703,40.51974,68.95508,42.18493,68.95508,42.18493],segments:[1,4,4]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[67.02409,33.58143,67.02409,33.58143,64.9426,37.74441,67.02409,39.68714],segments:[1,4]},{type:"arc",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(61,61,61)",arcTo:0,arcOval:!0,rotation:3.14159,rect:[68.95508,40.07324,28.49791,11.89121]},{type:"arc",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(61,61,61)",arcTo:0,arcOval:!0,rotation:3.14159,rect:[32.3979,40.07323,28.49791,11.89121]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[60.89581,46.6003,56.70566,57.66949,39.6779,55.58118,39.6779,55.58118],segments:[1,4]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",scaleX:-1,points:[90.173,46.6003,85.98284,57.66949,68.95508,55.58118,68.95508,55.58118],segments:[1,4]},{type:"shape",background:"rgb(61,61,61)",borderColor:"#979797",points:[40.88134,45.66533,40.88134,50.44931,49.68823,51.31913,49.03586,45.66533,40.99007,45.5566]},{type:"shape",background:"rgb(61,61,61)",borderColor:"#979797",points:[78.31735,45.66533,78.31735,50.44931,87.12423,51.31913,86.47187,45.66533,78.42607,45.5566]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[36.81151,80.08117,46.71402,84.60188,54.03326,76.42155,61.35251,85.46297,73.83828,76.20628,86.96987,83.95607,93.85858,76.85209,99.24038,80.08117]},{type:"shape",background:"rgb(237,237,237)",borderColor:"rgb(61,61,61)",borderCap:"round",points:[95.58345,31.98512,95.58345,31.98512,104.33563,25.53184,105.97087,18.7394,107.6061,11.94695,113.65647,33.63444,105.97087,42.39888],segments:[1,4,4]},{type:"shape",background:"rgb(237,237,237)",borderColor:"rgb(61,61,61)",borderCap:"round",rotation:.2618,points:[44.41276,23.77714,38.68944,23.77714,33.30496,20.23699,28.88983,14.5401,24.47469,8.84321,22.55729,35.68983,32.04166,40.72938],segments:[1,4,4]},{type:"oval",borderWidth:2,borderColor:"rgb(61,61,61)",rect:[21.53429,22.96531,88.8981,74.69064]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[93.19422,30.5138,93.19422,30.5138,96.32695,28.82985,99.04364,25.51534,100.63358,23.57553,102.08422,21.24706,102.68792,18.7394,104.32316,11.94695,112.13179,31.92062,104.44618,40.68506],segments:[1,4,4,4]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",rotation:.2618,points:[40.62881,26.14647,34.90549,26.14647,32.31798,22.75803,27.90285,17.06114,23.48771,11.36426,18.41848,35.24736,27.90285,40.28692],segments:[1,4,4]},{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",anchorX:.41176,anchorY:.88889,rect:[91.52207,49.98659,1.67215,3.35736]},{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",anchorX:.41176,anchorY:.88889,
rect:[39.44815,49.46033,2.86639,3.35736]}]}),ht.Default.setImage("editor.block",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",background:"rgb(255,227,199)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[15,14.5,1,14.5,1,1.50001,7,1.50001,8,3.50001,15,3.50001,15,14.5]},{type:"rect",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[5.5,7.22625,6,5]},{type:"circle",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[2.5,4.72625,6,5]}]}),ht.Default.setImage("editor.group",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",background:"rgb(255,227,199)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[15.5,15.5,.5,15.5,.5,.5,6.92857,.5,8.00001,2.80769,15.5,2.80769,15.5,15.5]},{type:"shape",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[2.82964,11.54111,13.17036,11.54111,13.17036,13.12467,13.17036,5.20688,2.82964,5.20688,2.82964,13.12467,13.17036,13.12467,7.26137,13.12467,5.78413,15.5,10.21588,15.5,8.84426,13.12467,13.17036,13.12467,13.17036,11.54111]}]}),ht.Default.setImage("editor.subgraph",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",background:"rgb(255,227,199)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[15.5,15.5,.5,15.5,.5,.5,6.92857,.5,8.00001,2.80769,15.5,2.80769,15.5,15.5]},{type:"shape",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",closePath:!0,points:[4.90316,8.05737,4.90316,8.05737,4.30121,6.50546,5.25104,5.82166,6.20086,5.13787,7.09165,5.82166,7.09165,5.82166,7.09165,5.82166,7.76857,4.36921,9.6391,4.91013,11.50964,5.45106,11.09684,8.05737,11.09684,8.05737,11.09684,8.05737,12.482,8.53031,12.482,9.79106,12.482,10.86629,11.67411,11.63079,11.09684,11.63079,4.90316,11.63079,4.31315,11.63079,3.518,10.84732,3.518,9.79106,3.518,8.56402,4.90316,8.05737,4.90316,8.05737],segments:[1,4,4,4,4,4,4,2,4,4]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderJoin:"miter",points:[13,13.5,8.02409,13.5,8,9,8.02409,13.5,3,13.5]}]}),ht.Default.setImage("editor.restore",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[7.5,1.71892,3,2]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:0,arcTo:4.7124,arcClose:!1,shadowColor:"#1ABC9C",rect:[2,2.78108,12,12]}]}),ht.Default.setImage("editor.add",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",rotation:3.14159,points:[9.47991,2.5,13.48953,7.4,9.47991,7.4,9.47991,2.5,2.48953,2.5,2.48953,13.5,13.48953,13.5,13.48953,7.4]}]}),ht.Default.setImage("editor.delete",{background:"rgb(89,89,89)",width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[5.5,5.57173,5.5,12.45709]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[8.05685,5.57173,8.05685,12.45709]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[10.5,5.57173,10.5,12.45709]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[1,3.18902,15,3.16996,5.32652,3.16021,6.32652,1.16021,9.32652,1.16021,10.32652,3.16021]},{type:"rect",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[3.33333,3.18902,9.33334,11.65078]}]}),ht.Default.setImage("editor.import",{background:"rgb(179,179,179)",width:16,height:16,comps:[{type:"triangle",borderColor:"rgb(255,255,255)",borderWidth:1,rotation:1.5708,rect:[7.5,1.71892,3,2]},{type:"arc",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",arcFrom:0,arcTo:4.7124,arcClose:!1,rect:[2,2.78108,12,12]}]}),ht.Default.setImage("editor.top",{background:"rgb(145,145,145)",width:16,height:16,comps:[{type:"rightTriangle",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rotation:2.35619,rect:[3.86035,6.44002,8.20153,8.2581]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",rotation:3.14159,points:[2.14176,4.58061,13.85824,4.51881]}]}),ht.Default.setImage("editor.up",{background:"rgb(145,145,145)",width:16,height:16,comps:[{type:"rightTriangle",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rotation:2.35619,rect:[3.89924,6.05159,8.20153,8.2581]}]}),ht.Default.setImage("editor.down",{background:"rgb(145,145,145)",width:16,height:16,comps:[{type:"rightTriangle",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rotation:5.49779,rect:[3.89924,.69031,8.20153,8.2581]}]}),ht.Default.setImage("editor.bottom",{background:"rgb(145,145,145)",width:16,height:16,comps:[{type:"rightTriangle",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rotation:5.49779,rect:[3.93812,.69031,8.20153,8.2581]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",rotation:3.14159,points:[2.14176,10.85024,13.85824,10.78844]}]}),ht.Default.setImage("editor.menu",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[.93729,4,14.93729,4]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1.06271,8,15.06271,8]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1.06271,12,15.06271,12]}]}),ht.Default.setImage("editor.undo",{background:"rgb(191,191,191)",width:16,height:16,comps:[{type:"shape",background:"rgb(255,255,255)",shadowColor:"#1ABC9C",points:[9.9945,5.006,6.0345,5.006,6.0345,3.527,6.0345,3.336,5.9255,3.162,5.7545,3.078,5.5825,2.994,5.3785,3.015,5.2275,3.132,2.4795,5.264,2.3575,5.359,2.2865,5.505,2.2865,5.659,2.2865,5.813,2.3575,5.959,2.4795,6.054,5.2275,8.186,5.3175,8.256,5.4255,8.292,5.5345,8.292,5.6095,8.292,5.6845,8.275,5.7545,8.241,5.9255,8.157,6.0345,7.983,6.0345,7.792,6.0345,6.006,9.9945,6.006,11.5445,6.006,12.7135,7.296,12.7135,9.006,12.7135,10.689,11.4815,12.006,9.9085,12.006,5.0345,12.006,4.7585,12.006,4.5345,12.23,4.5345,12.506,4.5345,12.782,4.7585,13.006,5.0345,13.006,9.9085,13.006,12.0425,13.006,13.7135,11.249,13.7135,9.006,13.7135,6.763,12.0795,5.006,9.9945,5.006,9.9945,5.006],segments:[1,2,2,4,4,2,4,4,2,4,4,4,2,2,4,4,2,4,4,2,4,4,2]}]}),ht.Default.setImage("editor.redo",{background:"rgb(191,191,191)",width:16,height:16,comps:[{type:"shape",background:"rgb(255,255,255)",shadowColor:"#1ABC9C",scaleX:-1,points:[9.9945,5.006,6.0345,5.006,6.0345,3.527,6.0345,3.336,5.9255,3.162,5.7545,3.078,5.5825,2.994,5.3785,3.015,5.2275,3.132,2.4795,5.264,2.3575,5.359,2.2865,5.505,2.2865,5.659,2.2865,5.813,2.3575,5.959,2.4795,6.054,5.2275,8.186,5.3175,8.256,5.4255,8.292,5.5345,8.292,5.6095,8.292,5.6845,8.275,5.7545,8.241,5.9255,8.157,6.0345,7.983,6.0345,7.792,6.0345,6.006,9.9945,6.006,11.5445,6.006,12.7135,7.296,12.7135,9.006,12.7135,10.689,11.4815,12.006,9.9085,12.006,5.0345,12.006,4.7585,12.006,4.5345,12.23,4.5345,12.506,4.5345,12.782,4.7585,13.006,5.0345,13.006,9.9085,13.006,12.0425,13.006,13.7135,11.249,13.7135,9.006,13.7135,6.763,12.0795,5.006,9.9945,5.006,9.9945,5.006],segments:[1,2,2,4,4,2,4,4,2,4,4,4,2,2,4,4,2,4,4,2,4,4,2]}]}),ht.Default.setImage("editor.edit",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(51,153,255)",shadowColor:"#1ABC9C",rotation:5.49779,closePath:!0,points:[6,-.83884,.5,13.16116,6.04966,10.58206,11.5,13.16116,6,-.83884]}]}),ht.Default.setImage("editor.rulers",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:1.5708,points:[1.50517,1.5,1.5,4.49799,2.47337,4.49798,1.5,4.49799,1.50003,14.5,11.23413,14.48019,11.23413,13.48171,11.23413,14.47896,14.5,14.47897,4.00002,14.47899,4.00001,12.00001,1.50521,12.00002]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[14,6,14,14,6,14]}]}),ht.Default.setImage("editor.grid",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.49468,1.49999,4.5,14.49999,4.49468,11.53541,1.5,11.51432,14.5,11.51432,11.52105,11.53541,11.52105,14.49999,11.52105,1.49999,11.5,4.50429,14.5,4.50429,1.5,4.50429]}]}),ht.Default.setImage("editor.save",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",points:[3.66183,14.5,14.5,14.5,14.5,4.83454,10.71984,1.5,3.66183,1.5,3.66183,6.18654,10.71984,6.18654,10.71984,1.5,1.5,1.5,1.5,14.5,3.66183,14.5,3.66183,9.03168,12.17213,9.03168,12.17213,14.5]}]}),ht.Default.setImage("editor.preview",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",points:[1.9869,6.489,2,2,14,8,1.9869,14,2,9.555]}]}),ht.Default.setImage("editor.reload",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[7.5,1.71892,3,2]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:0,arcTo:4.7124,arcClose:!1,shadowColor:"#1ABC9C",rect:[2,2.78108,12,12]}]}),ht.Default.setImage("editor.zoomout",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"white",points:[2,8,14,8]}]}),ht.Default.setImage("editor.zoomin",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"white",points:[2,8,14,8,8,2,8,14],segments:[1,2,1,2]}]}),ht.Default.setImage("editor.zoomtofit",{background:"rgb(179,179,179)",gridLightColor:"rgba(0,0,0,0.20)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[8.00001,11.91764,8.00001,15]},{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-1.5708,rect:[9.75,7.24608,2,1.5]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:-1.5708,points:[13.516,6.484,13.516,9.51599]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:-3.14159,points:[8.00001,.99999,8.00001,4.08236]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:1.5708,points:[2.516,6.4801,2.516,9.51209]},{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[4.25,7.24608,2,1.5]},{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:3.14159,rect:[7.00001,4.5,2,1.5]},{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:6.28319,rect:[7,10,2,1.5]}]}),ht.Default.setImage("editor.toggleleft",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[2.50002,1.00002,10.99995,13.99996]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[3.49001,5.50001,3.51001,10.49999]}]}),ht.Default.setImage("editor.toggleboth",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[2.5,1,11,14]}]}),ht.Default.setImage("editor.toggleright",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[2.50002,1.00002,10.99995,13.99996]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[12.49999,5.50001,12.51999,10.49999]}]}),ht.Default.setImage("editor.layout.helper",ht.Default.parse(JSON.stringify({modified:"Mon Oct 29 2018 09:55:40 GMT+0800 (\u4e2d\u56fd\u6807\u51c6\u65f6\u95f4)",dataBindings:[{attr:"selectColor",valueType:"Color",defaultValue:"#60ACFC"},{attr:"layout.h",valueType:"String"},{attr:"layout.v",valueType:"String"}],width:100,height:100,interactive:!0,disableSelectedBorder:!0,pixelPerfect:!1,comps:[{type:"rect",borderColor:"#979797",displayName:"\u5de6\u4fa7\u4ea4\u4e92",rect:[5.51795,27.5,20.9641,44.5],onDown:"__ht__function(event, data, view, point, width, height) {\nif (ht.Default.isShiftDown()) {\n    data.a('layout.h', 'leftright');\n}\nelse {\n    data.a('layout.h', 'left');\n}\n}"},{type:"rect",borderColor:"#979797",displayName:"\u53f3\u4fa7\u4ea4\u4e92",rect:[74.0359,27.5,20.9641,45],onDown:"__ht__function(event, data, view, point, width, height) {\nif (ht.Default.isShiftDown()) {\n    data.a('layout.h', 'leftright');\n}\nelse {\n    data.a('layout.h', 'right');\n}\n}"},{type:"rect",borderColor:"#979797",displayName:"\u4e0a\u4fa7\u4ea4\u4e92",rect:[27.5,6,45,20],onDown:"__ht__function(event, data, view, point, width, height) {\nif (ht.Default.isShiftDown()) {\n    data.a('layout.v', 'topbottom');\n}\nelse {\n    data.a('layout.v', 'top');\n}\n}"},{type:"rect",borderColor:"#979797",displayName:"\u4e0b\u4fa7\u4ea4\u4e92",rect:[27.5,74,45,20],onDown:"__ht__function(event, data, view, point, width, height) {\nif (ht.Default.isShiftDown()) {\n    data.a('layout.v', 'topbottom');\n}\nelse {\n    data.a('layout.v', 'bottom');\n}\n}"},{type:"rect",borderColor:"#979797",displayName:"\u6a2a\u5411\u4e2d\u5fc3\u4ea4\u4e92",rect:[28.22051,44,16,12],onDown:"__ht__function(event, data, view, point, width, height) {\ndata.a('layout.h', 'center');\n}"},{type:"rect",borderColor:"#979797",displayName:"\u6a2a\u5411\u4e2d\u5fc3\u4ea4\u4e92",rect:[55.77949,44,16,12],onDown:"__ht__function(event, data, view, point, width, height) {\ndata.a('layout.h', 'center');\n}"},{type:"rect",borderColor:"#979797",displayName:"\u7eb5\u5411\u4e2d\u5fc3\u4ea4\u4e92",rect:[44.22051,28,11.55897,16],onDown:"__ht__function(event, data, view, point, width, height) {\ndata.a('layout.v', 'center');\n}"},{type:"rect",borderColor:"#979797",displayName:"\u7eb5\u5411\u4e2d\u5fc3\u4ea4\u4e92",rect:[44.22051,56,11.55897,16],onDown:"__ht__function(event, data, view, point, width, height) {\ndata.a('layout.v', 'center');\n}"},{type:"rect",borderWidth:1,borderColor:"#d4d4d4",rect:[5,5,90,90]},{type:"rect",borderWidth:1,borderColor:"#d4d4d4",borderPattern:[6,6],rect:[27.5,27.5,45,45]},{type:"rect",background:{func:"__ht__function(data, view) {\nvar layoutH = data.a('layout.h');\nif (layoutH === 'left' || layoutH === 'leftright') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D4D4D4"},borderColor:"#979797",rect:[8,48,16,4]},{type:"rect",background:{func:"__ht__function(data, view) {\nvar layoutH = data.a('layout.h');\nif (layoutH === 'right' || layoutH === 'leftright') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D8D8D8"},borderColor:"#979797",rect:[76,48,16,4]},{type:"rect",background:{func:"__ht__function(data, view) {\nvar layoutH = data.a('layout.h');\nif (layoutH === 'center') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D8D8D8"},borderColor:"#979797",rect:[34,48,32,4],onDown:"__ht__function(event, data, view, point, width, height) {\ndata.a('layout.h', 'center');\n}"},{type:"rect",background:{func:"__ht__function(data, view) {\nvar layoutV = data.a('layout.v');\nif (layoutV === 'bottom' || layoutV === 'topbottom') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D8D8D8"},borderColor:"#979797",rect:[48,76,4,16]},{type:"rect",background:{func:"__ht__function(data, view) {\nvar layoutV = data.a('layout.v');\nif (layoutV === 'top' || layoutV === 'topbottom') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D8D8D8"},borderColor:"#979797",rect:[48,8,4,16]},{type:"rect",background:{func:"__ht__function(data, view) {\nvar layoutV = data.a('layout.v');\nif (layoutV === 'center') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D8D8D8"},borderColor:"#979797",rect:[48,34,4,32],onDown:"__ht__function(event, data, view, point, width, height) {\ndata.a('layout.v', 'center');\n}"},{type:"rect",background:{func:"__ht__function(data, view) {\nif (data.a('layout.h') === 'center' || data.a('layout.v')  === 'center') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D8D8D8"},borderColor:"#979797",rect:[48,48,4,4]}]}))),ht.Default.setImage("editor.attachPoint",{width:10,height:10,boundExtend:1,comps:[{type:"shape",borderWidth:1,background:{func:"attr@selectColor",value:"rgb(51,153,255)"},borderColor:{func:"attr@selectColor",value:"rgb(51,153,255)"},closePath:!0,points:[5,0,0,5,5,10,10,5]}]}),ht.Default.setImage("editor.display.rect",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[2.5,1.5,11,13]}]}),ht.Default.setImage("editor.display.oval",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[1,1,14,14]}]}),ht.Default.setImage("editor.display.roundrect",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"roundRect",borderWidth:1,borderColor:"rgb(138,138,138)",cornerRadius:2.5,shadowColor:"#1ABC9C",rect:[2.5,1,11,14]}]}),ht.Default.setImage("editor.display.triangle",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",rotation:4.71239,points:[1.00872,1,14.99345,8,.99345,15,1.00872,1]}]}),ht.Default.setImage("editor.display.polygon",{width:16,height:16,comps:[{type:"polygon",rect:[1,1,14,14],borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.display.star",{width:16,height:16,comps:[{type:"star",rect:[1,1,14,14],borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.display.arc",{width:16,height:16,comps:[{type:"arc",rect:[1,1,14,14],arcFrom:0,arcTo:4.1888,borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.display.shape",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-2.35619,rect:[6.45666,.50222,10,8]},{type:"oval",background:"rgb(138,138,138)",borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-2.35619,rect:[4.92983,8.48004,2.48323,2.47136]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:-2.35619,points:[.71918,15.84031,-.26373,13.78,4.61411,6.85806,4.66212,13.2497,4.61411,6.85806,9.56535,13.77996,8.58245,15.84028]}]}),ht.Default.setImage("editor.display.node",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1.5,9.38462,14.5,9.38462,14.5,11.23077,14.5,2,1.5,2,1.5,11.23077,14.5,11.23077,7.07143,11.23077,5,15,11,15,8.92857,11.23077]}]}),ht.Default.setImage("editor.display.group",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[13,12.5,13,10.54,3,10.54,13,10.54,13,5.5,3,5.5,3,12.5,13,12.5,7,12.5,5.85714,15.5,10.14287,15.5,9,12.5]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[15.5,15.5,.5,15.5,.5,.5,6.92857,.5,8,2.19286,15.5,2.19286,15.5,15.5]}]}),ht.Default.setImage("editor.display.edge",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[.69044,.97071,4,4.00837]},{type:"circle",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[11.27696,10.99163,4,4.00837]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",points:[4.35933,3.02819,7.84441,2.9749,7.84441,12.99581,11.64067,12.99581]}]}),ht.Default.setImage("editor.display.text",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1,15,8.06501,1,15,15,12.38059,9.8,4.10171,9.8]}]}),ht.Default.setImage("editor.display.subgraph",{gridThickColor:"rgb(191,191,191)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(207,207,207)",visible:!1,closePath:!0,points:[2.81788,9.09381,2.81788,9.09381,1.38027,6.92868,3.20223,5.43826,5.02418,3.94784,6.51488,5.43826,6.51488,5.43826,6.51488,5.43826,7.61273,3.06338,10.74281,3.94784,13.87289,4.8323,13.18212,9.09381,13.18212,9.09381,13.18212,9.09381,15.5,9.8671,15.5,11.92851,15.5,13.6866,14.14811,14.93662,13.18212,14.93662,2.81788,14.93662,1.83057,14.93662,.5,13.65558,.5,11.92851,.5,9.92221,2.81788,9.09381,2.81788,9.09381],segments:[1,4,4,4,4,4,4,2,4,4]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[4.99379,5.52777,6,4.47223]},{type:"circle",background:"rgb(138,138,138)",borderColor:"rgb(138,138,138)",visible:!1,shadowColor:"#1ABC9C",rect:[4,6.43826,2,2]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:3.15905,arcTo:5.5676,arcClose:!1,visible:!1,shadowColor:"#1ABC9C",rect:[2.5,3.11794,5,5]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:3.57792,arcTo:6.6497,arcClose:!1,visible:!1,shadowColor:"#1ABC9C",rect:[5.63862,1.53868,9.36138,7.15852]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:1.5708,arcTo:3.87463,arcClose:!1,visible:!1,shadowColor:"#1ABC9C",rect:[-1,6.56338,8.99379,5.93662]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:5.00909,arcTo:1.5708,arcClose:!1,visible:!1,shadowColor:"#1ABC9C",rect:[8.00621,6.56338,8.99379,5.93662]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",visible:!1,points:[3.4969,12.5,12.5031,12.5]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",points:[9.72,12.5,8,10,6.34,12.5]},{type:"circle",background:"rgb(138,138,138)",borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",displayName:"\u5706\u5f62",rect:[0,0,2,2]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderJoin:"miter",points:[15,15.5,8.02409,15.5,8.02409,14,8.02409,15.5,1,15.5]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",closePath:!0,points:[2.81167,6.59481,2.81167,6.59481,1.80439,4.03022,3.39379,2.90023,4.98319,1.77025,6.47379,2.90023,6.47379,2.90023,6.47379,2.90023,7.60652,.5,10.7366,1.3939,13.86668,2.28781,13.17591,6.59481,13.17591,6.59481,13.17591,6.59481,15.49379,7.37636,15.49379,9.45978,15.49379,11.23663,14.1419,12.5,13.17591,12.5,2.81167,12.5,1.82436,12.5,.49379,11.20528,.49379,9.45978,.49379,7.43206,2.81167,6.59481,2.81167,6.59481],segments:[1,4,4,4,4,4,4,2,4,4]}]}),ht.Default.setImage("editor.symbol.rect",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[2.5,1.5,11,13]}]}),ht.Default.setImage("editor.symbol.oval",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[1,1,14,14]}]}),ht.Default.setImage("editor.symbol.roundrect",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"roundRect",borderWidth:1,borderColor:"rgb(138,138,138)",cornerRadius:2.5,shadowColor:"#1ABC9C",rect:[2.5,1,11,14]}]}),ht.Default.setImage("editor.symbol.triangle",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",rotation:4.71239,points:[1.00872,1,14.99345,8,.99345,15,1.00872,1]}]}),ht.Default.setImage("editor.symbol.polygon",{width:16,height:16,comps:[{type:"polygon",rect:[1,1,14,14],borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.symbol.star",{width:16,height:16,comps:[{type:"star",rect:[1,1,14,14],borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.symbol.arc",{width:16,height:16,comps:[{type:"arc",rect:[1,1,14,14],arcFrom:0,arcTo:4.1888,borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.symbol.image",{background:"rgb(156,156,156)",width:16,height:16,comps:[{type:"rect",borderWidth:1,borderColor:"rgb(255,255,255)",rect:[.5,1.96,15,12]},{type:"circle",background:"rgb(255,255,255)",borderColor:"rgb(255,255,255)",rect:[3.32103,4.48721,1.5,1.5]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",points:[2.18757,9.112,6.11684,9.112,7.77072,10.39241,9.50807,13.68975,9.69338,14.04145,9.04982,12.34611,7.45717,10.69236,7.45717,10.69236,8.72728,5.98721,14.05092,5.98721],segments:[1,4,4,4]}]}),ht.Default.setImage("editor.symbol.shape",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-2.35619,rect:[6.45666,.50222,10,8]},{type:"oval",background:"rgb(138,138,138)",borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-2.35619,rect:[4.92983,8.48004,2.48323,2.47136]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:-2.35619,points:[.71918,15.84031,-.26373,13.78,4.61411,6.85806,4.66212,13.2497,4.61411,6.85806,9.56535,13.77996,8.58245,15.84028]}]}),ht.Default.setImage("editor.symbol.border",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",points:[.5,6.01503,.5,2,15.48868,2,15.5,14,.5,14,.5,10]}]}),ht.Default.setImage("editor.symbol.text",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1,15,8.06501,1,15,15,12.38059,9.8,4.10171,9.8]}]}),ht.Default.setImage("editor.symbol.piechart",{background:"rgb(97,97,97)",width:16,height:16,comps:[{type:"arc",borderWidth:1,borderColor:"rgb(255,255,255)",arcFrom:.5236,arcTo:4.71239,rect:[.53628,2.06928,13.08634,13.08634]},{type:"arc",borderWidth:1,borderColor:"rgb(255,255,255)",arcFrom:4.71239,arcTo:.5236,rect:[2.37737,1,13.08634,13.08634]}]}),ht.Default.setImage("editor.symbol.onedimensionalcolumnchart",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[3.42625,5.95042,3,9.04958]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[10.00543,1,3,14]}]}),ht.Default.setImage("editor.symbol.columnchart",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[1,9,3,6]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[4,5.95042,3,9.04958]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[9,1,3,14]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[12,10.93747,3,4.06253]}]}),ht.Default.setImage("editor.symbol.linechart",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",points:[1,14,5,7,11,8,15,2]}]}),ht.Default.setImage("editor.point.mirrored",{width:30,height:30,fitSize:!1,comps:[{type:"arc",background:"rgb(202,235,248)",borderWidth:2,borderColor:"rgb(17,158,216)",arcClose:!1,rect:[3.5,10.30081203536023,23,25.3726296254234]},{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(51,51,51)",rect:[12,7.300812035360231,6,6]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[17.842265898626422,9.310233818119592,9.826713258365732,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[24.713262902082427,8.310233818119592,3,4]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.4018068742542837,9.30081203536023,9.826713258365732,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.286737097917573,8.310233818119592,3,4]}]}),ht.Default.setImage("editor.point.straight",{width:30,height:30,fitSize:!1,comps:[{type:"shape",background:"rgb(200,234,247)",borderWidth:2,borderColor:"rgb(17,160,217)",points:[26.974999999999998,23.185840967335317,15.133692185007973,10.275109094255685,3.0250000000000004,23.185840967335317]},{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(51,51,51)",rect:[12,7.561327956066684,6,6]}]}),ht.Default.setImage("editor.point.disconnected",{width:30,height:30,fitSize:!1,comps:[{type:"shape",background:"rgb(200,234,247)",borderWidth:2,borderColor:"rgb(17,160,217)",points:[3.1940148593724587,22.95774078992803,3.1940148593724587,18.139874123261343,7.6015038461565965,10.497740789928038,14.542032480517832,10.497740789928038,26.80598514062754,22.95774078992803],segments:[1,4,2]},{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(51,51,51)",rect:[12.093814401372779,7.5391087731804305,6,6]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rotation:.7853981633974483,rect:[16.36973009802768,14.555043156001322,9.826713258365732,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rotation:.7853981633974483,rect:[22.831111406474626,16.51363217953681,3,4]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.2671011430070465,9.53910877318043,9.826713258365732,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.152031366670336,8.548530555939791,3,4]}]}),ht.Default.setImage("editor.point.asymmetric",{width:30,height:30,fitSize:!1,comps:[{type:"shape",background:"rgb(200,234,247)",borderWidth:2,borderColor:"rgb(17,160,217)",points:[3.5000000000000027,22.974997694265234,3.5000000000000027,17.50768540873153,5.131816608669447,11.637417102180905,12.400695544362113,11.637417102180905,22.516641067164265,11.637417102180905,26.5,22.974997694265234,26.5,22.974997694265234],segments:[1,4,4]},{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(51,51,51)",rect:[9.324670579660944,7.637417102180905,6,6]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[3.405482351035767,9.637417102180905,6.540642002660807,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.7221578598514142,8.637417102180905,3,4]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[15.278596259040164,9.637417102180905,11.965262549245955,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[24.731262324024406,8.637417102180905,3,4]}]}),ht.Default.setImage("editor.layout.circular",{width:16,height:16,comps:[{type:"shape",background:"white",points:[7,2,7,4,9,4,9,2,2,7,2,9,4,9,4,7,12,7,12,9,14,9,14,7,4,12,4,14,6,14,6,12,10,12,10,14,12,14,12,12],
segments:[1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2]},{type:"shape",borderColor:"white",borderWidth:1,points:[8,3,3,8,5,13,11,13,13,8],segments:[1,2,2,2,2,5]}]}),ht.Default.setImage("editor.layout.symmetric",{width:16,height:16,comps:[{type:"shape",background:"white",points:[7,2,7,4,9,4,9,2,2,7,2,9,4,9,4,7,12,7,12,9,14,9,14,7,4,12,4,14,6,14,6,12,10,12,10,14,12,14,12,12],segments:[1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2]},{type:"shape",borderWidth:1,borderColor:"white",points:[8,8,8,3,8,8,3,8,8,8,5,13,8,8,11,13,8,8,13,8],segments:[1,2,1,2,1,2,1,2,1,2]}]}),ht.Default.setImage("editor.layout.hierarchical",{width:16,height:16,comps:[{type:"shape",background:"white",points:[4,3,4,5,6,5,6,3,10,3,10,5,12,5,12,3,1,11,1,13,3,13,3,11,7,11,7,13,9,13,9,11,13,11,13,13,15,13,15,11],segments:[1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2]},{type:"shape",borderColor:"white",borderWidth:1,points:[5,4,2,12,5,4,8,12,5,4,14,12,11,4,2,12,11,4,8,12,11,4,14,12],segments:[1,2,1,2,1,2,1,2,1,2,1,2]}]}),ht.Default.setImage("editor.layout.towardnorth",{width:16,height:16,comps:[{type:"shape",background:"white",points:[7,3,7,5,9,5,9,3,1,11,1,13,3,13,3,11,7,11,7,13,9,13,9,11,13,11,13,13,15,13,15,11],segments:[1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2]},{type:"shape",borderColor:"white",borderWidth:1,points:[8,4,2,12,8,4,8,12,8,4,14,12],segments:[1,2,1,2,1,2]}]}),ht.Default.setImage("editor.layout.towardsouth",{width:16,height:16,comps:[{type:"image",name:"editor.layout.towardnorth",rotation:Math.PI,rect:[0,0,16,16]}]}),ht.Default.setImage("editor.layout.towardeast",{width:16,height:16,comps:[{type:"image",name:"editor.layout.towardnorth",rotation:.5*-Math.PI,rect:[0,0,16,16]}]}),ht.Default.setImage("editor.layout.towardwest",{width:16,height:16,comps:[{type:"image",name:"editor.layout.towardnorth",rotation:.5*Math.PI,rect:[0,0,16,16]}]}),ht.Default.setImage("editor.align.distributehorizontal",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,2,2,14,14,2,14,14],segments:[1,2,1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return Jp.config.color_dark}}},{type:"shape",points:[8,5,8,11],borderWidth:3,borderCap:"round",borderColor:{func:function(){return Jp.config.color_select}}}]}),ht.Default.setImage("editor.align.distributevertical",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,2,14,2,2,14,14,14],segments:[1,2,1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return Jp.config.color_dark}}},{type:"shape",points:[5,8,11,8],borderWidth:3,borderCap:"round",borderColor:{func:function(){return Jp.config.color_select}}}]}),ht.Default.setImage("editor.align.alignleft",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,2,2,14],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return Jp.config.color_dark}}},{type:"shape",points:[5,5,13,5,5,11,8,11],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return Jp.config.color_select}}}]}),ht.Default.setImage("editor.align.alignhorizontal",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[8,2,8,14],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return Jp.config.color_dark}}},{type:"shape",points:[3,5,13,5,6,11,10,11],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return Jp.config.color_select}}}]}),ht.Default.setImage("editor.align.alignright",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[14,2,14,14],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return Jp.config.color_dark}}},{type:"shape",points:[3,5,11,5,11,11,8,11],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return Jp.config.color_select}}}]}),ht.Default.setImage("editor.align.aligntop",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,2,14,2],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return Jp.config.color_dark}}},{type:"shape",points:[5,5,5,13,11,5,11,8],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return Jp.config.color_select}}}]}),ht.Default.setImage("editor.align.alignvertical",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,8,14,8],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return Jp.config.color_dark}}},{type:"shape",points:[5,3,5,13,11,6,11,10],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return Jp.config.color_select}}}]}),ht.Default.setImage("editor.align.alignbottom",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,14,14,14],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return Jp.config.color_dark}}},{type:"shape",points:[5,3,5,11,11,11,11,8],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return Jp.config.color_select}}}]});var dQ=function(){return!0};kc("editor.layout.circular"),kc("editor.layout.symmetric"),kc("editor.layout.hierarchical"),kc("editor.layout.towardnorth"),kc("editor.layout.towardsouth"),kc("editor.layout.towardeast"),kc("editor.layout.towardwest"),kc("editor.root"),kc("editor.bind",dQ),kc("editor.unbind"),kc("editor.dir"),kc("editor.dxf"),kc("editor.obj"),kc("editor.mtl"),kc("editor.ttf"),kc("editor.otf"),kc("editor.sound"),kc("editor.video"),kc("editor.resetsize"),kc("editor.restore"),kc("editor.js"),ht.Data.prototype.$50$=Ep,ht.Data.prototype.$51$=function(c){return this._refGraph?[]:[lp.call(this,c),jp]},ht.Node.prototype.$50$=Ip,ht.Node.prototype.$51$=function(c){return this._refGraph?[]:[mp.call(this,c),fp]},ht.Edge.prototype.$50$=Pp,ht.Edge.prototype.$51$=function(c){return this._refGraph?[]:[Gp.call(this,c),ep]},ht.Group.prototype.$51$=function(c){return this._refGraph?[]:[dp.call(this,c),Rp]},ht.Shape.prototype.$51$=function(c){return this._refGraph?[]:[tp.call(this,c),bp]},ht.Block.prototype.$51$=function(c){return this._refGraph?[]:[Yp.call(this,c),sp]},ht.RefGraph.prototype.$51$=function(c){return this._refGraph?[]:[hp.call(this,c),Fp]};var RQ=function(c){function p(Q,r,i){Tp(this,p);var n=Sp(this,c.call(this));return n.parse(Q,r,i),n}return Np(p,c),p.prototype.getClass=function(){return p},p.prototype.toLabel=function(){return this.getDisplayName()||i("editor.comptype."+this.s("shape").toLowerCase())},p.prototype.parse=function(c,p,Q){c&&(ac(this,"shape",c.type,"rect"),ac(this,"shape.background",c.background,null),ac(this,"shape.repeat.image",c.repeatImage),ac(this,"shape.border.width",c.borderWidth),ac(this,"shape.border.color",c.borderColor,null),ac(this,"shape.border.3d",c.border3d),ac(this,"shape.border.3d.color",c.border3dColor),ac(this,"shape.border.3d.accuracy",c.border3dAccuracy),ac(this,"shape.border.cap",c.borderCap),ac(this,"shape.border.join",c.borderJoin),ac(this,"shape.border.pattern",c.borderPattern),ac(this,"shape.gradient",c.gradient),ac(this,"shape.gradient.color",c.gradientColor),ac(this,"shape.dash",c.dash),ac(this,"shape.dash.pattern",c.dashPattern),ac(this,"shape.dash.offset",c.dashOffset),ac(this,"shape.dash.color",c.dashColor),ac(this,"shape.dash.width",c.dashWidth),ac(this,"shape.dash.3d",c.dash3d),ac(this,"shape.dash.3d.color",c.dash3dColor),ac(this,"shape.dash.3d.accuracy",c.dash3dAccuracy),ac(this,"shape.border.width.absolute",c.borderWidthAbsolute),ac(this,"shape.fill.clip.direction",c.fillClipDiretion),ac(this,"shape.fill.clip.percentage",c.fillClipPercentage),"rect"===this.compType?ac(this,"shape.depth",c.depth):"roundRect"===this.compType?ac(this,"shape.corner.radius",c.cornerRadius):"polygon"===this.compType?ac(this,"shape.polygon.side",c.polygonSide):"arc"===this.compType&&(ac(this,"shape.arc.from",c.arcFrom),ac(this,"shape.arc.to",c.arcTo),ac(this,"shape.arc.close",c.arcClose),ac(this,"shape.arc.oval",c.arcOval)),Dc(this,c,p,Q))},p.prototype.toJSON=function(){var c={};return sc(this,c,"shape","type",void 0),sc(this,c,"shape.background","background",null),sc(this,c,"shape.repeat.image","repeatImage"),sc(this,c,"shape.border.width","borderWidth"),sc(this,c,"shape.border.color","borderColor",null),sc(this,c,"shape.border.3d","border3d"),sc(this,c,"shape.border.3d.color","border3dColor"),sc(this,c,"shape.border.3d.accuracy","border3dAccuracy"),sc(this,c,"shape.border.cap","borderCap"),sc(this,c,"shape.border.join","borderJoin"),sc(this,c,"shape.border.pattern","borderPattern"),sc(this,c,"shape.gradient","gradient"),sc(this,c,"shape.gradient.color","gradientColor"),sc(this,c,"shape.dash","dash"),sc(this,c,"shape.dash.pattern","dashPattern"),sc(this,c,"shape.dash.offset","dashOffset"),sc(this,c,"shape.dash.color","dashColor"),sc(this,c,"shape.dash.width","dashWidth"),sc(this,c,"shape.dash.3d","dash3d"),sc(this,c,"shape.dash.3d.color","dash3dColor"),sc(this,c,"shape.dash.3d.accuracy","dash3dAccuracy"),sc(this,c,"shape.border.width.absolute","borderWidthAbsolute"),sc(this,c,"shape.fill.clip.direction","fillClipDirection"),sc(this,c,"shape.fill.clip.percentage","fillClipPercentage"),"rect"===this.compType?sc(this,c,"shape.depth","depth"):"roundRect"===this.compType?sc(this,c,"shape.corner.radius","cornerRadius"):"polygon"===this.compType?sc(this,c,"shape.polygon.side","polygonSide"):"arc"===this.compType&&(sc(this,c,"shape.arc.from","arcFrom"),sc(this,c,"shape.arc.to","arcTo"),sc(this,c,"shape.arc.close","arcClose"),sc(this,c,"shape.arc.oval","arcOval")),Uc(this,c),c},Ap(p,[{key:"compType",get:function(){return this.s("shape")}}]),p}(ht.Node),tQ=function(c){function p(Q,r,i){Tp(this,p);var n=Sp(this,c.call(this));return n.parse(Q,r,i),n}return Np(p,c),p.prototype.getClass=function(){return p},p.prototype.toLabel=function(){return this.getDisplayName()||i("editor.comptype.shape")},p.prototype.parse=function(c,p,Q){c&&(ac(this,"type",c.type,"shape"),ac(this,"shape.background",c.background,null),ac(this,"shape.repeat.image",c.repeatImage),ac(this,"shape.border.width",c.borderWidth),ac(this,"shape.border.color",c.borderColor,null),ac(this,"shape.border.3d",c.border3d),ac(this,"shape.border.3d.color",c.border3dColor),ac(this,"shape.border.3d.accuracy",c.border3dAccuracy),ac(this,"shape.border.cap",c.borderCap),ac(this,"shape.border.join",c.borderJoin),ac(this,"shape.border.pattern",c.borderPattern),ac(this,"shape.gradient",c.gradient),ac(this,"shape.gradient.color",c.gradientColor),ac(this,"shape.dash",c.dash),ac(this,"shape.dash.pattern",c.dashPattern),ac(this,"shape.dash.offset",c.dashOffset),ac(this,"shape.dash.color",c.dashColor),ac(this,"shape.dash.width",c.dashWidth),ac(this,"shape.dash.3d",c.dash3d),ac(this,"shape.dash.3d.color",c.dash3dColor),ac(this,"shape.dash.3d.accuracy",c.dash3dAccuracy),ac(this,"shape.fill.rule",c.fillRule),ac(this,"shape.fill.clip.direction",c.fillClipDiretion),ac(this,"shape.fill.clip.percentage",c.fillClipPercentage),ac(this,"shape.gradient.pack",c.gradientPack),ac(this,"shape.border.width.absolute",c.borderWidthAbsolute),Dc(this,c,p,Q),Hc(this,c),this.setPoints(uc(Mc(c.points))),this.setSegments(Mc(c.segments)))},p.prototype.toJSON=function(){var c={};if(sc(this,c,"type","type",void 0),sc(this,c,"shape.background","background",null),sc(this,c,"shape.repeat.image","repeatImage"),sc(this,c,"shape.border.width","borderWidth"),sc(this,c,"shape.border.color","borderColor",null),sc(this,c,"shape.border.3d","border3d"),sc(this,c,"shape.border.3d.color","border3dColor"),sc(this,c,"shape.border.3d.accuracy","border3dAccuracy"),sc(this,c,"shape.border.cap","borderCap"),sc(this,c,"shape.border.join","borderJoin"),sc(this,c,"shape.border.pattern","borderPattern"),sc(this,c,"shape.gradient","gradient"),sc(this,c,"shape.gradient.color","gradientColor"),sc(this,c,"shape.dash","dash"),sc(this,c,"shape.dash.pattern","dashPattern"),sc(this,c,"shape.dash.offset","dashOffset"),sc(this,c,"shape.dash.color","dashColor"),sc(this,c,"shape.dash.width","dashWidth"),sc(this,c,"shape.dash.3d","dash3d"),sc(this,c,"shape.dash.3d.color","dash3dColor"),sc(this,c,"shape.dash.3d.accuracy","dash3dAccuracy"),sc(this,c,"shape.fill.rule","fillRule"),sc(this,c,"shape.fill.clip.direction","fillClipDirection"),sc(this,c,"shape.fill.clip.percentage","fillClipPercentage"),sc(this,c,"shape.gradient.pack","gradientPack"),sc(this,c,"shape.border.width.absolute","borderWidthAbsolute"),Uc(this,c),Yc(this,c),Bc(c,"points",this.a("points"),xc(this.getPoints())),this.getSegments()){var p=this.getSegments().toArray();if(p.length){var Q=1===p[0];if(Q)for(var r=1;r<p.length;r++)if(2!==p[r]){Q=!1;break}Q||Bc(c,"segments",this.a("segments"),p)}}return c},Ap(p,[{key:"compType",get:function(){return this.s("type")}}]),p}(ht.Shape),bQ=function(c){function p(Q,r,i){Tp(this,p);var n=Sp(this,c.call(this));return n.parse(Q,r,i),n}return Np(p,c),p.prototype.getClass=function(){return p},p.prototype.toLabel=function(){if(this.getDisplayName())return this.getDisplayName();var c=this.s("image");return c&&c.length<100?c:i("editor.comptype.image")},p.prototype.onStyleChanged=function(p,Q,r){c.prototype.onStyleChanged.call(this,p,Q,r),"image"===p&&this.setImage(r)},p.prototype.parse=function(c,p,Q){c&&(ac(this,"type",c.type,"image"),ac(this,"body.color",c.color),ac(this,"image.stretch",c.stretch),ac(this,"image",c.name,"node_image"),Dc(this,c,p,Q))},p.prototype.toJSON=function(){var c={};return sc(this,c,"type","type",void 0),sc(this,c,"body.color","color"),sc(this,c,"image.stretch","stretch"),sc(this,c,"image","name"),Uc(this,c),c},Ap(p,[{key:"compType",get:function(){return this.s("type")}}]),p}(ht.Node),YQ=function(c){function p(Q,r,i){Tp(this,p);var n=Sp(this,c.call(this));return n.parse(Q,r,i),n}return Np(p,c),p.prototype.getClass=function(){return p},p.prototype.toLabel=function(){return this.getDisplayName()||this.s("text")||i("editor.comptype.text")},p.prototype.parse=function(c,p,Q){c&&(ac(this,"type",c.type,"text"),ac(this,"text",c.text),ac(this,"text.align",c.align),ac(this,"text.vAlign",c.vAlign),ac(this,"text.color",c.color),ac(this,"text.font",c.font),ac(this,"text.shadow",c.shadow),ac(this,"text.shadow.color",c.shadowColor),ac(this,"text.shadow.blur",c.shadowBlur),ac(this,"text.shadow.offset.x",c.shadowOffsetX),ac(this,"text.shadow.offset.y",c.shadowOffsetY),Dc(this,c,p,Q))},p.prototype.toJSON=function(){var c={};return sc(this,c,"type","type",void 0),sc(this,c,"text","text"),sc(this,c,"text.align","align"),sc(this,c,"text.vAlign","vAlign"),sc(this,c,"text.color","color"),sc(this,c,"text.font","font"),sc(this,c,"text.shadow","shadow"),sc(this,c,"text.shadow.color","shadowColor"),sc(this,c,"text.shadow.blur","shadowBlur"),sc(this,c,"text.shadow.offset.x","shadowOffsetX"),sc(this,c,"text.shadow.offset.y","shadowOffsetY"),Uc(this,c),c},Ap(p,[{key:"compType",get:function(){return this.s("type")}}]),p}(ht.Text),sQ=function(c){function p(Q,r,i){Tp(this,p);var n=Sp(this,c.call(this));return n.s({"shape.border.color":"red","shape.border.width":1,"shape.background":null}),n.parse(Q,r,i),n.setClosePath(!0),n}return Np(p,c),p.prototype.getClass=function(){return p},p.prototype.toLabel=function(){return this.getDisplayName()||i("editor.comptype.clip")},p.prototype.parse=function(c,p,Q){c&&(ac(this,"type",c.type,"clip"),Dc(this,c,p,Q),this.setPoints(uc(Mc(c.points))),this.setSegments(Mc(c.segments)))},p.prototype.toJSON=function(){var c={};if(sc(this,c,"type","type",void 0),Uc(this,c),Bc(c,"points",this.a("points"),xc(this.getPoints())),this.getSegments()){var p=this.getSegments().toArray();if(p.length){var Q=1===p[0];if(Q)for(var r=1;r<p.length;r++)if(2!==p[r]){Q=!1;break}Q||Bc(c,"segments",this.a("segments"),p)}}return c},Ap(p,[{key:"compType",get:function(){return this.s("type")}}]),p}(ht.Shape),hQ=function(c){function p(Q,r,i){return Tp(this,p),Sp(this,c.call(this))}return Np(p,c),p.prototype.getClass=function(){return p},p.prototype.toLabel=function(){return this.getDisplayName()||i("editor.comptype.restore")},p.prototype.parse=function(c,p,Q){c&&(ac(this,"type",c.type,"restore"),Dc(this,c,p,Q))},p.prototype.toJSON=function(){var c={};return sc(this,c,"type","type",void 0),Uc(this,c),c},Ap(p,[{key:"compType",get:function(){return this.s("type")}}]),p}(ht.Node),FQ=function(c){function p(){return Tp(this,p),Sp(this,c.call(this))}return Np(p,c),p}(ht.widget.BorderPane),BQ=function(c){function p(Q){return Tp(this,p),Sp(this,c.call(this,Q))}return Np(p,c),p}(ht.widget.ContextMenu),DQ=function(c){function p(Q){return Tp(this,p),Sp(this,c.call(this,Q))}return Np(p,c),p.prototype.invalidateAll=function(p,Q){if("imageLoading"!==Q)return"imageLoaded"===Q?(this.fpImageLoaded=!0,this.dm().each(function(c){c.fp("imageLoaded",!1,!0)}),void(this.fpImageLoaded=!1)):void c.prototype.invalidateAll.call(this,p,Q)},p.prototype.adjustZoom=function(c){return c>Jp.config.maxZoom?Jp.config.maxZoom:c<Jp.config.minZoom?Jp.config.minZoom:c},p.prototype.getUnionNodeRect=function(c){var p=this,Q=void 0;return c=c._as||c,c.forEach(function(c){c instanceof ht.Node&&(Q=V(Q,p.getNodeRect(c)))}),Q},p.prototype.$64$=function(c){this.validate();var p=this.getViewRect(),Q=this.getUnionNodeRect(c);if(!p||!Q||ht.Default.intersectsRect(p,Q))return null;var r=p.x+p.width/2-Q.x-Q.width/2,i=p.y+p.height/2-Q.y-Q.height/2;return this.moveDatas(c,r,i),{x:r,y:i}},p.prototype.getFullscreenDatas=function(){return null},p}(ht.graph.GraphView),UQ=function(c){function p(Q){return Tp(this,p),Sp(this,c.call(this,Q))}return Np(p,c),p}(ht.widget.ListView),aQ=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this,Q));return r.getView().style.background=Jp.config.color_pane_dark,r.setMaskBackground(null),r.setContentBorderColor(null),r.setContentBackground("white"),r.getMask().style.border=Jp.config.color_select+" solid 1px",r}return Np(p,c),p}(ht.graph.Overview),_Q=function(c){function p(Q,r,i,n){Tp(this,p);var y=Sp(this,c.call(this,Q,r,i,n));return y.setTogglable(!1),y}return Np(p,c),p}(ht.widget.SplitView),wQ=function(c){function p(Q){return Tp(this,p),Sp(this,c.call(this,Q))}return Np(p,c),p}(ht.widget.TablePane),$Q=function(c){function p(){return Tp(this,p),Sp(this,c.call(this))}return Np(p,c),p.prototype.add=function(p,Q,r){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=c.prototype.add.call(this,p,Q,r);return n.setVisible(i),n},p}(ht.widget.TabView),LQ=function(c){function p(Q){return Tp(this,p),Sp(this,c.call(this,Q))}return Np(p,c),p}(ht.widget.Toolbar),HQ=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this,Q));return r.setDoubleClickToToggle(!1),r}return Np(p,c),p.prototype.getToggleIcon=function(c){if(this._loader&&!this._loader.isLoaded(c))return this._collapseIcon;var p=c.getChildren(),Q=p.size();if(Q){for(var r=!1,i=0;i<Q;i++)if(this.isVisible(p.get(i))){r=!0;break}if(r)return this.isExpanded(c)?this._expandIcon:this._collapseIcon}},p.prototype.hasExpandedChild=function(c){if(!this.isExpanded(c))return!1;var p=c.getChildren(),Q=p.size();if(Q)for(var r=0;r<Q;r++)if(this.isVisible(p.get(r)))return!0;return!1},Ap(p,[{key:"expandIds",get:function(){return Object.keys(this._expandMap)},set:function(c){var p=this;c.forEach(function(c){var Q=p.dm().getDataById(c);Q&&p.expand(Q)})}},{key:"selectionIds",get:function(){var c=[];return this.sm().each(function(p){c.push(p.$34$||p._id)}),c},set:function(c){var p=this,Q=[];c.forEach(function(c){var r=p.dm().getDataById(c);r&&Q.push(r)}),this.sm().ss(Q)}}]),p}(ht.widget.TreeView);!function(c,p,Q){var r=c.ht,i=r.Default;i.getInternal().addMethod(i,{svgToShape:function(c,p){var Q=new r.SvgConverter(p);return{converter:Q,output:Q.toShape(c)}}});var n=r.Context2dProxy=function(c,p,Q){var r=this;r.ctx=c,r.writer=p,r._currentContext={a:1,b:0,c:0,d:1,tx:0,ty:0},r._emptyPath(),r._forceSplitEllipse=!0,r._splitToBezier=Q.splitToBezier,r._ellipseSegments=Q.segments,r._contextStack=[];for(var i in CanvasRenderingContext2D.prototype)if("webkitImageSmoothingEnabled"!==i){var n=c[i];"function"==typeof n&&(c[i]=function(p,Q){return function(){try{var i=Q.apply(c,arguments);return r.handleFunc(p,i,arguments),i}catch(c){}}}(i,n))}};n.prototype={},n.prototype.constructor=n,n.prototype.handleFunc=function(c,p,Q){var r=this;switch(c){case"save":r._ctxSave();break;case"restore":r._ctxRestore();break;case"translate":r._ctxTranslate.apply(r,Q);break;case"rotate":r._ctxRotate.apply(r,Q);break;case"scale":r._ctxScale.apply(r,Q);break;case"setTransform":r._ctxSetTransform.apply(r,Q);break;case"transform":r._ctxTransform.apply(r,Q);break;case"fillText":case"strokeText":r._ctxText(Q[0],Q[1],Q[2],"fillText"===c);break;case"rect":r._ctxRect.apply(r,Q);break;case"fill":r._ctxFill(Q[0]);break;case"fillRect":r._ctxRect.apply(r,Q),r._ctxDraw("fill");break;case"stroke":r._ctxDraw("stroke");break;case"moveTo":r._ctxMoveTo(Q[0],Q[1]);break;case"lineTo":r._ctxLineTo(Q[0],Q[1]);break;case"beginPath":r._ctxBeginPath();break;case"closePath":r._ctxClosePath();break;case"arc":r._ctxArc.apply(r,Q);break;case"ellipse":r._ctxEllipse.apply(r,Q);break;case"quadraticCurveTo":r._ctxBezier([{x:Q[0],y:Q[1]}],Q[2],Q[3]);break;case"bezierCurveTo":r._ctxBezier([{x:Q[0],y:Q[1]},{x:Q[2],y:Q[3]}],Q[4],Q[5]);break;case"createLinearGradient":r._ctxCreateGradient(p,!0,Q);break;case"createRadialGradient":r._ctxCreateGradient(p,!1,Q);break;case"createPattern":r._ctxCreatePattern(p,Q[0],Q[1]);break;case"drawImage":r._ctxDrawImage.apply(r,Q);break;case"clip":r._ctxClip()}},n.prototype.handleSetter=function(c,p){},n.prototype._ctxSave=function(){var c=this,p={},Q=c._currentContext;for(var r in Q)p[r]=Q[r],"clip"===r&&Q[r]&&delete Q[r];c._contextStack.push(p)},n.prototype._ctxRestore=function(){var c=this;c._currentContext.clip&&c.writer.addRestore(),c._currentContext=c._contextStack.pop(),c._transformUpdated()},n.prototype._ctxTranslate=function(c,p){if(c=c||0,p=p||0,0!==c||0!==p){var Q=this,r=Q._currentContext,i=r.a,n=r.b,y=r.c,X=r.d;r.tx=i*c+y*p+r.tx,r.ty=n*c+X*p+r.ty,Q._transformUpdated()}},n.prototype._ctxScale=function(c,p){if(c=c||1,p=p||1,1!==c||1!==p){var Q=this,r=Q._currentContext;r.a*=c,r.b*=c,r.c*=p,r.d*=p,Q._transformUpdated()}},n.prototype._ctxRotate=function(c){var p=Math.cos(c),Q=Math.sin(c),r=this,i=r._currentContext,n=i.a,y=i.b,X=i.c,W=i.d;i.a=n*p+X*Q,i.b=y*p+W*Q,i.c=-n*Q+X*p,i.d=-y*Q+W*p,r._transformUpdated()},n.prototype._ctxSetTransform=function(c,p,Q,r,i,n){var y=this,X=y._currentContext;X.a=c,X.b=p,X.c=Q,X.d=r,X.tx=i,X.ty=n,y._transformUpdated()},n.prototype._ctxTransform=function(c,p,Q,r,i,n){var y=this,X=y._currentContext,W=X.a,Z=X.b,o=X.c,l=X.d;X.a=W*c+o*p,X.b=Z*c+l*p,X.c=W*Q+o*r,X.d=Z*Q+l*r,X.tx=W*i+o*n+X.tx,X.ty=Z*i+l*n+X.ty,y._transformUpdated()},n.prototype._transformUpdated=function(){},n.prototype._calcCurrentRotation=function(){var c=this._currentContext;return 0===c.b&&0===c.c?0:Math.atan2(c.b,c.a)},n.prototype._calcCurrentScale=function(){var c=this._currentContext;return{x:Math.sqrt(c.a*c.a+c.c*c.c),y:Math.sqrt(c.b*c.b+c.d*c.d)}},n.prototype._transformPoint=function(c){var p=this._currentContext,Q=c.x,r=c.y;return{x:p.a*Q+p.c*r+p.tx,y:p.b*Q+p.d*r+p.ty}},n.prototype._transformPoints=function(c){for(var p=this,Q=new Array(c.length),r=0,i=c.length;r<i;r++)Q[r]=p._transformPoint(c[r]);return Q},n.prototype._transformSize=function(c){var p=this._currentContext;return c*Math.max(Math.sqrt(p.c*p.c+p.d*p.d),Math.sqrt(p.a*p.a+p.b*p.b))},n.prototype._equal=function(c,p){var Q=c-p;return Q>-1e-5&&Q<1e-5},n.prototype._ctxText=function(c,p,Q,r){var i,n,y=this,X=y.ctx,W=X.font,Z=r?X.fillStyle:X.strokeStyle,o=X.textAlign,l=X.textBaseline,j=1;if("string"==typeof W&&(n=W.match(/\d+/))){i=1*n[0];var E=y._transformSize(i);E<12&&(j=E/12,E=12),W=W.replace(/\d+/,E)}var m=y._calcCurrentRotation();"alphabetic"===l?(l="bottom",Q+=.25*X.measureText("e").width):"hanging"===l&&(l="top",Q+=.2*X.measureText("e").width),"string"==typeof Z&&"rgba(0,0,0,0)"===Z.replace(/ /g,"")||c.trim().length&&y.writer.addText(c,y._transformPoint({x:p,y:Q}),W,m,o,l,Z,j)},n.prototype._ctxDrawImage=function(c,p,r,i,n,y,X,W,Z){if(c.width&&c.height){i===Q&&n===Q?(y=p,X=r,p=0,r=0,i=W=c.width,n=Z=c.height):y===Q&&X===Q&&(y=p,X=r,W=i,Z=n,p=0,r=0,i=c.width,n=c.height);var o=this,l=o._currentContext,j=W/i,E=Z/n,m=y-j*p,f=X-E*r,I=l.a,G=l.b,e=l.c,P=l.d;l.tx,l.ty}},n.prototype._ctxClip=function(){var c=this;c._currentContext.clip=!0,c._ctxDraw("clip")},n.prototype._ctxCreateGradient=function(c,p,Q){c.isLinear=p,c.points=p?[Q[0],Q[1],Q[2],Q[3]]:[Q[0],Q[1],Q[2],Q[3],Q[4],Q[5]];var r=this._currentContext;c.trans=[r.a,r.b,r.c,r.d,r.tx,r.ty];var i=c.addColorStop;c.addColorStop=function(p,Q){i.apply(this,arguments),c.colorStops||(c.colorStops=[]),c.colorStops.push(p,Q)}},n.prototype._ctxCreatePattern=function(c,p,Q){},n.prototype._ctxRect=function(c,p,Q,r){var i=this,n=i._transformPoints([{x:c,y:p},{x:c+Q,y:p},{x:c+Q,y:p+r},{x:c,y:p+r}]);i._path.push({type:"rect",points:n})},n.prototype._ctxMoveTo=function(c,p){var Q=this,r=Q._transformPoint({x:c,y:p});Q._headPoint=r,Q._path.push({type:"moveTo",x:r.x,y:r.y})},n.prototype._ctxLineTo=function(c,p){var Q=this,r=Q._transformPoint({x:c,y:p});Q._path.push({type:"lineTo",x:r.x,y:r.y})},n.prototype._ctxArc=function(c,p,Q,r,i,n){r=r||0,i=i||2*Math.PI,Q&&this._ctxEllipse(c,p,Q,Q,0,r,i,n)},n.prototype._ctxEllipse=function(c,p,Q,r,i,n,y,X){var W,Z,o,l,j,E,m,f,I,G,e,P,d,R,t=this,b=t._calcCurrentScale(),Y=t._transformPoint({x:c,y:p});j=Math.sin(i),E=Math.cos(i);var s=function(c){return h(Math.cos(-c),Math.sin(-c))},h=function(i,n){var y=Q*i,X=r*n;return{x:c+(E*y-j*X),y:p+(j*y+E*X)}},F=[],B=y;if(X)for(;B>=n;)B-=2*Math.PI;else for(;B<=n;)B+=2*Math.PI;for(I=(B-n)/t._ellipseSegments,e=0;e<=t._ellipseSegments;e++)G=n+I*e,P=t._transformPoint(s(-G)),F.push(P);var D=n,U=B;if(F[0],l=F[F.length-1],W=t._calcaEllipseAngle(n,y,X),n=W.start,y=W.end,m=t._equal(b.x,b.y),f=t._equal(Q,r),!t._forceSplitEllipse&&m&&f&&t._equal(Math.abs(n-y),2*Math.PI))t._path.push({type:"circle",x:Y.x,y:Y.y,end:l,keyPoints:F,radius:Q*b.x});else if(!t._forceSplitEllipse&&m&&f)Z=t._calcCurrentRotation(),o=Math.cos(Z),d=t._currentContext.a*o<0,R=t._currentContext.d*o<0,W=t._transformStartEndAngle(n,y,d,R),n=W.start-Z,y=W.end-Z,t._path.push({type:"arc",x:Y.x,y:Y.y,end:l,radius:Q*b.x,startAngle:n,endAngle:y,keyPoints:F});else{if(t._forceSplitEllipse||!m){if(t._path.length||t._path.push({type:"moveTo",x:F[0].x,y:F[0].y}),t._splitToBezier){var a,_,w,$=U-D,L=Math.max(Math.ceil(Math.abs($)/Math.PI*2),1),H=$/L,O=Math.tan(.5*H),M=Math.sin(H)*(Math.sqrt(4+3*O*O)-1)/3,K=Math.cos(D),u=Math.sin(D);for(e=0;e<L;e++){w=D+(e+1)*H,a=Math.cos(w),_=Math.sin(w);var x=h(a,_);t._ctxBezier([h(K-u*M,u+K*M),h(a+_*M,_-a*M)],x.x,x.y),K=a,u=_,w}return}for(e=1;e<=t._ellipseSegments;e++)P=F[e],t._path.push({type:"lineTo",x:P.x,y:P.y});return}var q,z,V=t._transformPoint(s(0)),T=t._transformPoint(s(Math.PI/2)),A=function(c,p){var Q=c.x-p.x,r=c.y-p.y;return Math.sqrt(Q*Q+r*r)},N=A(V,Y),S=A(T,Y);S>N?(z=N,N=S,S=z,q=T):q=V,Z=t._calcCurrentRotation(),o=Math.cos(Z),d=t._currentContext.a*o<0,R=t._currentContext.d*o<0,W=t._transformStartEndAngle(n-Math.PI/2,y-Math.PI/2,d,R),n=W.start,y=W.end,t._path.push({type:"ellipse",x:Y.x,y:Y.y,end:l,major:{x:q.x-Y.x,y:q.y-Y.y},ratio:S/N,startAngle:n,endAngle:y,keyPoints:F})}},n.prototype._ctxBezier=function(c,p,Q){var r=this,i=r._transformPoint({x:p,y:Q});this._path.push({type:"bezier",x:i.x,y:i.y,ctrl:r._transformPoints(c)})},n.prototype._ctxBeginPath=function(){this._emptyPath()},n.prototype._ctxClosePath=function(){var c=this,p=c._headPoint;p&&(c._path.push({type:"lineTo",x:p.x,y:p.y,subType:"closePath"}),c._headPoint=null,c._lastPoint=null)},n.prototype._calcaEllipseAngle=function(c,p,Q){c=-c,p=-p;var r,i=c%(2*Math.PI),n=p%(2*Math.PI);for(i<0&&(i+=2*Math.PI),n<0&&(n+=2*Math.PI),Q||(r=i,i=n,n=r);n<=i;)n+=2*Math.PI;return{start:i,end:n}},n.prototype._transformStartEndAngle=function(c,p,Q,r){var i;return(r||Q)&&(Q&&r?(c=Math.PI+c,p=Math.PI+p):(i=Math.PI*(Q?1:2)-p,p=Math.PI*(Q?1:2)-c,c=i)),{start:c,end:p}},n.prototype._ctxFill=function(c){var p=this;return p._fillRule=c||"nonzero",p._ctxDraw("fill")},n.prototype._ctxDraw=function(c){var p=this,Q=p._path;if(Q.length){var r,i,n,y,X,W=[],Z=[];if("clip"===c)X={clip:!0};else{if("stroke"===c){X={stroke:!0,lineWidth:p._transformSize(p.ctx.lineWidth),color:p.ctx.strokeStyle};var o=p.ctx.lineCap;"butt"!==o&&(X.lineCap=o);var l=p.ctx.getLineDash();if(l&&l.length){X.dash=!0;for(var j=0,E=l.length;j<E;j++)l[j]=p._transformSize(l[j]);X.dashPattern=l,X.dashOffset=p._transformSize(p.ctx.lineDashOffset)}}else X={stroke:!1,color:p.ctx.fillStyle},"nonzero"!==p._fillRule&&(X.fillRule=p._fillRule);if(p.ctx.globalAlpha<1&&(X.opacity=p.ctx.globalAlpha),"string"!=typeof X.color)if(X.color instanceof CanvasGradient){var m=X.color,f=[m.isLinear?"L":"R"];f=f.concat(m.points);var I=p._currentContext;f=f.concat([I.a,I.b,I.c,I.d,I.tx,I.ty]),f=f.concat(m.colorStops),X.gradientPack=f}else if(X.color instanceof CanvasPattern&&X.color.gradient){var n=X.color,m=n.gradient,f=[m.isLinear?"L":"R"];f=f.concat(m.points);var G=n.trans,I=p._currentContext,e=I.a,P=I.b,d=I.c,R=I.d,t=I.tx,b=I.ty,Y=G[0],s=G[1],h=G[2],F=G[3],B=G[4],D=G[5];f=f.concat([e*Y+d*s,P*Y+R*s,e*h+d*F,P*h+R*F,e*B+d*D+t,P*B+R*D+b]),f=f.concat(m.colorStops),X.gradientPack=f}else X.trans=[p._currentContext.a,p._currentContext.b,p._currentContext.c,p._currentContext.d,p._currentContext.tx,p._currentContext.ty],X.color=X.color.image?X.color.image:X.color,X.isPattern=!0;if("string"==typeof X.color&&"rgba(0,0,0,0)"===X.color.replace(/ /g,""))return}for(i=0,r=Q.length;i<r;i++)switch(n=Q[i],n.type){case"moveTo":p._lastPoint={x:n.x,y:n.y},W.push(p._lastPoint),Z.push(1);break;case"lineTo":"closePath"===n.subType?Z.push(5):(W.push({x:n.x,y:n.y}),Z.push(2)),p._lastPoint={x:n.x,y:n.y};break;case"rect":y=n.points,W.push({x:y[0].x,y:y[0].y},{x:y[1].x,y:y[1].y},{x:y[2].x,y:y[2].y},{x:y[3].x,y:y[3].y},{x:y[0].x,y:y[0].y}),Z.push(2,2,2,2,2),p._lastPoint=n.points[0];break;case"circle":case"arc":case"ellipse":console.log("split to line",n.type);break;case"arcBegin":W.length&&Z.length&&p.writer.addShape(W,Z,X),W=[],Z=[];break;case"arcClose":p.writer.addShape(W,Z,X),W=[],Z=[];break;case"bezier":if(!p._lastPoint)break;1===n.ctrl.length?(W.push({x:n.ctrl[0].x,y:n.ctrl[0].y},{x:n.x,y:n.y}),Z.push(3)):(W.push({x:n.ctrl[0].x,y:n.ctrl[0].y},{x:n.ctrl[1].x,y:n.ctrl[1].y},{x:n.x,y:n.y}),Z.push(4)),p._lastPoint={x:n.x,y:n.y};break;default:W.push({x:n.x,y:n.y}),Z.push(2)}p.writer.addShape(W,Z,X)}},n.prototype._emptyPath=function(){var c=this;c._path=[],c._lastPoint=null,c._headPoint=null};var y=r.SvgConverter=function(c){var p=this;p.initConfig(c||{}),p.initCanvas()};y.prototype={},y.prototype.constructor=y,y.prototype.initConfig=function(c){var p,r=this;p=r.options={},p.size=c.size||512,p.segments=c.segments||16,p.splitToBezier=c.splitToBezier===Q||c.splitToBezier},y.prototype.initCanvas=function(){var c=this,p=document.createElement("canvas");p.width=p.height=c.options.size,p.style.width=p.style.height=c.options.size;var Q=p.getContext;p.getContext=function(p){return function(Q){var r=p.apply(this,arguments);return"2d"===Q&&c.wrapContext2d(r),r}}(Q),c._canvas=p,c._segments=[]},y.prototype.toShape=function(c){var p=this;p._canvas;return p._segments=[],canvg(p._canvas,c,{ignoreMouse:!0,ignoreAnimation:!0}),p.write()},y.prototype.wrapContext2d=function(c){var p=this;return new r.Context2dProxy(c,p,p.options)},y.prototype.write=function(){var c=this;return{width:c._canvas.width,height:c._canvas.height,comps:c._segments}},y.prototype.addComponent=function(c){this._segments.push(c)},y.prototype.addText=function(c,p,Q,r,i,n,y,X){i=i||"left","start"===i?i="left":"end"===i&&(i="right"),"alphabetic"===n?n="bottom":"hanging"===n&&(n="top");var W=this,Z={type:"text",color:y,text:c,rotation:r,rect:[p.x,p.y,.01,.01],align:i,vAlign:n,font:Q};X&&1!==X&&(Z.scaleX=X,Z.scaleY=X),W.addComponent(Z)},y.prototype.addShape=function(c,p,r){for(var i=this,n=[],y=0,X=c.length;y<X;y++){var W=c[y];n.push(W.x,W.y)}if(r.clip)return void i.addComponent({type:"clip",points:n,segments:p});var Z={
type:"shape",points:n,segments:p};if(r.opacity!=Q&&(Z.opacity=r.opacity),r.stroke)r.dash?(Z.dash=r.dash,Z.dashPattern=r.dashPattern,Z.dashOffset=r.dashOffset,Z.dashColor=r.color,Z.dashWidth=r.lineWidth,Z.borderColor=null,Z.borderWidth=0,Z.background=null):(Z.borderColor=r.color,Z.borderWidth=r.lineWidth,Z.background=null),r.lineCap&&(Z.borderCap=r.lineCap);else{if(Z.borderColor=null,Z.borderWidth=0,r.isPattern)Z.repeatImage=r.color,Z.trans=r.trans,Z.background=null;else if(r.gradientPack){var o=r.gradientPack,l="L"===o[0]?[o[5],o[6],o[7],o[8],o[9],o[10]]:[o[7],o[8],o[9],o[10],o[11],o[12]];if(Math.abs(l[4])>1e8||Math.abs(l[5])>1e8){var j=l[0],E=l[1],m=l[2],f=l[3],I=l[4],G=l[5],e=Math.floor((I*f-G*m)/(j*f-E*m)),P=Math.floor((I*E-G*j)/(m*E-j*f));I=-(j*e+m*P),G=-(E*e+f*P),"L"===o[0]?(o[9]+=I,o[10]+=G,o[1]+=e,o[2]+=P,o[3]+=e,o[4]+=P):(o[11]+=I,o[12]+=G,o[1]+=e,o[2]+=P,o[4]+=e,o[5]+=P)}Z.gradientPack=o,Z.background=null}else Z.background=r.color;r.gradient&&(Z.gradient=r.gradient,Z.gradientColor=r.gradientColor),r.fillRule&&(Z.fillRule=r.fillRule)}i.addComponent(Z)},y.prototype.addRestore=function(){this.addComponent({type:"restore"})},function(c){function p(c){this.ok=!1,"#"==c.charAt(0)&&(c=c.substr(1,6)),c=c.replace(/ /g,""),c=c.toLowerCase();var Q={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var r in Q)c==r&&(c=Q[r]);for(var i=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],n=0;n<i.length;n++){var y=i[n].re,X=i[n].process,W=y.exec(c);if(W){var Z=X(W);this.r=Z[0],this.g=Z[1],this.b=Z[2],this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),p=this.g.toString(16),Q=this.b.toString(16);return 1==c.length&&(c="0"+c),1==p.length&&(p="0"+p),1==Q.length&&(Q="0"+Q),"#"+c+p+Q},this.getHelpXML=function(){for(var c=new Array,r=0;r<i.length;r++)for(var n=i[r].example,y=0;y<n.length;y++)c[c.length]=n[y];for(var X in Q)c[c.length]=X;var W=document.createElement("ul");W.setAttribute("id","rgbcolor-examples");for(var r=0;r<c.length;r++)try{var Z=document.createElement("li"),o=new p(c[r]),l=document.createElement("div");l.style.cssText="margin: 3px; border: 1px solid black; background:"+o.toHex()+"; color:"+o.toHex(),l.appendChild(document.createTextNode("test"));var j=document.createTextNode(" "+c[r]+" -> "+o.toRGB()+" -> "+o.toHex());Z.appendChild(l),Z.appendChild(j),W.appendChild(Z)}catch(c){}return W}}c.RGBColor=p}(void 0!==c?c:this),function(c){function p(c){for(var p=c.data,Q=c.width*c.height*4,r=0;r<Q;r+=4){var i=p[r+3]/255;p[r]*=i,p[r+1]*=i,p[r+2]*=i}}function Q(c){for(var p=c.data,Q=c.width*c.height*4,r=0;r<Q;r+=4){var i=p[r+3];0!=i&&(i=255/i,p[r]*=i,p[r+1]*=i,p[r+2]*=i)}}function r(c,p,Q,r){var y=document.getElementById(c),X=y.naturalWidth,W=y.naturalHeight,Z=document.getElementById(p);Z.style.width=X+"px",Z.style.height=W+"px",Z.width=X,Z.height=W;var o=Z.getContext("2d");o.clearRect(0,0,X,W),o.drawImage(y,0,0),isNaN(Q)||Q<1||(r?i(p,0,0,X,W,Q):n(p,0,0,X,W,Q))}function i(c,r,i,n,Z,o){if(!(isNaN(o)||o<1)){o|=0;var l,j=document.getElementById(c),E=j.getContext("2d");try{try{l=E.getImageData(r,i,n,Z)}catch(c){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),l=E.getImageData(r,i,n,Z)}catch(c){throw alert("Cannot access local image"),new Error("unable to access local image data: "+c)}}}catch(c){throw alert("Cannot access image"),new Error("unable to access image data: "+c)}p(l);var m,f,I,G,e,P,d,R,t,b,Y,s,h,F,B,D,U,a,_,w,$,L,H,O,M=l.data,K=o+o+1,u=n-1,x=Z-1,q=o+1,z=q*(q+1)/2,V=new y,T=V;for(I=1;I<K;I++)if(T=T.next=new y,I==q)var A=T;T.next=V;var N=null,S=null;d=P=0;var v=X[o],g=W[o];for(f=0;f<Z;f++){for(D=U=a=_=R=t=b=Y=0,s=q*(w=M[P]),h=q*($=M[P+1]),F=q*(L=M[P+2]),B=q*(H=M[P+3]),R+=z*w,t+=z*$,b+=z*L,Y+=z*H,T=V,I=0;I<q;I++)T.r=w,T.g=$,T.b=L,T.a=H,T=T.next;for(I=1;I<q;I++)G=P+((u<I?u:I)<<2),R+=(T.r=w=M[G])*(O=q-I),t+=(T.g=$=M[G+1])*O,b+=(T.b=L=M[G+2])*O,Y+=(T.a=H=M[G+3])*O,D+=w,U+=$,a+=L,_+=H,T=T.next;for(N=V,S=A,m=0;m<n;m++)M[P]=R*v>>g,M[P+1]=t*v>>g,M[P+2]=b*v>>g,M[P+3]=Y*v>>g,R-=s,t-=h,b-=F,Y-=B,s-=N.r,h-=N.g,F-=N.b,B-=N.a,G=d+((G=m+o+1)<u?G:u)<<2,D+=N.r=M[G],U+=N.g=M[G+1],a+=N.b=M[G+2],_+=N.a=M[G+3],R+=D,t+=U,b+=a,Y+=_,N=N.next,s+=w=S.r,h+=$=S.g,F+=L=S.b,B+=H=S.a,D-=w,U-=$,a-=L,_-=H,S=S.next,P+=4;d+=n}for(m=0;m<n;m++){for(U=a=_=D=t=b=Y=R=0,P=m<<2,s=q*(w=M[P]),h=q*($=M[P+1]),F=q*(L=M[P+2]),B=q*(H=M[P+3]),R+=z*w,t+=z*$,b+=z*L,Y+=z*H,T=V,I=0;I<q;I++)T.r=w,T.g=$,T.b=L,T.a=H,T=T.next;for(e=n,I=1;I<=o;I++)P=e+m<<2,R+=(T.r=w=M[P])*(O=q-I),t+=(T.g=$=M[P+1])*O,b+=(T.b=L=M[P+2])*O,Y+=(T.a=H=M[P+3])*O,D+=w,U+=$,a+=L,_+=H,T=T.next,I<x&&(e+=n);for(P=m,N=V,S=A,f=0;f<Z;f++)G=P<<2,M[G]=R*v>>g,M[G+1]=t*v>>g,M[G+2]=b*v>>g,M[G+3]=Y*v>>g,R-=s,t-=h,b-=F,Y-=B,s-=N.r,h-=N.g,F-=N.b,B-=N.a,G=m+((G=f+q)<x?G:x)*n<<2,R+=D+=N.r=M[G],t+=U+=N.g=M[G+1],b+=a+=N.b=M[G+2],Y+=_+=N.a=M[G+3],N=N.next,s+=w=S.r,h+=$=S.g,F+=L=S.b,B+=H=S.a,D-=w,U-=$,a-=L,_-=H,S=S.next,P+=n}Q(l),E.putImageData(l,r,i)}}function n(c,p,Q,r,i,n){if(!(isNaN(n)||n<1)){n|=0;var Z,o=document.getElementById(c),l=o.getContext("2d");try{try{Z=l.getImageData(p,Q,r,i)}catch(c){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),Z=l.getImageData(p,Q,r,i)}catch(c){throw alert("Cannot access local image"),new Error("unable to access local image data: "+c)}}}catch(c){throw alert("Cannot access image"),new Error("unable to access image data: "+c)}var j,E,m,f,I,G,e,P,d,R,t,b,Y,s,h,F,B,D,U,a,_=Z.data,w=n+n+1,$=r-1,L=i-1,H=n+1,O=H*(H+1)/2,M=new y,K=M;for(m=1;m<w;m++)if(K=K.next=new y,m==H)var u=K;K.next=M;var x=null,q=null;e=G=0;var z=X[n],V=W[n];for(E=0;E<i;E++){for(s=h=F=P=d=R=0,t=H*(B=_[G]),b=H*(D=_[G+1]),Y=H*(U=_[G+2]),P+=O*B,d+=O*D,R+=O*U,K=M,m=0;m<H;m++)K.r=B,K.g=D,K.b=U,K=K.next;for(m=1;m<H;m++)f=G+(($<m?$:m)<<2),P+=(K.r=B=_[f])*(a=H-m),d+=(K.g=D=_[f+1])*a,R+=(K.b=U=_[f+2])*a,s+=B,h+=D,F+=U,K=K.next;for(x=M,q=u,j=0;j<r;j++)_[G]=P*z>>V,_[G+1]=d*z>>V,_[G+2]=R*z>>V,P-=t,d-=b,R-=Y,t-=x.r,b-=x.g,Y-=x.b,f=e+((f=j+n+1)<$?f:$)<<2,s+=x.r=_[f],h+=x.g=_[f+1],F+=x.b=_[f+2],P+=s,d+=h,R+=F,x=x.next,t+=B=q.r,b+=D=q.g,Y+=U=q.b,s-=B,h-=D,F-=U,q=q.next,G+=4;e+=r}for(j=0;j<r;j++){for(h=F=s=d=R=P=0,G=j<<2,t=H*(B=_[G]),b=H*(D=_[G+1]),Y=H*(U=_[G+2]),P+=O*B,d+=O*D,R+=O*U,K=M,m=0;m<H;m++)K.r=B,K.g=D,K.b=U,K=K.next;for(I=r,m=1;m<=n;m++)G=I+j<<2,P+=(K.r=B=_[G])*(a=H-m),d+=(K.g=D=_[G+1])*a,R+=(K.b=U=_[G+2])*a,s+=B,h+=D,F+=U,K=K.next,m<L&&(I+=r);for(G=j,x=M,q=u,E=0;E<i;E++)f=G<<2,_[f]=P*z>>V,_[f+1]=d*z>>V,_[f+2]=R*z>>V,P-=t,d-=b,R-=Y,t-=x.r,b-=x.g,Y-=x.b,f=j+((f=E+H)<L?f:L)*r<<2,P+=s+=x.r=_[f],d+=h+=x.g=_[f+1],R+=F+=x.b=_[f+2],x=x.next,t+=B=q.r,b+=D=q.g,Y+=U=q.b,s-=B,h-=D,F-=U,q=q.next,G+=r}l.putImageData(Z,p,Q)}}function y(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var X=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],W=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24],Z={image:r,canvasRGBA:i,canvasRGB:n};c.stackBlur=Z}(void 0!==c?c:this),function(p,i){p.canvg=function(p,i){function n(c){var p=[0,0,0],Q=function(Q,r){var i=c.match(Q);null!=i&&(p[r]+=i.length,c=c.replace(Q," "))};return c=c.replace(/:not\(([^\)]*)\)/g,"     $1 "),c=c.replace(/{[\s\S]*/gm," "),Q(Z,1),Q(o,0),Q(l,1),Q(j,2),Q(E,1),Q(m,1),c=c.replace(/[\*\s\+>~]/g," "),c=c.replace(/[#\.]/g," "),Q(f,2),p.join("")}function y(y){var W={opts:y};W.FRAMERATE=30,W.MAX_VIRTUAL_PIXELS=3e4,W.log=function(c){},1==W.opts.log&&"undefined"!=typeof console&&(W.log=function(c){console.log(c)}),W.init=function(c){var p=0;W.UniqueId=function(){return"canvg"+ ++p},W.Definitions={},W.Styles={},W.StylesSpecificity={},W.Animations=[],W.Images=[],W.ctx=c,W.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(c,p){this.viewPorts.push({width:c,height:p})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){var c,p=this.Current();return p&&(c=p.width)?c:100},this.height=function(){var c,p=this.Current();return p&&(c=p.height)?c:100},this.ComputeSize=function(c){return null!=c&&"number"==typeof c?c:"x"==c?this.width():"y"==c?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},W.init(),W.ImagesLoaded=function(){for(var c=0;c<W.Images.length;c++)if(!W.Images[c].loaded)return!1;return!0},W.trim=function(c){return c.replace(/^\s+|\s+$/g,"")},W.compressSpaces=function(c){return c.replace(/[\s\r\t\n]+/gm," ")},W.ajax=function(c){c=r.Default.beforeLoadURL(c);var p=new r.Request,Q={};return Q.url=encodeURI(c),Q.sync=!0,p.send(Q),p.getResponseText()},W.parseXml=function(p){if("undefined"!=typeof Windows&&void 0!==Windows.Data&&void 0!==Windows.Data.Xml){var Q=new Windows.Data.Xml.Dom.XmlDocument,r=new Windows.Data.Xml.Dom.XmlLoadSettings;return r.prohibitDtd=!1,Q.loadXml(p,r),Q}if(c.DOMParser){return(new DOMParser).parseFromString(p,"text/xml")}p=p.replace(/<!DOCTYPE svg[^>]*>/,"");var Q=new ActiveXObject("Microsoft.XMLDOM");return Q.async="false",Q.loadXML(p),Q},W.Property=function(c,p){this.name=c,this.value=p},W.Property.prototype.getValue=function(){return this.value},W.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},W.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var c=parseFloat(this.value);return(this.value+"").match(/%$/)&&(c/=100),c},W.Property.prototype.valueOrDefault=function(c){return this.hasValue()?this.value:c},W.Property.prototype.numValueOrDefault=function(c){return this.hasValue()?this.numValue():c},W.Property.prototype.addOpacity=function(c){var Q=this.value;if(null!=c.value&&""!=c.value&&"string"==typeof this.value){var r=new p(this.value);r.ok&&(Q="rgba("+r.r+", "+r.g+", "+r.b+", "+c.numValue()+")")}return new W.Property(this.name,Q)},W.Property.prototype.getDefinition=function(){var c=this.value.match(/#([^\)'"]+)/);return c&&(c=c[1]),c||(c=this.value),W.Definitions[c]},W.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},W.Property.prototype.getFillStyleDefinition=function(c,p){var Q=this.getDefinition();if(null!=Q&&Q.createGradient)return Q.createGradient(W.ctx,c,p);if(null!=Q&&Q.createPattern){if(Q.getHrefAttribute().hasValue()){var r=Q.attribute("patternTransform");Q=Q.getHrefAttribute().getDefinition(),r.hasValue()&&(Q.attribute("patternTransform",!0).value=r.value)}return Q.createPattern(W.ctx,c)}return null},W.Property.prototype.getDPI=function(c){return 96},W.Property.prototype.getEM=function(c){var p=12,Q=new W.Property("fontSize",W.Font.Parse(W.ctx.font).fontSize);return Q.hasValue()&&(p=Q.toPixels(c)),p},W.Property.prototype.getUnits=function(){return(this.value+"").replace(/[0-9\.\-]/g,"")},W.Property.prototype.toPixels=function(c,p){if(!this.hasValue())return 0;var Q=this.value+"";if(Q.match(/em$/))return this.numValue()*this.getEM(c);if(Q.match(/ex$/))return this.numValue()*this.getEM(c)/2;if(Q.match(/px$/))return this.numValue();if(Q.match(/pt$/))return this.numValue()*this.getDPI(c)*(1/72);if(Q.match(/pc$/))return 15*this.numValue();if(Q.match(/cm$/))return this.numValue()*this.getDPI(c)/2.54;if(Q.match(/mm$/))return this.numValue()*this.getDPI(c)/25.4;if(Q.match(/in$/))return this.numValue()*this.getDPI(c);if(Q.match(/%$/))return this.numValue()*W.ViewPort.ComputeSize(c);var r=this.numValue();return p&&r<1?r*W.ViewPort.ComputeSize(c):r},W.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var c=this.value+"";return c.match(/s$/)?1e3*this.numValue():(c.match(/ms$/),this.numValue())},W.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var c=this.value+"";return c.match(/deg$/)?this.numValue()*(Math.PI/180):c.match(/grad$/)?this.numValue()*(Math.PI/200):c.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var Z={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return W.Property.prototype.toTextBaseline=function(){return this.hasValue()?Z[this.value]:null},W.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(c,p,Q,r,i,n){var y=null!=n?this.Parse(n):this.CreateFont("","","","","",W.ctx.font);return{fontFamily:i||y.fontFamily,fontSize:r||y.fontSize,fontStyle:c||y.fontStyle,fontWeight:Q||y.fontWeight,fontVariant:p||y.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var c=this;this.Parse=function(p){for(var Q={},r=W.trim(W.compressSpaces(p||"")).split(" "),i={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},n="",y=0;y<r.length;y++)i.fontStyle||-1==c.Styles.indexOf(r[y])?i.fontVariant||-1==c.Variants.indexOf(r[y])?i.fontWeight||-1==c.Weights.indexOf(r[y])?i.fontSize?"inherit"!=r[y]&&(n+=r[y]):("inherit"!=r[y]&&(Q.fontSize=r[y].split("/")[0]),i.fontStyle=i.fontVariant=i.fontWeight=i.fontSize=!0):("inherit"!=r[y]&&(Q.fontWeight=r[y]),i.fontStyle=i.fontVariant=i.fontWeight=!0):("inherit"!=r[y]&&(Q.fontVariant=r[y]),i.fontStyle=i.fontVariant=!0):("inherit"!=r[y]&&(Q.fontStyle=r[y]),i.fontStyle=!0);return""!=n&&(Q.fontFamily=n),Q}},W.ToNumberArray=function(c){for(var p=W.trim(W.compressSpaces((c||"").replace(/,/g," "))).split(" "),Q=0;Q<p.length;Q++)p[Q]=parseFloat(p[Q]);return p},W.Point=function(c,p){this.x=c,this.y=p},W.Point.prototype.angleTo=function(c){return Math.atan2(c.y-this.y,c.x-this.x)},W.Point.prototype.applyTransform=function(c){var p=this.x*c[0]+this.y*c[2]+c[4],Q=this.x*c[1]+this.y*c[3]+c[5];this.x=p,this.y=Q},W.CreatePoint=function(c){var p=W.ToNumberArray(c);return new W.Point(p[0],p[1])},W.CreatePath=function(c){for(var p=W.ToNumberArray(c),Q=[],r=0;r<p.length;r+=2)Q.push(new W.Point(p[r],p[r+1]));return Q},W.BoundingBox=function(c,p,Q,r){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(c,p){null!=c&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=c,this.x2=c),c<this.x1&&(this.x1=c),c>this.x2&&(this.x2=c)),null!=p&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=p,this.y2=p),p<this.y1&&(this.y1=p),p>this.y2&&(this.y2=p))},this.addX=function(c){this.addPoint(c,null)},this.addY=function(c){this.addPoint(null,c)},this.addBoundingBox=function(c){this.addPoint(c.x1,c.y1),this.addPoint(c.x2,c.y2)},this.addQuadraticCurve=function(c,p,Q,r,i,n){var y=c+2/3*(Q-c),X=p+2/3*(r-p),W=y+1/3*(i-c),Z=X+1/3*(n-p);this.addBezierCurve(c,p,y,W,X,Z,i,n)},this.addBezierCurve=function(c,p,Q,r,i,n,y,X){var W=[c,p],Z=[Q,r],o=[i,n],l=[y,X];this.addPoint(W[0],W[1]),this.addPoint(l[0],l[1]);for(var j=0;j<=1;j++){var E=function(c){return Math.pow(1-c,3)*W[j]+3*Math.pow(1-c,2)*c*Z[j]+3*(1-c)*Math.pow(c,2)*o[j]+Math.pow(c,3)*l[j]},m=6*W[j]-12*Z[j]+6*o[j],f=-3*W[j]+9*Z[j]-9*o[j]+3*l[j],I=3*Z[j]-3*W[j];if(0!=f){var G=Math.pow(m,2)-4*I*f;if(!(G<0)){var e=(-m+Math.sqrt(G))/(2*f);0<e&&e<1&&(0==j&&this.addX(E(e)),1==j&&this.addY(E(e)));var P=(-m-Math.sqrt(G))/(2*f);0<P&&P<1&&(0==j&&this.addX(E(P)),1==j&&this.addY(E(P)))}}else{if(0==m)continue;var d=-I/m;0<d&&d<1&&(0==j&&this.addX(E(d)),1==j&&this.addY(E(d)))}}},this.isPointInBox=function(c,p){return this.x1<=c&&c<=this.x2&&this.y1<=p&&p<=this.y2},this.addPoint(c,p),this.addPoint(Q,r)},W.Transform=function(c){var p=this;this.Type={},this.Type.translate=function(c){this.p=W.CreatePoint(c),this.getMatrix=function(){return[1,0,0,1,this.p.x||0,this.p.y||0]},this.apply=function(c){c.translate(this.p.x||0,this.p.y||0)},this.unapply=function(c){c.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(c){c.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(c){var p=W.ToNumberArray(c);this.angle=new W.Property("angle",p[0]),this.cx=p[1]||0,this.cy=p[2]||0,this.apply=function(c){c.translate(this.cx,this.cy),c.rotate(this.angle.toRadians()),c.translate(-this.cx,-this.cy)},this.getMatrix=function(){var c=this.angle.toRadians(),p=Math.sin(c),Q=Math.cos(c),r=this.cx,i=this.cy;return[Q,p,-p,Q,Q*-r+p*i+r,p*-r-Q*i+i]},this.unapply=function(c){c.translate(this.cx,this.cy),c.rotate(-1*this.angle.toRadians()),c.translate(-this.cx,-this.cy)},this.applyToPoint=function(c){var p=this.angle.toRadians();c.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),c.applyTransform([Math.cos(p),Math.sin(p),-Math.sin(p),Math.cos(p),0,0]),c.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(c){this.p=W.CreatePoint(c),this.getMatrix=function(){return[this.p.x||1,0,0,this.p.y||this.p.x||1,0,0]},this.apply=function(c){c.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(c){c.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(c){c.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(c){this.m=W.ToNumberArray(c),this.getMatrix=function(){return this.m},this.apply=function(c){c.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(c){var p=this.m[0],Q=this.m[2],r=this.m[4],i=this.m[1],n=this.m[3],y=this.m[5],X=1/(p*(1*n-0*y)-Q*(1*i-0*y)+r*(0*i-0*n));c.transform(X*(1*n-0*y),X*(0*y-1*i),X*(0*r-1*Q),X*(1*p-0*r),X*(Q*y-r*n),X*(r*i-p*y))},this.applyToPoint=function(c){c.applyTransform(this.m)}},this.Type.SkewBase=function(c){this.base=p.Type.matrix,this.base(c),this.angle=new W.Property("angle",c)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(c){this.base=p.Type.SkewBase,this.base(c),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(c){this.base=p.Type.SkewBase,this.base(c),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.getMatrix=function(){for(var c=1,p=0,Q=0,r=1,i=0,n=0,y=0;y<this.transforms.length;y++){var X=this.transforms[y].getMatrix(),W=c,Z=p,o=Q,l=r,j=i,E=n;c=W*X[0]+o*X[1],p=Z*X[0]+l*X[1],Q=W*X[2]+o*X[3],r=Z*X[2]+l*X[3],i=W*X[4]+o*X[5]+j,n=Z*X[4]+l*X[5]+E}return[c,p,Q,r,i,n]},this.apply=function(c){for(var p=0;p<this.transforms.length;p++)this.transforms[p].apply(c)},this.unapply=function(c){for(var p=this.transforms.length-1;p>=0;p--)this.transforms[p].unapply(c)},this.applyToPoint=function(c){for(var p=0;p<this.transforms.length;p++)this.transforms[p].applyToPoint(c)};for(var Q=W.trim(W.compressSpaces(c)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),r=0;r<Q.length;r++){var i=W.trim(Q[r].split("(")[0]),n=Q[r].split("(")[1].replace(")",""),y=this.Type[i];if(void 0!==y){var X=new y(n);X.type=i,this.transforms.push(X)}}},W.AspectRatio=function(c,p,Q,r,i,n,y,X,Z,o){p=W.compressSpaces(p),p=p.replace(/^defer\s/,"");var l=p.split(" ")[0]||"xMidYMid",j=p.split(" ")[1]||"meet",E=Q/r,m=i/n,f=Math.min(E,m),I=Math.max(E,m);"meet"==j&&(r*=f,n*=f),"slice"==j&&(r*=I,n*=I),Z=new W.Property("refX",Z),o=new W.Property("refY",o),Z.hasValue()&&o.hasValue()?c.translate(-f*Z.toPixels("x"),-f*o.toPixels("y")):(l.match(/^xMid/)&&("meet"==j&&f==m||"slice"==j&&I==m)&&c.translate(Q/2-r/2,0),l.match(/YMid$/)&&("meet"==j&&f==E||"slice"==j&&I==E)&&c.translate(0,i/2-n/2),l.match(/^xMax/)&&("meet"==j&&f==m||"slice"==j&&I==m)&&c.translate(Q-r,0),l.match(/YMax$/)&&("meet"==j&&f==E||"slice"==j&&I==E)&&c.translate(0,i-n)),"none"==l?c.scale(E,m):"meet"==j?c.scale(f,f):"slice"==j&&c.scale(I,I),c.translate(null==y?0:-y,null==X?0:-X)},W.Element={},W.EmptyProperty=new W.Property("EMPTY",""),W.Element.ElementBase=function(c){this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(c,p){var Q=this.attributes[c];return null!=Q?Q:(1==p&&(Q=new W.Property(c,""),this.attributes[c]=Q),Q||W.EmptyProperty)},this.getHrefAttribute=function(){for(var c in this.attributes)if("href"==c||c.match(/:href$/))return this.attributes[c];return W.EmptyProperty},this.style=function(c,p,Q){var r=this.styles[c];if(null!=r)return r;var i=this.attribute(c);if(null!=i&&i.hasValue())return this.styles[c]=i,i;if(1!=Q){var n=this.parent;if(null!=n){var y=n.style(c);if(null!=y&&y.hasValue())return y}}return 1==p&&(r=new W.Property(c,""),this.styles[c]=r),r||W.EmptyProperty},this.render=function(c){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(c.save(),this.style("mask").hasValue()){var p=this.style("mask").getDefinition();null!=p&&p.apply(c,this)}else this.setContext(c),this.renderChildren(c),this.clearContext(c);c.restore()}},this.setContext=function(c){},this.clearContext=function(c){},this.renderChildren=function(c){for(var p=0;p<this.children.length;p++)this.children[p].render(c)},this.addChild=function(c,p){var Q=c;p&&(Q=W.CreateElement(c)),Q.parent=this,"title"!=Q.type&&this.children.push(Q)},this.addStylesFromStyleDefinition=function(){for(var p in W.Styles)if("@"!=p[0]&&X(c,p)){var Q=W.Styles[p],r=W.StylesSpecificity[p];if(null!=Q)for(var i in Q){var n=this.stylesSpecificity[i];void 0===n&&(n="000"),r>n&&(this.styles[i]=Q[i],this.stylesSpecificity[i]=r)}}};var p=new RegExp("^[A-Z-]+$");if(null!=c&&1==c.nodeType){for(var Q=0;Q<c.attributes.length;Q++){var r=c.attributes[Q],i=function(c){return p.test(c)?c.toLowerCase():c}(r.nodeName);this.attributes[i]=new W.Property(i,r.value)}if(this.addStylesFromStyleDefinition(),this.attribute("style").hasValue())for(var n=this.attribute("style").value.split(";"),Q=0;Q<n.length;Q++)if(""!=W.trim(n[Q])){var y=n[Q].split(":"),Z=W.trim(y[0]),o=W.trim(y[1]);this.styles[Z]=new W.Property(Z,o)}this.attribute("id").hasValue()&&null==W.Definitions[this.attribute("id").value]&&(W.Definitions[this.attribute("id").value]=this);for(var Q=0;Q<c.childNodes.length;Q++){var l=c.childNodes[Q];if(1==l.nodeType&&this.addChild(l,!0),this.captureTextNodes&&(3==l.nodeType||4==l.nodeType)){var j=l.value||l.text||l.textContent||"";""!=W.compressSpaces(j)&&this.addChild(new W.Element.tspan(l),!1)}}}},W.Element.RenderedElementBase=function(c){this.base=W.Element.ElementBase,this.base(c),this.setContext=function(c){if(this.style("fill").isUrlDefinition()){var p=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=p&&(c.fillStyle=p)}else if(this.style("fill").hasValue()){var Q=this.style("fill");"currentColor"==Q.value&&(Q.value=this.style("color").value),"inherit"!=Q.value&&(c.fillStyle="none"==Q.value?"rgba(0,0,0,0)":Q.value)}if(this.style("fill-opacity").hasValue()){var Q=new W.Property("fill",c.fillStyle);Q=Q.addOpacity(this.style("fill-opacity")),c.fillStyle=Q.value}if(this.style("stroke").isUrlDefinition()){var p=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));null!=p&&(c.strokeStyle=p)}else if(this.style("stroke").hasValue()){var r=this.style("stroke");"currentColor"==r.value&&(r.value=this.style("color").value),"inherit"!=r.value&&(c.strokeStyle="none"==r.value?"rgba(0,0,0,0)":r.value)}if(this.style("stroke-opacity").hasValue()){var r=new W.Property("stroke",c.strokeStyle);r=r.addOpacity(this.style("stroke-opacity")),c.strokeStyle=r.value}if(this.style("stroke-width").hasValue()){var i=this.style("stroke-width").toPixels();c.lineWidth=0==i?.001:i}if(this.style("stroke-linecap").hasValue()&&(c.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(c.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(c.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var n=W.ToNumberArray(this.style("stroke-dasharray").value);void 0!==c.setLineDash?c.setLineDash(n):void 0!==c.webkitLineDash?c.webkitLineDash=n:void 0===c.mozDash||1==n.length&&0==n[0]||(c.mozDash=n);var y=this.style("stroke-dashoffset").numValueOrDefault(1);void 0!==c.lineDashOffset?c.lineDashOffset=y:void 0!==c.webkitLineDashOffset?c.webkitLineDashOffset=y:void 0!==c.mozDashOffset&&(c.mozDashOffset=y)}if(void 0!==c.font&&(c.font=W.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.style("text-align").hasValue()?c.textAlign=this.style("text-align").value:c.textAlign="start",this.style("transform",!1,!0).hasValue()){new W.Transform(this.style("transform",!1,!0).value).apply(c)}if(this.style("clip-path",!1,!0).hasValue()){var X=this.style("clip-path",!1,!0).getDefinition();null!=X&&X.apply(c)}this.style("opacity").hasValue()&&(c.globalAlpha=this.style("opacity").numValue())}},W.Element.RenderedElementBase.prototype=new W.Element.ElementBase,W.Element.PathElementBase=function(c){this.base=W.Element.RenderedElementBase,this.base(c),this.path=function(c){return null!=c&&c.beginPath(),new W.BoundingBox},this.renderChildren=function(c){this.path(c),W.Mouse.checkPath(this,c),""!=c.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?c.fill(this.style("fill-rule").value):c.fill()),""!=c.strokeStyle&&c.stroke();var p=this.getMarkers();if(null!=p){if(this.style("marker-start").isUrlDefinition()){var Q=this.style("marker-start").getDefinition();Q.render(c,p[0][0],p[0][1],"start")}if(this.style("marker-mid").isUrlDefinition())for(var Q=this.style("marker-mid").getDefinition(),r=1;r<p.length-1;r++)Q.render(c,p[r][0],p[r][1],"mid",p[r-1][1]);if(this.style("marker-end").isUrlDefinition()){var Q=this.style("marker-end").getDefinition();Q.render(c,p[p.length-1][0],p[p.length-1][1],"end")}}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},W.Element.PathElementBase.prototype=new W.Element.RenderedElementBase,W.Element.svg=function(p){this.base=W.Element.RenderedElementBase,this.base(p),this.baseClearContext=this.clearContext,this.clearContext=function(c){this.baseClearContext(c),W.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(p){p.strokeStyle="rgba(0,0,0,0)",p.lineCap="butt",p.lineJoin="miter",p.miterLimit=4,void 0!==p.font&&void 0!==c.getComputedStyle&&(p.font=c.getComputedStyle(p.canvas).getPropertyValue("font")),this.baseSetContext(p),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),p.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var Q=W.ViewPort.width(),r=W.ViewPort.height(),i=0,n=0;if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),void 0===this.root&&(Q=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y"),
this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(i=-this.attribute("refX").toPixels("x"),n=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(p.beginPath(),p.moveTo(i,n),p.lineTo(Q,n),p.lineTo(Q,r),p.lineTo(i,r),p.closePath(),p.clip())),W.ViewPort.SetCurrent(Q,r),this.attribute("viewBox").hasValue()){var y=W.ToNumberArray(this.attribute("viewBox").value),X=y[0],Z=y[1];Q=y[2],r=y[3],W.AspectRatio(p,this.attribute("preserveAspectRatio").value,W.ViewPort.width(),Q,W.ViewPort.height(),r,X,Z,this.attribute("refX").value,this.attribute("refY").value),W.ViewPort.RemoveCurrent(),W.ViewPort.SetCurrent(y[2],y[3])}else 0===i&&0===n||p.translate(i,n)}},W.Element.svg.prototype=new W.Element.RenderedElementBase,W.Element.rect=function(c){this.base=W.Element.PathElementBase,this.base(c),this.path=function(c){var p=this.attribute("x").toPixels("x"),Q=this.attribute("y").toPixels("y"),r=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y"),n=this.attribute("rx").toPixels("x"),y=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(y=n),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(n=y),n=Math.min(n,r/2),y=Math.min(y,i/2),null!=c&&(c.beginPath(),c.moveTo(p+n,Q),c.lineTo(p+r-n,Q),c.quadraticCurveTo(p+r,Q,p+r,Q+y),c.lineTo(p+r,Q+i-y),c.quadraticCurveTo(p+r,Q+i,p+r-n,Q+i),c.lineTo(p+n,Q+i),c.quadraticCurveTo(p,Q+i,p,Q+i-y),c.lineTo(p,Q+y),c.quadraticCurveTo(p,Q,p+n,Q),c.closePath()),new W.BoundingBox(p,Q,p+r,Q+i)}},W.Element.rect.prototype=new W.Element.PathElementBase,W.Element.circle=function(c){this.base=W.Element.PathElementBase,this.base(c),this.path=function(c){var p=this.attribute("cx").toPixels("x"),Q=this.attribute("cy").toPixels("y"),r=this.attribute("r").toPixels();return null!=c&&(c.beginPath(),c.arc(p,Q,r,0,2*Math.PI,!0),c.closePath()),new W.BoundingBox(p-r,Q-r,p+r,Q+r)}},W.Element.circle.prototype=new W.Element.PathElementBase,W.Element.ellipse=function(c){this.base=W.Element.PathElementBase,this.base(c),this.path=function(c){var p=(Math.sqrt(2)-1)/3*4,Q=this.attribute("rx").toPixels("x"),r=this.attribute("ry").toPixels("y"),i=this.attribute("cx").toPixels("x"),n=this.attribute("cy").toPixels("y");return null!=c&&(c.beginPath(),c.moveTo(i,n-r),c.bezierCurveTo(i+p*Q,n-r,i+Q,n-p*r,i+Q,n),c.bezierCurveTo(i+Q,n+p*r,i+p*Q,n+r,i,n+r),c.bezierCurveTo(i-p*Q,n+r,i-Q,n+p*r,i-Q,n),c.bezierCurveTo(i-Q,n-p*r,i-p*Q,n-r,i,n-r),c.closePath()),new W.BoundingBox(i-Q,n-r,i+Q,n+r)}},W.Element.ellipse.prototype=new W.Element.PathElementBase,W.Element.line=function(c){this.base=W.Element.PathElementBase,this.base(c),this.getPoints=function(){return[new W.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new W.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(c){var p=this.getPoints();return null!=c&&(c.beginPath(),c.moveTo(p[0].x,p[0].y),c.lineTo(p[1].x,p[1].y)),new W.BoundingBox(p[0].x,p[0].y,p[1].x,p[1].y)},this.getMarkers=function(){var c=this.getPoints(),p=c[0].angleTo(c[1]);return[[c[0],p],[c[1],p]]}},W.Element.line.prototype=new W.Element.PathElementBase,W.Element.polyline=function(c){this.base=W.Element.PathElementBase,this.base(c),this.points=W.CreatePath(this.attribute("points").value),this.path=function(c){var p=new W.BoundingBox(this.points[0].x,this.points[0].y);null!=c&&(c.beginPath(),c.moveTo(this.points[0].x,this.points[0].y));for(var Q=1;Q<this.points.length;Q++)p.addPoint(this.points[Q].x,this.points[Q].y),null!=c&&c.lineTo(this.points[Q].x,this.points[Q].y);return p},this.getMarkers=function(){for(var c=[],p=0;p<this.points.length-1;p++)c.push([this.points[p],this.points[p].angleTo(this.points[p+1])]);return c.length>0&&c.push([this.points[this.points.length-1],c[c.length-1][1]]),c}},W.Element.polyline.prototype=new W.Element.PathElementBase,W.Element.polygon=function(c){this.base=W.Element.polyline,this.base(c),this.basePath=this.path,this.path=function(c){var p=this.basePath(c);return null!=c&&(c.lineTo(this.points[0].x,this.points[0].y),c.closePath()),p}},W.Element.polygon.prototype=new W.Element.polyline,W.Element.path=function(c){this.base=W.Element.PathElementBase,this.base(c);var p=this.attribute("d").value;p=p.replace(/,/gm," ");for(var Q=0;Q<2;Q++)p=p.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");p=p.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),p=p.replace(/([0-9])([+\-])/gm,"$1 $2");for(var Q=0;Q<2;Q++)p=p.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");p=p.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),p=W.compressSpaces(p),p=W.trim(p),this.PathParser=new function(c){this.tokens=c.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new W.Point(0,0),this.control=new W.Point(0,0),this.current=new W.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return!!this.isEnd()||null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var c=new W.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(c)},this.getAsControlPoint=function(){var c=this.getPoint();return this.control=c,c},this.getAsCurrentPoint=function(){var c=this.getPoint();return this.current=c,c},this.getReflectedControlPoint=function(){return"c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase()?this.current:new W.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)},this.makeAbsolute=function(c){return this.isRelativeCommand()&&(c.x+=this.current.x,c.y+=this.current.y),c},this.addMarker=function(c,p,Q){null!=Q&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(Q)),this.addMarkerAngle(c,null==p?null:p.angleTo(c))},this.addMarkerAngle=function(c,p){this.points.push(c),this.angles.push(p)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var c=0;c<this.angles.length;c++)if(null==this.angles[c])for(var p=c+1;p<this.angles.length;p++)if(null!=this.angles[p]){this.angles[c]=this.angles[p];break}return this.angles}}(p),this.path=function(c){var p=this.PathParser;p.reset();var Q=new W.BoundingBox;for(null!=c&&c.beginPath();!p.isEnd();)switch(p.nextCommand(),p.command){case"M":case"m":var r=p.getAsCurrentPoint();for(p.addMarker(r),Q.addPoint(r.x,r.y),null!=c&&c.moveTo(r.x,r.y),p.start=p.current;!p.isCommandOrEnd();){var r=p.getAsCurrentPoint();p.addMarker(r,p.start),Q.addPoint(r.x,r.y),null!=c&&c.lineTo(r.x,r.y)}break;case"L":case"l":for(;!p.isCommandOrEnd();){var i=p.current,r=p.getAsCurrentPoint();p.addMarker(r,i),Q.addPoint(r.x,r.y),null!=c&&c.lineTo(r.x,r.y)}break;case"H":case"h":for(;!p.isCommandOrEnd();){var n=new W.Point((p.isRelativeCommand()?p.current.x:0)+p.getScalar(),p.current.y);p.addMarker(n,p.current),p.current=n,Q.addPoint(p.current.x,p.current.y),null!=c&&c.lineTo(p.current.x,p.current.y)}break;case"V":case"v":for(;!p.isCommandOrEnd();){var n=new W.Point(p.current.x,(p.isRelativeCommand()?p.current.y:0)+p.getScalar());p.addMarker(n,p.current),p.current=n,Q.addPoint(p.current.x,p.current.y),null!=c&&c.lineTo(p.current.x,p.current.y)}break;case"C":case"c":for(;!p.isCommandOrEnd();){var y=p.current,X=p.getPoint(),Z=p.getAsControlPoint(),o=p.getAsCurrentPoint();p.addMarker(o,Z,X),Q.addBezierCurve(y.x,y.y,X.x,X.y,Z.x,Z.y,o.x,o.y),null!=c&&c.bezierCurveTo(X.x,X.y,Z.x,Z.y,o.x,o.y)}break;case"S":case"s":for(;!p.isCommandOrEnd();){var y=p.current,X=p.getReflectedControlPoint(),Z=p.getAsControlPoint(),o=p.getAsCurrentPoint();p.addMarker(o,Z,X),Q.addBezierCurve(y.x,y.y,X.x,X.y,Z.x,Z.y,o.x,o.y),null!=c&&c.bezierCurveTo(X.x,X.y,Z.x,Z.y,o.x,o.y),p.previousCommand=p.command}break;case"Q":case"q":for(;!p.isCommandOrEnd();){var y=p.current,Z=p.getAsControlPoint(),o=p.getAsCurrentPoint();p.addMarker(o,Z,Z),Q.addQuadraticCurve(y.x,y.y,Z.x,Z.y,o.x,o.y),null!=c&&c.quadraticCurveTo(Z.x,Z.y,o.x,o.y)}break;case"T":case"t":for(;!p.isCommandOrEnd();){var y=p.current,Z=p.getReflectedControlPoint();p.control=Z;var o=p.getAsCurrentPoint();p.addMarker(o,Z,Z),Q.addQuadraticCurve(y.x,y.y,Z.x,Z.y,o.x,o.y),null!=c&&c.quadraticCurveTo(Z.x,Z.y,o.x,o.y),p.previousCommand=p.command}break;case"A":case"a":for(;!p.isCommandOrEnd();){var y=p.current,l=p.getScalar(),j=p.getScalar(),E=p.getScalar()*(Math.PI/180),m=p.getScalar(),f=p.getScalar(),o=p.getAsCurrentPoint(),I=new W.Point(Math.cos(E)*(y.x-o.x)/2+Math.sin(E)*(y.y-o.y)/2,-Math.sin(E)*(y.x-o.x)/2+Math.cos(E)*(y.y-o.y)/2),G=Math.pow(I.x,2)/Math.pow(l,2)+Math.pow(I.y,2)/Math.pow(j,2);G>1&&(l*=Math.sqrt(G),j*=Math.sqrt(G));var e=(m==f?-1:1)*Math.sqrt((Math.pow(l,2)*Math.pow(j,2)-Math.pow(l,2)*Math.pow(I.y,2)-Math.pow(j,2)*Math.pow(I.x,2))/(Math.pow(l,2)*Math.pow(I.y,2)+Math.pow(j,2)*Math.pow(I.x,2)));isNaN(e)&&(e=0);var P=new W.Point(e*l*I.y/j,e*-j*I.x/l),d=new W.Point((y.x+o.x)/2+Math.cos(E)*P.x-Math.sin(E)*P.y,(y.y+o.y)/2+Math.sin(E)*P.x+Math.cos(E)*P.y),R=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2))},t=function(c,p){return(c[0]*p[0]+c[1]*p[1])/(R(c)*R(p))},b=function(c,p){return(c[0]*p[1]<c[1]*p[0]?-1:1)*Math.acos(t(c,p))},Y=b([1,0],[(I.x-P.x)/l,(I.y-P.y)/j]),s=[(I.x-P.x)/l,(I.y-P.y)/j],h=[(-I.x-P.x)/l,(-I.y-P.y)/j],F=b(s,h);t(s,h)<=-1&&(F=Math.PI),t(s,h)>=1&&(F=0);var B=1-f?1:-1,D=Y+B*(F/2),U=new W.Point(d.x+l*Math.cos(D),d.y+j*Math.sin(D));if(p.addMarkerAngle(U,D-B*Math.PI/2),p.addMarkerAngle(o,D-B*Math.PI),Q.addPoint(o.x,o.y),null!=c){var t=l>j?l:j,a=l>j?1:l/j,_=l>j?j/l:1;c.translate(d.x,d.y),c.rotate(E),c.scale(a,_),c.arc(0,0,t,Y,Y+F,1-f),c.scale(1/a,1/_),c.rotate(-E),c.translate(-d.x,-d.y)}}break;case"Z":case"z":null!=c&&c.closePath(),p.current=p.start}return Q},this.getMarkers=function(){for(var c=this.PathParser.getMarkerPoints(),p=this.PathParser.getMarkerAngles(),Q=[],r=0;r<c.length;r++)Q.push([c[r],p[r]]);return Q}},W.Element.path.prototype=new W.Element.PathElementBase,W.Element.pattern=function(c){this.base=W.Element.ElementBase,this.base(c),this.createPattern=function(c,p){var Q=this.attribute("width").toPixels("x",!0),r=this.attribute("height").toPixels("y",!0),i=new W.Element.svg;i.attributes.viewBox=new W.Property("viewBox",this.attribute("viewBox").value),i.attributes.width=new W.Property("width",Q+"px"),i.attributes.height=new W.Property("height",r+"px"),i.attributes.transform=new W.Property("transform",this.attribute("patternTransform").value),i.children=this.children;var n=document.createElement("canvas");n.width=Q,n.height=r;var y=n.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&y.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var X=-1;X<=1;X++)for(var Z=-1;Z<=1;Z++)y.save(),i.attributes.x=new W.Property("x",X*n.width),i.attributes.y=new W.Property("y",Z*n.height),i.render(y),y.restore();return c.createPattern(n,"repeat")}},W.Element.pattern.prototype=new W.Element.ElementBase,W.Element.marker=function(c){this.base=W.Element.ElementBase,this.base(c),this.baseRender=this.render,this.render=function(c,p,r,i,n){if(n!==Q){r=(r+n)/2;var y=(r-n)%(2*Math.PI);Math.abs(y)>Math.PI&&(r+=Math.PI)}c.save(),c.translate(p.x,p.y);var X=this.attribute("orient").valueOrDefault("auto")||"";"auto"===X?c.rotate(r):"auto-start-reverse"===X?c.rotate("start"===i?r+Math.PI:r):X&&c.rotate(new W.Property("angle",X).toRadians()),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&c.scale(c.lineWidth,c.lineWidth);var Z=new W.Element.svg;Z.attributes.viewBox=new W.Property("viewBox",this.attribute("viewBox").value),Z.attributes.refX=new W.Property("refX",this.attribute("refX").value),Z.attributes.refY=new W.Property("refY",this.attribute("refY").value),Z.attributes.width=new W.Property("width",this.attribute("markerWidth").value),Z.attributes.height=new W.Property("height",this.attribute("markerHeight").value),Z.attributes.fill=new W.Property("fill",this.attribute("fill").valueOrDefault("black")),Z.attributes.stroke=new W.Property("stroke",this.attribute("stroke").valueOrDefault("none")),Z.children=this.children,Z.render(c),c.restore()}},W.Element.marker.prototype=new W.Element.ElementBase,W.Element.defs=function(c){this.base=W.Element.ElementBase,this.base(c),this.render=function(c){}},W.Element.defs.prototype=new W.Element.ElementBase,W.Element.GradientBase=function(c){this.base=W.Element.ElementBase,this.base(c),this.stops=[];for(var p=0;p<this.children.length;p++){var Q=this.children[p];"stop"==Q.type&&this.stops.push(Q)}this.getGradient=function(){},this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")},this.attributesToInherit=["gradientUnits"],this.inheritStopContainer=function(c){for(var p=0;p<this.attributesToInherit.length;p++){var Q=this.attributesToInherit[p];!this.attribute(Q).hasValue()&&c.attribute(Q).hasValue()&&(this.attribute(Q,!0).value=c.attribute(Q).value)}},this.createGradient=function(c,p,Q){var r=this;this.getHrefAttribute().hasValue()&&(r=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(r));var i=function(c){if(Q.hasValue()){return new W.Property("color",c).addOpacity(Q).value}return c},n=this.getGradient(c,p);if(null==n)return i(r.stops[r.stops.length-1].color);for(var y=0;y<r.stops.length;y++)n.addColorStop(r.stops[y].offset,i(r.stops[y].color));if(this.attribute("gradientTransform").hasValue()){var X=W.ViewPort.viewPorts[0],Z=new W.Element.rect;Z.attributes.x=new W.Property("x",-W.MAX_VIRTUAL_PIXELS/3),Z.attributes.y=new W.Property("y",-W.MAX_VIRTUAL_PIXELS/3),Z.attributes.width=new W.Property("width",W.MAX_VIRTUAL_PIXELS),Z.attributes.height=new W.Property("height",W.MAX_VIRTUAL_PIXELS);var o=new W.Element.g;o.attributes.transform=new W.Property("transform",this.attribute("gradientTransform").value),o.children=[Z];var l=new W.Element.svg;l.attributes.x=new W.Property("x",0),l.attributes.y=new W.Property("y",0),l.attributes.width=new W.Property("width",X.width),l.attributes.height=new W.Property("height",X.height),l.children=[o];var j=document.createElement("canvas");j.width=X.width,j.height=X.height;var E=j.getContext("2d");E.fillStyle=n,l.render(E);var m=E.createPattern(j,"no-repeat");return m.gradient=n,m.gradientTransform=this.attribute("gradientTransform").value,m.trans=new W.Transform(this.attribute("gradientTransform").value).getMatrix(),m}return n}},W.Element.GradientBase.prototype=new W.Element.ElementBase,W.Element.linearGradient=function(c){this.base=W.Element.GradientBase,this.base(c),this.attributesToInherit.push("x1"),this.attributesToInherit.push("y1"),this.attributesToInherit.push("x2"),this.attributesToInherit.push("y2"),this.getGradient=function(c,p){var Q="objectBoundingBox"==this.gradientUnits()?p.getBoundingBox():null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var r="objectBoundingBox"==this.gradientUnits()?Q.x()+Q.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),i="objectBoundingBox"==this.gradientUnits()?Q.y()+Q.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),n="objectBoundingBox"==this.gradientUnits()?Q.x()+Q.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),y="objectBoundingBox"==this.gradientUnits()?Q.y()+Q.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return r==n&&i==y?null:c.createLinearGradient(r,i,n,y)}},W.Element.linearGradient.prototype=new W.Element.GradientBase,W.Element.radialGradient=function(c){this.base=W.Element.GradientBase,this.base(c),this.attributesToInherit.push("cx"),this.attributesToInherit.push("cy"),this.attributesToInherit.push("r"),this.attributesToInherit.push("fx"),this.attributesToInherit.push("fy"),this.getGradient=function(c,p){var Q=p.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var r="objectBoundingBox"==this.gradientUnits()?Q.x()+Q.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),i="objectBoundingBox"==this.gradientUnits()?Q.y()+Q.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),n=r,y=i;this.attribute("fx").hasValue()&&(n="objectBoundingBox"==this.gradientUnits()?Q.x()+Q.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(y="objectBoundingBox"==this.gradientUnits()?Q.y()+Q.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var X="objectBoundingBox"==this.gradientUnits()?(Q.width()+Q.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return c.createRadialGradient(n,y,0,r,i,X)}},W.Element.radialGradient.prototype=new W.Element.GradientBase,W.Element.stop=function(c){this.base=W.Element.ElementBase,this.base(c),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var p=this.style("stop-color",!0);""===p.value&&(p.value="#000"),this.style("stop-opacity").hasValue()&&(p=p.addOpacity(this.style("stop-opacity"))),this.color=p.value},W.Element.stop.prototype=new W.Element.ElementBase,W.Element.AnimateBase=function(c){this.base=W.Element.ElementBase,this.base(c),W.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var c=this.attribute("attributeType").value,p=this.attribute("attributeName").value;return"CSS"==c?this.parent.style(p,!0):this.parent.attribute(p,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(c){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+c;var p=!1;if(this.begin<this.duration){var Q=this.calcValue();if(this.attribute("type").hasValue()){Q=this.attribute("type").value+"("+Q+")"}this.getProperty().value=Q,p=!0}return p},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var c={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var p=c.progress*(this.values.value.length-1),Q=Math.floor(p),r=Math.ceil(p);c.from=new W.Property("from",parseFloat(this.values.value[Q])),c.to=new W.Property("to",parseFloat(this.values.value[r])),c.progress=(p-Q)/(r-Q)}else c.from=this.from,c.to=this.to;return c}},W.Element.AnimateBase.prototype=new W.Element.ElementBase,W.Element.animate=function(c){this.base=W.Element.AnimateBase,this.base(c),this.calcValue=function(){var c=this.progress();return c.from.numValue()+(c.to.numValue()-c.from.numValue())*c.progress+this.initialUnits}},W.Element.animate.prototype=new W.Element.AnimateBase,W.Element.animateColor=function(c){this.base=W.Element.AnimateBase,this.base(c),this.calcValue=function(){var c=this.progress(),Q=new p(c.from.value),r=new p(c.to.value);if(Q.ok&&r.ok){var i=Q.r+(r.r-Q.r)*c.progress,n=Q.g+(r.g-Q.g)*c.progress,y=Q.b+(r.b-Q.b)*c.progress;return"rgb("+parseInt(i,10)+","+parseInt(n,10)+","+parseInt(y,10)+")"}return this.attribute("from").value}},W.Element.animateColor.prototype=new W.Element.AnimateBase,W.Element.animateTransform=function(c){this.base=W.Element.AnimateBase,this.base(c),this.calcValue=function(){for(var c=this.progress(),p=W.ToNumberArray(c.from.value),Q=W.ToNumberArray(c.to.value),r="",i=0;i<p.length;i++)r+=p[i]+(Q[i]-p[i])*c.progress+" ";return r}},W.Element.animateTransform.prototype=new W.Element.animate,W.Element.font=function(c){this.base=W.Element.ElementBase,this.base(c),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var p=0;p<this.children.length;p++){var Q=this.children[p];"font-face"==Q.type?(this.fontFace=Q,Q.style("font-family").hasValue()&&(W.Definitions[Q.style("font-family").value]=this)):"missing-glyph"==Q.type?this.missingGlyph=Q:"glyph"==Q.type&&(""!=Q.arabicForm?(this.isRTL=!0,this.isArabic=!0,void 0===this.glyphs[Q.unicode]&&(this.glyphs[Q.unicode]=[]),this.glyphs[Q.unicode][Q.arabicForm]=Q):this.glyphs[Q.unicode]=Q)}},W.Element.font.prototype=new W.Element.ElementBase,W.Element.fontface=function(c){this.base=W.Element.ElementBase,this.base(c),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},W.Element.fontface.prototype=new W.Element.ElementBase,W.Element.missingglyph=function(c){this.base=W.Element.path,this.base(c),this.horizAdvX=0},W.Element.missingglyph.prototype=new W.Element.path,W.Element.glyph=function(c){this.base=W.Element.path,this.base(c),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},W.Element.glyph.prototype=new W.Element.path,W.Element.text=function(c){this.captureTextNodes=!0,this.base=W.Element.RenderedElementBase,this.base(c),this.baseSetContext=this.setContext,this.setContext=function(c){this.baseSetContext(c);var p=this.style("dominant-baseline").toTextBaseline();null==p&&(p=this.style("alignment-baseline").toTextBaseline()),null!=p&&(c.textBaseline=p)},this.getBoundingBox=function(){var c=this.attribute("x").toPixels("x"),p=this.attribute("y").toPixels("y"),Q=this.parent.style("font-size").numValueOrDefault(W.Font.Parse(W.ctx.font).fontSize);return new W.BoundingBox(c,p-Q,c+Math.floor(2*Q/3)*this.children[0].getText().length,p)},this.renderChildren=function(c){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),this.x+=this.getAnchorDelta(c,this,0);for(var p=0;p<this.children.length;p++)this.renderChild(c,this,this,p)},this.getAnchorDelta=function(c,p,Q){var r=this.style("text-anchor").valueOrDefault("start");if("start"!=r){for(var i=0,n=Q;n<p.children.length;n++){var y=p.children[n];if(n>Q&&y.attribute("x").hasValue())break;y.measureTextRecursive&&(i+=y.measureTextRecursive(c))}return-1*("end"==r?i:i/2)}return 0},this.renderChild=function(c,p,Q,r){var i=Q.children[r];i.attribute("x").hasValue()?(i.x=i.attribute("x").toPixels("x")+p.getAnchorDelta(c,Q,r),i.attribute("dx").hasValue()&&(i.x+=i.attribute("dx").toPixels("x"))):(i.attribute("dx").hasValue()&&(p.x+=i.attribute("dx").toPixels("x")),i.x=p.x),p.x=i.x+(i.measureText?i.measureText(c):0),i.attribute("y").hasValue()?(i.y=i.attribute("y").toPixels("y"),i.attribute("dy").hasValue()&&(i.y+=i.attribute("dy").toPixels("y"))):(i.attribute("dy").hasValue()&&(p.y+=i.attribute("dy").toPixels("y")),i.y=p.y),p.y=i.y,i.render(c);for(var r=0;r<i.children.length;r++)p.renderChild(c,p,i,r)}},W.Element.text.prototype=new W.Element.RenderedElementBase,W.Element.TextElementBase=function(c){this.base=W.Element.RenderedElementBase,this.base(c),this.getGlyph=function(c,p,Q){var r=p[Q],i=null;if(c.isArabic){var n="isolated";(0==Q||" "==p[Q-1])&&Q<p.length-2&&" "!=p[Q+1]&&(n="terminal"),Q>0&&" "!=p[Q-1]&&Q<p.length-2&&" "!=p[Q+1]&&(n="medial"),Q>0&&" "!=p[Q-1]&&(Q==p.length-1||" "==p[Q+1])&&(n="initial"),void 0!==c.glyphs[r]&&null==(i=c.glyphs[r][n])&&"glyph"==c.glyphs[r].type&&(i=c.glyphs[r])}else i=c.glyphs[r];return null==i&&(i=c.missingGlyph),i},this.renderChildren=function(c){var p=this.parent.style("font-family").getDefinition();if(null==p)""!=c.fillStyle&&c.fillText(W.compressSpaces(this.getText()),this.x,this.y),""!=c.strokeStyle&&c.strokeText(W.compressSpaces(this.getText()),this.x,this.y);else{var Q=this.parent.style("font-size").numValueOrDefault(W.Font.Parse(W.ctx.font).fontSize),r=this.parent.style("font-style").valueOrDefault(W.Font.Parse(W.ctx.font).fontStyle),i=this.getText();p.isRTL&&(i=i.split("").reverse().join(""));for(var n=W.ToNumberArray(this.parent.attribute("dx").value),y=0;y<i.length;y++){var X=this.getGlyph(p,i,y),Z=Q/p.fontFace.unitsPerEm;c.translate(this.x,this.y),c.scale(Z,-Z);var o=c.lineWidth;c.lineWidth=c.lineWidth*p.fontFace.unitsPerEm/Q,"italic"==r&&c.transform(1,0,.4,1,0,0),X.render(c),"italic"==r&&c.transform(1,0,-.4,1,0,0),c.lineWidth=o,c.scale(1/Z,-1/Z),c.translate(-this.x,-this.y),this.x+=Q*(X.horizAdvX||p.horizAdvX)/p.fontFace.unitsPerEm,void 0===n[y]||isNaN(n[y])||(this.x+=n[y])}}},this.getText=function(){},this.measureTextRecursive=function(c){for(var p=this.measureText(c),Q=0;Q<this.children.length;Q++)p+=this.children[Q].measureTextRecursive(c);return p},this.measureText=function(c){var p=this.parent.style("font-family").getDefinition();if(null!=p){var Q=this.parent.style("font-size").numValueOrDefault(W.Font.Parse(W.ctx.font).fontSize),r=0,i=this.getText();p.isRTL&&(i=i.split("").reverse().join(""));for(var n=W.ToNumberArray(this.parent.attribute("dx").value),y=0;y<i.length;y++){r+=(this.getGlyph(p,i,y).horizAdvX||p.horizAdvX)*Q/p.fontFace.unitsPerEm,void 0===n[y]||isNaN(n[y])||(r+=n[y])}return r}var X=W.compressSpaces(this.getText());if(!c.measureText)return 10*X.length;c.save(),this.setContext(c);var Z=c.measureText(X).width;return c.restore(),Z}},W.Element.TextElementBase.prototype=new W.Element.RenderedElementBase,W.Element.tspan=function(c){this.captureTextNodes=!0,this.base=W.Element.TextElementBase,this.base(c),this.text=W.compressSpaces(c.value||c.text||c.textContent||""),this.getText=function(){return this.children.length>0?"":this.text}},W.Element.tspan.prototype=new W.Element.TextElementBase,W.Element.tref=function(c){this.base=W.Element.TextElementBase,this.base(c),this.getText=function(){var c=this.getHrefAttribute().getDefinition();if(null!=c)return c.children[0].getText()}},W.Element.tref.prototype=new W.Element.TextElementBase,W.Element.a=function(p){this.base=W.Element.TextElementBase,this.base(p),this.hasText=p.childNodes.length>0;for(var Q=0;Q<p.childNodes.length;Q++)3!=p.childNodes[Q].nodeType&&(this.hasText=!1);this.text=this.hasText?p.childNodes[0].value:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(c){if(this.hasText){this.baseRenderChildren(c);var p=new W.Property("fontSize",W.Font.Parse(W.ctx.font).fontSize);W.Mouse.checkBoundingBox(this,new W.BoundingBox(this.x,this.y-p.toPixels("y"),this.x+this.measureText(c),this.y))}else if(this.children.length>0){var Q=new W.Element.g;Q.children=this.children,Q.parent=this,Q.render(c)}},this.onclick=function(){c.open(this.getHrefAttribute().value)},this.onmousemove=function(){W.ctx.canvas.style.cursor="pointer"}},W.Element.a.prototype=new W.Element.TextElementBase,W.Element.image=function(c){this.base=W.Element.RenderedElementBase,this.base(c);var p=this.getHrefAttribute().value;if(""!=p){var Q=p.match(/\.svg$/);if(W.Images.push(this),this.loaded=!1,Q)this.img=W.ajax(p),this.loaded=!0;else{this.img=document.createElement("img"),1==W.opts.useCORS&&(this.img.crossOrigin="Anonymous");var r=this;this.img.onload=function(){r.loaded=!0},this.img.onerror=function(){W.log('ERROR: image "'+p+'" not found'),r.loaded=!0},this.img.src=p}this.renderChildren=function(c){var p=this.attribute("x").toPixels("x"),r=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),n=this.attribute("height").toPixels("y");0!=i&&0!=n&&(c.save(),Q?c.drawSvg(this.img,p,r,i,n):(c.translate(p,r),W.AspectRatio(c,this.attribute("preserveAspectRatio").value,i,this.img.width,n,this.img.height,0,0),c.drawImage(this.img,0,0)),c.restore())},this.getBoundingBox=function(){var c=this.attribute("x").toPixels("x"),p=this.attribute("y").toPixels("y"),Q=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");return new W.BoundingBox(c,p,c+Q,p+r)}}},W.Element.image.prototype=new W.Element.RenderedElementBase,W.Element.g=function(c){this.base=W.Element.RenderedElementBase,this.base(c),this.getBoundingBox=function(){for(var c=new W.BoundingBox,p=0;p<this.children.length;p++)c.addBoundingBox(this.children[p].getBoundingBox());return c}},W.Element.g.prototype=new W.Element.RenderedElementBase,W.Element.symbol=function(c){this.base=W.Element.RenderedElementBase,this.base(c),this.render=function(c){}},W.Element.symbol.prototype=new W.Element.RenderedElementBase,W.Element.switch=function(c){this.base=W.Element.RenderedElementBase,this.base(c)},W.Element.switch.prototype=new W.Element.symbol,W.Element.style=function(c){this.base=W.Element.ElementBase,this.base(c);for(var p="",Q=0;Q<c.childNodes.length;Q++)p+=c.childNodes[Q].data;p=p.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),p=W.compressSpaces(p);for(var r=p.split("}"),Q=0;Q<r.length;Q++)if(""!=W.trim(r[Q]))for(var i=r[Q].split("{"),y=i[0].split(","),X=i[1].split(";"),Z=0;Z<y.length;Z++){var o=W.trim(y[Z]);if(""!=o){for(var l=W.Styles[o]||{},j=0;j<X.length;j++){var E=X[j].indexOf(":"),m=X[j].substr(0,E),f=X[j].substr(E+1,X[j].length-E);null!=m&&null!=f&&(l[W.trim(m)]=new W.Property(W.trim(m),W.trim(f)))}if(W.Styles[o]=l,W.StylesSpecificity[o]=n(o),"@font-face"==o)for(var I=l["font-family"].value.replace(/"/g,""),G=l.src.value.split(","),e=0;e<G.length;e++)if(G[e].indexOf('format("svg")')>0)for(var P=G[e].indexOf("url"),d=G[e].indexOf(")",P),R=G[e].substr(P+5,d-P-6),t=W.parseXml(W.ajax(R)),b=t.getElementsByTagName("font"),Y=0;Y<b.length;Y++){var s=W.CreateElement(b[Y]);W.Definitions[I]=s}}}},W.Element.style.prototype=new W.Element.ElementBase,W.Element.use=function(c){this.base=W.Element.RenderedElementBase,this.base(c),this.baseSetContext=this.setContext,this.setContext=function(c){this.baseSetContext(c),this.attribute("x").hasValue()&&c.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&c.translate(0,this.attribute("y").toPixels("y"))};var p=this.getHrefAttribute().getDefinition();this.path=function(c){null!=p&&p.path(c)},this.getBoundingBox=function(){if(null!=p)return p.getBoundingBox()},this.renderChildren=function(c){if(null!=p){var Q=p;"symbol"==p.type&&(Q=new W.Element.svg,Q.type="svg",Q.attributes.viewBox=new W.Property("viewBox",p.attribute("viewBox").value),Q.attributes.preserveAspectRatio=new W.Property("preserveAspectRatio",p.attribute("preserveAspectRatio").value),Q.attributes.overflow=new W.Property("overflow",p.attribute("overflow").value),Q.children=p.children),
"svg"==Q.type&&(this.attribute("width").hasValue()&&(Q.attributes.width=new W.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(Q.attributes.height=new W.Property("height",this.attribute("height").value)));var r=Q.parent;Q.parent=null,Q.render(c),Q.parent=r}}},W.Element.use.prototype=new W.Element.RenderedElementBase,W.Element.mask=function(c){this.base=W.Element.ElementBase,this.base(c),this.apply=function(c,p){var Q=this.attribute("x").toPixels("x"),r=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),n=this.attribute("height").toPixels("y"),y=1;if(0==i&&0==n){for(var X=new W.BoundingBox,Z=0;Z<this.children.length;Z++)this.children[Z].getBoundingBox&&X.addBoundingBox(this.children[Z].getBoundingBox());Q=Math.floor(X.x1),r=Math.floor(X.y1),i=Math.floor(X.width()),n=Math.floor(X.height())}if(i&&n){var o=Q+i,l=r+n;(o>2048||l>2048)&&(y=Math.min(2048/o,2048/l),o*=y,l*=y);var j=p.style("mask").value;p.style("mask").value="";var E=document.createElement("canvas");E.width=o,E.height=l;var m=E.getContext("2d");if(m.save(),1!==y&&m.scale(y,y),this.renderChildren(m),m.restore(),E.width&&E.height){var f=document.createElement("canvas");f.width=o,f.height=l;var I=f.getContext("2d");I.save(),1!==y&&I.scale(y,y),p.render(I),I.restore(),I.globalCompositeOperation="destination-in",I.fillStyle=m.createPattern(E,"no-repeat"),I.fillRect(0,0,o,l),c.save(),1!==y&&c.scale(1/y,1/y),c.fillStyle=I.createPattern(f,"no-repeat"),c.fillRect(0,0,o,l),c.restore(),p.style("mask").value=j}}},this.render=function(c){}},W.Element.mask.prototype=new W.Element.ElementBase,W.Element.clipPath=function(c){this.base=W.Element.ElementBase,this.base(c),this.apply=function(c){var p=c.beginPath;c.beginPath=function(){};var Q=c.closePath;c.closePath=function(){};var r;this.style("transform",!1,!0).hasValue()&&(r=new W.Transform(this.style("transform",!1,!0).value),r.apply(c)),p.call(c);for(var i=0;i<this.children.length;i++){var n=this.children[i];if(void 0!==n.path){var y=null;n.style("transform",!1,!0).hasValue()&&(y=new W.Transform(n.style("transform",!1,!0).value),y.apply(c)),n.path(c),c.closePath=Q,y&&y.unapply(c)}}Q.call(c),c.clip(),r&&r.unapply(c),c.beginPath=p,c.closePath=Q},this.render=function(c){}},W.Element.clipPath.prototype=new W.Element.ElementBase,W.Element.filter=function(c){this.base=W.Element.ElementBase,this.base(c),this.apply=function(c,p){return},this.render=function(c){}},W.Element.filter.prototype=new W.Element.ElementBase,W.Element.feMorphology=function(c){this.base=W.Element.ElementBase,this.base(c),this.apply=function(c,p,Q,r,i){}},W.Element.feMorphology.prototype=new W.Element.ElementBase,W.Element.feComposite=function(c){this.base=W.Element.ElementBase,this.base(c),this.apply=function(c,p,Q,r,i){}},W.Element.feComposite.prototype=new W.Element.ElementBase,W.Element.feColorMatrix=function(c){function p(c,p,Q,r,i,n){return c[Q*r*4+4*p+n]}function Q(c,p,Q,r,i,n,y){c[Q*r*4+4*p+n]=y}function r(c,p){var Q=i[c];return Q*(Q<0?p-255:p)}this.base=W.Element.ElementBase,this.base(c);var i=W.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var n=i[0];i=[.213+.787*n,.715-.715*n,.072-.072*n,0,0,.213-.213*n,.715+.285*n,.072-.072*n,0,0,.213-.213*n,.715-.715*n,.072+.928*n,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var y=i[0]*Math.PI/180,X=function(c,p,Q){return c+Math.cos(y)*p+Math.sin(y)*Q};i=[X(.213,.787,-.213),X(.715,-.715,-.715),X(.072,-.072,.928),0,0,X(.213,-.213,.143),X(.715,.285,.14),X(.072,-.072,-.283),0,0,X(.213,-.213,-.787),X(.715,-.715,.715),X(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}this.apply=function(c,i,n,y,X){if(y&&X){for(var W=c.getImageData(0,0,y,X),n=0;n<X;n++)for(var i=0;i<y;i++){var Z=p(W.data,i,n,y,X,0),o=p(W.data,i,n,y,X,1),l=p(W.data,i,n,y,X,2),j=p(W.data,i,n,y,X,3);Q(W.data,i,n,y,X,0,r(0,Z)+r(1,o)+r(2,l)+r(3,j)+r(4,1)),Q(W.data,i,n,y,X,1,r(5,Z)+r(6,o)+r(7,l)+r(8,j)+r(9,1)),Q(W.data,i,n,y,X,2,r(10,Z)+r(11,o)+r(12,l)+r(13,j)+r(14,1)),Q(W.data,i,n,y,X,3,r(15,Z)+r(16,o)+r(17,l)+r(18,j)+r(19,1))}c.clearRect(0,0,y,X),c.putImageData(W,0,0)}}},W.Element.feColorMatrix.prototype=new W.Element.ElementBase,W.Element.feGaussianBlur=function(c){this.base=W.Element.ElementBase,this.base(c),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(c,p,Q,r,n){if(void 0===i.canvasRGBA)return void W.log("ERROR: StackBlur.js must be included for blur to work");c.canvas.id=W.UniqueId(),c.canvas.style.display="none",document.body.appendChild(c.canvas),i.canvasRGBA(c.canvas.id,p,Q,r,n,this.blurRadius),document.body.removeChild(c.canvas)}},W.Element.feGaussianBlur.prototype=new W.Element.ElementBase,W.Element.title=function(c){},W.Element.title.prototype=new W.Element.ElementBase,W.Element.desc=function(c){},W.Element.desc.prototype=new W.Element.ElementBase,W.Element.MISSING=function(c){W.log("ERROR: Element '"+c.nodeName+"' not yet implemented.")},W.Element.MISSING.prototype=new W.Element.ElementBase,W.CreateElement=function(c){var p=c.nodeName.replace(/^[^:]+:/,"");p=p.replace(/\-/g,"");var Q=null;return Q=void 0!==W.Element[p]?new W.Element[p](c):new W.Element.MISSING(c),Q.type=c.nodeName,Q},W.load=function(c,p){W.loadXml(c,W.ajax(p))},W.loadXml=function(c,p){W.loadXmlDoc(c,W.parseXml(p))},W.loadXmlDoc=function(p,Q){W.init(p);var r=function(Q){for(var r=p.canvas;r;)Q.x-=r.offsetLeft,Q.y-=r.offsetTop,r=r.offsetParent;return c.scrollX&&(Q.x+=c.scrollX),c.scrollY&&(Q.y+=c.scrollY),Q};1!=W.opts.ignoreMouse&&(p.canvas.onclick=function(c){var p=r(new W.Point(null!=c?c.clientX:event.clientX,null!=c?c.clientY:event.clientY));W.Mouse.onclick(p.x,p.y)},p.canvas.onmousemove=function(c){var p=r(new W.Point(null!=c?c.clientX:event.clientX,null!=c?c.clientY:event.clientY));W.Mouse.onmousemove(p.x,p.y)});var i=W.CreateElement(Q.documentElement);i.root=!0,i.addStylesFromStyleDefinition();var n=!0,y=function(){var c=!1;p.canvas.parentElement||(c=!0,document.body.appendChild(p.canvas)),W.ViewPort.Clear(),p.canvas.parentNode&&W.ViewPort.SetCurrent(p.canvas.parentNode.clientWidth,p.canvas.parentNode.clientHeight),1!=W.opts.ignoreDimensions&&(i.style("width").hasValue()&&(p.canvas.width=i.style("width").toPixels("x"),p.canvas.style.width=p.canvas.width+"px"),i.style("height").hasValue()&&(p.canvas.height=i.style("height").toPixels("y"),p.canvas.style.height=p.canvas.height+"px"));var r=p.canvas.clientWidth||p.canvas.width,y=p.canvas.clientHeight||p.canvas.height;if(1==W.opts.ignoreDimensions&&i.style("width").hasValue()&&i.style("height").hasValue()&&(r=i.style("width").toPixels("x"),y=i.style("height").toPixels("y")),W.ViewPort.SetCurrent(r,y),null!=W.opts.offsetX&&(i.attribute("x",!0).value=W.opts.offsetX),null!=W.opts.offsetY&&(i.attribute("y",!0).value=W.opts.offsetY),null!=W.opts.scaleWidth||null!=W.opts.scaleHeight){var X=null,Z=null,o=W.ToNumberArray(i.attribute("viewBox").value);null!=W.opts.scaleWidth&&(i.attribute("width").hasValue()?X=i.attribute("width").toPixels("x")/W.opts.scaleWidth:isNaN(o[2])||(X=o[2]/W.opts.scaleWidth)),null!=W.opts.scaleHeight&&(i.attribute("height").hasValue()?Z=i.attribute("height").toPixels("y")/W.opts.scaleHeight:isNaN(o[3])||(Z=o[3]/W.opts.scaleHeight)),null==X&&(X=Z),null==Z&&(Z=X),i.attribute("width",!0).value=W.opts.scaleWidth,i.attribute("height",!0).value=W.opts.scaleHeight,i.style("transform",!0,!0).value+=" scale("+1/X+","+1/Z+")"}1!=W.opts.ignoreClear&&p.clearRect(0,0,r,y),i.render(p),n&&(n=!1,"function"==typeof W.opts.renderCallback&&W.opts.renderCallback(Q)),c&&p.canvas.parentElement&&p.canvas.parentElement.removeChild(p.canvas)},X=!0;W.ImagesLoaded()&&(X=!1,y()),W.intervalID=setInterval(function(){var c=!1;if(X&&W.ImagesLoaded()&&(X=!1,c=!0),1!=W.opts.ignoreMouse&&(c|=W.Mouse.hasEvents()),1!=W.opts.ignoreAnimation)for(var p=0;p<W.Animations.length;p++)c|=W.Animations[p].update(1e3/W.FRAMERATE);"function"==typeof W.opts.forceRedraw&&1==W.opts.forceRedraw()&&(c=!0),c&&(y(),W.Mouse.runEvents())},1e3/W.FRAMERATE)},W.stop=function(){W.intervalID&&clearInterval(W.intervalID)},W.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(c,p){this.events.push({type:"onclick",x:c,y:p,run:function(c){c.onclick&&c.onclick()}})},this.onmousemove=function(c,p){this.events.push({type:"onmousemove",x:c,y:p,run:function(c){c.onmousemove&&c.onmousemove()}})},this.eventElements=[],this.checkPath=function(c,p){for(var Q=0;Q<this.events.length;Q++){var r=this.events[Q];p.isPointInPath&&p.isPointInPath(r.x,r.y)&&(this.eventElements[Q]=c)}},this.checkBoundingBox=function(c,p){for(var Q=0;Q<this.events.length;Q++){var r=this.events[Q];p.isPointInBox(r.x,r.y)&&(this.eventElements[Q]=c)}},this.runEvents=function(){W.ctx.canvas.style.cursor="";for(var c=0;c<this.events.length;c++)for(var p=this.events[c],Q=this.eventElements[c];Q;)p.run(Q),Q=Q.parent;this.events=[],this.eventElements=[]}},W}var X,W=function(c,p,Q){if(null!=c||null!=p||null!=Q){"string"==typeof c&&(c=document.getElementById(c)),null!=c.svg&&c.svg.stop();var r=y(Q||{});1==c.childNodes.length&&"OBJECT"==c.childNodes[0].nodeName||(c.svg=r);var i=c.getContext("2d");void 0!==p.documentElement?r.loadXmlDoc(i,p):"<"==p.substr(0,1)?r.loadXml(i,p):r.load(i,p)}else for(var n=document.querySelectorAll("svg"),X=0;X<n.length;X++){var Z=n[X],o=document.createElement("canvas");o.width=Z.clientWidth,o.height=Z.clientHeight,Z.parentNode.insertBefore(o,Z),Z.parentNode.removeChild(Z);var l=document.createElement("div");l.appendChild(Z),W(o,l.innerHTML)}};void 0!==Element.prototype.matches?X=function(c,p){return c.matches(p)}:void 0!==Element.prototype.webkitMatchesSelector?X=function(c,p){return c.webkitMatchesSelector(p)}:void 0!==Element.prototype.mozMatchesSelector?X=function(c,p){return c.mozMatchesSelector(p)}:void 0!==Element.prototype.msMatchesSelector?X=function(c,p){return c.msMatchesSelector(p)}:void 0!==Element.prototype.oMatchesSelector?X=function(c,p){return c.oMatchesSelector(p)}:("function"!=typeof jQuery&&"function"!=typeof Zepto||(X=function(c,p){return $(c).is(p)}),void 0===X&&(X=Sizzle.matchesSelector));var Z=/(\[[^\]]+\])/g,o=/(#[^\s\+>~\.\[:]+)/g,l=/(\.[^\s\+>~\.\[:]+)/g,j=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,E=/(:[\w-]+\([^\)]*\))/gi,m=/(:[^\s\+>~\.\[:]+)/g,f=/([^\s\+>~\.\[:]+)/g;return"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(c,p,Q,r,i,n){var y={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:p,offsetY:Q,scaleWidth:r,scaleHeight:i};for(var X in n)n.hasOwnProperty(X)&&(y[X]=n[X]);W(this.canvas,c,y)}),W}(p.RGBColor,p.stackBlur)}(void 0!==c?c:this)}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object),function(c,p,Q){function r(c){this._pointer=0,this._data=c,this._eof=!1}function i(c,p){return c<=9?p:c>=10&&c<=59?parseFloat(p):c>=60&&c<=99?parseInt(p):c>=100&&c<=109?p:c>=110&&c<=149?parseFloat(p):c>=160&&c<=179?parseInt(p):c>=210&&c<=239?parseFloat(p):c>=270&&c<=289?parseInt(p):c>=290&&c<=299?n(p):c>=300&&c<=369?p:c>=370&&c<=389?parseInt(p):c>=390&&c<=399?p:c>=400&&c<=409?parseInt(p):c>=410&&c<=419?p:c>=420&&c<=429?parseInt(p):c>=430&&c<=439?p:c>=440&&c<=459?parseInt(p):c>=460&&c<=469?parseFloat(p):c>=470&&c<=481?p:999===c?p:c>=1e3&&c<=1009?p:c>=1010&&c<=1059?parseFloat(p):c>=1060&&c<=1071?parseInt(p):(console.log("WARNING: Group code does not have a defined type: %j",{code:c,value:p}),p)}function n(c){if("0"===c)return!1;if("1"===c)return!0;throw TypeError("String '"+c+"' cannot be cast to Boolean type")}function y(c){c&&c.sanitize!==Q&&(this.sanitize=c.sanitize)}function X(c){E.debug("unhandled group "+W(c))}function W(c){return c.code+":"+c.value}function Z(c){return m[c]}var o=c.ht,l=o.Default;l.getInternal().addMethod(l,{cadToShape:function(c,p){return new o.DxfViewer(p).toShape(c)},shapeToCad:function(c,p,Q){return new o.DxfWriter(Q).toDxf(c,p)}});var j=function(){},E={debug:j,warn:j,error:j},m=[0,16711680,16776960,65280,65535,255,16711935,16777215,8421504,12632256,16711680,16744319,13369344,13395558,10027008,10046540,8323072,8339263,4980736,4990502,16727808,16752511,13382400,13401958,10036736,10051404,8331008,8343359,4985600,4992806,16744192,16760703,13395456,13408614,10046464,10056268,8339200,8347455,4990464,4995366,16760576,16768895,13408512,13415014,10056192,10061132,8347392,8351551,4995328,4997670,16776960,16777087,13421568,13421670,10000384,10000460,8355584,8355647,5000192,5000230,12582656,14679935,10079232,11717734,7510016,8755276,6258432,7307071,3755008,4344870,8388352,12582783,6736896,10079334,5019648,7510092,4161280,6258495,2509824,3755046,4194048,10485631,3394560,8375398,2529280,6264908,2064128,5209919,1264640,3099686,65280,8388479,52224,6736998,38912,5019724,32512,4161343,19456,2509862,65343,8388511,52275,6737023,38950,5019743,32543,4161359,19475,2509871,65407,8388543,52326,6737049,38988,5019762,32575,4161375,19494,2509881,65471,8388575,52377,6737074,39026,5019781,32607,4161391,19513,2509890,65535,8388607,52428,6737100,39064,5019800,32639,4161407,19532,2509900,49151,8380415,39372,6730444,29336,5014936,24447,4157311,14668,2507340,32767,8372223,26316,6724044,19608,5010072,16255,4153215,9804,2505036,16383,8364031,13260,6717388,9880,5005208,8063,4149119,4940,2502476,255,8355839,204,6710988,152,5000344,127,4145023,76,2500172,4129023,10452991,3342540,8349388,2490520,6245528,2031743,5193599,1245260,3089996,8323327,12550143,6684876,10053324,4980888,7490712,4128895,6242175,2490444,3745356,12517631,14647295,10027212,11691724,7471256,8735896,6226047,7290751,3735628,4335180,16711935,16744447,13369548,13395660,9961624,9981080,8323199,8339327,4980812,4990540,16711871,16744415,13369497,13395634,9961586,9981061,8323167,8339311,4980793,4990530,16711807,16744383,13369446,13395609,9961548,9981042,8323135,8339295,4980774,4990521,16711743,16744351,13369395,13395583,9961510,9981023,8323103,8339279,4980755,4990511,3355443,5987163,8684676,11382189,14079702,16777215];r.prototype.next=function(){var c;if(!this.hasNext())throw this._eof?new Error("Cannot call 'next' after EOF group has been read"):new Error("Unexpected end of input: EOF group not read before end of file. Ended on code "+this._data[this._pointer]);return c={code:parseInt(this._data[this._pointer])},this._pointer++,c.value=i(c.code,this._data[this._pointer].trim()),this._pointer++,0===c.code&&"EOF"===c.value&&(this._eof=!0),c},r.prototype.hasNext=function(){return!this._eof&&!(this._pointer>this._data.length-2)},r.prototype.isEOF=function(){return this._eof},y.prototype.parse=function(c,p){throw new Error("read() not implemented. Use readSync()")},y.prototype.parseSync=function(c){return"string"==typeof c?this._parse(c):(console.error("Cannot read dxf source of type `"+typeof c),null)},y.prototype.parseStream=function(c,p){function Q(c){n+=c}function r(){try{var c=y._parse(n)}catch(c){return p(c)}p(null,c)}function i(c){p(c)}var n="",y=this;c.on("data",Q),c.on("end",r),c.on("error",i)},y.prototype.sanitizeFileName=function(){var c=/[\/\?<>\\:\*\|":]/g,p=/[\x00-\x1f\x80-\x9f]/g,Q=/^\.+$/,r=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,i=/[\. ]+$/;return function(n){var y=this.sanitize;return null==y?n:n.replace(c,y).replace(p,y).replace(Q,y).replace(r,y).replace(i,y)}}(),y.prototype._parse=function(c){var i,n,y=this,o={},l=0,j=c.split(/\r\n|\r|\n/g);if(i=new r(j),!i.hasNext())throw Error("Empty file");var m=function(c,p){return n.code===c&&n.value===p},f=function(){var c=null,p=null,Q={};for(n=i.next();;){if(m(0,"ENDSEC")){c&&(Q[c]=p);break}9===n.code?(c&&(Q[c]=p),c=n.value):10===n.code?p={x:n.value}:20===n.code?p.y=n.value:30===n.code?p.z=n.value:p=n.value,n=i.next()}return n=i.next(),Q},I=function(){var c,p={};for(n=i.next();"EOF"!==n.value&&!m(0,"ENDSEC");)m(0,"BLOCK")?(E.debug("block {"),c=G(),E.debug("}"),A(c),c.name?p[c.name]=c:E.error('block with handle "'+c.handle+'" is missing a name.')):(X(n),n=i.next());return p},G=function(){var c={};for(n=i.next();"EOF"!==n.value;){switch(n.code){case 1:c.xrefPath=n.value,n=i.next();break;case 2:c.name=y.sanitizeFileName(n.value),n=i.next();break;case 3:c.name2=y.sanitizeFileName(n.value),n=i.next();break;case 5:c.handle=n.value,n=i.next();break;case 8:c.layer=n.value,n=i.next();break;case 10:c.position=B();break;case 67:c.paperSpace=!(!n.value||1!=n.value),n=i.next();break;case 70:0!=n.value&&(c.type=n.value),n=i.next();break;case 100:n=i.next();break;case 330:c.ownerHandle=n.value,n=i.next();break;case 0:if("ENDBLK"==n.value)break;i._pointer-=2,c.entities=Y(!0);break;default:X(n),n=i.next()}if(m(0,"ENDBLK")){n=i.next();break}}return c},e=function(){var c={};for(n=i.next();"EOF"!==n.value&&!m(0,"ENDSEC");)if(m(0,"TABLE")){n=i.next();var p=b[n.value];p?(E.debug(n.value+" Table {"),c[b[n.value].tableName]=P(),E.debug("}")):E.debug("Unhandled Table "+n.value)}else n=i.next();return n=i.next(),c},P=function(){var c,Q=b[n.value],r={},y=0;for(n=i.next();!m(0,"ENDTAB");)switch(n.code){case 5:r.handle=n.value,n=i.next();break;case 330:r.ownerHandle=n.value,n=i.next();break;case 100:"AcDbSymbolTable"===n.value?n=i.next():(X(n),n=i.next());break;case 70:y=n.value,n=i.next();break;case 0:n.value===Q.dxfSymbolName?r[Q.tableRecordsProperty]=Q.parseTableRecords():(X(n),n=i.next());break;default:X(n),n=i.next()}var W=r[Q.tableRecordsProperty];return W&&(W.constructor===Array?c=W.length:"object"==typeof W&&(c=p.keys(W).length),y!==c&&E.warn("Parsed "+c+" "+Q.dxfSymbolName+"'s but expected "+y)),n=i.next(),r},d=function(){var c=[],p={};for(E.debug("ViewPort {"),n=i.next();!m(0,"ENDTAB");)switch(n.code){case 2:p.name=n.value,n=i.next();break;case 10:p.lowerLeftCorner=B();break;case 11:p.upperRightCorner=B();break;case 12:p.center=B();break;case 13:p.snapBasePoint=B();break;case 14:p.snapSpacing=B();break;case 15:p.gridSpacing=B();break;case 16:p.viewDirectionFromTarget=B();break;case 17:p.viewTarget=B();break;case 40:p.viewHeight=n.value,p.aspectRatio!==Q&&(p.viewWidth=n.value*p.aspectRatio),n=i.next();break;case 41:p.aspectRatio=n.value,p.viewHeight!==Q&&(p.viewWidth=n.value*p.viewHeight),n=i.next();break;case 42:p.lensLength=n.value,n=i.next();break;case 43:p.frontClippingPlane=n.value,n=i.next();break;case 44:p.backClippingPlane=n.value,n=i.next();break;case 45:p.viewHeight=n.value,n=i.next();break;case 50:p.snapRotationAngle=n.value,n=i.next();break;case 51:p.viewTwistAngle=n.value,n=i.next();break;case 79:p.orthographicType=n.value,n=i.next();break;case 110:p.ucsOrigin=B();break;case 111:p.ucsXAxis=B();break;case 112:p.ucsYAxis=B();break;case 110:p.ucsOrigin=B();break;case 281:p.renderMode=n.value,n=i.next();break;case 281:p.defaultLightingType=n.value,n=i.next();break;case 292:p.defaultLightingOn=n.value,n=i.next();break;case 330:p.ownerHandle=n.value,n=i.next();break;case 63:case 421:case 431:p.ambientColor=n.value,n=i.next();break;case 0:"VPORT"===n.value&&(E.debug("}"),c.push(p),E.debug("ViewPort {"),p={},n=i.next());break;default:X(n),n=i.next()}return E.debug("}"),c.push(p),c},R=function(){var c,p,Q={},r={};for(E.debug("LType {"),n=i.next();!m(0,"ENDTAB");)switch(n.code){case 2:r.name=n.value,c=n.value,n=i.next();break;case 3:r.description=n.value,n=i.next();break;case 73:p=n.value,p>0&&(r.pattern=[]),n=i.next();break;case 40:r.patternLength=n.value,n=i.next();break;case 49:r.pattern.push(n.value),n=i.next();break;case 0:E.debug("}"),p>0&&p!==r.pattern.length&&E.warn("lengths do not match on LTYPE pattern"),Q[c]=r,r={},E.debug("LType {"),n=i.next();break;default:n=i.next()}return E.debug("}"),Q[c]=r,Q},t=function(){var c,p={},r={};for(E.debug("Layer {"),n=i.next();!m(0,"ENDTAB");)switch(n.code){case 2:r.name=n.value,c=n.value,n=i.next();break;case 62:r.visible=n.value>=0,r.color=Z(Math.abs(n.value)),n=i.next();break;case 6:r.lineType=n.value,n=i.next();break;case 0:"LAYER"===n.value&&(E.debug("}"),p[c]=r,E.debug("Layer {"),r={},c=Q,n=i.next());break;default:X(n),n=i.next()}return E.debug("}"),p[c]=r,p},b={VPORT:{tableRecordsProperty:"viewPorts",tableName:"viewPort",dxfSymbolName:"VPORT",parseTableRecords:d},LTYPE:{tableRecordsProperty:"lineTypes",tableName:"lineType",dxfSymbolName:"LTYPE",parseTableRecords:R},LAYER:{tableRecordsProperty:"layers",tableName:"layer",dxfSymbolName:"LAYER",parseTableRecords:t}},Y=function(c){var p=[],Q=c?"ENDBLK":"ENDSEC";for(n=i.next();;)if(0===n.code){if(n.value===Q)break;var r;if("LWPOLYLINE"===n.value)E.debug("LWPOLYLINE {"),r=$(),E.debug("}");else if("POLYLINE"===n.value)E.debug("POLYLINE {"),r=L(),E.debug("}");else if("LINE"===n.value)E.debug("LINE {"),r=H(),E.debug("}");else if("CIRCLE"===n.value)E.debug("CIRCLE {"),r=O(),E.debug("}");else if("ARC"===n.value)E.debug("ARC {"),r=O(),E.debug("}");else if("ELLIPSE"===n.value)E.debug("ELLIPSE {"),r=M(),E.debug("}");else if("SPLINE"===n.value)E.debug("SPLINE {"),r=x(),E.debug("}");else if("TEXT"===n.value)E.debug("TEXT {"),r=q(),E.debug("}");else if("DIMENSION"===n.value)E.debug("DIMENSION {"),r=z(),E.debug("}");else if("INSERT"===n.value)E.debug("INSERT {"),r=K(),E.debug("}");else if("HATCH"===n.value)E.debug("HATCH {"),r=u(),E.debug("}");else if("SOLID"===n.value)E.debug("SOLID {"),r=V(),E.debug("}");else if("POINT"===n.value)E.debug("POINT {"),r=T(),E.debug("}");else if("MTEXT"===n.value)E.debug("MTEXT {"),r=_(),E.debug("}");else{if("ATTDEF"!==n.value){E.warn("Unhandled entity "+n.value),n=i.next();continue}E.debug("ATTDEF {"),r=w(),E.debug("}")}A(r),p.push(r)}else n=i.next();return"ENDSEC"==Q&&(n=i.next()),p},s=function(c){switch(n.code){case 0:c.type=n.value,n=i.next();break;case 5:c.handle=n.value,n=i.next();break;case 6:c.lineType=n.value,n=i.next();break;case 8:c.layer=n.value,n=i.next();break;case 48:c.lineTypeScale=n.value,n=i.next();break;case 60:c.visible=0===n.value,n=i.next();break;case 62:c.colorIndex=n.value,c.color=Z(Math.abs(n.value)),n=i.next();break;case 67:c.inPaperSpace=0!==n.value,n=i.next();break;case 210:c.extrusionDirection=B();break;case 230:c.extrusionDirection={x:0,y:0,z:n.value},n=i.next();break;case 330:c.ownerHandle=n.value,n=i.next();break;case 347:c.materialObjectHandle=n.value,n=i.next();break;case 370:c.lineweight=n.value,n=i.next();break;case 420:c.color=n.value,n=i.next();break;case 100:if("AcDbEntity"==n.value){n=i.next();break}default:X(n),n=i.next()}},h=function(){var c={type:n.value};for(n=i.next();"EOF"!==n&&0!==n.code;)switch(n.code){case 10:c.x=n.value,n=i.next();break;case 20:c.y=n.value,n=i.next();break;case 30:c.z=n.value,n=i.next();break;case 40:case 41:case 42:n=i.next();break;case 70:c.curveFittingVertex=0!=(1|n.value),c.curveFitTangent=0!=(2|n.value),c.splineVertex=0!=(8|n.value),c.splineControlPoint=0!=(16|n.value),c.ThreeDPolylineVertex=0!=(32|n.value),c.ThreeDPolylineMesh=0!=(64|n.value),c.polyfaceMeshVertex=0!=(128|n.value),n=i.next();break;case 50:case 71:case 72:case 73:case 74:n=i.next();break;default:s(c)}return c},F=function(){var c={type:n.value};for(n=i.next();"EOF"!=n&&0!=n.code;)s(c);return c},B=function(){var c={},p=n.code;if(c.x=n.value,p+=10,n=i.next(),n.code!=p)throw new Error("Expected code for point value to be "+p+" but got "+n.code+".");return c.y=n.value,p+=10,n=i.next(),n.code!=p?c:(c.z=n.value,n=i.next(),c)},D=function(){var c={},p=n.code;return c.x=n.value,p+=1,n=i.next(),n.code!=p?(i._pointer-=2,c.y=1):c.y=n.value,p+=1,n=i.next(),n.code!=p?(i._pointer-=2,c.z=1):c.z=n.value,n=i.next(),c},U=function(c){if(!c||c<=0)throw Error("n must be greater than 0 verticies");var p,Q=[],r=!1,y=!1;for(p=0;p<c;p++){for(var X={};"EOF"!==n&&0!==n.code&&!y;){switch(n.code){case 10:if(r){y=!0;continue}X.x=n.value,r=!0;break;case 20:X.y=n.value;break;case 30:X.z=n.value;break;case 40:X.startWidth=n.value;break;case 41:X.endWidth=n.value;break;case 42:0!=n.value&&(X.bulge=n.value);break;default:if(r){y=!0;continue}}n=i.next()}Q.push(X),r=!1,y=!1}return Q},a=function(){for(var c=[];"EOF"!==n;)if(0===n.code)if("VERTEX"===n.value)c.push(h());else if("SEQEND"===n.value){F();break}return c},_=function(){var c={type:n.value};for(n=i.next();"EOF"!==n&&0!==n.code;)switch(n.code){case 1:c.text=n.value,n=i.next();break;case 3:c.text+=n.value,n=i.next();break;case 10:c.position=B();break;case 40:c.height=n.value,n=i.next();break;case 41:c.width=n.value,n=i.next();break;case 71:c.attachmentPoint=n.value,n=i.next();break;case 72:c.drawingDirection=n.value,n=i.next();break;case 50:c.angle=2*n.value*Math.PI/360,n=i.next();break;case 11:c.directionX=n.value,n=i.next();break;case 21:c.directionY=n.value,n=i.next();break;default:s(c)}return c},w=function(){var c={type:n.value,scale:1,textStyle:"STANDARD"};for(n=i.next();"EOF"!==n&&0!==n.code;)switch(n.code){case 1:c.text=n.value,n=i.next();break;case 2:c.tag=n.value,n=i.next();break;case 3:c.prompt=n.value,n=i.next();break;case 7:c.textStyle=n.value,n=i.next();break;case 10:c.x=n.value,n=i.next();break;case 20:c.y=n.value,n=i.next();break;case 30:c.z=n.value,n=i.next();break;case 39:c.thickness=n.value,n=i.next();break;case 40:c.textHeight=n.value,n=i.next();break;case 41:c.scale=n.value,n=i.next();break;case 50:c.rotation=n.value,n=i.next();break;case 51:c.obliqueAngle=n.value,n=i.next();break;case 70:c.invisible=!!(1&n.value),c.constant=!!(2&n.value),c.verificationRequired=!!(4&n.value),c.preset=!!(8&n.value),n=i.next();break;case 71:c.backwards=!!(2&n.value),c.mirrored=!!(4&n.value),n=i.next();break;case 72:c.horizontalJustification=n.value,n=i.next();break;case 73:c.fieldLength=n.value,n=i.next();break;case 74:c.verticalJustification=n.value,n=i.next();break;case 100:n=i.next();break;case 210:c.extrusionDirectionX=n.value,n=i.next();break;case 220:c.extrusionDirectionY=n.value,n=i.next();break;case 230:c.extrusionDirectionZ=n.value,n=i.next();break;default:s(c)}return c},$=function(){var c={type:n.value,vertices:[]},p=0;for(n=i.next();"EOF"!==n&&0!==n.code;)switch(n.code){case 38:c.elevation=n.value,n=i.next();break;case 39:c.depth=n.value,n=i.next();break;case 70:c.shape=1===n.value,n=i.next();break;case 90:p=n.value,n=i.next();break;case 10:c.vertices=U(p);break;case 40:0!==n.value&&(c.startWidth=n.value),n=i.next();break;case 41:0!==n.value&&(c.endWidth=n.value),n=i.next();break;case 43:0!==n.value&&(c.width=n.value),n=i.next();break;default:s(c)}return c},L=function(){var c={type:n.value,vertices:[]};for(n=i.next();"EOF"!==n&&0!==n.code;)switch(n.code){case 10:case 20:case 30:case 39:n=i.next();break;case 40:0!==n.value&&(c.startWidth=n.value),n=i.next();break;case 41:0!==n.value&&(c.endWidth=n.value),n=i.next();break;case 70:c.shape=1===n.value,n=i.next();break;case 71:case 72:case 73:case 74:case 75:case 100:n=i.next();break;default:s(c)}return c.vertices=a(),c},H=function(){var c={type:n.value,vertices:[]};for(n=i.next();"EOF"!==n&&0!==n.code;)switch(n.code){case 10:c.vertices.unshift(B());break;case 11:c.vertices.push(B());break;case 100:if("AcDbLine"==n.value){n=i.next();break}default:s(c)}return c},O=function(){var c,p;for(c={type:n.value},n=i.next();"EOF"!==n&&0!==n.code;)switch(n.code){case 10:c.center=B();break;case 40:c.radius=n.value,n=i.next();break;case 50:c.startAngle=Math.PI/180*n.value,n=i.next();break;case 51:p=Math.PI/180*n.value,p<c.startAngle?c.angleLength=p+2*Math.PI-c.startAngle:c.angleLength=p-c.startAngle,c.endAngle=p,n=i.next();break;default:s(c)}return c},M=function(){var c,p;for(c={type:n.value},n=i.next();"EOF"!==n&&0!==n.code;)switch(n.code){case 10:c.center=B();break;case 11:c.major=B();break;case 40:c.ratio=n.value,n=i.next();break;case 41:c.startAngle=n.value,n=i.next();break;case 42:p=n.value,p<c.startAngle?c.angleLength=p+2*Math.PI-c.startAngle:c.angleLength=p-c.startAngle,c.endAngle=p,n=i.next();break;default:s(c)}return c},K=function(){var c;for(c={type:n.value},n=i.next();"EOF"!==n&&0!==n.code;)switch(n.code){case 2:c.block=y.sanitizeFileName(n.value),n=i.next();break;case 10:c.center=B();break;case 41:c.scale=D();break;case 50:c.deg=n.value,n=i.next();break;default:s(c)}return c},u=function(){var c;for(c={type:n.value},n=i.next();"EOF"!==n&&0!==n.code;)switch(n.code){case 2:c.block=y.sanitizeFileName(n.value),n=i.next();break;case 10:c.center=B();break;case 41:c.scale=D();break;case 50:c.deg=n.value,n=i.next();break;default:s(c)}return c},x=function(){var c,p;for(c={type:n.value},n=i.next();"EOF"!==n&&0!==n.code;)switch(n.code){case 10:c.center=B();break;case 11:c.major=B();break;case 40:c.ratio=n.value,n=i.next();break;case 41:c.startAngle=n.value,n=i.next();break;case 42:p=n.value,p<c.startAngle?c.angleLength=p+2*Math.PI-c.startAngle:c.angleLength=p-c.startAngle,c.endAngle=p,n=i.next();break;default:s(c)}return c},q=function(){var c;for(c={type:n.value},n=i.next();"EOF"!==n&&0!==n.code;)switch(n.code){case 10:c.startPoint=B();break;case 11:c.endPoint=B();break;case 40:c.textHeight=n.value,n=i.next();break;case 41:c.xScale=n.value,n=i.next();break;case 1:c.text=n.value,n=i.next();break;case 7:c.font=n.value,n=i.next();break;case 71:c.generationFlags=n.value,n=i.next();break;case 72:c.halign=n.value,n=i.next();break;case 73:c.valign=n.value,n=i.next();break;case 50:c.rotation=2*n.value*Math.PI/360,n=i.next();break;default:s(c)}return c},z=function(){var c;for(c={type:n.value},n=i.next();"EOF"!==n&&0!==n.code;)switch(n.code){case 2:c.block=y.sanitizeFileName(n.value),n=i.next();break;case 10:c.anchorPoint=B();break;case 11:c.middleOfText=B();break;case 71:c.attachmentPoint=n.value,n=i.next();break;case 42:c.actualMeasurement=n.value,n=i.next();break;case 1:c.text=n.value,n=i.next();break;case 50:c.angle=n.value,n=i.next();break;default:s(c)}return c},V=function(){var c;for(c={type:n.value},c.points=[],n=i.next();"EOF"!==n&&0!==n.code;)switch(n.code){case 10:c.points[0]=B();break;case 11:c.points[1]=B();break;case 12:c.points[2]=B();break;case 13:c.points[3]=B();break;default:s(c)}return c},T=function(){var c;for(c={type:n.value},n=i.next();"EOF"!==n&&0!==n.code;)switch(n.code){case 10:c.position=B();break;case 39:c.thickness=n.value,n=i.next();break;case 100:if("AcDbPoint"==n.value){n=i.next();break}default:s(c)}return c},A=function(c){if(!c)throw new TypeError("entity cannot be undefined or null");c.handle||(c.handle=l++)};return function(){for(n=i.next();!i.isEOF();)if(0===n.code&&"SECTION"===n.value){if(n=i.next(),2!==n.code){console.error("Unexpected code %s after 0:SECTION",W(n)),n=i.next();continue}"HEADER"===n.value?(E.debug("> HEADER"),o.header=f(),E.debug("<")):"BLOCKS"===n.value?(E.debug("> BLOCKS"),o.blocks=I(),E.debug("<")):"ENTITIES"===n.value?(E.debug("> ENTITIES"),o.entities=Y(!1),E.debug("<")):"TABLES"===n.value?(E.debug("> TABLES"),o.tables=e(),E.debug("<")):"EOF"===n.value?E.debug("EOF"):E.warn("Skipping section '%s'",n.value)}else n=i.next()}(),o};var f=o.DxfViewer=function(c){this.init(c)};f.prototype={},f.prototype.constructor=f;var I={LINE:["LINE","POLYLINE","LWPOLYLINE"],CIRCLE:["CIRCLE","ARC"],ELLIPSE:["ELLIPSE"],TEXT:["TEXT","MTEXT"],SOLID:["SOLID"],POINT:["POINT"]};p.defineProperties(f.prototype,{dxf:{get:function(){return this._dxf}}}),f.prototype.init=function(c){var p=this,Q=p.options={};c=c||{},Q.font=c.font||"Standard",Q.textScaleRatio=c.textScaleRatio||1,Q.size=c.size,Q.scale=c.scale,Q.blockSize=c.blockSize||256,Q.filter=c.filter,Q.defaultColor=c.defaultColor||0,Q.edgeLayer=c.edgeLayer,Q.showText=c.showText||!0,Q.mapColor=c.mapColor,Q.circleSegments=c.circleSegments||72,Q.browserMinFontSize=c.browserMinFontSize||8,Q.boundingType=c.boundingType||"Reset",Q.convertArcToBezier=c.convertArcToBezier,!1!==c.sanitize&&(Q.sanitize=c.sanitize||"_")},f.prototype.toShape=function(c){var p=this;p.parseFile(c);var Q,r,i,n=p._dxf.blocks,y=p.sortBlocks(n);p._blockDef={};for(var X=y.length-1;X>=0;X--)r=y[X],i=n[r],i.entities&&(p._blockDef[r]||(Q=p.entitiesToShape(i.entities,i.position,null,!1))&&(Q.flag=i.type,p._blockDef[r]=Q))
;return Q=p.entitiesToShape(p._dxf.entities,null,p.options.size,!0,p.options.scale),Q.sortedBlockName=y,Q.blockDef=p._blockDef,Q.layers=p._dxf.tables.layer.layers,Q},f.prototype.entitiesToShape=function(c,p,Q,r,i){var n=this;n._minFontSize=12,n._bound={xMin:1/0,yMin:1/0,xMax:-1/0,yMax:-1/0},p=p||{x:0,y:0,z:0};var y,X,W,Z=n._models={},o=n._dxf;for(y=0,X=c.length;y<X;y++)W=c[y],n._groupEntity(Z,W,o);if(r)switch(n.options.boundingType){case"Viewport":var l=n._dxfViewport;!l||isNaN(l.x)||isNaN(l.y)||isNaN(l.width)||isNaN(l.height)||(n._bound={xMin:l.x-l.width/2,xMax:l.x+l.width/2,yMin:l.y-l.height/2,yMax:l.y+l.height/2});break;case"Standard":n._bound={xMin:0,xMax:1,yMin:0,yMax:1}}n._shiftX=n._bound.xMin,n._shiftY=n._bound.yMax;var j=n._bound.xMax-n._bound.xMin,E=n._bound.yMax-n._bound.yMin;if(!(j<0||E<0)){if(j=j||1,E=E||1,n._bound.pos=p,i)n._scale=i;else{if(Q){var m=Q/j,f=Q/E;n._scale=Math.min(m,f)}else n._scale=1;n._scale*=Math.max(1,Math.ceil(n.options.browserMinFontSize/n._minFontSize))}n.shapeComps=[],n.drawLine(),n.drawSolid(),n.drawCircle(),n.drawEllipse(),n.options.showText&&n.drawText(),n.drawBlock();var I={width:j*n._scale,height:E*n._scale,comps:n.shapeComps,scale:n._scale,anchorX:-(n._bound.xMin-p.x)/j,anchorY:(n._bound.yMax-p.y)/E,bound:n._bound};return n._calcBoundExtend(I),I}},f.prototype._calcBoundExtend=function(c){var p=1,Q=!1;c.comps.forEach(function(c){p=Math.max(p,c.borderWidth||0),c.borderWidthAbsolute&&(Q=!0)}),c.boundExtend=p,Q&&(c.boundExtendAbsolute=!0)},f.prototype._bulgesAt=function(c,p){return c[p].bulge},f.prototype._isStraightLine=function(c){return!c||Math.abs(c)<1e-6},f.prototype._getDistance=function(c,p){var Q=c.x-p.x,r=c.y-p.y;return Math.sqrt(Q*Q+r*r)},f.prototype._getBulgeSegment=function(c,p,Q){var r=this,i=Q<0,n=4*Math.atan(Q);if(Math.abs(n)>2*Math.PI-1e-6)return[p];var y={x:(c.x+p.x)/2,y:(c.y+p.y)/2},X=r._getDistance(c,p)/2,W=Math.atan2(p.y-c.y,p.x-c.x),Z=Math.abs(X/Math.sin(n/2)),o=Math.abs(Z*Z-X*X),l=Math.sqrt(o);Q>0?W+=Math.PI/2:W-=Math.PI/2,Math.abs(n)>Math.PI&&(l*=-1);var j,W,E=l*Math.cos(W)+y.x,m=l*Math.sin(W)+y.y,f=Math.atan2(c.y-m,c.x-E),I=Math.atan2(p.y-m,p.x-E),G=[];if(j=2*Math.PI/r.options.circleSegments,W=f,i){for(;I>f;)I-=2*Math.PI;for(;W>I;)W-=j,W<I&&(W=I),G.push({x:E+Z*Math.cos(W),y:m+Z*Math.sin(W)})}else{for(;I<f;)I+=2*Math.PI;for(;W<I;)W+=j,W>I&&(W=I),G.push({x:E+Z*Math.cos(W),y:m+Z*Math.sin(W)})}return G},f.prototype.drawLine=function(){var c,p,r,i,n,y,X,W,Z,o,l,j,E,m,f,G,e,P,d,R,t=this,b=t._models;for(c=I.LINE,i=0,n=c.length;i<n;i++){p=c[i],r=b[p];for(W in r)for(Z=r[W],y=0,X=Z.length;y<X;y++)if(o=Z[y],(l=o.vertices)&&l.length){for(f=t.toLocal(l[0].x,1),G=t.toLocal(l[0].y,2),P={type:"shape",cadType:p,cadLayer:o.layer,maybeEdge:o.layer===t.options.edgeLayer,borderColor:W,points:[f,G],segments:[1]},R=Q,o.startWidth?R=(o.startWidth+(o.endWidth?o.endWidth:o.startWidth))/2:o.width&&(R=o.width),R?P.borderWidth=t.toLocal(R):(P.borderWidthAbsolute=!0,P.borderWidth=1),E=1,m=l.length;E<m;E++)j=l[E],e=t._bulgesAt(l,E-1),t._isStraightLine(e)?(P.points.push(t.toLocal(j.x,1),t.toLocal(j.y,2)),P.segments.push(2)):(d=t._getBulgeSegment(l[E-1],j,e),d.forEach(function(c){P.points.push(t.toLocal(c.x,1),t.toLocal(c.y,2)),P.segments.push(2)}));o.shape&&(e=t._bulgesAt(l,l.length-1),t._isStraightLine(e)?P.segments.push(5):(d=t._getBulgeSegment(l[l.length-1],l[0],e),d.forEach(function(c){P.points.push(t.toLocal(c.x,1),t.toLocal(c.y,2)),P.segments.push(2)}))),P.handle=o.handle,t.shapeComps.push(P)}}},f.prototype.drawBlock=function(){var c,p,Q,r,i,n,y,X,W,Z,o,l,j=this,E=j._models.BLOCK;if(E)for(c=0,p=E.length;c<p;c++)Q=E[c],r=Q.block,i=j._blockDef[r],o=Q.transform,n=Math.atan2(o.b,o.a),n===Math.PI||0===n?(W=Math.cos(n),y=o.a/W,X=o.d/W):(Z=Math.sin(n),y=o.b/Z,X=-o.c/Z),l={type:"image",cadType:"block",cadLayer:Q.layer,handle:Q.handle,name:r,rect:[[j.toLocal(o.tx,1),j.toLocal(o.ty,2)],j.toLocal(i.width/i.scale),j.toLocal(i.height/i.scale)],rotation:n},1===y&&1===X||(l.scaleX=y,l.scaleY=X),j.shapeComps.push(l)},f.prototype.drawSolid=function(){var c,p,Q,r,i,n,y,X,W,Z,o,l=this,j=l._models;for(c=I.SOLID,r=0,i=c.length;r<i;r++){p=c[r],Q=j[p];for(X in Q)for(W=Q[X],n=0,y=W.length;n<y;n++)Z=W[n],o=Z.points,l.shapeComps.push({type:"shape",cadType:p,cadLayer:Z.layer,handle:Z.handle,background:X,points:[l.toLocal(o[0].x,1),l.toLocal(o[0].y,2),l.toLocal(o[1].x,1),l.toLocal(o[1].y,2),l.toLocal(o[3].x,1),l.toLocal(o[3].y,2),l.toLocal(o[2].x,1),l.toLocal(o[2].y,2)],segments:[1,2,2,2,5]})}},f.prototype.extrusionZNagative=function(c){var p=c.extrusionDirection;return!!p&&Math.abs(p.z+1)<1e-5},f.prototype.drawCircle=function(){var c,p,Q,r,i,n,y,X,W,Z,o,l,j,E,m,f,G,e,P,d,R=this,t=R._models;for(c=I.CIRCLE,r=0,i=c.length;r<i;r++){p=c[r],Q=t[p];for(X in Q)for(W=Q[X],n=0,y=W.length;n<y;n++){if(Z=W[n],o=Z.startAngle||0,l=Z.angleLength||2*Math.PI,j=o+l,E=R.toLocal(Z.radius),m=Z.addonAngle||0,f=R.toLocal(Z.center.x,1),G=R.toLocal(Z.center.y,2),d=Z.xInvert^R.extrusionZNagative(Z),P=Z.yInvert,P||d?d&&P?(o=Math.PI+o,j=Math.PI+j,e=!1):(o=Math.PI*(d?1:2)-o,j=Math.PI*(d?1:2)-j,e=!0):e=!1,e=!e,o=2*Math.PI-o-m,j=2*Math.PI-j-m,e){var b=o;o=j,j=b}var Y={type:"arc",cadType:p,cadLayer:Z.layer,handle:Z.handle,borderColor:X,borderWidth:1,borderWidthAbsolute:!0,rect:[f-E,G-E,2*E,2*E],arcFrom:o,arcTo:j,arcClose:!1};R.options.convertArcToBezier?R.shapeComps.push(R._convertArcToBezier(Y)):R.shapeComps.push(Y)}}},f.prototype.drawText=function(){var c,p,Q,r,i,n,y,X,W,Z,o,l,j,E,m,f,G,e,P,d,R,t,b,Y,s=this,h=s._models;for(c=I.TEXT,Y=s.options.textScaleRatio,r=0,i=c.length;r<i;r++){p=c[r],Q=h[p];for(X in Q)for(W=Q[X],n=0,y=W.length;n<y;n++)if(Z=W[n],(o=Z.text)&&o.length){if("MTEXT"===p)l=s.toLocal(Z.height||12),j=s.toLocal(Z.position.x,1),E=s.toLocal(Z.position.y,2),d=Z.angle?Z.angle:Z.directionX?Math.atan2(Z.directionY,Z.directionX):0,d+=Z.addonAngle||0,b=1,P=Z.attachmentPoint||1,G=P%3,e=Math.floor(P/3),e=1===e?"middle":0===e?"top":"bottom",f=0===G?"right":2===G?"center":"left";else{l=s.toLocal(Z.textHeight||12);var F=Z.endPoint;F||(F=Z.startPoint),j=F.x,E=F.y,d=Z.rotation||0,b=Z.xScale||1,2===Z.generationFlags?d=2*Math.PI-d:4===Z.generationFlags?d=Math.PI-d:6===Z.generationFlags&&(d=Math.PI+d),j=s.toLocal(j,1),E=s.toLocal(E,2),G=Z.halign,e=Z.valign,f=2===G?"right":1===G?"center":"left",e=3===e?"top":2===e?"middle":"bottom"}E+=l/4;if(d=2*Math.PI-d,m=l*Y+"px "+(Z.font||s.options.font),"MTEXT"===p)for(o=o.replace(/\\{/g,"#@#"),o=o.replace(/\\}/g,"#@@"),o=o.replace(/({|})/g,""),o=o.replace(/#@#/g,"{"),o=o.replace(/#@@/g,"}"),o=o.replace(/\\[FfLIOoKkNXQHWSACT~][^;]*;/g,""),E-=l/6,R=o.split("\\P"),t=0;t<R.length;t++)s.shapeComps.push({type:"text",cadType:p,cadLayer:Z.layer,handle:Z.handle,color:X,text:R[t],rotation:d,rect:[j,E+t*l*1.5,0,0],align:f,vAlign:e,font:m});else s.shapeComps.push({type:"text",cadType:p,cadLayer:Z.layer,handle:Z.handle,color:X,text:o,scaleX:b,rotation:d,rect:[j,E,1e-5,1e-5],align:f,vAlign:e,font:m})}}},f.prototype.drawEllipse=function(){var c,p,Q,r,i,n,y,X,W,Z,o,l,j,E,m,f,G,e,P,d,R,t,b=this,Y=b._models;for(c=I.ELLIPSE,r=0,i=c.length;r<i;r++){p=c[r],Q=Y[p];for(X in Q)for(W=Q[X],n=0,y=W.length;n<y;n++){if(Z=W[n],o=Z.major,l=Math.atan2(o.y,o.x),j=b.toLocal(Math.sqrt(o.x*o.x+o.y*o.y)),E=j*Z.ratio,m=Z.startAngle||0,f=Z.angleLength||2*Math.PI,G=m+f,e=b.toLocal(Z.center.x,1),P=b.toLocal(Z.center.y,2),d=Z.xInvert,R=Z.yInvert^b.extrusionZNagative(Z),R^=1,R||d?d&&R?(m=Math.PI+m,G=Math.PI+G,t=!1):(m=Math.PI*(d?1:2)-m,G=Math.PI*(d?1:2)-G,t=!0):t=!1,t){var s=m;m=G,G=s}l=2*Math.PI-l;var h={type:"arc",cadType:p,cadLayer:Z.layer,handle:Z.handle,borderColor:X,borderWidth:1,borderWidthAbsolute:!0,rotation:l,rect:[e-j,P-E,2*j,2*E],arcFrom:m,arcTo:G,arcClose:!1,arcOval:!0};b.options.convertArcToBezier?b.shapeComps.push(b._convertArcToBezier(h)):b.shapeComps.push(h)}}},f.prototype._convertArcToBezier=function(c){var p=c.arcFrom,Q=c.arcTo;if(p===Q)return c;p>Q&&(Q+=2*Math.PI);var r={type:"shape"},i=c.rect,n="type,rect,arcFrom,arcTo,arcClose,arcOval,rotation".split(",");for(var y in c)n.indexOf(y)>=0||(r[y]=c[y]);var X,W,Z,o,l,j=r.points=[],E=r.segments=[1],m=Q-p,f=Math.max(Math.ceil(Math.abs(m)/Math.PI*2),1),I=m/f,G=Math.tan(.5*I),e=Math.sin(I)*(Math.sqrt(4+3*G*G)-1)/3,P=Math.cos(p),d=Math.sin(p),R=i[2]/2,t=i[3]/2,b=i[0]+R,Y=i[1]+t,s=Math.sin(c.rotation||0),h=Math.cos(c.rotation||0),F=function(c,p){var Q=R*c,r=t*p;return{x:b+(h*Q-s*r),y:Y+(s*Q+h*r)}},B=F(P,d);j.push(B.x,B.y);for(var D=0;D<f;D++)Z=p+(D+1)*I,X=Math.cos(Z),W=Math.sin(Z),B=F(P-d*e,d+P*e),o=F(X+W*e,W-X*e),l=F(X,W),P=X,d=W,j.push(B.x,B.y,o.x,o.y,l.x,l.y),E.push(4);return r},f.prototype._transformPoint=function(c,p,Q){if(c){var r=c.x,i=c.y;return Q=Q||1,{x:r*Q*p.a+i*p.c+p.tx,y:r*Q*p.b+i*p.d+p.ty}}},f.prototype._groupEntity=function(c,p,Q,r,i){var n=this,y=n.getColor(p,Q);if(y&&(!n.options.filter||!n.options.filter(p,i))){var X,W,Z,o=n._transformPoint,l=p.type;if("DIMENSION"===l||"INSERT"===l){if(!p.block)return;var j=Q.blocks[p.block];if(!j||!j.entities)return;if(!(Z=n._blockDef[p.block]))return void console.log("no entity ",p.block);var E=r||{a:1,b:0,c:0,d:1,tx:0,ty:0};if("INSERT"===l){var m=p.scale?p.scale.x:1,f=p.scale?p.scale.y:1,I=0,G=1,e=0;if(p.deg&&(I=p.deg*Math.PI/180,I=2*Math.PI-I,G=Math.cos(I),e=Math.sin(I)),r){var P=m*G,d=m*e,R=-f*e,t=f*G,b=p.center.x,Y=p.center.y;E={a:r.a*P+r.c*d,b:r.b*P+r.d*d,c:r.a*R+r.c*t,d:r.b*R+r.d*t,tx:r.a*b+r.c*Y+r.tx,ty:r.b*b+r.d*Y+r.ty}}else E={a:m*G,b:m*e,c:-f*e,d:f*G,tx:p.center.x,ty:p.center.y}}n.extrusionZNagative(p)&&(E.a*=-1,E.c*=-1,E.tx*=-1);var s=Z.bound,h=(s.pos.x,s.pos.y,o({x:s.xMin,y:s.yMin},E)),F=o({x:s.xMax,y:s.yMax},E),B=o({x:s.xMin,y:s.yMax},E),D=o({x:s.xMax,y:s.yMin},E),U=n._bound;U.xMin=Math.min(U.xMin,h.x,F.x,B.x,D.x),U.yMin=Math.min(U.yMin,h.y,F.y,B.y,D.y),U.xMax=Math.max(U.xMax,h.x,F.x,B.x,D.x),U.yMax=Math.max(U.yMax,h.y,F.y,B.y,D.y);var a;return(a=n._models.BLOCK)||(n._models.BLOCK=a=[]),void a.push({handle:p.handle,block:p.block,transform:E})}(X=c[l])||(X=c[l]={}),(W=X[y])||(W=X[y]=[]);var _=n.extrusionZNagative(p)&&["POINT","LINE","ELLIPSE"].indexOf(l)<0;if(r||_){r||(r={a:1,b:0,c:0,d:1,tx:0,ty:0});var w={};for(var $ in p)w[$]=p[$];w.radius&&(w.radius*=Math.sqrt(r.a*r.a+r.b*r.b)),w.textHeight&&(w.textHeight*=Math.sqrt(r.a*r.a+r.b*r.b));var L=_?-1:1;if(w.position=o(w.position,r,L),w.startPoint=o(w.startPoint,r,L),w.center=o(w.center,r,L),"ELLIPSE"===l){var H;H=o({x:p.major.x+p.center.x,y:p.major.y+p.center.y},r,L),w.major={x:H.x-w.center.x,y:H.y-w.center.y},n.extrusionZNagative(p)&&(w.major.x*=-1)}var O;w.vertices&&(O=[],w.vertices.forEach(function(c){var p=o(c,r,L);c.bulge&&(p.bulge=c.bulge),O.push(p)}),w.vertices=O),w.points&&(O=[],w.points.forEach(function(c){var p=o(c,r,L);c.bulge&&(p.bulge=c.bulge),O.push(p)}),w.points=O);var M=Math.atan2(r.b,r.a),K=Math.cos(M);w.yInvert=r.d*K<0,w.xInvert=r.a*K<0,0!==M&&(w.addonAngle=M),p=w}n.mergeBound(p),W.push(p)}},f.prototype.getPointsBound=function(c){for(var p=1/0,Q=1/0,r=-1/0,i=-1/0,n=0,y=c.length;n<y;n++){var X=c[n];p=Math.min(p,X.x),Q=Math.min(Q,X.y),r=Math.max(r,X.x),i=Math.max(i,X.y)}return{xMin:p,yMin:Q,xMax:r,yMax:i}},f.prototype.mergeBound=function(c){var p,Q,r=this;Q=c.type;for(p in I)if(I[p].indexOf(Q)>=0)break;var i,n,y,X,W,Z,o,l,j,E,m,f,G,e,P,d,R,t,b,Y,s,h=r.getPointsBound;switch(p){case"LINE":for(i=h(c.vertices),Y=c.vertices.length,t=0;t<Y;t++)b=c.vertices[t],r._isStraightLine(b.bulge)||(t!==Y-1||c.shape)&&(s=h(r._getBulgeSegment(b,c.vertices[(t+1)%Y],b.bulge)),i.xMin=Math.min(i.xMin,s.xMin),i.yMin=Math.min(i.yMin,s.yMin),i.xMax=Math.max(i.xMax,s.xMax),i.yMax=Math.max(i.yMax,s.yMax));break;case"SOLID":i=h(c.points);break;case"POINT":if(!c.position)return;n=c.position.x,y=c.position.y,i={xMin:n,yMin:y,xMax:n,yMax:y};break;case"TEXT":if(!c.text||!c.text.length)return;n=c.position?c.position.x:c.startPoint.x,y=c.position?c.position.y:c.startPoint.y,R=c.height||c.textHeight||12,r._minFontSize=Math.min(r._minFontSize,R),i={xMin:n,yMin:y,xMax:n+R*c.text.length,yMax:y+R};break;case"CIRCLE":for(n=c.center.x,y=c.center.y,X=c.radius,W=[],Z=c.startAngle||0,o=Z+(c.angleLength||2*Math.PI),l=c.xInvert^r.extrusionZNagative(c),j=c.yInvert,E=l?-1:1,m=j?-1:1,f=Z;f<o+Math.PI/30;f+=Math.PI/30)f=Math.min(f,o),W.push({x:n+E*X*Math.cos(f),y:y+m*X*Math.sin(f)});i=h(W);break;case"ELLIPSE":for(n=c.center.x,y=c.center.y,W=[],G=Math.sqrt(c.major.x*c.major.x+c.major.y*c.major.y),e=G*c.ratio,X=Math.atan2(c.major.y,c.major.x),P=Math.sin(X),d=Math.cos(X),Z=c.startAngle||0,o=Z+(c.angleLength||2*Math.PI),l=c.xInvert,j=c.yInvert^r.extrusionZNagative(c),E=l?-1:1,m=j?-1:1,f=Z;f<o+Math.PI/30;f+=Math.PI/30){f=Math.min(f,o);var F=E*G*Math.cos(f),B=m*e*Math.sin(f);W.push({x:n+(d*F-P*B),y:y+(P*F+d*B)})}i=h(W);break;default:return}var D=r._bound;D.xMin=Math.min(D.xMin,i.xMin),D.yMin=Math.min(D.yMin,i.yMin),D.xMax=Math.max(D.xMax,i.xMax),D.yMax=Math.max(D.yMax,i.yMax)},f.prototype.parseFile=function(c){var p=this,Q="string"==typeof p.options.sanitize?{sanitize:p.options.sanitize}:null,r=new y(Q),i=r.parseSync(c);p._dxf=i,p._isAc2015="AC1015"===i.header.$ACADVER,p._dxfViewport=p.getCameraParametersFromDxf(i)},f.prototype.toLocal=function(c,p){var Q=this;return(2===p?-(c-Q._shiftY):1===p?c-Q._shiftX:c)*Q._scale},f.prototype.getCameraParametersFromDxf=function(c){var p,Q,r,i,n,y,X,W,Z,o,l,j;if(!p&&c.tables&&c.tables.viewPort){o=c.tables.viewPort.viewPorts;for(Z in o)if(l=o[Z],j=l.viewDirectionFromTarget,l.center&&(0===l.renderMode||j&&0===j.x&&0===j.y&&1===j.z)){r=l.center,i=l.upperRightCorner,n=l.lowerLeftCorner,p={x:i.x,y:i.y},Q={x:n.x,y:n.y},y=l.viewWidth||0,X=l.viewHeight||0,l.viewTarget&&(r={x:r.x+l.viewTarget.x,y:r.y+l.viewTarget.y});break}}return!p&&c.header&&(W=c.header,W.$EXTMIN&&W.$EXTMAX&&(p=W.$EXTMAX,Q=W.$EXTMIN)),y=Math.max(y,p.x-Q.x),X=Math.max(X,p.y-Q.y),r=r||{x:y/2+Q.x,y:X/2+Q.y},{width:y,height:X,x:r.x,y:r.y}},f.prototype.getColor=function(c,p){var r,i=this;if(c||console.log("no entity",c),p.tables&&p.tables.layer&&(r=p.tables.layer.layers[c.layer]),!r||r.visible){var n;c.color!==Q?0===(n=c.color)&&(n=i.options.defaultColor):r&&(n=r.color),n&&16777215!==n||(n=i.options.defaultColor);var n="#"+((1<<24)+n).toString(16).slice(1);return i.options.mapColor&&(n=i.options.mapColor(n)),n}},f.prototype.sortBlocks=function(c){var Q,r,i,n,y=p.keys(c),X={};for(Q in c)if(r=c[Q],r.entities)for(var W=0,Z=r.entities.length;W<Z;W++)i=r.entities[W],"DIMENSION"!==(n=i.type)&&"INSERT"!==n||i.block&&(X[Q]||(X[Q]=[]),X[Q].push(i.block));for(var o=y.length,l=o,j={},E=new Array(o),m=!1,f=function(c,p,Q){if(Q.indexOf(c)>=0)return void(m=!0);if(!j[p]){j[p]=!0;var r=X[c],i=r?r.length:0;if(i){var n=Q.concat(c);do{var W=r[--i];if(f(W,y.indexOf(W),n),m)break}while(i)}E[--o]=c}};l--;)j[l]||f(y[l],l,[]);return m?[]:E};var G=o.DxfWriter=function(c){this.init(c)};G.prototype={},G.prototype.constructor=G,p.defineProperties(G.prototype,{}),G.prototype.init=function(c){var Q=this,r=o.DxfWriter.template;r.converted||(p.keys(r).forEach(function(c){r[c]=r[c].join("\n")}),r.converted=!0),Q._transformFunc=c.transformFunc||function(c){return c},Q._drawingScale=c.scale,Q._matchFunc=c.matchFunc||function(){return!0},Q._maxHandleId=262128},G.prototype.toDxf=function(c,p){var Q=this;return Q.dxfContent=c,Q.gv=p,Q.outputEntityLines=["ENTITIES","  0","ENDSEC"],Q._fetchEntityContent(),Q._collectGvEntity(),Q._insertEntities(),Q._write()},G.prototype._collectGvEntity=function(){var c=this;c.gv.dm().toDatas(c._matchFunc).each(function(p){var Q=p.a("handle");Q&&c._recordMaxHandleId(Q)})},G.prototype._fetchEntityContent=function(){var c=this,p=c.dxfContent,Q=c.entitiesStartIndex=p.indexOf("ENTITIES"),r=c.entitiesEndIndex=p.indexOf("ENDSEC",Q)+"ENDSEC".length;c.entitiesContent=p.slice(Q,r),c.dxfEntityLines=c.entitiesContent.split(/\r\n|\n/)},G.prototype._updateEntities=function(){var c=this,p=c.outputEntityLines,r=c.dxfEntityLines,i=c.gvEntities;p.push(r[0]);for(var n,y,X,W,Z,o,l,j,E,m,f,I,G,e,P=1,d=1e5,R=c._findCode,t=c._toFloat;d--;){if("ENDSEC"===(W=r[P+1].trim())){p.push(r[P]),p.push(r[P+1]);break}for(n=P+2;d--&&"0"!==r[n].trim();)n+=2;if(Z=r[R("5",r,P,n)],c._recordMaxHandleId(Z),o=i[Z]){for(y=p.length,f=P;f<n;f++)p.push(r[f]);if(X=p.length,P=n,"edge"!==o.a("shapeType")){if("image"===o.a("shapeType")){for(l=c._getNodeRealScale(o),E=2*Math.PI-o.getRotation();E>=2*Math.PI;)E-=2*Math.PI;for(;E<0;)E+=2*Math.PI;j=c._transformFunc(o.getPosition()),Math.abs(l.x-1)<1e-5&&Math.abs(l.y+1)<1e-5&&(l.x=-1,l.y=1,E=2*Math.PI-E);var b={};[{key:"10",value:j.x},{key:"20",value:j.y},{key:"42",value:l.y,default:1,before:["50"]},{key:"41",value:l.x,default:1,dependOn:"42",before:["42","50"]},{key:"50",value:180*E/Math.PI,default:0}].forEach(function(c){if(I=c.key,G=c.value,e=c.default!==Q&&Math.abs(G-c.default)<1e-5,G=t(G,"10"===I||"20"===I||"50"===I),m=R(I,p,y,X))G!==p[m].trim()&&(p[m]=G);else{if(e&&(!c.dependOn||b[c.dependOn]))return void(b[I]=!0);var r=!1;do{if(!c.before)break;if(m=Q,c.before.forEach(function(c){var Q=R(c,p,y,X);Q&&(!m||Q<m)&&(m=Q)}),!m)break;p.splice(m-1,0," "+I,G),r=!0}while(!1);r||(p.push(" "+I),p.push(G)),X+=2}})}}else c._tryUpdateEdge(p,y,X,W,o)}else console.log("have no entity with handle "+Z+" "+W),P=n}},G.prototype._recordMaxHandleId=function(c){var p=parseInt("0x"+c),Q=this;Q._maxHandleId=Math.max(Q._maxHandleId,p)},G.prototype._nextHandleId=function(){return(++this._maxHandleId).toString(16).toUpperCase()},G.prototype._getNodeRealScale=function(c){var p=this,Q=c.getScale(),r=c.getSize(),i=o.Default.getImage(c.getImage());return{x:Q.x*r.width*i.scale/(i.width*p._drawingScale),y:Q.y*r.height*i.scale/(i.height*p._drawingScale)}},G.template={INSERT:["  0","INSERT","  5","$HANDLE","330","1F","100","AcDbEntity","  8","0","100","AcDbBlockReference","  2","$BLOCK"," 10","$POSITION.X"," 20","$POSITION.Y"," 30","0.0"," 41","$SCALE.X"," 42","$SCALE.Y"," 50","$ROTATION"]},G.prototype._insertEntities=function(){var c,p=this;p.gv.dm().toDatas(p._matchFunc).each(function(Q){if(c=null,Q.a("addonBlock"))c=p._addonBlock(Q);else if(Q.a("addonText"))c=p._addonText(Q);else if(Q.a("addonARC")&&!Q.s("shape.arc.oval")){var r=Q.s("shape.arc.to"),i=Q.s("shape.arc.from")||0;c=!r||Math.abs(r-i)>=2*Math.PI?p._addonCircle(Q):p._addonARC(Q)}else Q.a("addonARC")&&Q.s("shape.arc.oval")?c=p._addonEllipse(Q):Q.a("addonLine")?c=p._addonLine(Q):Q.a("addonRect")&&(c=p._addonRect(Q));if(c){var n=c.length,y=p.outputEntityLines.length,X=y+n;p.outputEntityLines.length=X,p.outputEntityLines[X-1]=p.outputEntityLines[y-1],p.outputEntityLines[X-2]=p.outputEntityLines[y-2];for(var W=0,Z=y-2;W<n;++W,++Z)p.outputEntityLines[Z]=c[W]}})};var e=function(c){if(c instanceof o.Shape){var p=new o.Matrix,Q=c.getPosition();return p.translate(-Q.x,-Q.y).scale(c.getScaleX(),c.getScaleY()).rotate(c.getRotation()).translate(Q.x,Q.y),p}return c.getMatrix?c.getMatrix():new o.Matrix};G.prototype._addonRect=function(c){var p=this,Q=c.getPoints(),r=c.getSegments(),i=!0;r&&(i=5===r.get(r.size()-1));var n,y=["  0","LWPOLYLINE","  5",c.a("handle")||p._nextHandleId(),"330","1F","100","AcDbEntity","  8","0","100","AcDbPolyline"," 90","        "+Q.size()," 70","     "+(i?1:0)," 43","0.0"],X=p._toFloat,W=e(c);return Q.each(function(c){n=p._transformFunc(W.tf(c)),y.push.apply(y,[" 10",X(n.x,!0)," 20",X(n.y,!0)])}),y},G.prototype._addonCircle=function(c){var p=this,Q=["  0","CIRCLE","  5",c.a("handle")||p._nextHandleId(),"330","1F","100","AcDbEntity","  8","0","100","AcDbCircle"],r=p._toFloat,i=p._transformFunc(c.getPosition());Q.push.apply(Q,[" 10",r(i.x,!0)," 20",r(i.y,!0)," 30","0.0"]);var n=c.getScale(),y=c.getWidth()*n.x,X=c.getHeight()*n.y;return Q.push.apply(Q,[" 40",.5*Math.min(y,X)/p._drawingScale]),Q},G.prototype._addonLine=function(c){var p,Q=this,r=[],i=Q._toFloat,n=c.getPoints(),y=e(c),X=Q._transformFunc(y.tf(n.get(0))),W=c.a("handle")||Q._nextHandleId();return n.each(function(c,n){0!==n&&(r.push.apply(r,["  0","LINE","  5",W,"330","1F","100","AcDbEntity","  8","0","100","AcDbLine"]),r.push.apply(r,[" 10",i(X.x,!0)," 20",i(X.y,!0)," 30","0.0"]),p=Q._transformFunc(y.tf(c)),r.push.apply(r,[" 11",i(p.x,!0)," 21",i(p.y,!0)," 31","0.0"]),X=p,W=Q._nextHandleId())}),r},G.prototype._addonEllipse=function(c){var p=this,Q=["  0","ELLIPSE","  5",c.a("handle")||p._nextHandleId()];Q.push.apply(Q,["330","1F","100","AcDbEntity","  8","0","100","AcDbEllipse"]);var r=p._toFloat,i=p._transformFunc(c.getPosition());Q.push(" 10");Q.push(r(i.x,!0));Q.push(" 20");Q.push(r(i.y,!0)),Q.push.apply(Q,[" 30","0.0"]);var n,y=c.getScale(),X=c.getWidth()*y.x/p._drawingScale,W=c.getHeight()*y.y/p._drawingScale,Z=.5*Math.max(X,W),o=0;X>W?n={x:Z,y:0}:(n={x:0,y:Z},o=.5*-Math.PI);var l=-c.getRotation(),j=Math.sin(l),E=Math.cos(l),m=E*n.x-j*n.y,f=j*n.x+E*n.y;Q.push.apply(Q,[" 11",r(m,!0)," 21",r(f,!0)," 31","0.0"]),Q.push.apply(Q,["210","0.0","220","0.0","230","1.0"]);var I=X/W;I>1&&(I=1/I),Q.push.apply(Q,[" 40",r(I,!0)]);var G=c.s("shape.arc.from"),e=c.s("shape.arc.to"),P=2*Math.PI-e+o,d=(P+e-G)%(2*Math.PI);return Q.push.apply(Q,[" 41",P," 42",d||2*Math.PI]),Q},G.prototype._addonARC=function(c){var p=this,Q=["  0","ARC","  5",c.a("handle")||p._nextHandleId()];Q.push.apply(Q,["330","1F","100","AcDbEntity","  8","0","100","AcDbCircle"]);var r=p._toFloat,i=p._transformFunc(c.getPosition());Q.push(" 10");Q.push(r(i.x,!0));Q.push(" 20");Q.push(r(i.y,!0)),Q.push.apply(Q,[" 30","0.0"]);var n=c.getScale(),y=c.getWidth()*n.x,X=c.getHeight()*n.y,W=.5*Math.min(y,X);Q.push.apply(Q,[" 40",r(W/p._drawingScale,!0)]),Q.push.apply(Q,["100","AcDbArc"]);var Z=c.getRotation(),o=c.s("shape.arc.from"),l=c.s("shape.arc.to"),j=2*Math.PI,E=(j-l-Z)%j,m=(E+l-o)%j;return m=m||2*Math.PI,Q.push.apply(Q,[" 50",r(180*E/Math.PI,!0)," 51",r(180*m/Math.PI,!0)]),Q};var P={left:0,center:1,right:2},d={top:3,middle:2,bottom:1};G.prototype._addonText=function(c){var p=this,Q=["  0","TEXT","  5",c.a("handle")||p._nextHandleId()];Q.push.apply(Q,["330","1F","100","AcDbEntity","  8","0","100","AcDbText"]);var r=c.s("text.font")||"16px Standard",i=c.s("text"),n=o.Default.getTextSize(r,i),y=c.getScale(),X=parseFloat(r)/p._drawingScale*y.y,W=X/n.height*n.width,Z=p._toFloat,l=p._transformFunc(c.getPosition());l.y+=X/4;var j=Q.push(" 10");Q.push(Z(l.x,!0));var E=Q.push(" 20");Q.push(Z(l.y,!0)),Q.push.apply(Q,[" 30","0.0"]),Q.push(" 40"),Q.push(X),Q.push("  1"),Q.push(i);var m=2*Math.PI-c.getRotation();Q.push(" 50"),Q.push(Z(180*m/Math.PI%360,!0)),Q.push(" 41"),Q.push(y.x/y.y),r=r.substr(r.indexOf("px")+3).split(","),Q.push("  7"),Q.push(r[0]);var f=c.s("text.align")||"left",I=c.s("text.vAlign")||"bottom";if("left"!==f&&(Q.push(" 72"),Q.push("     "+P[f])),"bottom"!==I||"left"!==f){Q.push(" 11"),Q.push(Z(l.x,!0)),Q.push(" 21"),Q.push(Z(l.y,!0)),Q.push.apply(Q,[" 31","0.0"]);var G=0,e=0;"center"===f?G=.5*W:"right"===f&&(G=W),G*=y.x,"top"===I?e=X:"middle"===I&&(e=.5*X),e*=y.y;var R=Math.cos(m+Math.PI),t=Math.sin(m+Math.PI);Q[j]=R*G-t*e+l.x,Q[E]=t*G+R*e+l.y}return Q.push.apply(Q,["100","AcDbText"]),"bottom"!==I&&(Q.push(" 73"),Q.push("     "+d[I])),Q},G.prototype._addonBlock=function(c){var p=this,Q=o.DxfWriter.template.INSERT;Q=Q.replace("$HANDLE",c.a("handle")||p._nextHandleId()),Q=Q.replace("$BLOCK",c.getImage());for(var r=p._getNodeRealScale(c),i=2*Math.PI-c.getRotation();i>=2*Math.PI;)i-=2*Math.PI;for(;i<0;)i+=2*Math.PI;var n=p._transformFunc(c.getPosition());Math.abs(r.x-1)<1e-5&&Math.abs(r.y+1)<1e-5&&(r.x=-1,r.y=1,i=2*Math.PI-i);var y=p._toFloat;return Q=Q.replace("$POSITION.X",y(n.x,!0)),Q=Q.replace("$POSITION.Y",y(n.y,!0)),Q=Q.replace("$SCALE.X",y(r.x)),Q=Q.replace("$SCALE.Y",y(r.y)),Q=Q.replace("$ROTATION",y(180*i/Math.PI,!0)),Q.split(/\r\n|\n/)},G.prototype._tryUpdateEdge=function(c,p,Q,r,i){var n=this,y=o.Default.getInternal(),X=y.getEdgeAgentPosition(n.gv,i.getSourceAgent(),i.s("edge.source.position"),i.s("edge.source.offset.x"),i.s("edge.source.offset.y"),i.s("edge.source.anchor.x"),i.s("edge.source.anchor.y")),W=y.getEdgeAgentPosition(n.gv,i.getTargetAgent(),i.s("edge.target.position"),i.s("edge.target.offset.x"),i.s("edge.target.offset.y"),i.s("edge.target.anchor.x"),i.s("edge.target.anchor.y"));X=n._transformFunc(X),W=n._transformFunc(W);var Z=n._findCode;if("LINE"===r)c[Z("10",c,p,Q)]=X.x,c[Z("20",c,p,Q)]=X.y,c[Z("11",c,p,Q)]=W.x,c[Z("21",c,p,Q)]=W.y;else if("LWPOLYLINE"===r){for(var l,j=Z("10",c,p,Q),E=j;l=Z("10",c,E+1,Q);)E=l;E=(l=Z("30",c,E+1,Q))?l:Z("20",c,E+1,Q),c.splice(j-1,E-j+2);var m=[X];i.s("edge.points").each(function(c){m.push(n._transformFunc(c))}),m.push(W);var f=j-1;m.forEach(function(p){c.splice(f,0,"10",p.x,"20",p.y),f+=4})}},G.prototype._findCode=function(c,p,Q,r){for(var i=Q,n=!1;i<r;){if(c===p[i].trim()){n=!0;break}i+=2}if(n)return i+1},G.prototype._toFloat=function(c,p){return p||(c=Math.round(1e8*c)/1e8),c=""+c,c.indexOf(".")<0&&(c+=".0"),c},G.prototype._write=function(){var c=this,p=c.dxfContent,Q=c.outputEntityLines.join("\n"),r=c.entitiesStartIndex,i=c.entitiesEndIndex;return p.slice(0,r)+Q+p.slice(i)}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object),function(c,p,Q){var r=c.ht,i=r.Default;i.getInternal().addMethod(i,{fontToShape:function(c,p,Q){return new r.FontConverter(p).toShape(c,Q)}}),function(p){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=p();else if("function"==typeof define&&define.amd)define([],p);else{var Q;Q=void 0!==c?c:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,Q.opentype=p()}}(function(){return function c(p,Q,r){function i(y,X){if(!Q[y]){if(!p[y]){var W="function"==typeof require&&require;if(!X&&W)return W(y,!0);if(n)return n(y,!0);var Z=new Error("Cannot find module '"+y+"'");throw Z.code="MODULE_NOT_FOUND",Z}var o=Q[y]={exports:{}};p[y][0].call(o.exports,function(c){var Q=p[y][1][c];return i(Q||c)},o,o.exports,c,p,Q,r)}return Q[y].exports}for(var n="function"==typeof require&&require,y=0;y<r.length;y++)i(r[y]);return i}({1:[function(c,p,Q){Q.argument=function(c,p){if(!c)throw new Error(p)},Q.assert=Q.argument},{}],2:[function(c,p,Q){function r(c,p,Q,r,i){c.beginPath(),c.moveTo(p,Q),c.lineTo(r,i),c.stroke()}Q.line=r},{}],3:[function(c,Q,r){function i(c){this.font=c}function n(c){this.cmap=c}function y(c,p){this.encoding=c,this.charset=p}function X(c){var p;switch(c.version){case 1:this.names=r.standardNames.slice();break;case 2:for(this.names=new Array(c.numberOfGlyphs),p=0;p<c.numberOfGlyphs;p++)c.glyphNameIndex[p]<r.standardNames.length?this.names[p]=r.standardNames[c.glyphNameIndex[p]]:this.names[p]=c.names[c.glyphNameIndex[p]-r.standardNames.length];break;case 2.5:for(this.names=new Array(c.numberOfGlyphs),p=0;p<c.numberOfGlyphs;p++)this.names[p]=r.standardNames[p+c.glyphNameIndex[p]];break;case 3:this.names=[]}}function W(c){var Q,r,i,n,y,X;if(c.tables.cmap)for(Q=c.tables.cmap.glyphIndexMap,r=p.keys(Q),i=0;i<r.length;i+=1)n=r[i],y=Q[n],X=c.glyphs[y],X.addUnicode(parseInt(n));for(i=0;i<c.glyphs.length;i+=1)X=c.glyphs[i],c.cffEncoding?X.name=c.cffEncoding.charset[i]:X.name=c.glyphNames.glyphIndexToName(i)}
var Z=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],o=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],l=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],j=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];i.prototype.charToGlyphIndex=function(c){var p,Q,r,i,n;if(p=c.charCodeAt(0),!(Q=this.font.glyphs))return null;for(r=0;r<Q.length;r+=1)for(i=Q[r],n=0;n<i.unicodes.length;n+=1)if(i.unicodes[n]===p)return r},n.prototype.charToGlyphIndex=function(c){return this.cmap.glyphIndexMap[c.charCodeAt(0)]||0},y.prototype.charToGlyphIndex=function(c){var p,Q;return p=c.charCodeAt(0),Q=this.encoding[p],this.charset.indexOf(Q)},X.prototype.nameToGlyphIndex=function(c){return this.names.indexOf(c)},X.prototype.glyphIndexToName=function(c){return this.names[c]},r.cffStandardStrings=Z,r.cffStandardEncoding=o,r.cffExpertEncoding=l,r.standardNames=j,r.DefaultEncoding=i,r.CmapEncoding=n,r.CffEncoding=y,r.GlyphNames=X,r.addGlyphNames=W},{}],4:[function(p,i,n){function y(c){c=c||{},this.familyName=c.familyName||" ",this.styleName=c.styleName||" ",this.designer=c.designer||" ",this.designerURL=c.designerURL||" ",this.manufacturer=c.manufacturer||" ",this.manufacturerURL=c.manufacturerURL||" ",this.license=c.license||" ",this.licenseURL=c.licenseURL||" ",this.version=c.version||"Version 0.1",this.description=c.description||" ",this.copyright=c.copyright||" ",this.trademark=c.trademark||" ",this.unitsPerEm=c.unitsPerEm||1e3,this.supported=!0,this.glyphs=c.glyphs||[],this.encoding=new Z.DefaultEncoding(this),this.tables={}}var X=p("./path"),W=p("./tables/sfnt"),Z=p("./encoding");y.prototype.hasChar=function(c){return null!==this.encoding.charToGlyphIndex(c)},y.prototype.charToGlyphIndex=function(c){return this.encoding.charToGlyphIndex(c)},y.prototype.charToGlyph=function(c){var p,Q;return p=this.charToGlyphIndex(c),Q=this.glyphs[p],Q||(Q=this.glyphs[0]),Q},y.prototype.stringToGlyphs=function(c){var p,Q,r;for(r=[],p=0;p<c.length;p+=1)Q=c[p],r.push(this.charToGlyph(Q));return r},y.prototype.nameToGlyphIndex=function(c){return this.glyphNames.nameToGlyphIndex(c)},y.prototype.nameToGlyph=function(c){var p,Q;return p=this.nametoGlyphIndex(c),Q=this.glyphs[p],Q||(Q=this.glyphs[0]),Q},y.prototype.glyphIndexToName=function(c){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(c):""},y.prototype.getKerningValue=function(c,p){c=c.index||c,p=p.index||p;var Q=this.getGposKerningValue;return Q?Q(c,p):this.kerningPairs[c+","+p]||0},y.prototype.forEachGlyph=function(c,p,r,i,n,y){var X,W,Z,o,l,j;if(this.supported)for(p=p!==Q?p:0,r=r!==Q?r:0,i=i!==Q?i:72,n=n||{},X=n.kerning===Q||n.kerning,W=1/this.unitsPerEm*i,Z=this.stringToGlyphs(c),o=0;o<Z.length;o+=1)l=Z[o],y(l,p,r,i,n),l.advanceWidth&&(p+=l.advanceWidth*W),X&&o<Z.length-1&&(j=this.getKerningValue(l,Z[o+1]),p+=j*W)},y.prototype.getPath=function(c,p,Q,r,i){var n=new X.Path;return this.forEachGlyph(c,p,Q,r,i,function(c,p,Q,r){var i=c.getPath(p,Q,r);n.extend(i)}),n},y.prototype.draw=function(c,p,Q,r,i,n){this.getPath(p,Q,r,i,n).draw(c)},y.prototype.drawPoints=function(c,p,Q,r,i,n){this.forEachGlyph(p,Q,r,i,n,function(p,Q,r,i){p.drawPoints(c,Q,r,i)})},y.prototype.drawMetrics=function(c,p,Q,r,i,n){this.forEachGlyph(p,Q,r,i,n,function(p,Q,r,i){p.drawMetrics(c,Q,r,i)})},y.prototype.validate=function(){function c(c,p){c||Q.push(p)}function p(p){c(r[p]&&r[p].trim().length>0,"No "+p+" specified.")}var Q=[],r=this;p("familyName"),p("weightName"),p("manufacturer"),p("copyright"),p("version"),c(this.unitsPerEm>0,"No unitsPerEm specified.")},y.prototype.toTables=function(){return W.fontToTable(this)},y.prototype.toBuffer=function(){for(var c=this.toTables(),p=c.encode(),Q=new ArrayBuffer(p.length),r=new Uint8Array(Q),i=0;i<p.length;i++)r[i]=p[i];return Q},y.prototype.download=function(){var p=this.familyName.replace(/\s/g,"")+"-"+this.styleName+".otf",Q=this.toBuffer();c.requestFileSystem=c.requestFileSystem||c.webkitRequestFileSystem,c.requestFileSystem(c.TEMPORARY,Q.byteLength,function(c){c.root.getFile(p,{create:!0},function(c){c.createWriter(function(p){var i=new DataView(Q),n=new Blob([i],{type:"font/opentype"});p.write(n),p.addEventListener("writeend",function(){location.href=c.toURL()},r.Default.eventListenerOptionsFalse)})})},function(c){throw c})},n.Font=y},{"./encoding":3,"./path":8,"./tables/sfnt":23}],5:[function(c,p,r){function i(c){this.font=c.font||null,this.index=c.index||0,this.name=c.name||null,this.unicode=c.unicode||Q,this.unicodes=c.unicodes||c.unicode!==Q?[c.unicode]:[],this.xMin=c.xMin||0,this.yMin=c.yMin||0,this.xMax=c.xMax||0,this.yMax=c.yMax||0,this.advanceWidth=c.advanceWidth||0,this.path=c.path||null}var n=c("./check"),y=c("./draw"),X=c("./path");i.prototype.addUnicode=function(c){0===this.unicodes.length&&(this.unicode=c),this.unicodes.push(c)},i.prototype.getPath=function(c,p,r){var i,n,y,W;c=c!==Q?c:0,p=p!==Q?p:0,r=r!==Q?r:72,i=1/this.font.unitsPerEm*r,n=new X.Path,y=this.path.commands;for(var Z=0;Z<y.length;Z+=1)W=y[Z],"M"===W.type?n.moveTo(c+W.x*i,p+-W.y*i):"L"===W.type?n.lineTo(c+W.x*i,p+-W.y*i):"Q"===W.type?n.quadraticCurveTo(c+W.x1*i,p+-W.y1*i,c+W.x*i,p+-W.y*i):"C"===W.type?n.curveTo(c+W.x1*i,p+-W.y1*i,c+W.x2*i,p+-W.y2*i,c+W.x*i,p+-W.y*i):"Z"===W.type&&n.closePath();return n},i.prototype.getContours=function(){var c,p,r,i;if(this.points===Q)return[];for(c=[],p=[],r=0;r<this.points.length;r+=1)i=this.points[r],p.push(i),i.lastPointOfContour&&(c.push(p),p=[]);return n.argument(0===p.length,"There are still points left in the current contour."),c},i.prototype.getMetrics=function(){for(var c=this.path.commands,p=[],Q=[],r=0;r<c.length;r+=1){var i=c[r];"Z"!==i.type&&(p.push(i.x),Q.push(i.y)),"Q"!==i.type&&"C"!==i.type||(p.push(i.x1),Q.push(i.y1)),"C"===i.type&&(p.push(i.x2),Q.push(i.y2))}var n={xMin:Math.min.apply(null,p),yMin:Math.min.apply(null,Q),xMax:Math.max.apply(null,p),yMax:Math.max.apply(null,Q),leftSideBearing:0};return n.rightSideBearing=this.advanceWidth-n.leftSideBearing-(n.xMax-n.xMin),n},i.prototype.draw=function(c,p,Q,r){this.getPath(p,Q,r).draw(c)},i.prototype.drawPoints=function(c,p,r,i){function n(p,Q,r,i){var n,y=2*Math.PI;for(c.beginPath(),n=0;n<p.length;n+=1)c.moveTo(Q+p[n].x*i,r+p[n].y*i),c.arc(Q+p[n].x*i,r+p[n].y*i,2,0,y,!1);c.closePath(),c.fill()}var y,X,W,Z,o,l;for(p=p!==Q?p:0,r=r!==Q?r:0,i=i!==Q?i:24,y=1/this.font.unitsPerEm*i,W=[],Z=[],o=this.path,X=0;X<o.commands.length;X+=1)l=o.commands[X],l.x!==Q&&W.push({x:l.x,y:-l.y}),l.x1!==Q&&Z.push({x:l.x1,y:-l.y1}),l.x2!==Q&&Z.push({x:l.x2,y:-l.y2});c.fillStyle="blue",n(W,p,r,y),c.fillStyle="red",n(Z,p,r,y)},i.prototype.drawMetrics=function(c,p,r,i){var n;p=p!==Q?p:0,r=r!==Q?r:0,i=i!==Q?i:24,n=1/this.font.unitsPerEm*i,c.lineWidth=1,c.strokeStyle="black",y.line(c,p,-1e4,p,1e4),y.line(c,-1e4,r,1e4,r),c.strokeStyle="blue",y.line(c,p+this.xMin*n,-1e4,p+this.xMin*n,1e4),y.line(c,p+this.xMax*n,-1e4,p+this.xMax*n,1e4),y.line(c,-1e4,r+-this.yMin*n,1e4,r+-this.yMin*n),y.line(c,-1e4,r+-this.yMax*n,1e4,r+-this.yMax*n),c.strokeStyle="green",y.line(c,p+this.advanceWidth*n,-1e4,p+this.advanceWidth*n,1e4)},r.Glyph=i},{"./check":1,"./draw":2,"./path":8}],6:[function(p,Q,r){function i(c){var p,Q=new ArrayBuffer(c.length),r=new Uint8Array(Q);for(p=0;p<c.length;p+=1)r[p]=c[p];return Q}function n(c,Q){p("fs").readFile(c,function(c,p){if(c)return Q(c.message);Q(null,i(p))})}function y(c,p){var Q=new XMLHttpRequest;Q.open("get",c,!0),Q.responseType="arraybuffer",Q.onload=function(){return 200!==Q.status?p("Font could not be loaded: "+Q.statusText):p(null,Q.response||Q.responseText)},Q.send()}function X(c){var p,Q,r,i,n,y,X,W,l,E,F,B,D,U,a,_,w,$;if(p=new o.Font,Q=new DataView(c,0),1===(r=j.getFixed(Q,0)))p.outlinesFormat="truetype";else{if("OTTO"!==(r=j.getTag(Q,0)))throw new Error("Unsupported OpenType version "+r);p.outlinesFormat="cff"}for(i=j.getUShort(Q,4),y=12,n=0;n<i;n+=1){switch(X=j.getTag(Q,y),W=j.getULong(Q,y+8),X){case"cmap":p.tables.cmap=m.parse(Q,W),p.encoding=new Z.CmapEncoding(p.tables.cmap),p.encoding||(p.supported=!1);break;case"head":p.tables.head=e.parse(Q,W),p.unitsPerEm=p.tables.head.unitsPerEm,a=p.tables.head.indexToLocFormat;break;case"hhea":p.tables.hhea=P.parse(Q,W),p.ascender=p.tables.hhea.ascender,p.descender=p.tables.hhea.descender,p.numberOfHMetrics=p.tables.hhea.numberOfHMetrics;break;case"hmtx":l=W;break;case"maxp":p.tables.maxp=b.parse(Q,W),p.numGlyphs=_=p.tables.maxp.numGlyphs;break;case"name":p.tables.name=Y.parse(Q,W),p.familyName=p.tables.name.fontFamily,p.styleName=p.tables.name.fontSubfamily;break;case"OS/2":p.tables.os2=s.parse(Q,W);break;case"post":p.tables.post=h.parse(Q,W),p.glyphNames=new Z.GlyphNames(p.tables.post);break;case"glyf":E=W;break;case"loca":F=W;break;case"CFF ":B=W;break;case"kern":D=W;break;case"GPOS":U=W}y+=16}return E&&F?($=0===a,w=t.parse(Q,F,_,$),p.glyphs=I.parse(Q,E,w,p),d.parse(Q,l,p.numberOfHMetrics,p.numGlyphs,p.glyphs),Z.addGlyphNames(p)):B?(f.parse(Q,B,p),Z.addGlyphNames(p)):p.supported=!1,p.supported&&(p.kerningPairs=D?R.parse(Q,D):{},U&&G.parse(Q,U,p)),p}function W(p,Q){(void 0===c?n:y)(p,function(c,p){if(c)return Q(c);var r=X(p);return r.supported?Q(null,r):Q("Font is not supported (is this a Postscript font?)")})}var Z=p("./encoding"),o=p("./font"),l=p("./glyph"),j=p("./parse"),E=p("./path"),m=p("./tables/cmap"),f=p("./tables/cff"),I=p("./tables/glyf"),G=p("./tables/gpos"),e=p("./tables/head"),P=p("./tables/hhea"),d=p("./tables/hmtx"),R=p("./tables/kern"),t=p("./tables/loca"),b=p("./tables/maxp"),Y=p("./tables/name"),s=p("./tables/os2"),h=p("./tables/post");r._parse=j,r.Font=o.Font,r.Glyph=l.Glyph,r.Path=E.Path,r.parse=X,r.load=W},{"./encoding":3,"./font":4,"./glyph":5,"./parse":7,"./path":8,"./tables/cff":10,"./tables/cmap":11,"./tables/glyf":12,"./tables/gpos":13,"./tables/head":14,"./tables/hhea":15,"./tables/hmtx":16,"./tables/kern":17,"./tables/loca":18,"./tables/maxp":19,"./tables/name":20,"./tables/os2":21,"./tables/post":22,fs:Q}],7:[function(c,p,r){function i(c,p){this.data=c,this.offset=p,this.relativeOffset=0}r.getByte=function(c,p){return c.getUint8(p)},r.getCard8=r.getByte,r.getUShort=function(c,p){return c.getUint16(p,!1)},r.getCard16=r.getUShort,r.getShort=function(c,p){return c.getInt16(p,!1)},r.getULong=function(c,p){return c.getUint32(p,!1)},r.getFixed=function(c,p){var Q,r;return Q=c.getInt16(p,!1),r=c.getUint16(p+2,!1),Q+r/65535},r.getTag=function(c,p){var Q,r="";for(Q=p;Q<p+4;Q+=1)r+=String.fromCharCode(c.getInt8(Q));return r},r.getOffset=function(c,p,Q){var r,i;for(i=0,r=0;r<Q;r+=1)i<<=8,i+=c.getUint8(p+r);return i},r.getBytes=function(c,p,Q){var r,i;for(r=[],i=p;i<Q;i+=1)r.push(c.getUint8(i));return r},r.bytesToString=function(c){var p,Q;for(p="",Q=0;Q<c.length;Q+=1)p+=String.fromCharCode(c[Q]);return p};var n={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};i.prototype.parseByte=function(){var c=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,c},i.prototype.parseChar=function(){var c=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,c},i.prototype.parseCard8=i.prototype.parseByte,i.prototype.parseUShort=function(){var c=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,c},i.prototype.parseCard16=i.prototype.parseUShort,i.prototype.parseSID=i.prototype.parseUShort,i.prototype.parseOffset16=i.prototype.parseUShort,i.prototype.parseShort=function(){var c=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,c},i.prototype.parseF2Dot14=function(){var c=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,c},i.prototype.parseULong=function(){var c=r.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,c},i.prototype.parseFixed=function(){var c=r.getFixed(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,c},i.prototype.parseOffset16List=i.prototype.parseUShortList=function(c){for(var p=new Array(c),Q=this.data,i=this.offset+this.relativeOffset,n=0;n<c;n++)p[n]=r.getUShort(Q,i),i+=2;return this.relativeOffset+=2*c,p},i.prototype.parseString=function(c){var p=this.data,Q=this.offset+this.relativeOffset,r="";this.relativeOffset+=c;for(var i=0;i<c;i++)r+=String.fromCharCode(p.getUint8(Q+i));return r},i.prototype.parseTag=function(){return this.parseString(4)},i.prototype.parseLongDateTime=function(){var c=r.getULong(this.data,this.offset+this.relativeOffset+4);return this.relativeOffset+=8,c},i.prototype.parseFixed=function(){var c=r.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,c/65536},i.prototype.parseVersion=function(){var c=r.getUShort(this.data,this.offset+this.relativeOffset),p=r.getUShort(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,c+p/4096/10},i.prototype.skip=function(c,p){p===Q&&(p=1),this.relativeOffset+=n[c]*p},r.Parser=i},{}],8:[function(c,p,r){function i(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}i.prototype.moveTo=function(c,p){this.commands.push({type:"M",x:c,y:p})},i.prototype.lineTo=function(c,p){this.commands.push({type:"L",x:c,y:p})},i.prototype.curveTo=i.prototype.bezierCurveTo=function(c,p,Q,r,i,n){this.commands.push({type:"C",x1:c,y1:p,x2:Q,y2:r,x:i,y:n})},i.prototype.quadTo=i.prototype.quadraticCurveTo=function(c,p,Q,r){this.commands.push({type:"Q",x1:c,y1:p,x:Q,y:r})},i.prototype.close=i.prototype.closePath=function(){this.commands.push({type:"Z"})},i.prototype.extend=function(c){c.commands&&(c=c.commands),Array.prototype.push.apply(this.commands,c)},i.prototype.draw=function(c){var p,Q;for(c.beginPath(),p=0;p<this.commands.length;p+=1)Q=this.commands[p],"M"===Q.type?c.moveTo(Q.x,Q.y):"L"===Q.type?c.lineTo(Q.x,Q.y):"C"===Q.type?c.bezierCurveTo(Q.x1,Q.y1,Q.x2,Q.y2,Q.x,Q.y):"Q"===Q.type?c.quadraticCurveTo(Q.x1,Q.y1,Q.x,Q.y):"Z"===Q.type&&c.closePath();this.fill&&(c.fillStyle=this.fill,c.fill()),this.stroke&&(c.strokeStyle=this.stroke,c.lineWidth=this.strokeWidth,c.stroke())},i.prototype.toPathData=function(c){function p(p){return Math.round(p)===p?""+Math.round(p):p.toFixed(c)}function r(){for(var c="",Q=0;Q<arguments.length;Q+=1){var r=arguments[Q];r>=0&&Q>0&&(c+=" "),c+=p(r)}return c}c=c!==Q?c:2;for(var i="",n=0;n<this.commands.length;n+=1){var y=this.commands[n];"M"===y.type?i+="M"+r(y.x,y.y):"L"===y.type?i+="L"+r(y.x,y.y):"C"===y.type?i+="C"+r(y.x1,y.y1,y.x2,y.y2,y.x,y.y):"Q"===y.type?i+="Q"+r(y.x1,y.y1,y.x,y.y):"Z"===y.type&&(i+="Z")}return i},i.prototype.toSVG=function(c){var p='<path d="';return p+=this.toPathData(c),p+='"',this.fill&"black"!==this.fill&&(null===this.fill?p+=' fill="none"':p+=' fill="'+this.fill+'"'),this.stroke&&(p+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),p+="/>"},r.Path=i},{}],9:[function(c,r,i){function n(c,r,i){var n;for(n=0;n<r.length;n+=1){var y=r[n];this[y.name]=y.value}if(this.tableName=c,this.fields=r,i){var X=p.keys(i);for(n=0;n<X.length;n+=1){var W=X[n],Z=i[W];this[W]!==Q&&(this[W]=Z)}}}var y=c("./check"),X=c("./types").encode,W=c("./types").sizeOf;n.prototype.sizeOf=function(){for(var c=0,p=0;p<this.fields.length;p+=1){var r=this.fields[p],i=this[r.name];if(i===Q&&(i=r.value),"function"==typeof i.sizeOf)c+=i.sizeOf();else{var n=W[r.type];y.assert("function"==typeof n,"Could not find sizeOf function for field"+r.name),c+=n(i)}}return c},n.prototype.encode=function(){return X.TABLE(this)},i.Table=n},{"./check":1,"./types":24}],10:[function(c,p,r){function i(c,p){if(c===p)return!0;if(Array.isArray(c)&&Array.isArray(p)){if(c.length!==p.length)return!1;for(var Q=0;Q<c.length;Q+=1)if(!i(c[Q],p[Q]))return!1;return!0}return!1}function n(c,p,Q){var r,i,n,y,X,W,Z,o,l;if(r=[],i=[],0!==(n=H.getCard16(c,p))){for(X=H.getByte(c,p+2),W=p+(n+1)*X+2,Z=p+3,o=0;o<n+1;o+=1)r.push(H.getOffset(c,Z,X)),Z+=X;y=W+r[n]}else y=p+2;for(o=0;o<r.length-1;o+=1)l=H.getBytes(c,W+r[o],W+r[o+1]),Q&&(l=Q(l)),i.push(l);return{objects:i,startOffset:p,endOffset:y}}function y(c){var p,Q,r,i,n,y;for(p="",Q=15,r=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];(i=c.parseByte(),n=i>>4,y=15&i,n!==Q)&&(p+=r[n],y!==Q);)p+=r[y];return parseFloat(p)}function X(c,p){var Q,r,i,n;if(28===p)return Q=c.parseByte(),r=c.parseByte(),Q<<8|r;if(29===p)return Q=c.parseByte(),r=c.parseByte(),i=c.parseByte(),n=c.parseByte(),Q<<24|r<<16|i<<8|n;if(30===p)return y(c);if(p>=32&&p<=246)return p-139;if(p>=247&&p<=250)return Q=c.parseByte(),256*(p-247)+Q+108;if(p>=251&&p<=254)return Q=c.parseByte(),256*-(p-251)-Q-108;throw new Error("Invalid b0 "+p)}function W(c){var p,Q,r,i,n;for(p={},i=0;i<c.length;i+=1){if(Q=c[i][0],r=c[i][1],n=1===r.length?r[0]:r,p.hasOwnProperty(Q))throw new Error("Object "+p+" already has key "+Q);p[Q]=n}return p}function Z(c,p,r){var i,n,y,Z;for(p=p!==Q?p:0,i=new H.Parser(c,p),n=[],y=[],r=r!==Q?r:c.length;i.relativeOffset<r;)Z=i.parseByte(),Z<=21?(12===Z&&(Z=1200+i.parseByte()),n.push([Z,y]),y=[]):y.push(X(i,Z));return W(n)}function o(c,p){return p=p<=390?$.cffStandardStrings[p]:c[p-391]}function l(c,p,r){var i,n,y,X;for(X={},i=0;i<p.length;i+=1)n=p[i],y=c[n.op],y===Q&&(y=n.value!==Q?n.value:null),"SID"===n.type&&(y=o(r,y)),X[n.name]=y;return X}function j(c,p){var Q={};return Q.formatMajor=H.getCard8(c,p),Q.formatMinor=H.getCard8(c,p+1),Q.size=H.getCard8(c,p+2),Q.offsetSize=H.getCard8(c,p+3),Q.startOffset=p,Q.endOffset=p+4,Q}function E(c,p){var Q;return Q=Z(c,0,c.byteLength),l(Q,K,p)}function m(c,p,Q,r){var i;return i=Z(c,p,Q),l(i,u,r)}function f(c,p,Q,r){var i,n,y,X,W,Z;if(i=new H.Parser(c,p),Q-=1,y=[".notdef"],0===(n=i.parseCard8()))for(X=0;X<Q;X+=1)W=i.parseSID(),y.push(o(r,W));else if(1===n)for(;y.length<=Q;)for(W=i.parseSID(),Z=i.parseCard8(),X=0;X<=Z;X+=1)y.push(o(r,W)),W+=1;else{if(2!==n)throw new Error("Unknown charset format "+n);for(;y.length<=Q;)for(W=i.parseSID(),Z=i.parseCard16(),X=0;X<=Z;X+=1)y.push(o(r,W)),W+=1}return y}function I(c,p,Q){var r,i,n,y,X,W,Z,o,l,j;if(r={},i=new H.Parser(c,p),0===(n=i.parseCard8()))for(y=i.parseCard8(),X=0;X<y;X+=1)W=i.parseCard8(),r[W]=X;else{if(1!==n)throw new Error("Unknown encoding format "+n);for(Z=i.parseCard8(),W=1,X=0;X<Z;X+=1)for(o=i.parseCard8(),l=i.parseCard8(),j=o;j<=o+l;j+=1)r[j]=W,W+=1}return new $.CffEncoding(r,Q)}function G(c,p,Q){function r(c,p){j&&y.closePath(),y.moveTo(c,p),j=!0}function i(){var c;c=W.length%2!=0,c&&!o&&(l=W.shift()+p.nominalWidthX),Z+=W.length>>1,W.length=0,o=!0}function n(c){var X,d,R,t,b,Y,s;for(X=0;X<c.length;)switch(P=c[X],X+=1,P){case 1:case 3:i();break;case 4:W.length>1&&!o&&(l=W.shift()+p.nominalWidthX,o=!0),m+=W.pop(),r(E,m);break;case 5:for(;W.length>0;)E+=W.shift(),m+=W.shift(),y.lineTo(E,m);break;case 6:for(;W.length>0&&(E+=W.shift(),y.lineTo(E,m),0!==W.length);)m+=W.shift(),y.lineTo(E,m);break;case 7:for(;W.length>0&&(m+=W.shift(),y.lineTo(E,m),0!==W.length);)E+=W.shift(),y.lineTo(E,m);break;case 8:for(;W.length>0;)f=E+W.shift(),I=m+W.shift(),G=f+W.shift(),e=I+W.shift(),E=G+W.shift(),m=e+W.shift(),y.curveTo(f,I,G,e,E,m);break;case 10:Y=W.pop()+p.subrsBias,(s=p.subrs[Y])&&n(s);break;case 11:return;case 12:P=c[X],X+=1;var h,F,B,D,U,a;switch(P){case 35:f=E+W.shift(),I=m+W.shift(),G=f+W.shift(),e=I+W.shift(),h=G+W.shift(),F=e+W.shift(),B=h+W.shift(),D=F+W.shift(),U=B+W.shift(),a=D+W.shift(),E=U+W.shift(),m=a+W.shift(),W.shift(),y.curveTo(f,I,G,e,h,F),y.curveTo(B,D,U,a,E,m);break;case 34:f=E+W.shift(),I=m,G=f+W.shift(),e=I+W.shift(),h=G+W.shift(),F=e,B=h+W.shift(),D=e,U=B+W.shift(),a=m,E=U+W.shift(),y.curveTo(f,I,G,e,h,F),y.curveTo(B,D,U,a,E,m);break;case 36:f=E+W.shift(),I=m+W.shift(),G=f+W.shift(),e=I+W.shift(),h=G+W.shift(),F=e,B=h+W.shift(),D=e,U=B+W.shift(),a=D+W.shift(),E=U+W.shift(),y.curveTo(f,I,G,e,h,F),y.curveTo(B,D,U,a,E,m);break;case 37:f=E+W.shift(),I=m+W.shift(),G=f+W.shift(),e=I+W.shift(),h=G+W.shift(),F=e+W.shift(),B=h+W.shift(),D=F+W.shift(),U=B+W.shift(),a=D+W.shift(),Math.abs(U-E)>Math.abs(a-m)?E=U+W.shift():m=a+W.shift(),y.curveTo(f,I,G,e,h,F),y.curveTo(B,D,U,a,E,m);break;default:console.log("Glyph "+Q+": unknown operator 1200"+P),W.length=0}break;case 14:W.length>0&&!o&&(l=W.shift()+p.nominalWidthX,o=!0),j&&(y.closePath(),j=!1);break;case 18:i();break;case 19:case 20:i(),X+=Z+7>>3;break;case 21:W.length>2&&!o&&(l=W.shift()+p.nominalWidthX,o=!0),m+=W.pop(),E+=W.pop(),r(E,m);break;case 22:W.length>1&&!o&&(l=W.shift()+p.nominalWidthX,o=!0),E+=W.pop(),r(E,m);break;case 23:i();break;case 24:for(;W.length>2;)f=E+W.shift(),I=m+W.shift(),G=f+W.shift(),e=I+W.shift(),E=G+W.shift(),m=e+W.shift(),y.curveTo(f,I,G,e,E,m);E+=W.shift(),m+=W.shift(),y.lineTo(E,m);break;case 25:for(;W.length>6;)E+=W.shift(),m+=W.shift(),y.lineTo(E,m);f=E+W.shift(),I=m+W.shift(),G=f+W.shift(),e=I+W.shift(),E=G+W.shift(),m=e+W.shift(),y.curveTo(f,I,G,e,E,m);break;case 26:for(W.length%2&&(E+=W.shift());W.length>0;)f=E,I=m+W.shift(),G=f+W.shift(),e=I+W.shift(),E=G,m=e+W.shift(),y.curveTo(f,I,G,e,E,m);break;case 27:for(W.length%2&&(m+=W.shift());W.length>0;)f=E+W.shift(),I=m,G=f+W.shift(),e=I+W.shift(),E=G+W.shift(),m=e,y.curveTo(f,I,G,e,E,m);break;case 28:d=c[X],R=c[X+1],W.push((d<<24|R<<16)>>16),X+=2;break;case 29:Y=W.pop()+p.gsubrsBias,(s=p.gsubrs[Y])&&n(s);break;case 30:for(;W.length>0&&(f=E,I=m+W.shift(),G=f+W.shift(),e=I+W.shift(),E=G+W.shift(),m=e+(1===W.length?W.shift():0),y.curveTo(f,I,G,e,E,m),0!==W.length);)f=E+W.shift(),I=m,G=f+W.shift(),e=I+W.shift(),m=e+W.shift(),E=G+(1===W.length?W.shift():0),y.curveTo(f,I,G,e,E,m);break;case 31:for(;W.length>0&&(f=E+W.shift(),I=m,G=f+W.shift(),e=I+W.shift(),m=e+W.shift(),E=G+(1===W.length?W.shift():0),y.curveTo(f,I,G,e,E,m),0!==W.length);)f=E,I=m+W.shift(),G=f+W.shift(),e=I+W.shift(),E=G+W.shift(),
m=e+(1===W.length?W.shift():0),y.curveTo(f,I,G,e,E,m);break;default:P<32?console.log("Glyph "+Q+": unknown operator "+P):P<247?W.push(P-139):P<251?(d=c[X],X+=1,W.push(256*(P-247)+d+108)):P<255?(d=c[X],X+=1,W.push(256*-(P-251)-d-108)):(d=c[X],R=c[X+1],t=c[X+2],b=c[X+3],X+=4,W.push((d<<24|R<<16|t<<8|b)/65536))}}var y,X,W,Z,o,l,j,E,m,f,I,G,e,P;return y=new O.Path,W=[],Z=0,o=!1,l=p.defaultWidthX,j=!1,E=m=0,n(c),X=new L.Glyph({font:p,index:Q}),X.path=y,X.advanceWidth=l,X}function e(c){return c.length<1240?107:c.length<33900?1131:32768}function P(c,p,Q){var r,i,y,X,W,Z,o,l,P,d,R,t,b,Y;Q.tables.cff={},r=j(c,p),i=n(c,r.endOffset,H.bytesToString),y=n(c,i.endOffset),X=n(c,y.endOffset,H.bytesToString),W=n(c,X.endOffset),Q.gsubrs=W.objects,Q.gsubrsBias=e(Q.gsubrs);var s=new DataView(new Uint8Array(y.objects[0]).buffer);for(Z=E(s,X.objects),Q.tables.cff.topDict=Z,o=p+Z.private[1],l=m(c,o,Z.private[0],X.objects),Q.defaultWidthX=l.defaultWidthX,Q.nominalWidthX=l.nominalWidthX,0!==l.subrs?(P=o+l.subrs,d=n(c,P),Q.subrs=d.objects,Q.subrsBias=e(Q.subrs)):(Q.subrs=[],Q.subrsBias=0),t=n(c,p+Z.charStrings),Q.nGlyphs=t.objects.length,b=f(c,p+Z.charset,Q.nGlyphs,X.objects),0===Z.encoding?Q.cffEncoding=new $.CffEncoding($.cffStandardEncoding,b):1===Z.encoding?Q.cffEncoding=new $.CffEncoding($.cffExpertEncoding,b):Q.cffEncoding=I(c,p+Z.encoding,b),Q.encoding=Q.encoding||Q.cffEncoding,Q.glyphs=[],Y=0;Y<Q.nGlyphs;Y+=1)R=t.objects[Y],Q.glyphs.push(G(R,Q,Y))}function d(c,p){var Q,r;return Q=$.cffStandardStrings.indexOf(c),Q>=0&&(r=Q),Q=p.indexOf(c),Q>=0?r=Q+$.cffStandardStrings.length:(r=$.cffStandardStrings.length+p.length,p.push(c)),r}function R(){return new M.Table("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function t(c){var p=new M.Table("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);p.names=[];for(var Q=0;Q<c.length;Q+=1)p.names.push({name:"name_"+Q,type:"NAME",value:c[Q]});return p}function b(c,p,r){var n,y,X,W={};for(n=0;n<c.length;n+=1)y=c[n],(X=p[y.name])===Q||i(X,y.value)||("SID"===y.type&&(X=d(X,r)),W[y.op]={name:y.name,type:y.type,value:X});return W}function Y(c,p){var Q=new M.Table("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return Q.dict=b(K,c,p),Q}function s(c){var p=new M.Table("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return p.topDicts=[{name:"topDict_0",type:"TABLE",value:c}],p}function h(c){var p=new M.Table("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);p.strings=[];for(var Q=0;Q<c.length;Q+=1)p.strings.push({name:"string_"+Q,type:"STRING",value:c[Q]});return p}function F(){return new M.Table("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function B(c,p){for(var Q=new M.Table("Charsets",[{name:"format",type:"Card8",value:0}]),r=0;r<c.length;r+=1){var i=c[r],n=d(i,p);Q.fields.push({name:"glyph_"+r,type:"SID",value:n})}return Q}function D(c){var p,Q,r,i,n,y,X,W,Z,o,l=[],j=c.path;for(l.push({name:"width",type:"NUMBER",value:c.advanceWidth}),p=0,Q=0,r=0;r<j.commands.length;r+=1)i=j.commands[r],"Q"===i.type&&(i={type:"C",x:i.x,y:i.y,x1:1/3*p+2/3*i.x1,y1:1/3*Q+2/3*i.y1,x2:1/3*i.x+2/3*i.x1,y2:1/3*i.y+2/3*i.y1}),"M"===i.type?(n=Math.round(i.x-p),y=Math.round(i.y-Q),l.push({name:"dx",type:"NUMBER",value:n}),l.push({name:"dy",type:"NUMBER",value:y}),l.push({name:"rmoveto",type:"OP",value:21}),p=Math.round(i.x),Q=Math.round(i.y)):"L"===i.type?(n=Math.round(i.x-p),y=Math.round(i.y-Q),l.push({name:"dx",type:"NUMBER",value:n}),l.push({name:"dy",type:"NUMBER",value:y}),l.push({name:"rlineto",type:"OP",value:5}),p=Math.round(i.x),Q=Math.round(i.y)):"C"===i.type?(X=Math.round(i.x1-p),W=Math.round(i.y1-Q),Z=Math.round(i.x2-i.x1),o=Math.round(i.y2-i.y1),n=Math.round(i.x-i.x2),y=Math.round(i.y-i.y2),l.push({name:"dx1",type:"NUMBER",value:X}),l.push({name:"dy1",type:"NUMBER",value:W}),l.push({name:"dx2",type:"NUMBER",value:Z}),l.push({name:"dy2",type:"NUMBER",value:o}),l.push({name:"dx",type:"NUMBER",value:n}),l.push({name:"dy",type:"NUMBER",value:y}),l.push({name:"rrcurveto",type:"OP",value:8}),p=Math.round(i.x),Q=Math.round(i.y)):i.type;return l.push({name:"endchar",type:"OP",value:14}),l}function U(c){for(var p=new M.Table("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),Q=0;Q<c.length;Q+=1){var r=c[Q],i=D(r);p.charStrings.push({name:r.name,type:"CHARSTRING",value:i})}return p}function a(c,p){var Q=new M.Table("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return Q.dict=b(u,c,p),Q}function _(c){var p=new M.Table("Private DICT INDEX",[{name:"privateDicts",type:"INDEX",value:[]}]);return p.privateDicts=[{name:"privateDict_0",type:"TABLE",value:c}],p}function w(c,p){var Q=new M.Table("CFF ",[{name:"header",type:"TABLE"},{name:"nameIndex",type:"TABLE"},{name:"topDictIndex",type:"TABLE"},{name:"stringIndex",type:"TABLE"},{name:"globalSubrIndex",type:"TABLE"},{name:"charsets",type:"TABLE"},{name:"charStringsIndex",type:"TABLE"},{name:"privateDictIndex",type:"TABLE"}]),r={version:p.version,fullName:p.fullName,familyName:p.familyName,weight:p.weightName,charset:999,encoding:0,charStrings:999};r.private=[0,999];for(var i={},n=[],y=1;y<c.length;y+=1)n.push(c[y].name);var X=[];Q.header=R(),Q.nameIndex=t([p.postScriptName]);var W=Y(r,X);Q.topDictIndex=s(W),Q.globalSubrIndex=F(),Q.charsets=B(n,X),Q.charStringsIndex=U(c);var Z=a(i,X);Q.privateDictIndex=_(Z),Q.stringIndex=h(X);var o=Q.header.sizeOf()+Q.nameIndex.sizeOf()+Q.topDictIndex.sizeOf()+Q.stringIndex.sizeOf()+Q.globalSubrIndex.sizeOf();return r.charset=o,r.encoding=0,r.charStrings=r.charset+Q.charsets.sizeOf(),r.private[1]=r.charStrings+Q.charStringsIndex.sizeOf(),W=Y(r,X),Q.topDictIndex=s(W),Q}var $=c("../encoding"),L=c("../glyph"),H=c("../parse"),O=c("../path"),M=c("../table"),K=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]}],u=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];r.parse=P,r.make=w},{"../encoding":3,"../glyph":5,"../parse":7,"../path":8,"../table":9}],11:[function(c,p,r){function i(c,p){var Q,r,i,n,y,X,o,l,j,E,m,f,I,G,e,P,d,R,t,b,Y={};for(Y.version=Q=Z.getUShort(c,p),W.argument(0===Q,"cmap table version should be 0."),Y.numtables=r=Z.getUShort(c,p+2),i=-1,e=0;e<r;e+=1)if(n=Z.getUShort(c,p+4+8*e),y=Z.getUShort(c,p+4+8*e+2),3===n&&(1===y||0===y)){i=Z.getULong(c,p+4+8*e+4);break}if(-1===i)return null;for(t=new Z.Parser(c,p+i),Y.format=X=t.parseUShort(),W.argument(4===X,"Only format 4 cmap tables are supported."),Y.length=t.parseUShort(),Y.language=t.parseUShort(),Y.segCount=o=t.parseUShort()>>1,t.skip("uShort",3),Y.glyphIndexMap={},l=new Z.Parser(c,p+i+14),j=new Z.Parser(c,p+i+16+2*o),E=new Z.Parser(c,p+i+16+4*o),m=new Z.Parser(c,p+i+16+6*o),f=p+i+16+8*o,e=0;e<o-1;e+=1)for(I=l.parseUShort(),G=j.parseUShort(),d=E.parseShort(),R=m.parseUShort(),P=G;P<=I;P+=1)0!==R?(f=m.offset+m.relativeOffset-2,f+=R,f+=2*(P-G),0!==(b=Z.getUShort(c,f))&&(b=b+d&65535)):b=P+d&65535,Y.glyphIndexMap[P]=b;return Y}function n(c,p,Q){c.segments.push({end:p,start:p,delta:-(p-Q),offset:0})}function y(c){c.segments.push({end:65535,start:65535,delta:1,offset:0})}function X(c){var p,r,i,X=new o.Table("cmap",[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:1},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:12},{name:"format",type:"USHORT",value:4},{name:"length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);for(X.segments=[],p=0;p<c.length;p+=1){for(i=c[p],r=0;r<i.unicodes.length;r+=1)n(X,i.unicodes[r],p);X.segments=X.segments.sort(function(c,p){return c.start-p.start})}y(X);var W;W=X.segments.length,X.segCountX2=2*W,X.searchRange=2*Math.pow(2,Math.floor(Math.log(W)/Math.log(2))),X.entrySelector=Math.log(X.searchRange/2)/Math.log(2),X.rangeShift=X.segCountX2-X.searchRange;var Z=[],l=[],j=[],E=[],m=[];for(p=0;p<W;p+=1){var f=X.segments[p];Z=Z.concat({name:"end_"+p,type:"USHORT",value:f.end}),l=l.concat({name:"start_"+p,type:"USHORT",value:f.start}),j=j.concat({name:"idDelta_"+p,type:"SHORT",value:f.delta}),E=E.concat({name:"idRangeOffset_"+p,type:"USHORT",value:f.offset}),f.glyphId!==Q&&(m=m.concat({name:"glyph_"+p,type:"USHORT",value:f.glyphId}))}return X.fields=X.fields.concat(Z),X.fields.push({name:"reservedPad",type:"USHORT",value:0}),X.fields=X.fields.concat(l),X.fields=X.fields.concat(j),X.fields=X.fields.concat(E),X.fields=X.fields.concat(m),X.length=14+2*Z.length+2+2*l.length+2*j.length+2*E.length+2*m.length,X}var W=c("../check"),Z=c("../parse"),o=c("../table");r.parse=i,r.make=X},{"../check":1,"../parse":7,"../table":9}],12:[function(c,p,Q){function r(c,p,Q,r,i){var n;return(p&r)>0?(n=c.parseByte(),0==(p&i)&&(n=-n),n=Q+n):n=(p&i)>0?Q:Q+c.parseShort(),n}function i(c,p,Q,i){var n,y,X,W,j,E,m,f,I,G,e,P,d,R,t;if(n=new l.Parser(c,p),y=new o.Glyph({font:i,index:Q}),y.numberOfContours=n.parseShort(),y.xMin=n.parseShort(),y.yMin=n.parseShort(),y.xMax=n.parseShort(),y.yMax=n.parseShort(),y.numberOfContours>0){for(m=y.endPointIndices=[],W=0;W<y.numberOfContours;W+=1)m.push(n.parseUShort());for(y.instructionLength=n.parseUShort(),y.instructions=[],W=0;W<y.instructionLength;W+=1)y.instructions.push(n.parseByte());for(f=m[m.length-1]+1,E=[],W=0;W<f;W+=1)if(X=n.parseByte(),E.push(X),(8&X)>0)for(I=n.parseByte(),j=0;j<I;j+=1)E.push(X),W+=1;if(Z.argument(E.length===f,"Bad flags."),m.length>0){if(G=[],f>0){for(W=0;W<f;W+=1)X=E[W],e={},e.onCurve=!!(1&X),e.lastPointOfContour=m.indexOf(W)>=0,G.push(e);for(P=0,W=0;W<f;W+=1)X=E[W],e=G[W],e.x=r(n,X,P,2,16),P=e.x;for(d=0,W=0;W<f;W+=1)X=E[W],e=G[W],e.y=r(n,X,d,4,32),d=e.y}y.points=G}else y.points=[]}else if(0===y.numberOfContours)y.points=[];else for(y.isComposite=!0,y.points=[],y.components=[],t=!0;t;)E=n.parseUShort(),R={glyphIndex:n.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0},(1&E)>0?(R.dx=n.parseShort(),R.dy=n.parseShort()):(R.dx=n.parseChar(),R.dy=n.parseChar()),(8&E)>0?R.xScale=R.yScale=n.parseF2Dot14():(64&E)>0?(R.xScale=n.parseF2Dot14(),R.yScale=n.parseF2Dot14()):(128&E)>0&&(R.xScale=n.parseF2Dot14(),R.scale01=n.parseF2Dot14(),R.scale10=n.parseF2Dot14(),R.yScale=n.parseF2Dot14()),y.components.push(R),t=!!(32&E);return y}function n(c,p){var Q,r,i,n;for(Q=[],r=0;r<c.length;r+=1)i=c[r],n={x:p.xScale*i.x+p.scale01*i.y+p.dx,y:p.scale10*i.x+p.yScale*i.y+p.dy,onCurve:i.onCurve,lastPointOfContour:i.lastPointOfContour},Q.push(n);return Q}function y(c){var p,Q,r,i;for(p=[],Q=[],r=0;r<c.length;r+=1)i=c[r],Q.push(i),i.lastPointOfContour&&(p.push(Q),Q=[]);return Z.argument(0===Q.length,"There are still points left in the current contour."),p}function X(c){var p,Q,r,i,n,X,W,Z,o,l,E,m;if(p=new j.Path,!c)return p;for(Q=y(c),r=0;r<Q.length;r+=1){for(X=Q[r],Z=X[0],m=X[X.length-1],Z.onCurve?(E=null,i=!0):(Z=m.onCurve?m:{x:(Z.x+m.x)/2,y:(Z.y+m.y)/2},E=Z,i=!1),p.moveTo(Z.x,Z.y),n=i?1:0;n<X.length;n+=1)if(W=X[n],o=0===n?Z:X[n-1],o.onCurve&&W.onCurve)p.lineTo(W.x,W.y);else if(o.onCurve&&!W.onCurve)E=W;else if(o.onCurve||W.onCurve){if(o.onCurve||!W.onCurve)throw new Error("Invalid state.");p.quadraticCurveTo(E.x,E.y,W.x,W.y),E=null}else l={x:(o.x+W.x)/2,y:(o.y+W.y)/2},p.quadraticCurveTo(o.x,o.y,l.x,l.y),E=W;Z!==m&&(E?p.quadraticCurveTo(E.x,E.y,Z.x,Z.y):p.lineTo(Z.x,Z.y))}return p.closePath(),p}function W(c,p,Q,r){var y,W,Z,l,j,E,m,f,I;for(y=[],W=0;W<Q.length-1;W+=1)l=Q[W],j=Q[W+1],l!==j?y.push(i(c,p+l,W,r)):y.push(new o.Glyph({font:r,index:W}));for(W=0;W<y.length;W+=1){if(E=y[W],E.isComposite)for(Z=0;Z<E.components.length;Z+=1)m=E.components[Z],f=y[m.glyphIndex],f.points&&(I=n(f.points,m),E.points=E.points.concat(I));E.path=X(E.points)}return y}var Z=c("../check"),o=c("../glyph"),l=c("../parse"),j=c("../path");Q.parse=W},{"../check":1,"../glyph":5,"../parse":7,"../path":8}],13:[function(c,p,r){function i(c,p){for(var Q=new l.Parser(c,p),r=Q.parseUShort(),i=[],n=0;n<r;n++)i[Q.parseTag()]={offset:Q.parseUShort()};return i}function n(c,p){var Q=new l.Parser(c,p),r=Q.parseUShort(),i=Q.parseUShort();if(1===r)return Q.parseUShortList(i);if(2===r){for(var n,y,X,W,Z=[];i--;)for(y=Q.parseUShort(),X=Q.parseUShort(),W=Q.parseUShort(),n=y;n<=X;n++)Z[W++]=n;return Z}}function y(c,p){var Q=new l.Parser(c,p),r=Q.parseUShort();if(1===r){var i=Q.parseUShort(),n=Q.parseUShort(),y=Q.parseUShortList(n);return function(c){return y[c-i]||0}}if(2===r){for(var X=Q.parseUShort(),W=[],Z=[],o=[],j=0;j<X;j++)W[j]=Q.parseUShort(),Z[j]=Q.parseUShort(),o[j]=Q.parseUShort();return function(c){var p,Q,r;for(p=0,r=W.length-1;p<r;)Q=p+r+1>>1,c<W[Q]?r=Q-1:p=Q;return W[p]<=c&&c<=Z[p]?o[p]||0:0}}}function X(c,p){var Q,r,i,X,W,Z,o,j,E,m=new l.Parser(c,p);if(Q=m.parseUShort(),r=m.parseUShort(),i=n(c,p+r),X=m.parseUShort(),W=m.parseUShort(),4===X&&0===W){if(Z={},1===Q){var f,I,G,e,P,d;for(f=m.parseUShort(),d=[],I=m.parseOffset16List(f),o=0;o<f;o++){if(G=I[o],!(e=Z[G]))for(e={},m.relativeOffset=G,P=m.parseUShort();P--;)j=m.parseUShort(),X&&(E=m.parseShort()),W&&m.parseShort(),e[j]=E;d[i[o]]=e}return function(c,p){var Q=d[c];if(Q)return Q[p]}}if(2===Q){var R,t,b,Y,s,h,F,B,D,U,a;for(R=m.parseUShort(),t=m.parseUShort(),b=m.parseUShort(),Y=m.parseUShort(),F=y(c,p+R),B=y(c,p+t),D=[],s=0;s<b;s++)for(U=D[s]=[],h=0;h<Y;h++)X&&(E=m.parseShort()),W&&m.parseShort(),U[h]=E;for(a={},s=0;s<i.length;s++)a[i[s]]=1;return function(c,p){if(a[c]){var Q=F(c),r=B(p),i=D[Q];return i?i[r]:void 0}}}}}function W(c,p){var r,i,n,y,W,Z,o,j,E=new l.Parser(c,p);if(i=E.parseUShort(),n=E.parseUShort(),y=16&n,W=E.parseUShort(),Z=E.parseOffset16List(W),r={lookupType:i,lookupFlag:n,markFilteringSet:y?E.parseUShort():-1},2===i){for(o=[],j=0;j<W;j++)o.push(X(c,p+Z[j]));r.getKerningValue=function(c,p){for(var r=o.length;r--;){var i=o[r](c,p);if(i!==Q)return i}return 0}}return r}function Z(c,p,Q){var r,n,y,X,Z,j,E,m;for(r=new l.Parser(c,p),n=r.parseFixed(),o.argument(1===n,"Unsupported GPOS table version."),i(c,p+r.parseUShort()),i(c,p+r.parseUShort()),y=r.parseUShort(),r.relativeOffset=y,Z=r.parseUShort(),j=r.parseOffset16List(Z),E=p+y,X=0;X<Z;X++)m=W(c,E+j[X]),2!==m.lookupType||Q.getGposKerningValue||(Q.getGposKerningValue=m.getKerningValue)}var o=c("../check"),l=c("../parse");r.parse=Z},{"../check":1,"../parse":7}],14:[function(c,p,Q){function r(c,p){var Q={},r=new y.Parser(c,p);return Q.version=r.parseVersion(),Q.fontRevision=Math.round(1e3*r.parseFixed())/1e3,Q.checkSumAdjustment=r.parseULong(),Q.magicNumber=r.parseULong(),n.argument(1594834165===Q.magicNumber,"Font header has wrong magic number."),Q.flags=r.parseUShort(),Q.unitsPerEm=r.parseUShort(),Q.created=r.parseLongDateTime(),Q.modified=r.parseLongDateTime(),Q.xMin=r.parseShort(),Q.yMin=r.parseShort(),Q.xMax=r.parseShort(),Q.yMax=r.parseShort(),Q.macStyle=r.parseUShort(),Q.lowestRecPPEM=r.parseUShort(),Q.fontDirectionHint=r.parseShort(),Q.indexToLocFormat=r.parseShort(),Q.glyphDataFormat=r.parseShort(),Q}function i(c){return new X.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:0},{name:"modified",type:"LONGDATETIME",value:0},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],c)}var n=c("../check"),y=c("../parse"),X=c("../table");Q.parse=r,Q.make=i},{"../check":1,"../parse":7,"../table":9}],15:[function(c,p,Q){function r(c,p){var Q={},r=new n.Parser(c,p);return Q.version=r.parseVersion(),Q.ascender=r.parseShort(),Q.descender=r.parseShort(),Q.lineGap=r.parseShort(),Q.advanceWidthMax=r.parseUShort(),Q.minLeftSideBearing=r.parseShort(),Q.minRightSideBearing=r.parseShort(),Q.xMaxExtent=r.parseShort(),Q.caretSlopeRise=r.parseShort(),Q.caretSlopeRun=r.parseShort(),Q.caretOffset=r.parseShort(),r.relativeOffset+=8,Q.metricDataFormat=r.parseShort(),Q.numberOfHMetrics=r.parseUShort(),Q}function i(c){return new y.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],c)}var n=c("../parse"),y=c("../table");Q.parse=r,Q.make=i},{"../parse":7,"../table":9}],16:[function(c,p,Q){function r(c,p,Q,r,i){var y,X,W,Z,o;for(y=new n.Parser(c,p),X=0;X<r;X+=1)X<Q&&(Z=y.parseUShort(),o=y.parseShort()),W=i[X],W.advanceWidth=Z,W.leftSideBearing=o}function i(c){for(var p=new y.Table("hmtx",[]),Q=0;Q<c.length;Q+=1){var r=c[Q],i=r.advanceWidth||0,n=r.leftSideBearing||0;p.fields.push({name:"advanceWidth_"+Q,type:"USHORT",value:i}),p.fields.push({name:"leftSideBearing_"+Q,type:"SHORT",value:n})}return p}var n=c("../parse"),y=c("../table");Q.parse=r,Q.make=i},{"../parse":7,"../table":9}],17:[function(c,p,Q){function r(c,p){var Q,r,y,X,W,Z,o,l,j;for(Q={},r=new n.Parser(c,p),y=r.parseUShort(),i.argument(0===y,"Unsupported kern table version."),r.skip("uShort",1),X=r.parseUShort(),i.argument(0===X,"Unsupported kern sub-table version."),r.skip("uShort",2),W=r.parseUShort(),r.skip("uShort",3),Z=0;Z<W;Z+=1)o=r.parseUShort(),l=r.parseUShort(),j=r.parseShort(),Q[o+","+l]=j;return Q}var i=c("../check"),n=c("../parse");Q.parse=r},{"../check":1,"../parse":7}],18:[function(c,p,Q){function r(c,p,Q,r){var n,y,X,W,Z;for(n=new i.Parser(c,p),y=r?n.parseUShort:n.parseULong,X=[],Z=0;Z<Q+1;Z+=1)W=y.call(n),r&&(W*=2),X.push(W);return X}var i=c("../parse");Q.parse=r},{"../parse":7}],19:[function(c,p,Q){function r(c,p){var Q={},r=new n.Parser(c,p);return Q.version=r.parseVersion(),Q.numGlyphs=r.parseUShort(),1===Q.version&&(Q.maxPoints=r.parseUShort(),Q.maxContours=r.parseUShort(),Q.maxCompositePoints=r.parseUShort(),Q.maxCompositeContours=r.parseUShort(),Q.maxZones=r.parseUShort(),Q.maxTwilightPoints=r.parseUShort(),Q.maxStorage=r.parseUShort(),Q.maxFunctionDefs=r.parseUShort(),Q.maxInstructionDefs=r.parseUShort(),Q.maxStackElements=r.parseUShort(),Q.maxSizeOfInstructions=r.parseUShort(),Q.maxComponentElements=r.parseUShort(),Q.maxComponentDepth=r.parseUShort()),Q}function i(c){return new y.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:c}])}var n=c("../parse"),y=c("../table");Q.parse=r,Q.make=i},{"../parse":7,"../table":9}],20:[function(c,p,r){function i(c,p){var Q={},r=new o.Parser(c,p);Q.format=r.parseUShort();var i,n,y,X,W,Z,l,E,m,f,I,G=r.parseUShort(),e=r.offset+r.parseUShort(),P=0;for(m=0;m<G;m++)if(i=r.parseUShort(),n=r.parseUShort(),y=r.parseUShort(),X=r.parseUShort(),W=j[X],Z=r.parseUShort(),l=r.parseUShort(),3===i&&1===n&&1033===y){I=[];var d=Z/2;for(f=0;f<d;f++,l+=2)I[f]=o.getShort(c,e+l);E=String.fromCharCode.apply(null,I),W?Q[W]=E:(P++,Q["unknown"+P]=E)}return 1===Q.format&&(Q.langTagCount=r.parseUShort()),Q}function n(c,p,Q,r,i,n){return new l.Table("NameRecord",[{name:"platformID",type:"USHORT",value:c},{name:"encodingID",type:"USHORT",value:p},{name:"languageID",type:"USHORT",value:Q},{name:"nameID",type:"USHORT",value:r},{name:"length",type:"USHORT",value:i},{name:"offset",type:"USHORT",value:n}])}function y(c,p,Q,r){var i=Z.STRING(Q);return c.records.push(n(1,0,0,p,i.length,r)),c.strings.push(i),r+=i.length}function X(c,p,Q,r){var i=Z.UTF16(Q);return c.records.push(n(3,1,1033,p,i.length,r)),c.strings.push(i),r+=i.length}function W(c){var p,r,i=new l.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:0},{name:"stringOffset",type:"USHORT",value:0}]);i.records=[],i.strings=[];var n=0;for(p=0;p<j.length;p+=1)c[j[p]]!==Q&&(r=c[j[p]],n=y(i,p,r,n));for(p=0;p<j.length;p+=1)c[j[p]]!==Q&&(r=c[j[p]],n=X(i,p,r,n));for(i.count=i.records.length,i.stringOffset=6+12*i.count,p=0;p<i.records.length;p+=1)i.fields.push({name:"record_"+p,type:"TABLE",value:i.records[p]});for(p=0;p<i.strings.length;p+=1)i.fields.push({name:"string_"+p,type:"LITERAL",value:i.strings[p]});return i}var Z=c("../types").encode,o=c("../parse"),l=c("../table"),j=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","licence","licenceURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"];r.parse=i,r.make=W},{"../parse":7,"../table":9,"../types":24}],21:[function(c,p,Q){function r(c){for(var p=0;p<W.length;p+=1){var Q=W[p];if(c>=Q.begin&&c<Q.end)return p}return-1}function i(c,p){var Q={},r=new y.Parser(c,p);Q.version=r.parseUShort(),Q.xAvgCharWidth=r.parseShort(),Q.usWeightClass=r.parseUShort(),Q.usWidthClass=r.parseUShort(),Q.fsType=r.parseUShort(),Q.ySubscriptXSize=r.parseShort(),Q.ySubscriptYSize=r.parseShort(),Q.ySubscriptXOffset=r.parseShort(),Q.ySubscriptYOffset=r.parseShort(),Q.ySuperscriptXSize=r.parseShort(),Q.ySuperscriptYSize=r.parseShort(),Q.ySuperscriptXOffset=r.parseShort(),Q.ySuperscriptYOffset=r.parseShort(),Q.yStrikeoutSize=r.parseShort(),Q.yStrikeoutPosition=r.parseShort(),Q.sFamilyClass=r.parseShort(),Q.panose=[];for(var i=0;i<10;i++)Q.panose[i]=r.parseByte();return Q.ulUnicodeRange1=r.parseULong(),Q.ulUnicodeRange2=r.parseULong(),Q.ulUnicodeRange3=r.parseULong(),Q.ulUnicodeRange4=r.parseULong(),Q.achVendID=String.fromCharCode(r.parseByte(),r.parseByte(),r.parseByte(),r.parseByte()),Q.fsSelection=r.parseUShort(),Q.usFirstCharIndex=r.parseUShort(),Q.usLastCharIndex=r.parseUShort(),Q.sTypoAscender=r.parseShort(),Q.sTypoDescender=r.parseShort(),Q.sTypoLineGap=r.parseShort(),Q.usWinAscent=r.parseUShort(),Q.usWinDescent=r.parseUShort(),Q.version>=1&&(Q.ulCodePageRange1=r.parseULong(),Q.ulCodePageRange2=r.parseULong()),Q.version>=2&&(Q.sxHeight=r.parseShort(),Q.sCapHeight=r.parseShort(),Q.usDefaultChar=r.parseUShort(),Q.usBreakChar=r.parseUShort(),Q.usMaxContent=r.parseUShort()),Q}function n(c){return new X.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],c)}var y=c("../parse"),X=c("../table"),W=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];Q.unicodeRanges=W,Q.getUnicodeRange=r,Q.parse=i,Q.make=n},{"../parse":7,"../table":9}],22:[function(c,p,Q){function r(c,p){var Q,r,i={},X=new y.Parser(c,p);switch(i.version=X.parseVersion(),i.italicAngle=X.parseFixed(),i.underlinePosition=X.parseShort(),i.underlineThickness=X.parseShort(),i.isFixedPitch=X.parseULong(),i.minMemType42=X.parseULong(),i.maxMemType42=X.parseULong(),i.minMemType1=X.parseULong(),i.maxMemType1=X.parseULong(),i.version){case 1:i.names=n.standardNames.slice();break;case 2:for(i.numberOfGlyphs=X.parseUShort(),i.glyphNameIndex=new Array(i.numberOfGlyphs),Q=0;Q<i.numberOfGlyphs;Q++)i.glyphNameIndex[Q]=X.parseUShort();for(i.names=[],Q=0;Q<i.numberOfGlyphs;Q++)i.glyphNameIndex[Q]>=n.standardNames.length&&(r=X.parseChar(),i.names.push(X.parseString(r)));break;case 2.5:for(i.numberOfGlyphs=X.parseUShort(),i.offset=new Array(i.numberOfGlyphs),Q=0;Q<i.numberOfGlyphs;Q++)i.offset[Q]=X.parseChar()}return i}function i(){return new X.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}var n=c("../encoding"),y=c("../parse"),X=c("../table");Q.parse=r,Q.make=i},{"../encoding":3,"../parse":7,"../table":9}],23:[function(c,p,r){function i(c){return Math.log(c)/Math.log(2)|0}function n(c){for(;c.length%4!=0;)c.push(0);for(var p=0,Q=0;Q<c.length;Q+=4)p+=(c[Q]<<24)+(c[Q+1]<<16)+(c[Q+2]<<8)+c[Q+3];return p%=Math.pow(2,32)}function y(c,p,r,i){return new j.Table("Table Record",[{name:"tag",type:"TAG",value:c!==Q?c:""},{name:"checkSum",type:"ULONG",value:p!==Q?p:0},{name:"offset",type:"ULONG",value:r!==Q?r:0},{name:"length",type:"ULONG",value:i!==Q?i:0}])}function X(c){var p=new j.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);p.tables=c,p.numTables=c.length;var Q=Math.pow(2,i(p.numTables));p.searchRange=16*Q,p.entrySelector=i(Q),p.rangeShift=16*p.numTables-p.searchRange;for(var r=[],X=[],W=p.sizeOf()+y().sizeOf()*p.numTables;W%4!=0;)W+=1,X.push({name:"padding",type:"BYTE",value:0});for(var Z=0;Z<c.length;Z+=1){var o=c[Z];l.argument(4===o.tableName.length,"Table name"+o.tableName+" is invalid.");var E=o.sizeOf(),m=y(o.tableName,n(o.encode()),W,E);for(r.push({name:m.tag+" Table Record",type:"TABLE",value:m}),X.push({name:o.tableName+" table",type:"TABLE",value:o}),W+=E,l.argument(!isNaN(W),"Something went wrong calculating the offset.");W%4!=0;)W+=1,X.push({name:"padding",type:"BYTE",value:0})}return r.sort(function(c,p){return c.value.tag>p.value.tag?1:-1}),p.fields=p.fields.concat(r),p.fields=p.fields.concat(X),p}function W(c,p,Q){for(var r=0;r<p.length;r+=1){var i=c.charToGlyphIndex(p[r]);if(i>0)return c.glyphs[i].getMetrics()}return Q}function Z(c){for(var p=0,Q=0;Q<c.length;Q+=1)p+=c[Q]
;return p/c.length}function o(c){for(var p=[],Q=[],r=[],i=[],y=[],o=[],l=[],j=null,t=0,b=0,Y=0,s=0,h=0,F=0;F<c.glyphs.length;F+=1){var B=c.glyphs[F],D=0|B.unicode;(j>D||null===j)&&(j=D),t<D&&(t=D);var U=d.getUnicodeRange(D);if(U<32)b|=1<<U;else if(U<64)Y|=1<<U-32;else if(U<96)s|=1<<U-64;else{if(!(U<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");h|=1<<U-96}if(".notdef"!==B.name){var a=B.getMetrics();p.push(a.xMin),Q.push(a.yMin),r.push(a.xMax),i.push(a.yMax),o.push(a.leftSideBearing),l.push(a.rightSideBearing),y.push(B.advanceWidth)}}var _={xMin:Math.min.apply(null,p),yMin:Math.min.apply(null,Q),xMax:Math.max.apply(null,r),yMax:Math.max.apply(null,i),advanceWidthMax:Math.max.apply(null,y),advanceWidthAvg:Z(y),minLeftSideBearing:Math.min.apply(null,o),maxLeftSideBearing:Math.max.apply(null,o),minRightSideBearing:Math.min.apply(null,l)};_.ascender=_.yMax,_.descender=_.yMin;var w=f.make({unitsPerEm:c.unitsPerEm,xMin:_.xMin,yMin:_.yMin,xMax:_.xMax,yMax:_.yMax}),$=I.make({ascender:_.ascender,descender:_.descender,advanceWidthMax:_.advanceWidthMax,minLeftSideBearing:_.minLeftSideBearing,minRightSideBearing:_.minRightSideBearing,xMaxExtent:_.maxLeftSideBearing+(_.xMax-_.xMin),numberOfHMetrics:c.glyphs.length}),L=e.make(c.glyphs.length),H=d.make({xAvgCharWidth:Math.round(_.advanceWidthAvg),usWeightClass:500,usWidthClass:5,usFirstCharIndex:j,usLastCharIndex:t,ulUnicodeRange1:b,ulUnicodeRange2:Y,ulUnicodeRange3:s,ulUnicodeRange4:h,sTypoAscender:_.ascender,sTypoDescender:_.descender,sTypoLineGap:0,usWinAscent:_.ascender,usWinDescent:-_.descender,sxHeight:W(c,"xyvw",{yMax:0}).yMax,sCapHeight:W(c,"HIKLEFJMNTZBDPRAGOQSUVWXY",_).yMax,usBreakChar:c.hasChar(" ")?32:0}),O=G.make(c.glyphs),M=E.make(c.glyphs),K=c.familyName+" "+c.styleName,u=c.familyName.replace(/\s/g,"")+"-"+c.styleName,x=P.make({copyright:c.copyright,fontFamily:c.familyName,fontSubfamily:c.styleName,uniqueID:c.manufacturer+":"+K,fullName:K,version:c.version,postScriptName:u,trademark:c.trademark,manufacturer:c.manufacturer,designer:c.designer,description:c.description,manufacturerURL:c.manufacturerURL,designerURL:c.designerURL,license:c.license,licenseURL:c.licenseURL,preferredFamily:c.familyName,preferredSubfamily:c.styleName}),q=R.make(),z=m.make(c.glyphs,{version:c.version,fullName:K,familyName:c.familyName,weightName:c.styleName,postScriptName:u}),V=[w,$,L,H,x,M,q,z,O],T=X(V),A=T.encode(),N=n(A),S=T.fields,v=!1;for(F=0;F<S.length;F+=1)if("head table"===S[F].name){S[F].value.checkSumAdjustment=2981146554-N,v=!0;break}if(!v)throw new Error("Could not find head table with checkSum to adjust.");return T}var l=c("../check"),j=c("../table"),E=c("./cmap"),m=c("./cff"),f=c("./head"),I=c("./hhea"),G=c("./hmtx"),e=c("./maxp"),P=c("./name"),d=c("./os2"),R=c("./post");r.computeCheckSum=n,r.make=X,r.fontToTable=o},{"../check":1,"../table":9,"./cff":10,"./cmap":11,"./head":14,"./hhea":15,"./hmtx":16,"./maxp":19,"./name":20,"./os2":21,"./post":22}],24:[function(c,r,i){function n(c){return function(){return c}}var y=c("./check"),X={},W={},Z={};W.BYTE=function(c){return y.argument(c>=0&&c<=255,"Byte value should be between 0 and 255."),[c]},Z.BYTE=n(1),W.CHAR=function(c){return[c.charCodeAt(0)]},Z.BYTE=n(1),W.CHARARRAY=function(c){for(var p=[],Q=0;Q<c.length;Q+=1)p.push(c.charCodeAt(Q));return p},Z.CHARARRAY=function(c){return c.length},W.USHORT=function(c){return[c>>8&255,255&c]},Z.USHORT=n(2),W.SHORT=function(c){return c>=32768&&(c=-(65536-c)),[c>>8&255,255&c]},Z.SHORT=n(2),W.UINT24=function(c){return[c>>16&255,c>>8&255,255&c]},Z.UINT24=n(3),W.ULONG=function(c){return[c>>24&255,c>>16&255,c>>8&255,255&c]},Z.ULONG=n(4),W.LONG=function(c){return c>=2147483648&&(c=-(4294967296-c)),[c>>24&255,c>>16&255,c>>8&255,255&c]},Z.LONG=n(4),W.FIXED=W.ULONG,Z.FIXED=Z.ULONG,W.FWORD=W.SHORT,Z.FWORD=Z.SHORT,W.UFWORD=W.USHORT,Z.UFWORD=Z.USHORT,W.LONGDATETIME=function(){return[0,0,0,0,0,0,0,0]},Z.LONGDATETIME=n(8),W.TAG=function(c){return y.argument(4===c.length,"Tag should be exactly 4 ASCII characters."),[c.charCodeAt(0),c.charCodeAt(1),c.charCodeAt(2),c.charCodeAt(3)]},Z.TAG=n(4),W.Card8=W.BYTE,Z.Card8=Z.BYTE,W.Card16=W.USHORT,Z.Card16=Z.USHORT,W.OffSize=W.BYTE,Z.OffSize=Z.BYTE,W.SID=W.USHORT,Z.SID=Z.USHORT,W.NUMBER=function(c){return c>=-107&&c<=107?[c+139]:c>=108&&c<=1131?(c-=108,[247+(c>>8),255&c]):c>=-1131&&c<=-108?(c=-c-108,[251+(c>>8),255&c]):c>=-32768&&c<=32767?W.NUMBER16(c):W.NUMBER32(c)},Z.NUMBER=function(c){return W.NUMBER(c).length},W.NUMBER16=function(c){return[28,c>>8&255,255&c]},Z.NUMBER16=n(2),W.NUMBER32=function(c){return[29,c>>24&255,c>>16&255,c>>8&255,255&c]},Z.NUMBER32=n(4),W.NAME=W.CHARARRAY,Z.NAME=Z.CHARARRAY,W.STRING=W.CHARARRAY,Z.STRING=Z.CHARARRAY,W.UTF16=function(c){for(var p=[],Q=0;Q<c.length;Q+=1)p.push(0),p.push(c.charCodeAt(Q));return p},Z.UTF16=function(c){return 2*c.length},W.INDEX=function(c){var p,r,i,n,y,X,Z,o,l,j;for(r=1,i=[r],Z=[],o=0,l=0;l<c.length;l+=1)j=W.OBJECT(c[l]),Array.prototype.push.apply(Z,j),o+=j.length,r+=j.length,i.push(r);if(0===Z.length)return[0,0];for(y=[],p=1+Math.floor(Math.log(o)/Math.log(2))/8|0,n=[Q,W.BYTE,W.USHORT,W.UINT24,W.ULONG][p],l=0;l<i.length;l+=1)X=n(i[l]),Array.prototype.push.apply(y,X);return Array.prototype.concat(W.Card16(c.length),W.OffSize(p),y,Z)},Z.INDEX=function(c){return W.INDEX(c).length},W.DICT=function(c){for(var Q=[],r=p.keys(c),i=r.length,n=0;n<i;n+=1){var y=parseInt(r[n],0),X=c[y];Q=Q.concat(W.OPERAND(X.value,X.type)),Q=Q.concat(W.OPERATOR(y))}return Q},Z.DICT=function(c){return W.DICT(c).length},W.OPERATOR=function(c){return c<1200?[c]:[12,c-1200]},W.OPERAND=function(c,p){var Q,r;if(Q=[],Array.isArray(p))for(r=0;r<p.length;r+=1)y.argument(c.length===p.length,"Not enough arguments given for type"+p),Q=Q.concat(W.OPERAND(c[r],p[r]));else Q="SID"===p?Q.concat(W.NUMBER(c)):"offset"===p?Q.concat(W.NUMBER32(c)):Q.concat(W.NUMBER(c));return Q},W.OP=W.BYTE,Z.OP=Z.BYTE;var o="function"==typeof WeakMap&&new WeakMap;W.CHARSTRING=function(c){if(o&&o.has(c))return o.get(c);var p,Q,r=[],i=c.length;for(Q=0;Q<i;Q+=1)p=c[Q],r=r.concat(W[p.type](p.value));return o&&o.set(c,r),r},Z.CHARSTRING=function(c){return W.CHARSTRING(c).length},W.OBJECT=function(c){var p=W[c.type];return y.argument(p!==Q,"No encoding function for type "+c.type),p(c.value)},W.TABLE=function(c){var p,r=[],i=c.fields.length;for(p=0;p<i;p+=1){var n=c.fields[p],X=W[n.type];y.argument(X!==Q,"No encoding function for field type "+n.type);var Z=c[n.name];Z===Q&&(Z=n.value);var o=X(Z);r=r.concat(o)}return r},W.LITERAL=function(c){return c},Z.LITERAL=function(c){return c.length},i.decode=X,i.encode=W,i.sizeOf=Z},{"./check":1}]},{},[6])(6)});var n=r.FontConverter=function(c){var p=this;p._objPool=[],p.initConfig(c||{})};n.prototype={},n.prototype.constructor=n,n.prototype.initConfig=function(c){var p,Q=this;p=Q.options={},p.texts=c.texts,p.color=c.color||"black",p.width=c.width||100,p.height=c.height||100},n.prototype.toShape=function(c,p){var Q=this;return"string"==typeof c?(r.Default.xhrLoad(c,function(c){Q.toShapeImpl(c,p)},{responseType:"arraybuffer"}),null):Q.toShapeImpl(c,p)},n.prototype.toShapeImpl=function(c,Q){var r=this,i=opentype.parse(c);i.styleName||(i.styleName="");var n,y,X,W,Z,o,l=r.convertToTypeface(i),j=[],E=l.glyphs,m=r.options,f=0,I=m.texts,G=m.width,e=m.height;for(I||(I=p.keys(E)),n=0,y=I.length;n<y;n++)X=I[n],(W=r.createShape(X,E[X]))&&(j.push(W),f++);for(var P=Math.ceil(Math.sqrt(f*G*e)/G),d=0;d<f;d++)Z=d%P,o=Math.floor(d/P),r.fitPointsToRect(j[d].points,Z*G,o*e,G,e);var R={width:P*G,height:Math.ceil(f/P)*e,comps:j,familyName:i.familyName,styleName:i.styleName};return Q&&Q(R),R},n.prototype.createShape=function(c,p){if(!p)return!1;if(!p.o)return!1;var Q,r=this,i=p.o.split(" "),n=i.length,y=[],X=[];for(Q=0;Q<n;)switch(i[Q++]){case"m":y.push(1*i[Q++]),y.push(1*i[Q++]),X.push(1);break;case"l":y.push(1*i[Q++]),y.push(1*i[Q++]),X.push(2);break;case"q":y.push(1*i[Q+2]),y.push(1*i[Q+3]),y.push(1*i[Q+0]),y.push(1*i[Q+1]),Q+=4,X.push(3);break;case"b":y.push(1*i[Q+2]),y.push(1*i[Q+3]),y.push(1*i[Q+4]),y.push(1*i[Q+5]),y.push(1*i[Q+0]),y.push(1*i[Q+1]),Q+=6,X.push(4)}return{type:"shape",points:y,segments:X,borderColor:null,borderWidth:0,background:r.options.color,displayName:c}},n.prototype.fitPointsToRect=function(c,p,Q,r,i){var n,y,X,W,Z,o={x:1/0,y:1/0},l={x:-1/0,y:-1/0},j=c.length;for(n=0;n<j;n+=2)y=c[n],X=c[n+1],o.x=Math.min(o.x,y),o.y=Math.min(o.y,X),l.x=Math.max(l.x,y),l.y=Math.max(l.y,X);for(W=l.x-o.x,Z=l.y-o.y,n=0;n<j;n+=2)c[n]=(c[n]-o.x)*r/W+p,c[n+1]=(l.y-c[n+1])*i/Z+Q},n.prototype.convertToTypeface=function(c){var p=1e5/(72*(c.unitsPerEm||2048)),r={};r.glyphs={};var i=this.options.texts;return c.glyphs.forEach(function(c){if(c.unicode!=Q){var n=String.fromCharCode(c.unicode);if(!(i&&i.indexOf(n)<0)){var y={};y.ha=Math.round(c.advanceWidth*p),y.x_min=Math.round(c.xMin*p),y.x_max=Math.round(c.xMax*p),y.o="",c.path.commands.forEach(function(c,r){"c"===c.type.toLowerCase()&&(c.type="b"),y.o+=c.type.toLowerCase(),y.o+=" ",c.x!==Q&&c.y!==Q&&(y.o+=Math.round(c.x*p),y.o+=" ",y.o+=Math.round(c.y*p),y.o+=" "),c.x1!==Q&&c.y1!==Q&&(y.o+=Math.round(c.x1*p),y.o+=" ",y.o+=Math.round(c.y1*p),y.o+=" "),c.x2!==Q&&c.y2!==Q&&(y.o+=Math.round(c.x2*p),y.o+=" ",y.o+=Math.round(c.y2*p),y.o+=" ")}),r.glyphs[n]=y}}}),r.familyName=c.familyName,r.ascender=Math.round(c.ascender*p),r.descender=Math.round(c.descender*p),r.underlinePosition=c.tables.post.underlinePosition,r.underlineThickness=c.tables.post.underlineThickness,r.boundingBox={yMin:c.tables.head.yMin,xMin:c.tables.head.xMin,yMax:c.tables.head.yMax,xMax:c.tables.head.xMax},r.resolution=1e3,r.original_font_information=c.tables.name,c.styleName.toLowerCase().indexOf("bold")>-1?r.cssFontWeight="bold":r.cssFontWeight="normal",c.styleName.toLowerCase().indexOf("italic")>-1?r.cssFontStyle="italic":r.cssFontStyle="normal",r},n.prototype.reverseCommands=function(c){var p,r=[];c.forEach(function(c){"m"===c.type.toLowerCase()?(p=[c],r.push(p)):"z"!==c.type.toLowerCase()&&p.push(c)});var i=[];return r.forEach(function(c){var p={type:"m",x:c[c.length-1].x,y:c[c.length-1].y};i.push(p);for(var r=c.length-1;r>0;r--){var n=c[r];p={type:n.type},n.x2!==Q&&n.y2!==Q?(p.x1=n.x2,p.y1=n.y2,p.x2=n.x1,p.y2=n.y1):n.x1!==Q&&n.y1!==Q&&(p.x1=n.x1,p.y1=n.y1),p.x=c[r-1].x,p.y=c[r-1].y,i.push(p)}}),i}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);var OQ=function(){function c(p,Q){var r=this;Tp(this,c),this.editor=Q,this.handler=p,this.cookie=0,this.callbacks={},this.cmds={};var i=Jp.config.host||window.location.hostname,n=Jp.config.port||window.location.port,y=window.location.protocol+"//"+i+":"+n;this.socket=io.connect(y),this.socket.on("connect",function(){r.handler({type:"connected",message:y})}),this.socket.on("disconnect",function(){r.handler({type:"disconnected",message:y})}),this.socket.on("fileChanged",function(c){r.handler({type:"fileChanged",path:c.path,event:c.event})}),this.socket.on("operationDone",function(c,p){r.handleRespone(c,p)}),this.socket.on("download",function(c){r.handler({type:"download",path:c})}),this.socket.on("confirm",function(c,p){r.handler({type:"confirm",path:c,datas:p})})}return c.prototype.request=function(c,p,Q){var r=++this.cookie;this.callbacks[r]=Q,this.cmds[r]=c;var i=this.editor.sid;this.socket.emit(c,r,p,i?{sid:i}:null);var n=c;p&&(Ic(p)?n=c+": "+p:p.path&&(n=c+": "+p.path)),this.handler({type:"request",message:n,cmd:c,data:p})},c.prototype.handleRespone=function(c,p){var Q=this.callbacks[c],r=this.cmds[c];delete this.callbacks[c],delete this.cmds[c],this.handler({type:"response",message:r,cmd:r,data:p}),Q&&Q(p)},c}(),MQ=function(c){function p(Q,r){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Tp(this,p);var n=Sp(this,c.call(this,r));return n.editor=Q,n.editable=i,n.dragToIndexEnabled=!0,n.addTopPainter(n.$1$.bind(n)),n}return Np(p,c),p.prototype.getLabelColor=function(p){return p!==this.draggingData||this.isSelected(p)?c.prototype.getLabelColor.call(this,p):Jp.config.color_select},p.prototype.handleDelete=function(){this.editable&&this.removeSelection()},p.prototype.isDroppable=function(c,p){return!1},p.prototype._clearDragInfo=function(){this.editor.dnd.hideTip(),this._dragInfo&&(this._dragInfo=null,this.redraw())},p.prototype._endDrag=function(c,p){},p.prototype._endCrossDrag=function(c,p){},p.prototype.$1$=function(c){c.texureImage2D=!0;var p=void 0;if(this._dragInfo&&this._dragInfo.inView?p=this._dragInfo:this._crossDragInfo&&(p=this._crossDragInfo),p){var Q=this.getWidth(),r=this.getRowHeight(),i=p.type,n=p.parent,y=n?this.getRowDatas().indexOf(n):-1,X=Jp.config.color_select_dark;if(p.refData){if(N(c,X,0,y*r,Q,r,2),"up"===i||"down"===i){var W=p.x,Z=p.y;c.beginPath(),c.arc(W-3,Z,3,0,2*Math.PI,!0),c.moveTo(W,Z),c.lineTo(Q,Z),c.lineWidth=2,c.strokeStyle=X,c.stroke()}}else{var o=this.getViewRect();N(c,X,o.x,o.y,o.width,o.height,2)}}},p.prototype._dragging=function(c,p){var Q=this.getRowHeight(),r=this.lp(c),i=r.y/Q,n=Math.floor(i);if(n>this.getRowSize()-1)p.refData=null,p.type="parent",p.parent=null;else{var y=r.y-n*Q;this.dragToIndexEnabled?p.type=y<.25*Q?"up":y>.75*Q?"down":"parent":p.type="parent";var X=p.refData=this.getRowDatas().get(n);"up"===p.type?(p.parent=X.getParent(),p.x=(this.getLevel(X)+1)*this.getIndent(),p.y=n*Q):"down"===p.type?(this.getToggleIcon(X)===this.getExpandIcon()?(p.parent=X,p.x=(this.getLevel(X)+2)*this.getIndent()):(p.parent=X.getParent(),p.x=(this.getLevel(X)+1)*this.getIndent()),p.y=(n+1)*Q):p.parent=X}this.autoScroll(c),this.redraw()},p.prototype.$2$=function(){var c="";if(this.draggingData&&(c=this.getLabel(this.draggingData),this.isSelected(this.draggingData))){var p=this.sm().size();c+=p>1?" (+"+p+") ":""}return c},p.prototype.handleDragAndDrop=function(c,p){if(this.editable){if("prepare"===p)return void this._clearDragInfo();"begin"===p&&(this._dragInfo={tip:this.$2$(),view:this});var Q=this._dragInfo;if(Q){var r=this.editor.dnd;if("begin"===p||"between"===p){return this.getView().contains(b(c))?(Q.inView=!0,this._dragging(c,Q),r.clearDropView(c,Q)):(Q.inView&&this.redraw(),Q.inView=!1,r.crossDrag(c,Q)),void r.showTip(Q.tip,c)}return"end"===p?(Q.inView?this._endDrag(c,Q):r.crossDrop(c,Q),void this._clearDragInfo()):"cancel"===p?(Q.inView||r.crossCancel(c,Q),void this._clearDragInfo()):void 0}}},p.prototype.handleCrossDrag=function(c,p,Q){if("exit"===p||"cancel"===p)return this._crossDragInfo=null,void this.redraw();if("enter"===p||"over"===p)return this._crossDragInfo||(this._crossDragInfo={}),void this._dragging(c,this._crossDragInfo);if("drop"===p){if(this.explorer){var r=this._crossDragInfo.parent?this._crossDragInfo.parent.url:this.explorer.currentDir,i={url:r,event:c};this.editor.fireEvent("explorerCrossDrop",i),i.preventDefault||this._endCrossDrag(c,Q)}else this._endCrossDrag(c,Q);return this._crossDragInfo=null,void this.redraw()}},p.prototype.isEditable=function(c){return this.editable},p.prototype.rename=function(c,p){c.setName(p)},p.prototype.handleDataDoubleSelect=function(c,p){if(this.isEditable(p)){var Q=this.getLevel(p);Q+=this.getIcon(p)?2:1,this.lp(c).x>Q*this.getIndent()&&this.beginEditing(p)}},p.prototype.getEditingLabel=function(c){return this.getLabel(c)},p.prototype.beginEditing=function(c){var p=this;this.cancelEditing(),this.makeVisible(c),this.validate();var Q=this.getLevel(c);Q+=this.getIcon(c)?2:1;var r=this.getIndent()*Q,i=this.ty()+this.getRowIndex(c)*this.getRowHeight(),n=Math.max(1,this.getWidth()-r),y=this.getRowHeight();this._currentEditor=new ht.widget.TextField,this._currentEditor.data=c;var X=this._currentEditor.getElement(),W=this.getEditingLabel(c);X.value=null==W?"":W,X.onblur=function(c){p.endEditing()},X.onkeydown=function(c){I(c)?p.endEditing():G(c)&&p.cancelEditing()},this.getView().appendChild(this._currentEditor.getView()),L(this._currentEditor,r,i,n,y),this._currentEditor.setFocus(),ht.Default.callLater(X.select,X)},p.prototype.endEditing=function(){var c=this._currentEditor;c&&(this.rename(c.data,c.getValue()),delete this._currentEditor,O(c.getView()),this.redraw())},p.prototype.cancelEditing=function(){var c=this._currentEditor;c&&(delete this._currentEditor,O(c.getView()),this.redraw())},p}(HQ),KQ=function(c){function p(Q){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Tp(this,p);var i=Sp(this,c.call(this,Q.editor,Q.dataModel,r));return i.explorer=Q,i.dragToIndexEnabled=!1,i.setSortFunc(Jp.config.createFileTreeSortFunc(i)),i}return Np(p,c),p.prototype.isVisible=function(c){return!1!==c.a("visible")&&((!this._visibleFunc||!1!==this._visibleFunc(c))&&(c.fileType===QQ||c.fileType===pQ))},p.prototype.getLabel=function(c){return i("url:"+c.url,!0)||this.getEditingLabel(c)},p.prototype.getEditingLabel=function(c){return c.getName()},p.prototype.handleBackgroundClick=function(c){},p.prototype.handleDelete=function(){this.editable&&Jp.config.removeFileByKeyboardEnabled&&this.explorer.deleteSelection(this)},p.prototype.isDroppable=function(c,p){return!(!this.editable||p.view!==this.explorer.list)||p.view===this.editor.dndFromOutside},p.prototype._endCrossDrag=function(c,p){var Q=this;if(this._crossDragInfo){var r=p.view,n=this._crossDragInfo.parent;if(n||(n=this.explorer.rootNode),r===this.explorer.list){var y=r.draggingData,X=function(){r.isSelected(y)?r.sm().toSelection().each(function(c){Q.editor.moveFile(c,n)}):Q.editor.moveFile(y,n)};Jp.config.promptForMovingFile?Nc(i("editor.move"),i("editor.confirmmovefile"),X,function(){}):X()}else r===this.editor.dndFromOutside&&this.editor.dropLocalFileOnDir(c,n)}},p.prototype._endDrag=function(c,p){var Q=this,r=p.parent;r||(r=this.explorer.rootNode);var n=this.draggingData,y=function(){if(Q.isSelected(n)){Q.getTopRowOrderSelection().each(function(c){Q.editor.moveFile(c,r)})}else Q.editor.moveFile(n,r),Q.sm().ss(n);r&&Q.expand(r)};Jp.config.promptForMovingFile?Nc(i("editor.move"),i("editor.confirmmovefile"),y,function(){}):y()},p.prototype.isEditable=function(c){return this.editable&&!1!==c.a("editable")},p.prototype.beginEditing=function(p){var Q={data:p,url:p.url};this.editor.fireEvent("fileRenaming",Q),Q.preventDefault||c.prototype.beginEditing.call(this,p)},p.prototype.rename=function(c,p){this.editor.renameFile(c,p,function(){c.s("label")?c.s("label",p):c.setName(p)})},p.prototype.getIcon=function(c){return void 0!==c.getIcon()?c.getIcon():c.fileType===QQ?this.hasExpandedChild(c)?"editor.direxpanded":"editor.dircollapsed":c.fileType===pQ?"editor.root.state":null},p}(MQ),uQ=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this,Q));return r._lastSelectDataTime=Date.now(),r}return Np(p,c),p.prototype.isVScrollable=function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},p.prototype.isV=function(c){var p=this.gv.getViewRect();return this.isVScrollable()&&(p.x+p.width-this.gv.lp(c).x)*this.gv.getZoom()<ht.Default.scrollBarInteractiveSize},p.prototype.clear=function(c){c&&this._dragging&&!this._dragCancel&&this.gv.handleDragAndDrop(c,"end"),this.gv.draggingData&&(this.gv.draggingData.iv(),this.gv.draggingData=null,this.gv.redraw()),this._dragging=this._dragCancel=this._clientPoint=null},p.prototype.handle_mousedown=function(c){this.handle_touchstart(c)},p.prototype.handle_touchstart=function(c){if(!this.isV(c)&&!Tc(c.target)){k(c),this.clear(c),this._clientPoint=t(c);var p=this.gv.getDataAt(c);P(c)?p?(this.gv.draggingData=p,p.iv(),this.gv.redraw(),this.gv.handleDragAndDrop(c,"prepare"),R(this,c)):this.gv.sm().cs():(p&&this.handleSelection(c,p),this.clear(c))}},p.prototype.handle_mouseup=function(c){this.handle_touchend(c)},p.prototype.handle_touchend=function(c){if(this._clientPoint&&!this._dragging&&!this.gv._justDoubleClickData){var p=this.gv.getDataAt(c);p&&this.handleSelection(c,p)}this.gv._justDoubleClickData=!1,this.clear(c)},p.prototype.handleWindowMouseMove=function(c){this.handleWindowTouchMove(c)},p.prototype.handleWindowMouseUp=function(c){this.handleWindowTouchEnd(c)},p.prototype.handleWindowTouchMove=function(c){k(c),this._dragging?this._dragCancel||this.gv.handleDragAndDrop(c,"between"):this._clientPoint&&this.gv.draggingData&&h(t(c),this._clientPoint)>2&&(this._dragging=!0,this.gv.handleDragAndDrop(c,"begin"))},p.prototype.handleWindowTouchEnd=function(c){k(c),this.clear(c)},p.prototype.handleSelection=function(c,p){var Q=this.gv.sm();if(u(c))this.gv.isSelected(p)?Q.removeSelection(p):Q.appendSelection(p);else if(K(c)){var r=Q.ld();if(r)for(var i=this.gv.nodes,n=i.indexOf(r),y=i.indexOf(p);n!==y;)n+=y>n?1:-1,Q.as(i[n]);else Q.ss(p)}else if(P(c)){var X=Date.now();if(Q.contains(p)){var W=X-this._lastSelectDataTime;W>500&&W<1500&&this.gv.handleDataDoubleSelect(c,p)}Q.ss(p),this._lastSelectDataTime=X}else Q.contains(p)||Q.ss(p)},p.prototype.handle_keydown=function(c){if(!Tc(c.target))if(G(c))this._dragging&&!this._dragCancel&&(this.gv.handleDragAndDrop(c,"cancel"),this._dragCancel=!0);else if(E(c)||f(c)||j(c)||m(c)){var p=this.gv.sm(),Q=this.gv.nodes,r=p.ld();if(Q.length){var i=void 0;if(r){var n=Q.indexOf(r);E(c)||j(c)?0!==n&&(i=Q[n-1]):n!==Q.length-1&&(i=Q[n+1])}else i=Q[0];i&&(K(c)?p.as(i):p.ss(i))}}},p}(ht.graph.Interactor),xQ=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this,Q.editor,Q.dm));return r.displayView=Q,r.graphView=Q.graphView,r.nodeIcon=qc(r),r.initMenu(),Q.dm.addDataPropertyChangeListener(function(c){var p=c.data;(p instanceof ht.Shape||p instanceof ht.Edge)&&(p.editorIcon=null)}),r}return Np(p,c),p.prototype.getBorderColor=function(c){return null},p.prototype.onDataDoubleClicked=function(c,p){p.altKey?this.graphView.fitData(c,!0,Jp.config.fitPadding):this.graphView.makeCenter(c,!0)},p.prototype.onPropertyChanged=function(p){"filter"===p.property&&(this.visibleMap=null,this.ivm()),c.prototype.onPropertyChanged.call(this,p)},p.prototype.handleDataPropertyChange=function(p){!this._filter||"name"!==p.property&&"displayName"!==p.property?c.prototype.handleDataPropertyChange.call(this,p):(this.visibleMap=null,this.ivm())},p.prototype.checkVisible=function(c){if(!this._filter)return!0;if(Jp.config.displayTreeVisibleFunc)return Jp.config.displayTreeVisibleFunc(c,this._filter);var p=this.getLabel(c),Q=(this._filter+"").toLowerCase();return null!=p&&(p=(p+"").toLowerCase(),p.indexOf(Q)>=0)},p.prototype.validateModel=function(){var p=this;this._filter&&!this.visibleMap&&(this.visibleMap={},this.getDataModel().each(function(c){if(p.checkVisible(c)){p.visibleMap[c._id]=!0;for(var Q=c.getParent();Q&&!p.visibleMap[Q._id];)p.visibleMap[Q._id]=!0,Q=Q.getParent()}})),c.prototype.validateModel.call(this),Jp.config.filterDisplayViewEnabled&&this.graphView.setVisibleFunc(function(c){return p.isVisible(c)})},p.prototype.isVisible=function(c){if(c._refGraph)return!1;var p=this.getVisibleFunc();return!(p&&!p(c))&&(!this._filter||this.visibleMap&&this.visibleMap[c._id])},p.prototype.validate=function(){this.graphView.validate(),c.prototype.validate.call(this)},p.prototype.getLabel=function(c){return null==c.toLabel()&&c.s("editor.folder")?i("ht.Folder"):c.toLabel()||i(c.getClassName())},p.prototype.getIcon=function(c){return c instanceof ht.SubGraph?"editor.subgraph":c instanceof ht.Group?"editor.group":c instanceof ht.RefGraph||c instanceof ht.Text?c.getIcon():c instanceof ht.Block?"editor.block":c instanceof ht.Shape?(c.editorIcon||(c.editorIcon=Vc(c)),c.editorIcon):c instanceof ht.Edge?(c.editorIcon||(c.editorIcon=zc(this,c)),c.editorIcon):c instanceof ht.Node?this.nodeIcon:c.s("editor.folder")?this.hasExpandedChild(c)?"editor.direxpanded":"editor.dircollapsed":null},p.prototype.isDroppable=function(c,p){return!!this.editor.editable&&(p.view===this.editor.symbols.getFileListView()||(p.view===this.editor.assets.getFileListView()||p.view===this.editor.displays.getFileListView()))},p.prototype._endCrossDrag=function(c,p){var Q=this;if(this.editor.editable&&this._crossDragInfo){this.editor.beginTransaction();var r=[],i=p.view,n=this._crossDragInfo.type,y=this._crossDragInfo.parent,X=this._crossDragInfo.refData;i!==this.editor.symbols.getFileListView()&&i!==this.editor.assets.getFileListView()||i.toDraggingDatas("down"===n).forEach(function(c){var p=new ht.Node;p.setImage(c.getFileUUID()),p.setDisplayName(_(c.getName())),r.push(p),Q.displayView.addData(p,!0),Q.editor.gv.$64$([p]),Q._dropData(p,n,y,X)}),i===this.editor.displays.getFileListView()&&i.toDraggingDatas("down"===n).forEach(function(c){if(c.url!==Q.editor.url){var p=new ht.RefGraph;p.setRef(c.getFileUUID()),p.setDisplayName(_(c.getName())),r.push(p),Q.displayView.addData(p,!0),Q._dropData(p,n,y,X)}}),r.length&&this.sm().ss(r),this.editor.endTransaction()}},p.prototype._endDrag=function(c,p){var Q=this;if(this.editor.editable){this.editor.beginTransaction();var r=p.type,i=p.parent,n=p.refData;if(this.isSelected(this.draggingData)){var y=this.getTopRowOrderSelection();"down"===r&&y.reverse(),y.each(function(c){Q._dropData(c,r,i,n)})}else this._dropData(this.draggingData,r,i,n),this.sm().ss(this.draggingData);i&&this.expand(i),this.editor.endTransaction()}},p.prototype._dropData=function(c,p,Q,r){if(this.editor.editable)if(c.setParent(Q),"down"===p||"up"===p){var i=Q?Q.getChildren():this.dm().getRoots(),n=i.indexOf(r);"down"===p&&n++,i.indexOf(c)<n&&n--,this.dm().moveTo(c,n)}else Q||this.dm().moveToBottom(c)},p.prototype.rename=function(c,p){c.setDisplayName(p)},p.prototype.initMenu=function(){var c=this,p=function(){for(var p=c.editor.selection,Q=0;Q<p.length;Q++)if(p[Q].s("editor.folder"))return!0;return!1};this.menu=new BQ;var Q=[{id:"folder",label:i("editor.folder"),action:function(){c.editor.folder()},visible:function(){return c.editable&&!!c.editor.ld}},{id:"unfolder",label:i("editor.unfolder"),action:function(){c.editor.unfolder()},visible:function(){return c.editable&&p()}},{separator:!0,visible:function(){return c.editable&&!!c.editor.ld}},{id:"copy",label:i("editor.copy"),action:function(){c.editor.copy()},visible:function(){return c.editable&&!!c.editor.ld}},{id:"paste",label:i("editor.paste"),action:function(){c.editor.paste()},visible:function(){return c.editable&&c.editor.hasCopyInfo()}},{id:"delete",label:i("editor.delete"),action:function(){c.editor.delete()},visible:function(){return c.editable&&!!c.editor.ld}},{separator:!0,visible:function(){return c.editable&&!!c.editor.ld}},{id:"bringToFront",label:i("editor.bringtofront"),action:function(){c.editor.bringToFront()},visible:function(){return c.editable&&!!c.editor.ld}},{id:"bringForward",label:i("editor.bringforward"),action:function(){c.editor.bringForward()},visible:function(){return c.editable&&!!c.editor.ld}},{id:"sendBackward",label:i("editor.sendbackward"),action:function(){c.editor.sendBackward()},visible:function(){return c.editable&&!!c.editor.ld}},{id:"sendToBack",label:i("editor.sendtoback"),action:function(){c.editor.sendToBack()},visible:function(){return c.editable&&!!c.editor.ld}},{separator:!0,visible:function(){return c.editable&&!!c.editor.ld}},{id:"expandAll",label:i("editor.expandall"),action:function(){c.expandAll()}},{id:"collapseAll",label:i("editor.collapseall"),action:function(){c.collapseAll()}},"separator",{id:"combined",label:i("editor.combineshapes"),action:function(){c.editor.beginTransaction(),Wp(c.editor.sm.getSelection().toArray()),c.editor.endTransaction()},visible:function(){return c.editable&&c.editor.sm.size()>1&&op(c.editor.sm.getSelection())}},{id:"splitShape",label:i("editor.splitshape"),action:function(){c.editor.beginTransaction(),Zp(c.editor.ld),c.editor.endTransaction()},visible:function(){return c.editable&&1===c.editor.sm.size()&&c.editor.ld instanceof ht.Shape}}];this.menu.setItems(Q),this.menu.addTo(this.getView()),this.editor.menus.push(this.menu)},p.prototype.onClosed=function(){n(this.editor.menus,this.menu)},Ap(p,[{key:"editable",get:function(){return this.editor.editable},set:function(c){}}]),p}(MQ);v(xQ,{ms_ac:["filter"]});var qQ=function(c){function p(Q){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Tp(this,p);var i=Sp(this,c.call(this,Q.dataModel));return i.explorer=Q,i.editable=r,i.editor=Q.editor,i.getHScrollBar().style.display="none",i.setMaxFileSize(Jp.config.imageSize),i.enableToolTip(),i.setPannable(!1),i.setInteractors([new ht.graph.ScrollBarInteractor(i),new uQ(i),new ht.graph.DefaultInteractor(i),new ht.graph.TouchInteractor(i,{editable:!1})]),i}return Np(p,c),p.prototype.getToolTip=function(c){var p=this.getDataAt(c);return p?this._filter?p.url:this.getLabel(p):null},p.prototype.getLabel=function(c){return i("url:"+c.url,!0)||this.getEditingLabel(c)},p.prototype.isEditable=function(c){return this.editable&&!1!==c.a("editable")},p.prototype.getEditingLabel=function(c){return c.s("label")||c.getName()},p.prototype.rename=function(c,p){this.editor.renameFile(c,p,function(){c.s("label")?c.s("label",p):c.setName(p)})},p.prototype.handleDelete=function(){this.editable&&Jp.config.removeFileByKeyboardEnabled&&this.explorer.deleteSelection(this)},p.prototype.beginEditing=function(c){var p=this,Q={data:c,url:c.url};if(this.editor.fireEvent("fileRenaming",Q),!Q.preventDefault){this.cancelEditing(),this.makeVisible(c),this.validate();var r=this.getDataUI(c),i=!1,n=void 0;if(this.explorer.isAccordionMode()&&c.fileType===QQ?(n=c.getRect(),i=!0):r&&r.labelInfo&&(n=r.labelInfo.rect),n){var y=void 0,X=void 0,W=void 0,Z=void 0;if(i)y=n.x,X=n.y,W=n.width,Z=n.height;else if(this._layoutType===oQ)y=this._rowHeight,X=c.p().y-this._rowHeight/2,W=this.getWidth()-y,Z=this._rowHeight;else{var o=r.labelInfo.rect||c.getRect();y=c.p().x-c.getWidth()/2,X=o.y,W=c.getWidth(),Z=o.height}X+=this.ty(),this._currentEditor=new ht.widget.TextField,this._currentEditor.data=c;var l=this._currentEditor.getElement(),j=this.getEditingLabel(c);l.value=null==j?"":j,l.onblur=function(c){p.endEditing()},l.onkeydown=function(c){I(c)?p.endEditing():G(c)&&p.cancelEditing()},this.getView().appendChild(this._currentEditor.getView()),L(this._currentEditor,y,X,W,Z),this._currentEditor.setFocus(),ht.Default.callLater(l.select,l)}}},p.prototype.endEditing=function(){var c=this._currentEditor;c&&(this.rename(c.data,c.getValue()),delete this._currentEditor,O(c.getView()),this.redraw())},p.prototype.cancelEditing=function(){var c=this._currentEditor;c&&(delete this._currentEditor,O(c.getView()),this.redraw())},p.prototype._clearDragInfo=function(){this.editor.dnd.hideTip(),this._dragInfo&&(this._dragInfo=null,this.redraw())},p.prototype.handleDragAndDrop=function(c,p){if("prepare"===p)return void this._clearDragInfo();"begin"===p&&(this._dragInfo={tip:this.$2$(),view:this});var Q=this._dragInfo;if(Q){var r=this.editor.dnd;if("begin"===p||"between"===p){return this.getView().contains(b(c))?(Q.inView=!0,this._dragging(c,Q),r.clearDropView(c,Q)):(Q.inView&&this.redraw(),Q.inView=!1,r.crossDrag(c,Q)),void r.showTip(Q.tip,c)}return"end"===p?(Q.inView?this._endDrag(c,Q):r.crossDrop(c,Q),void this._clearDragInfo()):"cancel"===p?(Q.inView||r.crossCancel(c,Q),void this._clearDragInfo()):void 0}},p.prototype._dragging=function(c,p){if(this.editable){var Q=this.getDataAt(c);Q&&Q.fileType===QQ?p.targetData=Q:p.targetData=null,this.autoScroll(c),this.redraw()}},p.prototype.$2$=function(){var c="";if(this.draggingData&&(c=this.getLabel(this.draggingData),this.isSelected(this.draggingData))){var p=this.sm().size();c+=p>1?" (+"+p+") ":""}return c},p.prototype._endDrag=function(c,p){},p.prototype.handleSelectionChange=function(p){c.prototype.handleSelectionChange.call(this,p),this.redraw()},p.prototype.handleCrossDrag=function(c,p,Q){if(this.editable){if("exit"===p||"cancel"===p)return this._crossDragInfo=null,void this.redraw();if("enter"===p||"over"===p)return this._crossDragInfo||(this._crossDragInfo={}),void this._dragging(c,this._crossDragInfo);if("drop"===p){var r=this._crossDragInfo.targetData?this._crossDragInfo.targetData.url:this.explorer.currentDir,i={url:r,event:c};return this.editor.fireEvent("explorerCrossDrop",i),i.preventDefault||this._endCrossDrag(c,Q),this._crossDragInfo=null,void this.redraw()}}},
p.prototype._endCrossDrag=function(c,p){if(this.editable&&this._crossDragInfo){var Q=this._crossDragInfo.targetData;if(Q&&Q.fileType===QQ||(Q=this.dm().sm().ld()),Q){var r=p.view;"displays"===this.explorer.rootDir&&r instanceof xQ&&this.handleDisplayTreeDrop(r,Q),r===this.editor.dndFromOutside&&this.editor.dropLocalFileOnDir(c,Q)}}},p}(DQ);v(qQ,{ms_ac:["layoutType","fileSize","fileGap","rowHeight","maxFileSize","filter"],_fileRect:{x:0,y:0,width:0,height:0},_layoutType:ZQ,_fileSize:50,_fileGap:6,_rowHeight:21,_maxFileSize:200});var zQ={filter:!0,layoutType:!0,fileSize:!0,fileGap:!0,rowHeight:!0,visibleFunc:!0},VQ=function(c){function p(Q){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Tp(this,p);var i=Sp(this,c.call(this,Q,r));return i.nodes=[],i.doLayoutBind=i.doLayout.bind(i),i.dm().sm().ms(function(){i.sm().cs(),i.doLayoutLater()}),i.dm().mm(function(){i.doLayoutLater()}),i.addInteractorListener(i.handleInteraction.bind(i)),i.addBottomPainter(i.paintBottom.bind(i)),i.addTopPainter(i.paintTop.bind(i)),i}return Np(p,c),p.prototype.getDataAt=function(p){if(this._layoutType===oQ){var Q=Math.floor(this.lp(p).y/this._rowHeight);return this.nodes[Q]}return c.prototype.getDataAt.call(this,p)},p.prototype.paintBottom=function(c){var p=this,Q=this._rowHeight,r=this.getWidth();this.nodes.forEach(function(i){if(p.isSelected(i))if(p._layoutType===oQ)c.beginPath(),c.rect(0,i.p().y-Q/2,r,Q),c.fillStyle=Jp.config.color_select,c.fill();else{var n=i.getRect();N(c,Jp.config.color_select,n.x-2,n.y-2,n.width+4,n.height+4,1)}})},p.prototype.paintTop=function(c){c.texureImage2D=!0;var p=void 0;if(this._dragInfo&&this._dragInfo.inView?p=this._dragInfo:this._crossDragInfo&&(p=this._crossDragInfo),p){var Q=Jp.config.color_select_dark,r=p.targetData;if(c.texureImage2D=!0,r)if(this._layoutType===oQ){var i=r.p().y-this._rowHeight/2,n=this.getWidth(),y=this._rowHeight;N(c,Q,0,i,n,y,2)}else{var X=r.getRect();c.beginPath(),c.rect(X.x,X.y,X.width,X.height),c.lineWidth=2,c.strokeStyle=Jp.config.color_select_dark,c.stroke()}else{var W=this.getViewRect();N(c,Q,W.x,W.y,W.width,W.height,2)}}},p.prototype.toDraggingDatas=function(c){var p=[];return this.isSelected(this.draggingData)?(this.sm().toSelection().each(function(c){c.fileType!==QQ&&p.push(c)}),c&&p.reverse()):this.draggingData.fileType!==QQ&&p.push(this.draggingData),p},p.prototype.isDroppable=function(c,p){return"displays"===this.explorer.rootDir&&p.view instanceof xQ||p.view===this.editor.dndFromOutside},p.prototype._endDrag=function(c,p){var Q=this,r=p.targetData;if(r){var n=this.draggingData,y=function(){Q.isSelected(n)?Q.sm().toSelection().each(function(c){Q.editor.moveFile(c,r)}):Q.editor.moveFile(n,r)};Jp.config.promptForMovingFile?Nc(i("editor.move"),i("editor.confirmmovefile"),y,function(){}):y()}},p.prototype.handleDisplayTreeDrop=function(c,p){var Q=this,r=void 0;r=c.isSelected(c.draggingData)?c.getTopRowOrderSelection().toArray():[c.draggingData];var n={};r.forEach(function(c){g(c,n)});var y=new ht.JSONSerializer(c.getDataModel(),!0);y.isSerializable=function(c){return n[c._id]};var X=y.serialize();Ac(i("editor.inputnewdisplayname")+" ["+p.url+"]",c.getLabel(c.draggingData),{nullable:!1,trim:!0,maxLength:Jp.config.maxFileNameLength,checkFunc:Jp.config.checkFileName},function(c,r){if("ok"===r){nc(c)||(c+=".json");var i=p.url+"/"+c,y={path:i,content:X};Q.editor.request("upload",y,function(c){if(!0===c){var p=Q.editor.gv,r=p.isVisible;p.isVisible=function(c){return r.call(p,c)&&n[c._id]},Q.editor.saveImage(p,i.substr(0,i.length-5)+".png"),p.isVisible=r,p.redraw()}Q.editor.fireEvent("displayViewSaved",{url:i})})}})},p.prototype.handleDataDoubleSelect=function(c,p){if(this.isEditable(p)){var Q=this.lp(c);if(this._layoutType===oQ)Q.x>this._rowHeight&&this.beginEditing(p);else{var r=this.getDataUI(p);r&&r.labelInfo&&r.labelInfo.rect&&ht.Default.containsPoint(r.labelInfo.rect,Q)&&this.beginEditing(p)}}},p.prototype.getLabelColor=function(c){return c!==this.draggingData||this.isSelected(c)?this._layoutType===oQ?this.isSelected(c)?Jp.config.color_light:ht.Default.labelColor:this.isSelected(c)?Jp.config.color_select:ht.Default.labelColor:Jp.config.color_select},p.prototype.handleInteraction=function(c){var p=c.kind,Q=c.data,r=c.event;if("clickData"===p&&this._filter)this.dm().sm().ss(Q.getParent());else if("doubleClickData"===p)1===this.sm().size()&&(this.setFilter(""),this._justDoubleClickData=!0,Q.fileType===QQ?this.dm().sm().ss(Q):this.editor.open(Q,K(r)));else if("doubleClickBackground"===c.kind&&!this._filter){var i=this.dm().sm().ld();i&&i.getParent()&&this.dm().sm().ss(i.getParent())}},p.prototype.handleScroll=function(c,p){k(c),K(c)?p>0?this.setFileSize(Math.min(this.getFileSize()+2,this.getMaxFileSize())):this.setFileSize(Math.max(this.getFileSize()-2,1)):(EQ||c.wheelDelta!==c.wheelDeltaX)&&(p=EQ?-c.detail:c.wheelDelta/40,this.translate(0,20*p))},p.prototype.handlePinch=function(c,p,Q){Q<p?this.setFileSize(Math.min(this.getFileSize()+2,this.getMaxFileSize())):this.setFileSize(Math.max(this.getFileSize()-2,1))},p.prototype.onPropertyChanged=function(c){qQ.prototype.onPropertyChanged.apply(this,arguments),zQ[c.property]&&this.doLayoutLater()},p.prototype.isVisible=function(c){if(!1===c.a("visible"))return!1;if(this._visibleFunc&&!1===this._visibleFunc(c))return!1;if(this._filter){var p=this.getLabel(c);if(!p||p.indexOf(this._filter)<0)return!1}else{var Q=this.dm().sm().ld();if(!Q||c.getParent()!==Q)return!1}return c.fileType!==cQ},p.prototype.isMovable=function(){return!1},p.prototype.onValidated=function(){this._lastWidth===this.getWidth()&&this._lastHeight===this.getHeight()||this.doLayoutLater()},p.prototype.adjustTranslateX=function(){return 0},p.prototype.adjustTranslateY=function(c){var p=this.getHeight()-this._fileRect.height;return c<p&&(c=p),c>0?0:Math.round(c)},p.prototype.getContentRect=function(){return this._fileRect},p.prototype.doLayoutLater=function(){this._doLayoutLater||(this._doLayoutLater=!0,requestAnimationFrame(this.doLayoutBind))},p.prototype.doLayout=function(){var c=this;this._doLayoutLater=!1,this.redraw();var p=this.nodes=[];this.dm().getDatas().each(function(Q){c.isVisible(Q)&&p.push(Q)});var Q=this._lastWidth=this.getWidth();this._lastHeight=this.getHeight();var r=this._fileGap;if(this._layoutType===oQ){for(var i=this._rowHeight,n=Math.max(i-4,2),y=0;y<p.length;y++){var X=p[y];X.setPosition(r+n/2,i*y+2+n/2),X.setSize(n,n),X.s({"label.position":20,"label.offset.x":3,"label.offset.y":0,"label.max":void 0})}this._fileRect={x:0,y:0,width:Q,height:i*p.length}}else{for(var W=this._fileSize,Z=W+r,o=W+r+16,l=r,j=r,E=0,m=0;m<p.length;m++){var f=p[m];f.setPosition(l+W/2,j+W/2),f.setSize(W,W),f.s({"label.position":31,"label.offset.x":0,"label.offset.y":2,"label.max":W}),(E+2)*Z+r>Q?(l=r,m!==p.length-1&&(j+=o),E=0):(l+=Z,E++)}this._fileRect={x:0,y:0,width:Q,height:j+o}}this.tx(this.tx()),this.ty(this.ty()),this.showScrollBar()},p}(qQ),TQ=function(c){function p(Q,r,i,n){Tp(this,p);var y=Sp(this,c.call(this));y.setSize(20,20),y._id=y.url=r?r+"/"+i:i,y.path=r,y.value=n,y.rootDir=Q,y.uuid=Gc(n)&&Ic(n.fileType)&&null!=n.uuid?n.uuid:y.url,y.postfix=n?n.postfix:"";var X=cQ,W=void 0,Z=void 0;return y.s({"select.width":0,pixelPerfect:!1,"image.stretch":"centerUniform"}),""===r?(X=pQ,Z="editor.root.state"):"assets"===Q&&(Z=y.getFileImage(i))?X=rQ:nc(i)&&"displays"===Q?(X=nQ,Z=fc(y.url),y.s("label",_(i))):nc(i)&&"symbols"===Q?(X=iQ,Z=fc(y.url),y.s("label",_(i))):nc(i)&&"components"===Q?(X=yQ,Z=fc(y.url),y.s("label",_(i))):nc(i)&&"scenes"===Q?(X=WQ,Z=fc(y.url),y.s("label",_(i))):nc(i)&&"models"===Q&&(X=XQ,Z=fc(y.url),y.s("label",_(i))),Gc(n)&&(Ic(n.fileType)?(X=n.fileType,W=n.fileIcon,Z=n.fileImage||Z||W,Z||n.fileType!==QQ||(Z="editor.dir"),y.a(n.attrs),y.s(n.styles)):(X=QQ,Z="editor.dir")),Z||(Z="editor.unknown"),y.fileType=X,y.setIcon(W),y.setImage(Z),y.setName(i),y}return Np(p,c),p.prototype.getFileUUID=function(){return this.postfix?this.uuid+"."+this.postfix:this.uuid},p.prototype.getFileImage=function(c){return ic(c)?this.url:Zc(c)?"editor.dxf.state":oc(c)?"editor.obj.state":lc(c)?"editor.mtl.state":jc(c)?"editor.ttf.state":Ec(c)?"editor.otf.state":yc(c)?"editor.sound.state":Xc(c)?"editor.video.state":mc(c)?"editor.js.state":void 0},p}(ht.Node);ht.Default.setCompType("accordion-title-comp",function(c,p,Q,r,i){var n=Jp.config.drawAccordionTitle;if(n)return void n(c,p,r,i,{isHover:r.__hover,isExpanded:r.expanded,hoverColor:Jp.config.color_hover,selectColor:Jp.config.color_select});var y=r.__hover,X=p.x,W=p.y,Z=p.width,o=p.height,l=i.getLabel(r),j=i.getFileGap();c.save(),(y||i.isSelected(r))&&(c.fillStyle=Jp.config.color_hover,c.fillRect(X,W,Z,o)),c.fillStyle=Jp.config.color_select,c.fillRect(X+j,W+(o-8)/2,8,8),l&&ht.Default.drawText(c,l,"bold 14px Arial",ht.Default.labelColor,X+j+8+8,W,200,o,"left","middle"),c.restore()}),ht.Default.setImage("accordion-title",{width:160,height:24,fitSize:!0,pixelPerfect:!1,interactive:!0,boundExtend:2,onDown:function(c,p,Q,r,i,n){ht.Default.isLeftButton(c)&&(Q.getMutex()&&!p.expanded&&Q.dirs.forEach(function(c){c!==p&&(c.expanded=!1)}),p.expanded=!p.expanded,Q.ivm())},onEnter:function(c,p,Q,r,i,n){p.__hover=!0,p.iv()},onLeave:function(c,p,Q,r,i,n){p.__hover=!1,p.iv()},comps:[{type:"accordion-title-comp",displayName:"clock-pointer",rect:[0,0,160,24]}]});var AQ={layoutType:!0,fileSize:!0,fileGap:!0,rowHeight:!0,filePadding:!0,titleHeight:!0},NQ=function(c){function p(Q){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Tp(this,p);var i=Sp(this,c.call(this,Q,r));return i.setFileGap(10),i.setMutex(Jp.config.accordionMutex),i.nodes=[],i.dirs=[],i.bottomRects=[],i.addViewListener(function(c){"beginValidate"===c.kind&&i.doLayout()}),i.setSelectionModelShared(!1),i.dm().sm().ms(function(){i.sm().cs()}),i._layouted=!1,i.mi(i.handleInteraction.bind(i)),i.addBottomPainter(i.paintBottom.bind(i)),i.addTopPainter(i.paintTop.bind(i)),i}return Np(p,c),p.prototype.paintBottom=function(c){var p=this,Q=this._rowHeight,r=this.getWidth();this.nodes.forEach(function(i){if(p._layoutType===oQ)p.isSelected(i)&&(c.beginPath(),c.rect(0,i.p().y-Q/2,r,Q),c.fillStyle=Jp.config.color_select,c.fill());else{var n=p.isSelected(i)?Jp.config.color_select:Jp.config.color_mask,y=i.getRect(),X=y.x,W=y.y,Z=y.width,o=y.height,l=p._filePadding;N(c,n,X-l,W-l,Z+2*l,o+2*l,1)}}),this.bottomRects.forEach(function(p){var Q=p.x,r=p.y,i=p.width,n=p.height;c.beginPath(),c.lineWidth=2,c.strokeStyle=Jp.config.color_hover,c.moveTo(Q+10,r+n/2),c.lineTo(Q+i-10,r+n/2),c.stroke()})},p.prototype.isDroppable=function(c,p){return"displays"===this.explorer.rootDir&&p.view instanceof xQ||p.view===this.editor.dndFromOutside},p.prototype.handleDragAndDrop=function(p,Q){var r=this.draggingData;r&&r.fileType!==QQ&&c.prototype.handleDragAndDrop.call(this,p,Q)},p.prototype.isLabelVisible=function(c){return c.fileType!==QQ},p.prototype.paintTop=function(c){c.texureImage2D=!0;var p=void 0;if(this._dragInfo&&this._dragInfo.inView?p=this._dragInfo:this._crossDragInfo&&(p=this._crossDragInfo),p){var Q=Jp.config.color_select_dark,r=p.targetData;if(c.texureImage2D=!0,r){var i=r.getRect();c.beginPath(),c.rect(i.x,i.y,i.width,i.height),c.lineWidth=2,c.strokeStyle=Jp.config.color_select_dark,c.stroke()}else{var n=this.getViewRect();N(c,Q,0,0,n.width,n.height,2)}}},p.prototype.getDataAt=function(p){if(this._layoutType!==oQ)return c.prototype.getDataAt.call(this,p);var Q=c.prototype.getDataAt.call(this,p);if(Q)return Q;for(var r=this.lp(p).y,i=0;i<this.nodes.length;i++){var n=this.nodes[i],y=n.getY(),X=this._rowHeight,W=y-X/2,Z=y+X/2;if(r>=W&&r<Z)return n}},p.prototype.handleInteraction=function(c){var p=c.kind,Q=c.data,r=c.event;"doubleClickData"===p&&1===this.sm().size()&&Q.fileType!==QQ&&(this.setFilter(""),Q.getParent().expanded=!0,this.sm().ss(Q),this.ivm(),this.editor.open(Q,K(r)))},p.prototype.handleDataDoubleSelect=function(c,p){if(this.isEditable(p)){var Q=this.lp(c);if(p.fileType!==QQ)if(this._layoutType===oQ)Q.x>this._rowHeight&&this.beginEditing(p);else{var r=this.getDataUI(p);r&&r.labelInfo&&r.labelInfo.rect&&ht.Default.containsPoint(r.labelInfo.rect,Q)&&this.beginEditing(p)}}},p.prototype.getLabelColor=function(c){return c!==this.draggingData||this.isSelected(c)?this._layoutType===oQ?this.isSelected(c)?Jp.config.color_light:ht.Default.labelColor:this.isSelected(c)?Jp.config.color_select:ht.Default.labelColor:Jp.config.color_select},p.prototype.isVisible=function(c){if(!this._layouted)return!1;if(this._visibleFunc&&!1===this._visibleFunc(c))return!1;var p=this.explorer.rootDir,Q=c.getParent();if(!1===c.a("visible"))return!1;if(c.fileType===cQ||!Q)return!1;if(this._visibleFunc&&!this._visibleFunc(c))return!1;if(this._filter){var r=this.getLabel(c);if(Q.url===p&&c.fileType===QQ){for(var i=c.getChildren(),n=0;n<i.length;n++){var y=i.get(n);if(this.isVisible(y))return!0}return!1}if(Q.getParent()&&Q.getParent().url===p&&c.fileType!==QQ)return!(!r||r.indexOf(this._filter)<0)}return Q.url===p&&c.fileType===QQ||!(!Q.getParent()||Q.getParent().url!==p||c.fileType===QQ)&&!!Q.expanded},p.prototype.adjustTranslateX=function(c){return 0},p.prototype.adjustTranslateY=function(c){if(!this.contentHeight)return 0;var p=this.getViewRect(),Q=p.height-this.contentHeight;return c>=0||Q>=0?0:c>Q?c:Q},p.prototype.getImage=function(c){if(c.getImage)return c.fileType===QQ?"accordion-title":c.getImage()},p.prototype.doLayout=function(){var c=this;if(this._lastWidth!==this.getWidth()||this._lastHeight!==this.getHeight()||this._lastFileSize!==this.getFileSize()){this._doLayoutLater=!1,this.redraw();var p=this.dirs=[],Q=this.nodes=[],r=this.bottomRects=[];this.dm().each(function(Q){c.isVisible(Q)&&Q.fileType===QQ&&p.push(Q)});var i=this._lastWidth=this.getWidth(),n=this._titleHeight,y=0;this._lastHeight=this.getHeight(),this._lastFileSize=this._fileSize,this._expandIds&&(this.dirs.forEach(function(p){p.expanded=c._expandIds.indexOf(p.getId())>=0}),delete this._expandIds),p.forEach(function(p){p.setAnchor(0,0),p.p(0,y),p.setSize(i,n),p.s("label",null),y+=n;var X=[];p.getChildren().each(function(p){c.isVisible(p)&&(X.push(p),Q.push(p))}),y=c.layoutChildren(X,y),p.expanded&&(r.push({x:0,y:y,width:i,height:16}),y+=16)}),this.contentHeight=y,this._layouted=!0}},p.prototype.layoutChildren=function(c,p){if(!c||0===c.length)return p;var Q=this._fileGap;if(this._layoutType===oQ){var r=this._rowHeight,i=Math.max(r-4,15);return c.forEach(function(c,n){c.setPosition(Q+i/2,p+2+i/2),c.setSize(i,i),c.s({"label.position":20,"label.offset.x":3,"label.offset.y":0,"label.max":void 0}),p+=r}),p}var n=this.getWidth(),y=this._fileSize,X=this._filePadding,W=y+2*X,Z=Q,o=p+Q,l=0,j=y+Q+2*X,E=y+Q+16+2*X;return c.forEach(function(p,r){p.setPosition(Z+W/2,o+W/2),p.setSize(y,y),p.s({"label.position":31,"label.offset.x":0,"label.offset.y":2+X,"label.max":W}),(l+2)*j+Q>n?(Z=Q,r!==c.length-1&&(o+=E),l=0):(Z+=j,l++)}),o+E},p.prototype.handleScroll=function(c){var p=EQ?-c.detail:c.wheelDelta/10;(EQ||c.wheelDelta!==c.wheelDeltaX)&&this.translate(0,p)},p.prototype.adjustZoom=function(){return 1},p.prototype.onPropertyChanged=function(p){c.prototype.onPropertyChanged.call(this,p);var Q=p.property;"dataModel"!==Q&&"fileSize"!==Q||this.doLayout()},p.prototype._endDrag=function(c,p){var Q=this,r=p.targetData;if(r&&r.fileType===QQ){var n=this.draggingData,y=function(){Q.isSelected(n)?Q.sm().toSelection().each(function(c){Q.editor.moveFile(c,r)}):Q.editor.moveFile(n,r),Q.doLayout(),Q.redraw()};Jp.config.promptForMovingFile?Nc(i("editor.move"),i("editor.confirmmovefile"),y,function(){}):y()}},p.prototype.toDraggingDatas=function(c){var p=[];return this.isSelected(this.draggingData)?(this.sm().toSelection().each(function(c){c.fileType!==QQ&&p.push(c)}),c&&p.reverse()):this.draggingData.fileType!==QQ&&p.push(this.draggingData),p},p.prototype.invalidateModel=function(){this._lastWidth=null,this.iv()},p.prototype.ivm=function(){this.invalidateModel()},p.prototype.getContentRect=function(){return{x:0,y:0,width:this.getWidth(),height:this.contentHeight||0}},p.prototype.onPropertyChanged=function(p){c.prototype.onPropertyChanged.apply(this,arguments),AQ[p.property]&&this.ivm()},Ap(p,[{key:"expandIds",get:function(){var c=[];return this.dirs.forEach(function(p){p.expanded&&c.push(p.getId())}),c},set:function(c){this._expandIds=c,this._lastWidth=null}}]),p}(qQ);v(NQ,{ms_ac:["filePadding","titleHeight","mutex"],_mutex:!1,_filePadding:6,_titleHeight:36});var SQ=function(c){function p(Q,r){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Tp(this,p);var n=Sp(this,c.call(this));n.editor=Q,n.rootDir=r,n.copyFileInfos=[],n.dataModel=new ht.DataModel,n.dataModel.setAutoAdjustIndex(!1);var y=n.mode=Jp.config.explorerMode;y===lQ&&(n.accordion=new NQ(n,i)),n.tree=new KQ(n,i),n.list=new VQ(n,i),n.controlPane=new gp,n.controlPane.addRow([{id:"filter",textField:{}},{id:"url",textField:{editable:!1}},{id:"slider",slider:{min:1,max:n.getFileListView().getMaxFileSize(),step:1,onValueChanged:function(c,p){n.getFileListView().setFileSize(p),n.getFileListView().setLayoutType(p>16?ZQ:oQ)}}}],[.1,.2,ht.Default.isTouchable?70:50]);var X=n.controlPane.getViewById("filter").getElement();X.onkeyup=function(c){G(c)&&(X.value=""),y===lQ?(n.accordion.setFilter(X.value),n.accordion.ivm()):n.list.setFilter(X.value)},(y===lQ?n.accordion:n.list).mp(function(c){"filter"===c.property&&(X.value=c.newValue||"")});var W=n.controlPane.getItemById("slider").element;return W.getToolTip=function(){},n.getFileListView().mp(function(c){"fileSize"===c.property&&W.setValue(c.newValue)}),n.bottomPane=new FQ,n.bottomPane.setCenterView(n.getFileListView()),n.bottomPane.setBottomView(n.controlPane),n.bottomPane.setBottomHeight(ht.Default.widgetRowHeight+8),n.setOrientation("vertical"),y===lQ?(n.setLeftView(n.bottomPane),n.setPosition(1),n.accordion.sm().ms(function(){n.$52$(n.accordion)}),n.accordion.setFileSize(Jp.config.fileSize),n.setDraggable(!1)):(n.setLeftView(n.tree),n.setRightView(n.bottomPane),n.setPosition(Jp.config.explorerSplitViewPosition),n.list.setSelectionModelShared(!1),n.list.sm().ms(function(){n.$52$(n.list)}),n.list.setFileSize(Jp.config.fileSize)),n.tree.menu=new BQ,n.treeMenuItems=[],n.initTreeMenu(n.tree.menu,n.treeMenuItems),n.tree.menu.setItems(n.treeMenuItems),n.tree.menu.addTo(n.tree.getView()),n.editor.menus.push(n.tree.menu),n.list.menu=new BQ,n.listMenuItems=[],n.initListMenu(n.list.menu,n.listMenuItems),n.list.menu.setItems(n.listMenuItems),n.list.menu.addTo(n.list.getView()),n.editor.menus.push(n.list.menu),n.isAccordionMode()&&(n.accordion.menu=new BQ,n.accordionMenuItems=[],n.initAccordionMenu(n.accordion.menu,n.accordionMenuItems),n.accordion.menu.setItems(n.accordionMenuItems),n.accordion.menu.addTo(n.accordion.getView()),n.editor.menus.push(n.accordion.menu)),n}return Np(p,c),p.prototype.$52$=function(c){var p=c.sm().ld();this.controlPane.v("url",p?p.getFileUUID():"")},p.prototype.isAccordionMode=function(){return this.mode===lQ},p.prototype.parse=function(c){var p=this,Q=void 0,r=void 0,i=void 0,n=void 0;if(this.mode===lQ?(r=this.accordion.expandIds,Q=this.accordion.ty()):(Q=this.tree.ty(),r=this.tree.expandIds,i=this.tree.selectionIds,n=this.tree.dm().size()),this.dataModel.clear(),Pc(c))c.forEach(function(c){if(c){var Q=c.attrs&&c.attrs.path?c.attrs.path:"",r=p.rootNode=new TQ(p.rootDir,Q,c.name,c);p.dataModel.add(r),p.parseRoot(r,c)}});else{var y=this.rootNode=new TQ(this.rootDir,"",this.rootDir);this.dataModel.add(y),this.parseRoot(y,c)}var X=this.dataModel.getDatas(),W={};X.toArray().forEach(function(c,p){W[c._id]=p}),X.sort(function(c,p){return c.fileType===pQ?-1:p.fileType===pQ?1:c.fileType===QQ&&p.fileType!==QQ?-1:c.fileType!==QQ&&p.fileType===QQ?1:W[c._id]-W[p._id]}),this.mode===lQ?(this.accordion.expandIds=r,this.accordion.ty(Q)):(this.tree.expandIds=r,this.tree.selectionIds=i,this.tree.ty(Q),0===n&&(this.tree.expand(this.rootNode),this.tree.sm().ss(this.rootNode)));var Z={explorer:this};this.editor.fireEvent("explorerUpdated",Z)},p.prototype.parseRoot=function(c,p){c.a("editable",!1);var Q=void 0;p.fileType===QQ||p.fileType===pQ?(c.a(p.attrs),c.s(p.styles),p.fileIcon&&(c.setIcon(p.fileIcon),c.setImage(p.fileIcon)),Q=p.children):Q=p;for(var r in Q)this.parseChild(c,r,Q[r])},p.prototype.parseChild=function(c,p,Q){var r=new TQ(this.rootDir,c.url,p,Q);r.setParent(c),this.dataModel.add(r);var i=void 0;Q&&Q.fileType===QQ?i=Q.children:r.fileType===QQ&&(i=Q);for(var n in i)this.parseChild(r,n,i[n]);return r},p.prototype.deleteSelection=function(c){var p=this,Q=[];if(c.sm().getTopSelection().forEach(function(c){var r={data:c,url:c.url};p.editor.fireEvent("fileDeleting",r),r.preventDefault||Q.push(c)}),Q.length){var r=c.getLabel(Q[0])||Q[0].getName(),n=i("editor.delete")+" ["+r+"]";Q.length>1&&(n+=" ("+Q.length+")");var y=function(){p.editor.removeFiles(Q)};Jp.config.deleteFileConfirm?Nc(n,i("editor.deleteselection"),y,function(){}):y()}},p.prototype.addDeleteItem=function(c,p){var Q=this,r={id:"delete",label:i("editor.delete"),action:function(){Q.deleteSelection(p)},visible:function(){return!(!p.sm().ld()||!p.isEditable(p.sm().ld()))}};return c.push(r),r},p.prototype.addNewFolderItem=function(c,p){var Q=this,r={id:"newFolder",label:i("editor.newfolder"),action:function(){Q.editor.newFolder(p)},visible:function(){return p.editable}};return c.push(r),r},p.prototype.addLocateTreeFileItem=function(c){var p=this,Q=void 0;return Jp.config.locateFileEnabled&&(Q={id:"locateFile",label:i("editor.locatefile"),action:function(){var c=p.tree.sm().ld()||p.rootNode;p.editor.locate(c)}},c.push(Q)),Q},p.prototype.addLocateListFileItem=function(c){var p=this,Q=void 0;return Jp.config.locateFileEnabled&&(Q={id:"locateFile",label:i("editor.locatefile"),action:function(){var c=p.ld||p.tree.sm().ld()||p.rootNode;p.editor.locate(c)},visible:function(){return!p.isAccordionMode()||!!p.getFileListView().sm().ld()}},c.push(Q)),Q},p.prototype.addExportItem=function(c){var p=this,Q={id:"export",label:i("editor.export"),action:function(){var c=[],Q=p.getFileListView().sm();Q.size()>0&&(Q.each(function(p){c.push(p.url)}),p.editor.request("export",c))},visible:function(){var c=p.getFileListView().sm().ld();return!!c&&(c.fileType===nQ||c.fileType===iQ||c.fileType===yQ||c.fileType===WQ)}};return c.push(Q),Q},p.prototype.addRenameItem=function(c,p){var Q={id:"rename",label:i("editor.rename"),action:function(){var c=p.sm().ld();c&&!1!==c.a("editable")&&p.beginEditing(c)},visible:function(){var c=p.sm().ld();return!(!c||!p.isEditable(c))}};return c.push(Q),Q},p.prototype.addCopyItem=function(c){var p=this,Q={id:"copy",label:i("editor.copy"),action:function(){p.copyFiles()},visible:function(){if(!p.getFileListView().editable)return!1;var c=p.getFileListView().sm().ld();return!(!c||!1===c.a("editable"))}};return c.push(Q),Q},p.prototype.addPasteItem=function(c){var p=this,Q={id:"paste",label:i("editor.paste"),action:function(){p.pasteFiles()},visible:function(){return!!p.copyFileInfos.length&&(!!p.getFileListView().editable&&(!p.isAccordionMode()||!!p.ld))}};return c.push(Q),Q},p.prototype.copyFiles=function(){var c=this;this.copyFileInfos.length=0,this.getFileListView().sm().each(function(p){c.prepareCopyFileInfos(p)})},p.prototype.prepareCopyFileInfos=function(c,p){var Q=this;if(c.fileType!==pQ&&c.fileType!==cQ){var r={url:c.url,name:c.getName(),fileNode:c,parentInfo:p};if(this.copyFileInfos.push(r),this.editor.fireEvent("copyFile",{url:c.url}),c.fileType===QQ)return r.isDir=!0,void c.eachChild(function(c){Q.prepareCopyFileInfos(c,r)});this.loadFileInfo(r)}},p.prototype.loadFileInfo=function(c){var p=c.url;if(this.editor.requestBase64(p,function(p){c.content=p}),nc(p)){var Q=fc(p);this.dataModel.getDataById(Q)&&this.editor.requestBase64(Q,function(p){c.image=p})}},p.prototype.pasteFiles=function(){var c=this;this.copyFileInfos.forEach(function(p){c.pasteFileImpl(p)})},p.prototype.pasteFileImpl=function(c){var p=c.url,Q=c.parentInfo,r=void 0,i=2,n=Q?Q.pasteURL:this.currentDir;if(c.isDir){var y=n+"/"+c.name;for(r=y;this.dataModel.getDataById(r);)r=y+" "+i++}else if(c.content){var X=n+"/"+_(c.name),W=p.substring(p.lastIndexOf("."),p.length);for(r=X+W;this.dataModel.getDataById(r);)r=X+" "+i+++W}if(r){if(c.content){var Z={path:r,content:c.content};this.editor.request("upload",Z),this.editor.fireEvent("pasteFile",{url:r}),c.image&&(Z.path=fc(r),Z.content=c.image,this.editor.request("upload",Z),this.editor.fireEvent("pasteFile",{url:Z.path}))}c.isDir&&(c.pasteURL=r,this.editor.request("mkdir",r,function(c){}))}},p.prototype.enableDroppableToSymbolView=function(){var c=this.list;this.mode===lQ&&(c=this.accordion),c.isDroppableToSymbolView=!0},p.prototype.enableDroppableToDisplayView=function(){var c=this.list;this.mode===lQ&&(c=this.accordion),c.isDroppableToDisplayView=!0},p.prototype.getFileListView=function(){return this.mode===lQ?this.accordion:this.list},p.prototype.initTreeMenu=function(c,p){},p.prototype.initListMenu=function(c,p){},p.prototype.initAccordionMenu=function(c,p){},Ap(p,[{key:"currentDir",get:function(){var c=void 0;return this.isAccordionMode()?(c=this.ld,c&&c.fileType!==QQ&&(c=c.getParent()),c?c.url:this.accordion.dirs.length?this.accordion.dirs[this.accordion.dirs.length-1].url:this.rootDir):(c=this.tree.sm().ld(),c?c.url:this.rootDir)}},{key:"ld",get:function(){return this.getFileListView().sm().ld()}}]),p}(_Q),vQ=function(c){function p(Q){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Tp(this,p);var i=Sp(this,c.call(this,Q,"displays",r));return i.enableDroppableToDisplayView(),i}return Np(p,c),p.prototype.initTreeMenu=function(c,p){this.addLocateTreeFileItem(p),this.addNewFolderItem(p,this.tree),this.addNewDisplayItem(p,this.tree),this.addRenameItem(p,this.tree),this.addDeleteItem(p,this.tree)},p.prototype.initListMenu=function(c,p){this.addLocateListFileItem(p),this.addNewFolderItem(p,this.list),this.addNewDisplayItem(p,this.list),this.addCopyItem(p),this.addPasteItem(p),this.addRenameItem(p,this.list),this.addDeleteItem(p,this.list),this.addExportItem(p)},p.prototype.initAccordionMenu=function(c,p){this.addLocateListFileItem(p),this.addNewFolderItem(p,this.accordion),this.addNewDisplayItem(p,this.accordion),this.addCopyItem(p),this.addPasteItem(p),this.addRenameItem(p,this.accordion),this.addDeleteItem(p,this.accordion),this.addExportItem(p)},p.prototype.addNewDisplayItem=function(c,p){var Q=this,r={id:"newDisplayView",label:i("editor.newdisplayview"),action:function(){if(p instanceof VQ){var c=p.sm().ld();c&&c.fileType===QQ&&(Q.editor._rightClickURL=c.url)}Q.editor.newDisplayView(),Q.editor.save(),delete Q.editor._rightClickURL},visible:function(){if(!p.editable)return!1;if(Q.isAccordionMode()){var c=Q.accordion.sm().ld();return c&&c.fileType===QQ}return!0}};return c.push(r),r},p}(SQ),gQ=function(c){function p(Q){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Tp(this,p);var i=Sp(this,c.call(this,Q,"symbols",r));return i.enableDroppableToDisplayView(),i.enableDroppableToSymbolView(),i}return Np(p,c),p.prototype.initTreeMenu=function(c,p){this.addLocateTreeFileItem(p),this.addNewFolderItem(p,this.tree),this.addNewSymbolItem(p,this.tree),this.addRenameItem(p,this.tree),this.addDeleteItem(p,this.tree)},p.prototype.initListMenu=function(c,p){this.addLocateListFileItem(p),this.addNewFolderItem(p,this.list),this.addNewSymbolItem(p,this.list),this.addCopyItem(p),this.addPasteItem(p),this.addRenameItem(p,this.list),this.addDeleteItem(p,this.list),this.addExportItem(p)},p.prototype.initAccordionMenu=function(c,p){this.addLocateListFileItem(p),this.addNewFolderItem(p,this.accordion),this.addNewSymbolItem(p,this.accordion),this.addCopyItem(p),this.addPasteItem(p),this.addRenameItem(p,this.accordion),this.addDeleteItem(p,this.accordion),this.addExportItem(p)},p.prototype.addNewSymbolItem=function(c,p){var Q=this,r={id:"newSymbolView",label:i("editor.newsymbolview"),action:function(){if(p instanceof VQ){var c=p.sm().ld();c&&c.fileType===QQ&&(Q.editor._rightClickURL=c.url)}Q.editor.newSymbolView(),Q.editor.save(),delete Q.editor._rightClickURL},visible:function(){if(!p.editable)return!1;if(Q.isAccordionMode()){var c=Q.accordion.sm().ld();return c&&c.fileType===QQ}return!0}};return c.push(r),r},p}(SQ),kQ=function(c){function p(Q){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Tp(this,p);var i=Sp(this,c.call(this,Q,"components",r));return i.enableDroppableToSymbolView(),i}return Np(p,c),p.prototype.initTreeMenu=function(c,p){this.addLocateTreeFileItem(p),this.addNewFolderItem(p,this.tree),this.addNewComponentItem(p,this.tree),this.addRenameItem(p,this.tree),this.addDeleteItem(p,this.tree)},p.prototype.initListMenu=function(c,p){this.addLocateListFileItem(p),this.addNewFolderItem(p,this.list),this.addNewComponentItem(p,this.list),this.addCopyItem(p),this.addPasteItem(p),this.addRenameItem(p,this.list),this.addDeleteItem(p,this.list),this.addExportItem(p)},p.prototype.initAccordionMenu=function(c,p){this.addLocateListFileItem(p),this.addNewFolderItem(p,this.accordion),this.addNewComponentItem(p,this.accordion),this.addCopyItem(p),this.addPasteItem(p),this.addRenameItem(p,this.accordion),this.addDeleteItem(p,this.accordion),this.addExportItem(p)},p.prototype.addNewComponentItem=function(c,p){var Q=this,r={id:"newComponent",label:i("editor.newcomponent"),action:function(){var c=void 0;if(p instanceof VQ){var r=p.sm().ld();r&&r.fileType===QQ&&(c=r.url)}Q.editor.newComponent(c)},visible:function(){if(!p.editable)return!1;if(Q.isAccordionMode()){var c=Q.accordion.sm().ld();return c&&c.fileType===QQ}return!0}};return c.push(r),r},p}(SQ),JQ=function(c){function p(Q){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Tp(this,p);var i=Sp(this,c.call(this,Q,"scenes",r));return i.enableDroppableToDisplayView(),i}return Np(p,c),p.prototype.initTreeMenu=function(c,p){},p.prototype.initListMenu=function(c,p){},p.prototype.initAccordionMenu=function(c,p){},p}(SQ),CQ=function(c){function p(Q){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Tp(this,p);var i=Sp(this,c.call(this,Q,"models",r));return i.enableDroppableToDisplayView(),i}return Np(p,c),p.prototype.initTreeMenu=function(c,p){},p.prototype.initListMenu=function(c,p){},p.prototype.initAccordionMenu=function(c,p){},p}(SQ),cr=function(c){function p(Q){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Tp(this,p);var i=Sp(this,c.call(this,Q,"assets",r));return i.enableDroppableToDisplayView(),i.enableDroppableToSymbolView(),i}return Np(p,c),p.prototype.initTreeMenu=function(c,p){this.addLocateTreeFileItem(p),this.addNewFolderItem(p,this.tree),this.addRenameItem(p,this.tree),this.addDeleteItem(p,this.tree)},p.prototype.initListMenu=function(c,p){this.addLocateListFileItem(p),this.addNewFolderItem(p,this.list),this.addCopyItem(p),this.addPasteItem(p),this.addRenameItem(p,this.list),this.addDeleteItem(p,this.list),this.$54$(p)},p.prototype.initAccordionMenu=function(c,p){this.addLocateListFileItem(p),this.addNewFolderItem(p,this.accordion),this.addCopyItem(p),this.addPasteItem(p),this.addRenameItem(p,this.accordion),this.addDeleteItem(p,this.accordion),this.$54$(p)},p.prototype.$54$=function(c){var p=this;c.push("separator"),c.push({id:"convertToDisplay",label:i("editor.converttodisplay"),action:function(){p.editor.open(p.getFileListView().sm().ld(),!1)},visible:function(){var c=p.getFileListView().sm().ld();return!!c&&(Wc(c.url)||Zc(c.url))}}),c.push({id:"convertToSymbol",label:i("editor.converttosymbol"),action:function(){p.editor.open(p.getFileListView().sm().ld(),!0)},visible:function(){var c=p.getFileListView().sm().ld();return!!c&&(Wc(c.url)||Zc(c.url)||jc(c.url)||Ec(c.url))}}),c.push({id:"batchConvertSVG",label:i("editor.batchconvertsvg"),action:function(){p.editor.batchConvertSVG(p.getFileListView().sm().getSelection().toArray())},visible:function(){var c=p.getFileListView().sm().ld();return!!c&&Wc(c.url)}})},p}(SQ),pr=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));return r.editor=Q,r}
return Np(p,c),p.prototype.$6$=function(c){this.setGraphView(this.editor.gv)},p}(aQ),Qr=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));r.editView=Q,r.editor=Q.editor,r._topCanvas=q(),r._topDiv=z(),r._view.insertBefore(r._topCanvas,r._scrollBarDiv||null),r._view.insertBefore(r._topDiv,r._scrollBarDiv||null);var i=[];return r.menu=new BQ(i),r.menu.beforeShow=function(c){r._rightClickPosition=r.lp(c)},r.initMenuItems(i),r.menu.addTo(r.getView()),r.editor.menus.push(r.menu),r.addTopPainter(function(c){return c.texureImage2D=!0}),r}return Np(p,c),p.prototype.isEditable=function(p){return!!this.editable&&c.prototype.isEditable.call(this,p)},p.prototype.isMovable=function(p){return!!this.editable&&c.prototype.isMovable.call(this,p)},p.prototype.handleDelete=function(p){this.editable&&c.prototype.handleDelete.call(this,p)},p.prototype.onGroupDoubleClicked=function(p,Q,r){this.editable&&c.prototype.onGroupDoubleClicked.call(this,p,Q,r)},p.prototype.onEdgeDoubleClicked=function(p,Q,r){this.editable&&c.prototype.onEdgeDoubleClicked.call(this,p,Q,r)},p.prototype.checkDoubleClickOnNote=function(p,Q){return!!this.editable&&c.prototype.checkDoubleClickOnNote.call(this,p,Q)},p.prototype.$57$=function(c){var p=this;c.push({id:"copy",label:i("editor.copy"),action:function(){p.editor.copy()},visible:function(){return!!p.editor.ld}}),c.push({id:"paste",label:i("editor.paste"),action:function(){p.editor.paste(!1,p._rightClickPosition)},visible:function(){return p.editable&&p.editor.hasCopyInfo()}})},p.prototype.$56$=function(c){var p=this;c.push({separator:!0,visible:function(){return p.editable&&!!p.editor.ld}}),c.push({id:"bringToFront",label:i("editor.bringtofront"),action:function(){p.editor.bringToFront()},visible:function(){return p.editable&&!!p.editor.ld}}),c.push({id:"bringForward",label:i("editor.bringforward"),action:function(){p.editor.bringForward()},visible:function(){return p.editable&&!!p.editor.ld}}),c.push({id:"sendBackward",label:i("editor.sendbackward"),action:function(){p.editor.sendBackward()},visible:function(){return p.editable&&!!p.editor.ld}}),c.push({id:"sendToBack",label:i("editor.sendtoback"),action:function(){p.editor.sendToBack()},visible:function(){return p.editable&&!!p.editor.ld}})},p.prototype.addShapeSplitItems=function(c,p){var Q=this;c.push({id:"combined",label:i("editor.combineshapes"),action:function(){Q.editor.beginTransaction(),Wp(Q.editor.sm.getSelection().toArray(),p&&tQ),Q.editor.endTransaction()},visible:function(){return Q.editable&&Q.editor.sm.size()>1&&op(Q.editor.sm.getSelection())}}),c.push({id:"splitShape",label:i("editor.splitshape"),action:function(){Q.editor.beginTransaction(),Zp(Q.editor.ld,p&&tQ),Q.editor.endTransaction()},visible:function(){return Q.editable&&1===Q.editor.sm.size()&&Q.editor.ld instanceof ht.Shape}})},p.prototype.initMenuItems=function(c){},p.prototype.onClosed=function(){n(this.editor.menus,this.menu)},p.prototype.$58$=function(c){return c&&this.copyMap[c._id]?c._id:c},p.prototype.$50$=function(c,p){return c instanceof ht.Data?this.dm().contains(c)?c:void 0:p[c]},p.prototype.getSelectWidth=function(c){return!this.isEditable(c)||c instanceof ht.Edge?c.s("select.width"):0},p.prototype.onSelectionChanged=function(c){if(1===this.sm().size()&&("set"===c.kind||"append"===c.kind)){var p=this.sm().ld();p&&document.activeElement===this.getView()&&this._dataModel.isAutoAdjustIndex()&&this.adjustIndex(p)}},p.prototype.getContentRect=function(){var p=c.prototype.getContentRect.call(this);return p.width&&p.height||(p={x:0,y:0,width:this.dm().a("width")||100,height:this.dm().a("height")||100,empty:!0}),p},p.prototype.isDroppable=function(c,p){return!1},p.prototype.$59$=function(c){if(this.dragImage){var p=Jp.config.dragImageSize,Q=Y(c);this.dragImage.style.left=Q.x-p/2+"px",this.dragImage.style.top=Q.y-p/2+"px"}},p.prototype.removeDragImage=function(){this.dragImage&&(O(this.dragImage),this.dragImage=null)},p.prototype.handleCrossDrag=function(c,p,Q){var r=this,i=Q.view,n=i.draggingData;if("enter"===p){if(this._topDiv.style.border="solid "+Jp.config.color_select_dark+" 2px",!this.dragImage&&n){var y=void 0===n.a("dragImage")?n.getImage():n.a("dragImage");if(ht.Default.getImage(y)!==ht.Default.getImage("editor.unknown")){var X=Jp.config.dragImageSize;this.dragImage=ht.Default.toCanvas(y,X,X,"centerUniform",n,Q.view,null,ht.Default.devicePixelRatio),this.$59$(c),this.dragImage.style.opacity=Jp.config.dragImageOpacity,this.dragImage.className="ht-editor-dnd-image",ht.Default.appendToScreen(this.dragImage)}}}else if("exit"===p||"cancel"===p)this._topDiv.style.border="",this.removeDragImage();else if("over"===p)this.$59$(c);else if("drop"===p)if(this._topDiv.style.border="",n){this.removeDragImage();var W=this.lp(c);i.isSelected(n)?i.sm().toSelection().each(function(p){i.handleDropToEditView?i.handleDropToEditView(r.editView,p,W,c):r.editor.$100$(p,W)}):i.handleDropToEditView?i.handleDropToEditView(this.editView,n,W,c):this.editor.$100$(n,W)}else i===this.editor.dndFromOutside&&this.editor.dropLocalFileOnGraphView(c)},Ap(p,[{key:"editable",get:function(){return this.editor.editable},set:function(c){}}]),p}(DQ),rr=function(c){function p(Q){return Tp(this,p),Sp(this,c.call(this,Q))}return Np(p,c),p.prototype.handleDataModelChange=function(p){c.prototype.handleDataModelChange.call(this,p),this.editor&&this.editor.fireViewEvent(this.editView,"DataModelChanged",{event:p})},p.prototype.handleDataModelPropertyChange=function(p){c.prototype.handleDataModelPropertyChange.call(this,p),this.editor&&this.editor.fireViewEvent(this.editView,"DataModelPropertyChanged",{event:p})},p.prototype.handleDataPropertyChange=function(p){c.prototype.handleDataPropertyChange.call(this,p),this.editor&&this.editor.fireViewEvent(this.editView,"DataPropertyChanged",{event:p})},p.prototype.initMenuItems=function(c){this.$57$(c),this.$56$(c),this.addBlockItems(c),this.addShapeSplitItems(c)},p.prototype.isDroppable=function(c,p){if(this.editor.editable)return!!p.view.isDroppableToDisplayView},p.prototype.isSelectable=function(p,Q){return!p._refGraph&&c.prototype.isSelectable.call(this,p,Q)},p.prototype.addBlockItems=function(c){var p=this,Q=function(){return p.sm().size()>0},r=function(){for(var c=0;c<p.sm().size();c++){var Q=p.sm().getSelection().get(c);if(Q instanceof ht.Block&&!(Q instanceof ht.RefGraph))return!0}return!1};c.push({separator:!0,visible:function(){return p.editable&&(Q()||r())}}),c.push({id:"block",label:i("editor.block"),action:function(){p.editor.block()},visible:function(){return p.editable&&Q()}}),c.push({id:"unblock",label:i("editor.unblock"),action:function(){p.editor.unblock()},visible:function(){return p.editable&&r()}})},p}(Qr),ir=function(c){function p(Q,r,i,n){Tp(this,p);var y=Sp(this,c.call(this));return y.newAdded=n,y.defaultValueMap={},y.parse(Q,r,i),y}return Np(p,c),p.prototype.toLabel=function(){return this.getDisplayName()||this.s("type")||i("editor.comptype.comp")},p.prototype.getClass=function(){return p},p.prototype.getStyle=function(p,Q){var r=c.prototype.getStyle.call(this,p,Q);return void 0===r&&(r=this.defaultValueMap[p]),r},p.prototype.$61$=function(c){this.properties&&(this.properties=null),this.disableDirty=!0,this.defaultValueMap={};var p=this.s("type"),Q=ht.Default.getCompType(p);if(Q){this.$60$&&this.newAdded&&Q.events&&(this.a(Q.events),this.newAdded=!1),this.$60$=null;var r={cache:Q,width:{value:100,isSafeFunc:!0,func:function(c){return c._width}},height:{value:100,isSafeFunc:!0,func:function(c){return c._height}},comps:[{type:{func:function(c){return c.compType},isSafeFunc:!0}}]};if(!Q.width||this._width>0||this.setWidth(Q.width),!Q.height||this._height>0||this.setHeight(Q.height),Q.properties){this.properties=Q.properties;for(var i in this.properties){var n=this.properties[i];r.comps[0][i]={func:"style@"+i},c?ac(this,i,c[i],n.defaultValue):void 0===this.s(i)&&ac(this,i,void 0,n.defaultValue),this.defaultValueMap[i]=n.defaultValue}}var y=Jp.config.customProperties.comp;y&&y.length&&y.forEach(function(c){var p=c.property;r.comps[0][p]={func:"style@"+p}}),this.setImage(r),this.ivLater()}else this.$60$=c,"editor.comp"!==this.getImage()&&(this.setImage("editor.comp"),this.ivLater());this.disableDirty=!1},p.prototype.ivLater=function(){var c=this;ht.Default.callLater(function(){c.disableDirty=!0,c.iv(),c.disableDirty=!1})},p.prototype.onStyleChanged=function(p,Q,r){c.prototype.onStyleChanged.call(this,p,Q,r),"type"===p&&(this.fromDrop=!0,this.$61$(this.parsingComp))},p.prototype.parse=function(c,p,Q){if(c){if(this.parsingComp=c,ac(this,"type",c.type),this.$61$(c),Dc(this,c,p,Q),!this.$60$&&this.newAdded){var r=this.s("type"),i=ht.Default.getCompType(r);i.events&&this.a(i.events),this.newAdded=!1}this.parsingComp=null}},p.prototype.toJSON=function(){var c={};if(sc(this,c,"type","type",void 0),Uc(this,c),this.properties)for(var p in this.properties){var Q=this.properties[p];sc(this,c,p,p,Q.defaultValue)}return c},Ap(p,[{key:"compType",get:function(){var c=this.s("type");return this.$60$?this.$61$(this.$60$):c&&ht.Default.getCompType(c)!==this.getImage().cache&&this.$61$(),c}}]),p}(ht.Node),nr=function(c){function p(Q,r,i){Tp(this,p);var n=Sp(this,c.call(this));return n.s({border_color:Jp.config.color_dark,border_width:1}),n.setImage("border_image"),n.parse(Q,r,i),n}return Np(p,c),p.prototype.getClass=function(){return p},p.prototype.toLabel=function(){return this.getDisplayName()||i("editor.comptype.border")},p.prototype.parse=function(c,p,Q){c&&(ac(this,"type",c.type,"border"),ac(this,"border_color",c.color,Jp.config.color_dark),ac(this,"border_width",c.width,1),Dc(this,c,p,Q))},p.prototype.toJSON=function(){var c={};return sc(this,c,"type","type",void 0),sc(this,c,"border_color","color",void 0),sc(this,c,"border_width","width",void 0),Uc(this,c),c},Ap(p,[{key:"compType",get:function(){return this.s("type")}}]),p}(ht.Node),yr=function(c){function p(Q,r,i){Tp(this,p);var n=Sp(this,c.call(this));return n.setSize(100,100),n.setImage("pieChart_image"),n.s({"chart.label":!1,"chart.label.color":ht.Default.labelColor,"chart.label.font":ht.Default.labelFont,"chart.hollw":!1,"chart.start.angle":0,"chart.values":[],"chart.colors":void 0}),n.parse(Q,r,i),n}return Np(p,c),p.prototype.getClass=function(){return p},p.prototype.toLabel=function(){return this.getDisplayName()||i("editor.comptype.piechart")},p.prototype.parse=function(c,p,Q){c&&(ac(this,"chart.type",c.type,"pieChart"),ac(this,"chart.label",c.label,!1),ac(this,"chart.label.color",c.labelColor,ht.Default.labelColor),ac(this,"chart.label.font",c.labelFont,ht.Default.labelFont),ac(this,"chart.hollow",c.hollow,!1),ac(this,"chart.start.angle",c.startAngle,0),ac(this,"chart.values",c.values,[]),ac(this,"chart.colors",c.colors,void 0),Dc(this,c,p,Q))},p.prototype.toJSON=function(){var c={};return sc(this,c,"chart.type","type",void 0),sc(this,c,"chart.label","label",!1),sc(this,c,"chart.label.color","labelColor",ht.Default.labelColor),sc(this,c,"chart.label.font","labelFont",ht.Default.labelFont),sc(this,c,"chart.hollow","hollow",!1),sc(this,c,"chart.start.angle","startAngle",0),sc(this,c,"chart.values","values",[]),sc(this,c,"chart.colors","colors",void 0),Uc(this,c),c},Ap(p,[{key:"compType",get:function(){return this.s("chart.type")}}]),p}(ht.Node),Xr=function(c){function p(Q,r,i){Tp(this,p);var n=Sp(this,c.call(this));return n.setSize(100,100),n.setImage("columnChart_image"),n.s({"chart.label":!1,"chart.label.color":ht.Default.labelColor,"chart.label.font":ht.Default.labelFont,"chart.series":[],"chart.min.value":0,"chart.max.value":void 0}),n.parse(Q,r,i),n}return Np(p,c),p.prototype.getClass=function(){return p},p.prototype.toLabel=function(){return this.getDisplayName()||i("editor.comptype.columnchart")},p.prototype.parse=function(c,p,Q){c&&(ac(this,"chart.type",c.type,void 0),ac(this,"chart.label",c.label,!1),ac(this,"chart.label.color",c.labelColor,ht.Default.labelColor),ac(this,"chart.label.font",c.labelFont,ht.Default.labelFont),ac(this,"chart.series",c.series,[]),ac(this,"chart.min.value",c.minValue,0),ac(this,"chart.max.value",c.maxValue,void 0),Dc(this,c,p,Q))},p.prototype.toJSON=function(){var c={};return sc(this,c,"chart.type","type",void 0),sc(this,c,"chart.label","label",!1),sc(this,c,"chart.label.color","labelColor",ht.Default.labelColor),sc(this,c,"chart.label.font","labelFont",ht.Default.labelFont),sc(this,c,"chart.series","series",[]),sc(this,c,"chart.min.value","minValue",0),sc(this,c,"chart.max.value","maxValue",void 0),Uc(this,c),c},Ap(p,[{key:"compType",get:function(){return this.s("chart.type")}}]),p}(ht.Node),Wr=function(c){function p(Q,r,i){Tp(this,p);var n=Sp(this,c.call(this));return n.setSize(100,100),n.setImage("lineChart_image"),n.s({"chart.label":!1,"chart.label.color":ht.Default.labelColor,"chart.label.font":ht.Default.labelFont,"chart.series":[],"chart.min.value":0,"chart.max.value":void 0,"chart.line.point":!1,"chart.line.width":2,"chart.line.3d":!1}),n.parse(Q,r,i),n}return Np(p,c),p.prototype.getClass=function(){return p},p.prototype.toLabel=function(){return this.getDisplayName()||i("editor.comptype.linechart")},p.prototype.parse=function(c,p,Q){c&&(ac(this,"chart.type",c.type,void 0),ac(this,"chart.label",c.label,!1),ac(this,"chart.label.color",c.labelColor,ht.Default.labelColor),ac(this,"chart.label.font",c.labelFont,ht.Default.labelFont),ac(this,"chart.series",c.series,[]),ac(this,"chart.min.value",c.minValue,0),ac(this,"chart.max.value",c.maxValue,void 0),ac(this,"chart.line.point",c.linePoint,!1),ac(this,"chart.line.width",c.lineWidth,2),ac(this,"chart.line.3d",c.line3d,!1),Dc(this,c,p,Q))},p.prototype.toJSON=function(){var c={};return sc(this,c,"chart.type","type",void 0),sc(this,c,"chart.label","label",!1),sc(this,c,"chart.label.color","labelColor",ht.Default.labelColor),sc(this,c,"chart.label.font","labelFont",ht.Default.labelFont),sc(this,c,"chart.series","series",[]),sc(this,c,"chart.min.value","minValue",0),sc(this,c,"chart.max.value","maxValue",void 0),sc(this,c,"chart.line.point","linePoint",!1),sc(this,c,"chart.line.width","lineWidth",2),sc(this,c,"chart.line.3d","line3d",!1),Uc(this,c),c},Ap(p,[{key:"compType",get:function(){return this.s("chart.type")}}]),p}(ht.Node),Zr={width:!0,height:!0,position:!0,rotation:!0,anchor:!0,scale:!0,expanded:!0};ht.Default.getMSMap().hteditor_editview=function(c,p){Object.defineProperties(c,{dirty:{get:function(){return this.tab.a("dirty")},set:function(c){ht.Default.loadingRefGraph||this.tab.a("dirty",c)}}}),c.reload=function(){if(this.url){var c={url:this.url};if(this.editor.fireViewEvent(this,"Reloading",c),c.preventDefault)return!1;this.parse(this.url)}},c.save=function(c,p){var Q=this;if(!this.editable)return void(c&&c());var r=function(){c&&c(),Q.editor.fireViewEvent(Q,"Saved",{url:Q.url}),Q.editor.selectFileNode(Q.url)};if(p)this._saveAs(r,p);else if(this.url)this._saveImpl(r);else{var n=this.editor._rightClickURL||this.editor[this.type+"s"].currentDir,y=i("editor.inputnew"+this.type+"name"),X=this.editor[this.type+"s"];if(X.isAccordionMode()&&X.rootDir===n)return void this.editor.showMessage(i("editor.createFolderFirst"),"error",2e3);this._saveNew(c,r,y,n)}},c._saveNew=function(c,p,Q,r){var n=this,y=function(Q,y){if("ok"===y){var X=nc(Q)?_(Q):Q,W=r+"/"+X+".json";n.editor.getFileNode(W)?Nc(i("editor.filenameconflict"),W,function(){c&&c()}):(n.tab.setName(X),n.url=W,n.tab.setTag(n.url),n.editor.dataView.updateUrl(),n._saveImpl(p,!0))}else c&&c()},X={name:void 0};if(this.editor.fireViewEvent(this,"NewNameInputing",X),X.preventDefault)return!1;X.name?y(X.name,"ok"):Ac(Q,this.tab.getName(),{nullable:!1,trim:!0,maxLength:Jp.config.maxFileNameLength,checkFunc:Jp.config.checkFileName},y)},c._saveAs=function(c,p){this.tab.setName(w(p)),this.url=p,this.tab.setTag(this.url),this.editor.dataView.updateUrl(),this._saveImpl(c)},c._saveImpl=function(c,p){var Q=this,r=this.url,n={url:r};if("display"===this.type&&Jp.config.settingDefaultValueBeforeSaving&&this.dm.each(function(c){if(c instanceof ht.Node){var p=ht.Default.getImage(c.getImage());p&&p.dataBindings&&p.dataBindings.forEach(function(p){var Q=c.getAttrObject(),r=p.defaultValue;if(void 0!==r){var i=p.attr;Q&&void 0!==Q[i]||c.a(i,r)}})}}),this.editor.fireViewEvent(this,"Saving",n),n.preventDefault)return p&&(this.tab.setName(i("editor.untitled")),delete this.url,this.tab.setTag(void 0),this.editor.dataView.updateUrl()),!1;n={path:n.url,content:U(this.content)},this.editor.request("upload",n,function(p){!0===p?Q.editor.saveImage(Q.dm.a("snapshotURL")||Q.g3d||Q.graphView,r.substr(0,r.length-5)+".png",function(){c&&c(),Q.editor.showMessage(i("editor.savedsuccessfully"),"normal",1e3),Q.dirty=!1}):(Q.tab&&Q.editor.mainTabView.removeTab(Q.tab),delete Q.tab,Q.editor.showMessage(i("editor.savedfailed"),"error",1e3))})},c.parse=function(c,p){(c||p)&&(this.url=c,p?this.update(p):M(c,this.update.bind(this)))},c.update=function(c,p){var Q=this;if(c){if(p){var r=U(this.content),i=c,n={undo:function(){Q.updateImpl(r,!0)},redo:function(){Q.updateImpl(i,!0)}};this.dm.disableHistoryManager(),this.updateImpl(c,p),this.dm.enableHistoryManager(),this.dm.addHistory(n)}else this.dm.disableHistoryManager(),this.updateImpl(c,p),this.dm.enableHistoryManager(),this.dm.clearHistoryManager();var y=void 0;p?y="Committed":this.isOpened?y="Reloaded":(y="Opened",this.isOpened=!0);var X={url:this.url,json:c};this.editor.fireViewEvent(this,y,X)}},c.updateImpl=function(c,p){var r=this,i=a(c);if(this.clear(),this.isDeserializing=!0,this.dm.deserialize(i,void 0,{disableOnPreDeserialize:!0,disableOnPostDeserialize:!0}),this.isDeserializing=!1,this.dirty=!!p,!p&&Jp.config.fitContentForDisplayView)if(i.contentRect){var n=Q(i.contentRect);ht.Default.grow(n,Jp.config.fitPadding),this.graphView.getWidth()&&this.graphView.getHeight()?this.graphView.fitRect(n,Jp.config.animate):setTimeout(function(){r.graphView.fitRect(n,Jp.config.animate)},500)}else this.graphView.fitContent(Jp.config.animate,Jp.config.fitPadding)},c.$4$=function(){return this._interactionState},c.$5$=function(c,p,Q){var r=this,i=this._interactionState;if(i!==c){this._interactionState=c,this.editor.pointsEditingMode=!1;var n=[];if(this.graphView.getInteractors().each(function(p){p.keep?p.disabled="edit"!==c:n.push(p)}),n.forEach(function(c){c.tearDown(),r.graphView.getInteractors().remove(c)}),"edit"!==c){var y=this.createInteractor(p,Q);y.setUp(),this.graphView.getInteractors().add(y)}this.graphView.invalidateSelection(),this.editor.mainToolbar.iv(),this.fp("interactionState",i,c),this.validateCanvas()}},c.addData=function(c){var p=arguments.length>1&&void 0!==arguments[1]&&arguments[1],Q=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i="symbol"===this.type?"compCreated":"dataCreated",n={data:c};if(Q)return void this.editor.fireViewEvent(this,i,n,!1);this.dm.beginTransaction(),p||c.getParent()||c.setParent(this.graphView.getCurrentSubGraph()),this.dm.add(c),p||(r||this.dm.sm().ss(c),this.graphView.setFocus()),this.editor.fireViewEvent(this,i,n,!1),this.dm.endTransaction()},c.skewGrid=function(){this.dm.beginTransaction(),this.dm.a("gridAngle",2*Math.PI/3),this.dm.a("gridRotation",Math.PI/6),this.dm.endTransaction()},c.preview=function(){this.$65$("previews/"+this.type+".json",this.dm.a("previewURL")||Jp.config[this.type+"PreviewURL"])},c.$65$=function(c,p){var Q=this;this.tab.getTag()&&-1===p.indexOf("?")&&(p+="?tag="+encodeURI(this.tab.getTag()));var r={url:p};if(this.editor.fireViewEvent(this,"Previewing",r),r.preventDefault)return!1;p=r.url,window.open(p,p);var i=this.content;i.title=this.tab.getName(),r={path:c,content:U(i)},this.editor.request("upload",r,function(c){Q.editor.fireViewEvent(Q,"Preview",{url:p})})}};var or=function(){function c(p,Q,r,i,n){var y=this;Tp(this,c),this.editor=p,this.tab=Q,this.type=i,this.sceneView=n,Q.setView(this);var X=this.gv=this.graphView=new r(this);this._view=x(!0,this),X.addViewListener(function(c){"validate"===c.kind&&y.validateCanvas()}),this._hRuler=q(),this._vRuler=q(),this._view.appendChild(X.getView()),this.$5$("edit"),X.isInteractive=function(){return!1},X.addPropertyChangeListener(function(){y.iv()}),X.addInteractorListener(function(c){y.handleInteractorEvent(c)}),this.dm.sm().addSelectionChangeListener(function(c){y.iv()}),this.dm.addDataModelChangeListener(function(c){y.handleDataModelChanged(c)}),this.dm.addDataPropertyChangeListener(function(c){y.handleDataPropertyChanged(c)}),this.dm.addPropertyChangeListener(function(c){y.handleDataModelPropertyChanged(c)}),this.dm.addHierarchyChangeListener(function(c){y.handleHierarchyChanged(c)}),this.dm.layout=function(c,p){y._autoLayout||(y._autoLayout=new ht.layout.AutoLayout(X)),y._autoLayout.options=p||{};var Q=y.graphView.getZoom(),r=y.graphView.tx(),i=y.graphView.ty();y.dm.beginTransaction(),y._autoLayout.setAnimate(Jp.config.animate);var n=function(){var c=y.graphView.getZoom(),p=y.graphView.tx(),n=y.graphView.ty(),X={undo:function(){y.graphView.setZoom(Q),y.graphView.tx(r),y.graphView.ty(i)},redo:function(){y.graphView.setZoom(c),y.graphView.tx(p),y.graphView.ty(n)}};y.dm.addHistory(X),y.dm.endTransaction()};y._autoLayout.layout(c,function(){Jp.config.animate?X.fitContent({finishFunc:n}):(X.fitContent(!1,Jp.config.fitPadding),n())})},this.graphView.setEditable(!0),this.graphView.setEditStyle("hoverGuideVisible",Jp.config.hoverGuideVisible),this.graphView.setEditStyle("anchorVisible",Jp.config.anchorVisible),this.graphView.setEditStyle("connectGuideVisible",Jp.config.connectGuideVisible),this.graphView.setEditStyle("guideLineVisible",Jp.config.guideLineVisible),this.graphView.setEditStyle("moveDummyThreshold",Jp.config.moveDummyThreshold),this.graphView.setEditStyle("smartGuideThreshold",Jp.config.smartGuideThreshold),this.graphView.getInteractors().each(function(c){c.keep=!0}),this.setRulerEnabled(this.editor.isRulerEnabled()),this.setGridEnabled(this.editor.isGridEnabled()),this.clear()}return c.prototype.resetGrid=function(){},c.prototype.clear=function(){this.dm.beginTransaction(),this.dm.setName(void 0),this.dm.setBackground(void 0),this.dm.setHierarchicalRendering(!1),this.dm.setLayers(void 0),this.dm.clear(),this.dm.setAttrObject(void 0),this.dm.a("rotateAsClock",Jp.config.rotateAsClock),this.resetGrid(),this.dm.endTransaction()},c.prototype.handleInteractorEvent=function(c){"prepareMove"!==c.kind&&"prepareEdit"!==c.kind||!c.event.altKey||(this.editor.copy(),this.editor.paste(!0),this.editor.gv.validate())},c.prototype.handleDataModelChanged=function(c){this.dirty=!0},c.prototype.handleDataPropertyChanged=function(c){c.data.disableDirty||this.graphView.fpImageLoaded||"*"!==c.property&&(Zr[c.property]&&this.iv(),this.dirty=!0)},c.prototype.handleHierarchyChanged=function(c){this.dirty=!0},c.prototype.handleDataModelPropertyChanged=function(c){var p=c.property,Q=c.newValue;null!=Q&&("a:gridBlockSize"===p?this.graphView.setEditStyle("gridBlockSize",Q):"a:gridThickLinesEvery"===p?this.graphView.setEditStyle("gridThickLinesEvery",Q):"a:gridThickColor"===p?this.graphView.setEditStyle("gridThickColor",Q):"a:gridLightColor"===p?this.graphView.setEditStyle("gridLightColor",Q):"a:gridAngle"===p?this.graphView.setEditStyle("gridAngle",Q):"a:gridRotation"===p?this.graphView.setEditStyle("gridRotation",Q):"a:gridZoomThreshold"===p&&this.graphView.setEditStyle("gridZoomThreshold",Q)),"a:connectActionType"===p?this.graphView.setCurrentConnectActionType(Q):"a:rotateAsClock"===p&&this.graphView.setEditStyle("rotateAsClock",Q),this.dirty=!0,this.validateCanvas()},c.prototype.onPropertyChanged=function(c){"rulerEnabled"===c.property&&(this.graphView.getEditInteractor().alignmentGuideEnabled=c.newValue),"gridEnabled"===c.property&&(this.graphView.getEditInteractor().gridEnabled=c.newValue),this.iv()},c.prototype.onClosed=function(){this.graphView.onClosed()},c.prototype.validateCanvasLater=function(){var c=this;c._drawTimer||(c._drawTimer=setTimeout(function(){c._drawTimer=null,c.validateCanvas()},0))},c.prototype.validateCanvas=function(){var c=this.graphView._topCanvas,p=S(c);p.clearRect(0,0,c.clientWidth,c.clientHeight),this.graphView.getInteractors().each(function(c){c.$0$&&c.$0$(p)}),this.$0$(p),p.restore()},c.prototype.redraw=function(){this._lastWidth=this._lastHeight=null,this.iv()},c.prototype.validateImpl=function(){var c=this._rulerSize,p=this._rulerEnabled,Q=this.getWidth(),r=this.getHeight();if(Q!==this._lastWidth||r!==this._lastHeight||c!==this._lastRulerSize||p!==this._lastRulerEnabled){if(this._lastWidth=Q,this._lastHeight=r,this._lastRulerSize=c,this._lastRulerEnabled=p,p){this._hRuler.parentNode||(this._view.appendChild(this._hRuler),this._view.appendChild(this._vRuler));var i=Math.max(0,Q-c),n=Math.max(0,r-c);L(this._hRuler,c,0,i,c),L(this._vRuler,0,c,c,n),L(this.graphView,c,c,i,n),L(this.graphView._topDiv,0,0,i,n),H(this.graphView._topCanvas,i,n),H(this._hRuler,i,c),H(this._vRuler,c,n)}else this._hRuler.parentNode&&(O(this._hRuler),O(this._vRuler)),L(this.graphView,0,0,Q,r),L(this.graphView._topDiv,0,0,Q,r),H(this.graphView._topCanvas,Q,r);this.validateCanvas()}this._hRuler.style.background=this._rulerBackground,this._vRuler.style.background=this._rulerBackground,this.drawRuler()},c.prototype.$0$=function(c){var p=this.graphView.getZoom(),Q=this.graphView.tx(),r=this.graphView.ty(),i=Math.round(this.dm.a("width")||0)*p,n=Math.round(this.dm.a("height")||0)*p,y=this.graphView.getWidth(),X=this.graphView.getHeight();!Jp.config.mixMaskAndBackground&&this.dm.getBackground()||i>0&&n>0&&y>0&&X>0&&(c.beginPath(),Q&&c.rect(0,0,Q,X),r&&y-Q&&c.rect(Q,0,y-Q,r),y-Q-i&&n&&c.rect(Q+i,r,y-Q-i,n),y-Q&&X-r-n&&c.rect(Q,r+n,y-Q,X-r-n),c.fillStyle=Jp.config.color_mask,c.fill())},c.prototype.drawVerticalText=function(c,p,Q){c.save(),c.translate(11,Q+11),c.rotate(-Math.PI/2),T(c,p,this._rulerFont,this._rulerColor,11,-11,0,this._rulerSize,"right"),c.restore()},c.prototype.drawRuler=function(){if(this._rulerEnabled){var c,p,Q,r,i,n,y=this._rulerFont,X=this._rulerSize,W=this._rulerColor,Z=this.graphView,o=Z.getUnionNodeRect(Z.sm().getSelection()),l=Z.getZoom(),j=Math.log(l)/Math.log(10),E=Math.floor(j),m=100/Math.pow(10,E)*l,f=m/10,I=E>1?40+10*(E-1):40,G=Math.round(Z.tx()),e=Math.round(Z.ty()),P={x:-G,y:-e,width:Z.getWidth(),height:Z.getHeight()},d=Math.floor(P.x/m),R=Math.ceil((P.x+P.width)/m),t=Math.floor(P.y/m),b=Math.ceil((P.y+P.height)/m);for(S(this._hRuler,0,0,1,{x:0,y:0,width:P.width,height:X}).restore(),r=S(this._hRuler,G,0,1),r.lineWidth=1,r.strokeStyle=W,o&&(r.beginPath(),r.rect(o.x*l,0,o.width*l,X),r.fillStyle=Jp.config.color_line,r.fill()),r.beginPath(),c=d;c<=R;c++)i=c*m,n=E>1?(i/l).toFixed(E-1):Math.round(i/l),i=Math.round(i),r.moveTo(i,X),r.lineTo(i,0),T(r,n,y,W,i,0,1,X,"left");for(r.stroke(),r.beginPath(),c=d;c<=R;c++)for(Q=1;Q<10;Q++)i=c*m+Q*f,n=E>1?(i/l).toFixed(E-1):Math.round(i/l),i=Math.round(i),r.moveTo(i,X),5===Q?(r.lineTo(i,X-10),T(r,n,y,W,i,0,1,X,"left")):(r.lineTo(i,X-4),f>I&&T(r,n,y,W,i,0,1,X,"left"));for(r.stroke(),r.restore(),S(this._vRuler,0,0,1,{x:0,y:0,width:X,height:P.height}).restore(),r=S(this._vRuler,0,e,1),r.lineWidth=1,r.strokeStyle=W,o&&(r.beginPath(),r.rect(0,o.y*l,X,o.height*l),r.fillStyle=Jp.config.color_line,r.fill()),r.beginPath(),p=t;p<=b;p++)i=p*m,n=E>1?(i/l).toFixed(E-1):Math.round(i/l),i=Math.round(i),r.moveTo(X,i),r.lineTo(0,i),this.drawVerticalText(r,n,i);for(r.stroke(),r.beginPath(),p=t;p<=b;p++)for(Q=1;Q<10;Q++)i=p*m+Q*f,n=E>1?(i/l).toFixed(E-1):Math.round(i/l),i=Math.round(i),r.moveTo(X,i),5===Q?(r.lineTo(X-10,i),this.drawVerticalText(r,n,i)):(r.lineTo(X-4,i),f>I&&this.drawVerticalText(r,n,i));r.stroke(),r.restore()}},Ap(c,[{key:"editable",get:function(){return this.sceneView?this.sceneView.editable:this._editable},set:function(c){this.sceneView||c!==this._editable&&(this._editable=c,this.gv.invalidateSelection())}},{key:"dm",get:function(){return this.graphView.dm()}}]),c}();v(or,{ms_v:1,ms_fire:1,ms_ac:["gridEnabled","rulerEnabled","rulerBackground","rulerFont","rulerColor","rulerSize","guideColor"],hteditor_editview:1,_rulerFont:Jp.config.smallFont,_rulerBackground:Jp.config.color_pane,_rulerColor:Jp.config.color_dark,_rulerSize:Jp.config.rulerSize,_guideColor:Jp.config.color_transparent,_interactionState:void 0});var lr=function(c){function p(Q,r,i){Tp(this,p);var n=Sp(this,c.call(this,Q.getView().graphView));return n.tab=Q,n.editView=Q.getView(),n.editor=n.editView.editor,n.clazz=r,n.type=i,n._disabled=!1,n}return Np(p,c),p.prototype.beginTransaction=function(){this._isBeginTransaction||(this._isBeginTransaction=!0,this.dm.beginTransaction())},p.prototype.endTransaction=function(){this._isBeginTransaction&&(this._isBeginTransaction=!1,this.dm.endTransaction())},p.prototype.getDataAt=function(c){return this.gv.getDataAt(c)},p.prototype.getNodeAt=function(c){var p=this.getDataAt(c);return p instanceof ht.Node?p:null},p.prototype.setUp=function(){c.prototype.setUp.call(this),this.sm.cs()},p.prototype.$0$=function(c){},p.prototype.drawDiamond=function(c,p,Q,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4;p=this.toPoint(p),r&&(c.fillStyle=r),Q&&(c.strokeStyle=Q);var n=p,y=n.x,X=n.y;c.lineWidth=1,c.beginPath(),c.moveTo(y,X-i),c.lineTo(y+i,X),c.lineTo(y,X+i),c.lineTo(y-i,X),c.closePath(),r&&c.fill(),Q&&c.stroke()},p.prototype.drawRect=function(c,p,Q,r){p=this.toRect(p),r&&(c.fillStyle=r),Q&&(c.strokeStyle=Q),c.lineWidth=1,c.beginPath(),c.rect(p.x,p.y,p.width,p.height),c.stroke(),r&&c.fill(),Q&&c.stroke()},p.prototype.drawPoint=function(c,p,Q,r,i){p=this.toPoint(p),i&&(c.fillStyle=i),r&&(c.strokeStyle=r),c.lineWidth=1,c.beginPath(),c.arc(p.x,p.y,Q,0,2*Math.PI,!0),i&&c.fill(),r&&c.stroke()},p.prototype.drawPoints=function(c,p,Q,r,i){for(var n=0;n<p.length;n++)this.drawPoint(c,p[n],Q,r,i)},p.prototype.drawLine=function(c,p,Q,r){p=this.toPoint(p),Q=this.toPoint(Q),c.lineWidth=1,c.strokeStyle=r,c.beginPath(),c.moveTo(p.x,p.y),c.lineTo(Q.x,Q.y),c.stroke()},p.prototype.toRect=function(c){var p=this.zoom;return{x:c.x*p+this.tx,y:c.y*p+this.ty,width:c.width*p,height:c.height*p}},p.prototype.toPoint=function(c){return{x:c.x*this.zoom+this.tx,y:c.y*this.zoom+this.ty}},p.prototype.add=function(c){this.editView.addData(c)},p.prototype.remove=function(c){this.dm.remove(c)},p.prototype.lp=function(c){return this.gv.lp(c)},Ap(p,[{key:"dm",get:function(){return this.gv.dm()}},{key:"sm",get:function(){return this.gv.dm().sm()}},{key:"zoom",get:function(){return this.gv.getZoom()}},{key:"tx",get:function(){return this.gv.tx()}},{key:"ty",get:function(){return this.gv.ty()}},{key:"disabled",get:function(){return!this.editor.editable||this._disabled},set:function(c){this._disabled=c}}]),p}(ht.graph.Interactor),jr=function(c){function p(Q,r,i){return Tp(this,p),Sp(this,c.call(this,Q,r,i))}return Np(p,c),p.prototype.tearDown=function(){c.prototype.tearDown.call(this),this.node=this.p1=this.p2=null},p.prototype.$49$=function(c){this.node?this.remove(this.node):this.editView.$5$("edit")},p.prototype.handle_mousedown=function(c){this.handle_touchstart(c)},p.prototype.handle_touchstart=function(c){k(c),P(c)&&(this.gv.setFocus(c),this.p1=this.lp(c),this.startDragging(c))},p.prototype.handleWindowMouseMove=function(c){this.handleWindowTouchMove(c)},p.prototype.handleWindowMouseUp=function(c){this.handleWindowTouchEnd(c)},p.prototype.handleWindowTouchMove=function(c){if(k(c),this.p1){this.p2=this.lp(c);var p=F(this.p1,this.p2);if(this.node)this.node.setRect(p);else{if(!p.width||!p.height)return;this.beginTransaction(),this.createNode(p,!1)}}},p.prototype.handleWindowTouchEnd=function(c){if(k(c),this.endTransaction(),!this.node&&this.p1&&this.createNode({x:this.p1.x-25,y:this.p1.y-25,width:50,height:50},!0),this.node){var p="symbol"===this.editView.type?"compCreated":"dataCreated",Q={data:this.node};this.editor.fireViewEvent(this.editView,p,Q,!1)}Jp.config.continuousCreating?this.node=this.p1=this.p2=null:this.editView.$5$("edit")},p.prototype.createNode=function(c,p){
ec(this.type)?this.node=this.type(c,p):this.node=new this.clazz,p?this.node.setPosition(c.x+c.width/2,c.y+c.height/2):this.node.setRect(c),this.node.setParent(this.editView.graphView.getCurrentSubGraph()),this.dm.add(this.node),this.dm.sm().ss(this.node),this.editView.graphView.setFocus()},p.prototype.$0$=function(c){this.node&&this.drawRect(c,this.node.getRect(),Jp.config.color_data_border)},p}(lr),Er=function(c){function p(Q,r,i){return Tp(this,p),Sp(this,c.call(this,Q,r,i))}return Np(p,c),p.prototype.tearDown=function(){c.prototype.tearDown.call(this),this.draggingPoint=this.n1=this.n2=null},p.prototype.$49$=function(c){this.n1?(this.draggingPoint=this.n1=this.n2=null,this.editView.validateCanvas()):this.editView.$5$("edit")},p.prototype.drawAttachPoints=function(c,p,Q){var r=this,i=this.gv.getAttachPoints(p);i&&i.forEach(function(i,n){var y=i.x,X=i.y,W=i.offsetX,Z=i.offsetY;n===Q?r.drawDiamond(c,p.getAttachPosition(y,X,W,Z),Jp.config.color_select,Jp.config.color_select,6):r.drawDiamond(c,p.getAttachPosition(y,X,W,Z),Jp.config.color_select,Jp.config.color_light)})},p.prototype.drawCurve=function(c,p,Q){var r=this.gv.getEditInteractor();if(!r)return null;var i=r.getSubModule("Curve");if(!i)return null;i.drawEdgeHostHighlight(c,p,Q),this.editView.validateCanvasLater()},p.prototype.$0$=function(c){if(this.n1&&(this.n1 instanceof ht.Edge?this.drawCurve(c,this.n1,this.edgePosition1):(this.drawRect(c,this.gv.getNodeRect(this.n1),Jp.config.color_data_border),this.drawAttachPoints(c,this.n1,this.attachIndex1)),this.draggingPoint)){var p=void 0,Q=void 0;p=this.n1 instanceof ht.Edge?this.edgePosition1.point:this.attachIndex1||0===this.attachIndex1?this.getAttachPosition(this.n1,this.attachIndex1):this.n1.p(),this.n2 instanceof ht.Edge?Q=this.edgePosition2.point:this.n2&&(this.attachIndex2||0===this.attachIndex2)&&(Q=this.getAttachPosition(this.n2,this.attachIndex2)),this.drawLine(c,p,Q||this.draggingPoint,Jp.config.color_data_border)}if(this.n2)if(this.n2 instanceof ht.Edge)this.drawCurve(c,this.n2,this.edgePosition2);else{var r=this.gv.getNodeRect(this.n2);this.n1!==this.n2&&(this.drawRect(c,r,Jp.config.color_data_border),this.drawAttachPoints(c,this.n2,this.attachIndex2));var i=this.toPoint({x:r.x,y:r.y});c.beginPath(),c.moveTo(i.x,i.y-15-3),c.lineTo(i.x+10,i.y-15-3),c.lineTo(i.x+10,i.y-3),c.lineTo(i.x+5,i.y-7-3),c.moveTo(i.x+10,i.y-3),c.lineTo(i.x+15,i.y-7-3),c.lineWidth=1,c.strokeStyle=Jp.config.color_data_border,c.stroke()}},p.prototype.handle_mousemove=function(c){if(k(c),!this.draggingPoint){var p=this.getDataAt(c);if(p instanceof ht.Edge)this.edgePosition1=this.gv.calculateEdgePosition(p,this.lp(c));else{var Q=this.attachIndex1;if(p){var r=this.gv.calculateAttachPoint(p,this.lp(c));this.attachIndex1=r?r.index:null}else this.attachIndex1=null;if(p===this.n1&&Q===this.attachIndex1)return}this.n1=p,this.editView.validateCanvas()}},p.prototype.handle_mousedown=function(c){this.handle_touchstart(c)},p.prototype.handle_touchstart=function(c){k(c),P(c)&&(this.gv.setFocus(c),this.draggingPoint||(this.n1=this.getDataAt(c),this.n1&&(this.draggingPoint=this.lp(c),this.startDragging(c))))},p.prototype.handleWindowMouseMove=function(c){this.handleWindowTouchMove(c)},p.prototype.handleWindowMouseUp=function(c){this.handleWindowTouchEnd(c)},p.prototype.handleWindowTouchMove=function(c){var p=this.getDataAt(c);if(this.draggingPoint=this.lp(c),this.autoScroll(c),Jp.config.edgeLoop||this.n1!==p){if(this.n2=p,p)if(p instanceof ht.Edge)this.edgePosition2=this.gv.calculateEdgePosition(p,this.lp(c));else{var Q=this.gv.calculateAttachPoint(p,this.lp(c));this.attachIndex2=Q?Q.index:null}}else this.attachIndex2=null,this.edgePosition2=null;this.editView.validateCanvas()},p.prototype.handleWindowTouchEnd=function(c){if(this.n1&&this.n2){var p=void 0;Ic(this.type)?(p=new this.clazz(this.n1,this.n2),p.s("edge.type",this.type)):p=ec(this.type)?this.type(this.n1,this.n2):new this.clazz(this.n1,this.n2);var Q=void 0,r=void 0;if(this.n1 instanceof ht.Edge)void 0!==this.edgePosition1.index?p.setStyle("edge.source.index",this.edgePosition1.index):void 0!==this.edgePosition1.percent&&p.setStyle("edge.source.percent",this.edgePosition1.percent);else if(Q=this.getAttachPoint(this.n1,this.attachIndex1)){var i=Q,n=i.x,y=i.y,X=i.offsetX,W=i.offsetY;p.s({"edge.source.anchor.x":n,"edge.source.anchor.y":y,"edge.source.offset.x":X,"edge.source.offset.y":W})}if(this.n2 instanceof ht.Edge)void 0!==this.edgePosition2.index?p.setStyle("edge.target.index",this.edgePosition2.index):void 0!==this.edgePosition2.percent&&p.setStyle("edge.target.percent",this.edgePosition2.percent);else if(r=this.getAttachPoint(this.n2,this.attachIndex2)){var Z=r,o=Z.x,l=Z.y,j=Z.offsetX,E=Z.offsetY;p.s({"edge.target.anchor.x":o,"edge.target.anchor.y":l,"edge.target.offset.x":j,"edge.target.offset.y":E})}(Q||r)&&p.s("edge.offset",0),this.add(p),Jp.config.continuousCreating||this.editView.$5$("edit")}this.draggingPoint=this.n1=this.n2=null,this.editView.validateCanvas()},p.prototype.getAttachPoint=function(c,p){if(null===p||void 0===p)return null;var Q=this.gv.getAttachPoints(c);return Q&&0!==Q.length?Q[p]:null},p.prototype.getAttachPosition=function(c,p){var Q=this.getAttachPoint(c,p),r=Q.x,i=Q.y,n=Q.offsetX,y=Q.offsetY;return c.getAttachPosition(r,i,n,y)},p}(lr),mr=function(c){function p(Q,r,i){Tp(this,p);var n=Sp(this,c.call(this,Q,r,i));return n.points=[],n.segments=[],n.nextPoint=null,n.closePath=!1,n}return Np(p,c),p.prototype.tearDown=function(){c.prototype.tearDown.call(this),this.points=[],this.segments=[],this.nextPoint=null,this.isBreak=!1},p.prototype.$49$=function(c){this.isBreak?this.createShape():(this.preCtrl=null,this.isBreak=!0,this.editView.validateCanvas())},p.prototype.createShape=function(){if(this.points.length>1){var c=void 0;ec(this.type)?c=this.type(this.points,this.segments):(c=new this.clazz,c.setPoints(this.points),c.setSegments(this.segments)),this.closePath&&c.setClosePath&&c.setClosePath(!0),this.add(c)}this.editView.$5$("edit"),this.editor.pointsEditingMode=!0},p.prototype.handle_mousedown=function(c){this.handle_touchstart(c)},p.prototype.isCloseStart=function(c){var p=this.points[0];if(!p)return!1;var Q=this.lp(c);return ht.Default.getDistance(p,Q)<5},p.prototype.handle_touchstart=function(c){if(k(c),P(c)){if(this.gv.setFocus(c),d(c))this.createShape();else{if(this.isCloseStart(c))return this.closePath=!0,void this.createShape();var p=this.judgeNextPoint(c,!0);if(this.points.length){var Q=this.points[this.points.length-1];if(Math.abs(Q.x-p.x)<.01&&Math.abs(Q.y-p.y)<.01)return}this.preCtrl?(this.points.push(this.preCtrl),this.points.push(p),this.points.push(p),this.segments.push(4),this.preCtrl=null):(this.isBreak?(this.segments.push(1),this.isBreak=!1):this.segments.push(this.points.length>0?2:1),this.points.push(p)),this.nextPoint=this.lp(c),this.editView.validateCanvas()}this.downPoint=this.lp(c),this.startDragging(c),this._dragging=!0}},p.prototype.judgeNextPoint=function(c,p){var Q=this.lp(c);if(this._dragging||this.isBreak&&!p)return null;if(ht.Default.isShiftDown()&&this.points.length>0){var r=this.points[this.points.length-1],i=Q.x-r.x,n=Q.y-r.y,y=Math.atan2(n,i),X=ht.Default.getDistance(r,Q),W=y%(Math.PI/4);return y-=W,Math.abs(W)>Math.PI/8&&(W>0?y+=Math.PI/4:y-=Math.PI/4),{x:r.x+Math.cos(y)*X,y:r.y+Math.sin(y)*X}}var Z=this.gv.getEditInteractor(),o=Z.gridGuide.findClosest(Q);return o&&(o.x&&(Q.x+=o.x),o.y&&(Q.y+=o.y)),Q},p.prototype.handle_mousemove=function(c){this.nextPoint=this.judgeNextPoint(c),this.editView.validateCanvas()},p.prototype.handle_touchend=function(c){},p.prototype.handle_mouseup=function(c){this.handle_touchend(c)},p.prototype.handleWindowTouchMove=function(c){return this.handleWindowMouseMove(c)},p.prototype.updateCtrl=function(c){var p=this.points.length,Q=this.points[p-1],r=this.downPoint,i=this.lp(c),n=this.gv.getZoom(),y=ht.Default.getDistance(r,i),X=this.segments[this.segments.length-1];if(y*n>5){if(ht.Default.isShiftDown()){var W=Math.abs;W(Q.x-i.x)>=W(Q.y-i.y)?i.y=Q.y:i.x=Q.x}else{var Z=this.gv.getEditInteractor(),o=Z.gridGuide.findClosest(i);o&&(o.x&&(i.x+=o.x),o.y&&(i.y+=o.y))}var l={x:2*Q.x-i.x,y:2*Q.y-i.y};4===X?this.points[p-2]=l:1!==X&&(this.segments.pop(),this.segments.push(4),this.points.splice(p-1,0,l),this.points.push(this.points[p-1])),this.preCtrl=i}else 4===X&&(this.points[p-2]=this.points[p-1],this.preCtrl=null)},p.prototype.handleWindowMouseMove=function(c){0!==this.points.length&&(this.updateCtrl(c),this.editView.validateCanvas())},p.prototype.handleWindowTouchEnd=function(c){return this.handleWindowMouseUp(c)},p.prototype.handleWindowMouseUp=function(c){0!==this.points.length&&(this._dragging=!1,this.updateCtrl(c),this.nextPoint=this.judgeNextPoint(c,!0))},p.prototype.$0$=function(c){var p=[];c.beginPath();for(var Q=0,r=void 0,i=void 0,n=void 0,y=0;y<this.segments.length;y++){var X=this.segments[y];1===X?(r=this.toPoint(this.points[Q++]),c.moveTo(r.x,r.y)):2===X?(r=this.toPoint(this.points[Q++]),c.lineTo(r.x,r.y)):3===X?(r=this.toPoint(this.points[Q++]),i=this.toPoint(this.points[Q++]),c.quadraticCurveTo(r.x,r.y,i.x,i.y)):4===X?(r=this.toPoint(this.points[Q++]),i=this.toPoint(this.points[Q++]),n=this.toPoint(this.points[Q++]),c.bezierCurveTo(r.x,r.y,i.x,i.y,n.x,n.y)):5===X&&c.closePath(),p.push(this.points[Q-1])}var W=this.preCtrl;if(this.nextPoint)if(W)r=this.toPoint(W),i=this.toPoint(this.nextPoint),n=this.toPoint(this.nextPoint),c.bezierCurveTo(r.x,r.y,i.x,i.y,n.x,n.y);else{var Z=this.toPoint(this.nextPoint);c.lineTo(Z.x,Z.y)}if(c.strokeStyle=Jp.config.color_data_border,c.lineWidth=1,c.stroke(),this.drawPoints(c,p,4,Jp.config.color_data_border,Jp.config.color_data_background),W){var o=this.points[this.points.length-1],l=this.gv.getZoom(),j=3/l,E=6/l,m={x:2*o.x-W.x,y:2*o.y-W.y};this.drawLine(c,W,m,Jp.config.color_data_border),this.drawRect(c,{x:m.x-j,y:m.y-j,width:E,height:E},Jp.config.color_data_border,Jp.config.color_data_background),this.drawRect(c,{x:W.x-j,y:W.y-j,width:E,height:E},Jp.config.color_data_border,Jp.config.color_data_background)}},p}(lr),fr=function(c){function p(Q,r,i,n,y,X){Tp(this,p);var W=Sp(this,c.call(this,Q,r,rr,"display",X));W.displayTree=W.list=new(y||xQ)(W),W.dm.setHierarchicalRendering(!0),W.dm.enableHistoryManager(Jp.config.maxUndoRedoSteps),W.dirty=!1,W.parse(i,n);var Z=Q.getFileNode(i);return W.editable=!Z||!1!==Z.a("editable"),X||(i?n||W.editor.fireEvent("displayViewOpening",{displayView:W,url:i}):W.editor.fireEvent("displayViewCreated",{displayView:W,json:n})),W}return Np(p,c),p.prototype.onClosed=function(){c.prototype.onClosed.call(this),this.displayTree.onClosed()},p.prototype.handleDataModelChanged=function(c){"add"!==c.kind||this.isDeserializing||c.data.setLayer(this.editor.currentLayer),this.dirty=!0},p.prototype.clear=function(){this.sceneView||(this.dm.beginTransaction(),c.prototype.clear.call(this),this.dm.a("connectActionType",Jp.config.displayConnectActionType),this.dm.endTransaction())},p.prototype.resetGrid=function(){this.sceneView||(this.dm.beginTransaction(),this.dm.a("gridBlockSize",Jp.config.displayGridBlockSize),this.dm.a("gridThickLinesEvery",Jp.config.displayGridThickLinesEvery),this.dm.a("gridThickColor",Jp.config.displayGridThickColor),this.dm.a("gridLightColor",Jp.config.displayGridLightColor),this.dm.a("gridAngle",Jp.config.displayGridAngle),this.dm.a("gridRotation",Jp.config.displayGridRotation),this.dm.a("gridZoomThreshold",Jp.config.displayGridZoomThreshold),this.dm.endTransaction())},p.prototype.createInteractor=function(c,p){var Q=new c;return Q instanceof ht.Shape?new mr(this.tab,null,function(Q,r){var i=new c;return i.setPoints(Q),i.setSegments(r),p&&p(i),i}):Q instanceof ht.Edge?new Er(this.tab,null,function(c,Q){var r=new ht.Edge(c,Q);return p&&p(r),r}):Q instanceof ht.Node?new jr(this.tab,null,function(Q,r){var i=new c;return p&&p(i,Q,r),i}):void 0},Ap(p,[{key:"content",get:function(){var c=this.dm,p=c.toJSON();p.modified=(new Date).toString(),c.a("connectActionType")===Jp.config.displayConnectActionType&&delete p.connectActionType,c.a("rotateAsClock")===Jp.config.rotateAsClock&&delete p.rotateAsClock,c.a("gridBlockSize")===Jp.config.displayGridBlockSize&&delete p.a.gridBlockSize,c.a("gridThickLinesEvery")===Jp.config.displayGridThickLinesEvery&&delete p.a.gridThickLinesEvery,c.a("gridThickColor")===Jp.config.displayGridThickColor&&delete p.a.gridThickColor,c.a("gridLightColor")===Jp.config.displayGridLightColor&&delete p.a.gridLightColor,c.a("gridAngle")===Jp.config.displayGridAngle&&delete p.a.gridAngle,c.a("gridRotation")===Jp.config.displayGridRotation&&delete p.a.gridRotation,c.a("gridZoomThreshold")===Jp.config.displayGridZoomThreshold&&delete p.a.gridZoomThreshold,c.a("xAlignmentGuides")&&!c.a("xAlignmentGuides").length&&delete p.a.xAlignmentGuides,c.a("yAlignmentGuides")&&!c.a("yAlignmentGuides").length&&delete p.a.yAlignmentGuides;var Q=this.graphView.getContentRect();return c.a("width")>0&&c.a("height")>0&&(p.contentRect={x:0,y:0,width:c.a("width"),height:c.a("height")}),c.size()&&Q&&Q.width&&Q.height&&(p.contentRect=Q),p}}]),p}(or),Ir=function(c){function p(Q){return Tp(this,p),Sp(this,c.call(this,Q))}return Np(p,c),p.prototype.setDataModel=function(c){var p=this,Q=p._dataModel,r=p._selectionModel;Q!==c&&(Q&&(Q.umm(p.handleDataModelChange,p),Q.umd(p.handleDataPropertyChange,p),Q.removeIndexChangeListener(p.handleIndexChange,p),r||Q.sm().ums(p.handleSelectionChange,p)),p._dataModel=c,c.mm(p.handleDataModelChange,p),c.md(p.handleDataPropertyChange,p),c.addIndexChangeListener(p.handleIndexChange,p),r?r._setDataModel(c):c.sm().ms(p.handleSelectionChange,p),p.fp("dataModel",Q,c))},p.prototype.handleIndexChange=function(c){this.ivm()},p.prototype.handleDataPropertyChange=function(c){this.invalidateData(c.data)},p.prototype.validateModel=function(){var c=this;c._rows.clear(),c._rowMap={};var p=c._rows=c._dataModel.toDatas(c.isVisible,c),Q=0,r=c.getCurrentSortFunc(),i=p.size();for(r&&p.sort(r);Q<i;Q++)c._rowMap[p.get(Q)._id]=Q},p}(UQ),Gr=function(c){function p(Q,r){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Tp(this,p);var n=Sp(this,c.call(this,r));return n.editor=Q,n.editable=i,n.addTopPainter(n.$1$.bind(n)),n}return Np(p,c),p.prototype.isEditable=function(c){return this.editable},p.prototype.handleDelete=function(){this.editable&&this.removeSelection()},p.prototype.handleDataDoubleSelect=function(c,p){if(this.isEditable(p)){var Q=this.getIcon(p)?this.getIndent():0;this.lp(c).x>Q&&this.beginEditing(p)}},p.prototype.rename=function(c,p){c.setName(p)},p.prototype.isDroppable=function(c,p){return!1},p.prototype._clearDragInfo=function(){this.editor.dnd.hideTip(),this._dragInfo&&(this._dragInfo=null,this.redraw())},p.prototype._endDrag=function(c,p){},p.prototype._endCrossDrag=function(c,p){},p.prototype.$1$=function(c){c.texureImage2D=!0;var p=void 0;if(this._dragInfo&&this._dragInfo.inView?p=this._dragInfo:this._crossDragInfo&&(p=this._crossDragInfo),p){var Q=this.getWidth(),r=(this.getRowHeight(),p.type,Jp.config.color_select_dark);if(p.refData){var i=p.y;c.beginPath(),c.arc(4,i,3,0,2*Math.PI,!0),c.moveTo(7,i),c.lineTo(Q,i),c.lineWidth=2,c.strokeStyle=r,c.stroke()}else{var n=this.getViewRect();N(c,r,n.x,n.y,n.width,n.height,2)}}},p.prototype._dragging=function(c,p){var Q=this.getRowHeight(),r=this.lp(c),i=r.y/Q,n=Math.floor(i);n>this.getRowSize()-1?(p.refData=null,p.type=null,p.parent=null):(p.refData=this.getRowDatas().get(n),r.y-n*Q<.5*Q?(p.type="up",p.y=n*Q):(p.type="down",p.y=(n+1)*Q)),this.autoScroll(c),this.redraw()},p.prototype.$2$=function(){var c="";if(this.draggingData&&(c=this.getLabel(this.draggingData),this.isSelected(this.draggingData))){var p=this.sm().size();c+=p>1?" (+"+p+") ":""}return c},p.prototype.handleDragAndDrop=function(c,p){if(this.editable){if("prepare"===p)return void this._clearDragInfo();"begin"===p&&(this._dragInfo={tip:this.$2$(),view:this});var Q=this._dragInfo;if(Q){var r=this.editor.dnd;if("begin"===p||"between"===p){return this.getView().contains(b(c))?(Q.inView=!0,this._dragging(c,Q),r.clearDropView(c,Q)):(Q.inView&&this.redraw(),Q.inView=!1,r.crossDrag(c,Q)),void r.showTip(Q.tip,c)}return"end"===p?(Q.inView?this._endDrag(c,Q):r.crossDrop(c,Q),void this._clearDragInfo()):"cancel"===p?(Q.inView||r.crossCancel(c,Q),void this._clearDragInfo()):void 0}}},p.prototype.handleCrossDrag=function(c,p,Q){if(this.editable)return"exit"===p||"cancel"===p?(this._crossDragInfo=null,void this.redraw()):"enter"===p||"over"===p?(this._crossDragInfo||(this._crossDragInfo={}),void this._dragging(c,this._crossDragInfo)):"drop"===p?(this._endCrossDrag(c,Q),this._crossDragInfo=null,void this.redraw()):void 0},p.prototype.beginEditing=function(c){var p=this;this.cancelEditing(),this.makeVisible(c),this.validate();var Q=this.getIcon(c)?this.getIndent():0,r=this.ty()+this.getRowIndex(c)*this.getRowHeight(),i=Math.max(1,this.getWidth()-Q),n=this.getRowHeight();this._currentEditor=new ht.widget.TextField,this._currentEditor.data=c;var y=this._currentEditor.getElement(),X=this.getLabel(c);y.value=null==X?"":X,y.onblur=function(c){p.endEditing()},y.onkeydown=function(c){I(c)?p.endEditing():G(c)&&p.cancelEditing()},this.getView().appendChild(this._currentEditor.getView()),L(this._currentEditor,Q,r,i,n),this._currentEditor.setFocus(),ht.Default.callLater(y.select,y)},p.prototype.endEditing=function(){var c=this._currentEditor;c&&(this.rename(c.data,c.getValue()),delete this._currentEditor,O(c.getView()),this.redraw())},p.prototype.cancelEditing=function(){var c=this._currentEditor;c&&(delete this._currentEditor,O(c.getView()),this.redraw())},p}(Ir),er=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this,Q.editor,Q.dm));return r.symbolView=Q,r.graphView=Q.graphView,r.nodeIcon=qc(r),r.initMenu(),Q.dm.addDataPropertyChangeListener(function(c){c.data.editorIcon=null}),r}return Np(p,c),p.prototype.onDataDoubleClicked=function(c,p){p.altKey?this.graphView.fitData(c,!0,Jp.config.fitPadding):this.graphView.makeCenter(c,!0)},p.prototype.onPropertyChanged=function(p){"filter"===p.property&&this.ivm(),c.prototype.onPropertyChanged.call(this,p)},p.prototype.handleDataPropertyChange=function(p){!this._filter||"displayName"!==p.property&&"s:text"!==p.property&&"s:type"!==p.property&&"s:image"!==p.property?c.prototype.handleDataPropertyChange.call(this,p):this.ivm()},p.prototype.isVisible=function(c){if(!this._filter)return!0;var p=this.getVisibleFunc();if(p&&!p(c))return!1;if(Jp.config.symbolListVisibleFunc)return Jp.config.symbolListVisibleFunc(c,this._filter);var Q=this.getLabel(c),r=(this._filter+"").toLowerCase();return null!=Q&&(Q=(Q+"").toLowerCase(),Q.indexOf(r)>=0)},p.prototype.validate=function(){this.graphView.validate(),c.prototype.validate.call(this)},p.prototype.validateModel=function(){var p=this;c.prototype.validateModel.call(this),Jp.config.filterSymbolViewEnabled&&this.graphView.setVisibleFunc(function(c){return p.isVisible(c)})},p.prototype.getIcon=function(c){return c instanceof hQ?"editor.restore.state":c instanceof ht.Text?c.getIcon():c instanceof ht.Shape?(c.editorIcon||(c.editorIcon=Vc(c)),c.editorIcon):c instanceof ht.Node?this.nodeIcon:null},p.prototype.isDroppable=function(c,p){return!1},p.prototype._endCrossDrag=function(c,p){},p.prototype._endDrag=function(c,p){var Q=this;this.editor.beginTransaction();var r=p.type,i=p.refData;if(this.isSelected(this.draggingData)){var n=this.getRowOrderSelection();"down"===r&&n.reverse(),n.each(function(c){Q._dropData(c,r,i)})}else this._dropData(this.draggingData,r,i),this.sm().ss(this.draggingData);this.editor.endTransaction()},p.prototype._dropData=function(c,p,Q){if(Q){var r=this.dm().getDatas(),i=r.indexOf(Q);"down"===p&&i++,r.indexOf(c)<i&&i--,this.dm().moveToIndex(c,i)}else this.dm().bringToFront(c)},p.prototype.rename=function(c,p){c.setDisplayName(p)},p.prototype.initMenu=function(){var c=this;this.menu=new BQ;var p=[{id:"copy",label:i("editor.copy"),action:function(){c.editor.copy()},visible:function(){return!!c.editor.ld}},{id:"paste",label:i("editor.paste"),action:function(){c.editor.paste()},visible:function(){return c.editable&&c.editor.hasCopyInfo()}},{id:"delete",label:i("editor.delete"),action:function(){c.editor.delete()},visible:function(){return c.editable&&!!c.editor.ld}},"separator",{id:"bringToFront",label:i("editor.bringtofront"),action:function(){c.editor.bringToFront()},visible:function(){return c.editable&&!!c.editor.ld}},{id:"bringForward",label:i("editor.bringforward"),action:function(){c.editor.bringForward()},visible:function(){return c.editable&&!!c.editor.ld}},{id:"sendBackward",label:i("editor.sendbackward"),action:function(){c.editor.sendBackward()},visible:function(){return c.editable&&!!c.editor.ld}},{id:"sendToBack",label:i("editor.sendtoback"),action:function(){c.editor.sendToBack()},visible:function(){return c.editable&&!!c.editor.ld}},"separator",{id:"combined",label:i("editor.combineshapes"),action:function(){c.editor.beginTransaction(),Wp(c.editor.sm.getSelection().toArray(),tQ),c.editor.endTransaction()},visible:function(){return c.editable&&c.editor.sm.size()>1&&op(c.editor.sm.getSelection())}},{id:"splitShape",label:i("editor.splitshape"),action:function(){c.editor.beginTransaction(),Zp(c.editor.ld),c.editor.endTransaction()},visible:function(){return c.editable&&1===c.editor.sm.size()&&c.editor.ld instanceof ht.Shape}}];this.menu.setItems(p),this.menu.addTo(this.getView()),this.editor.menus.push(this.menu)},p.prototype.onClosed=function(){n(this.editor.menus,this.menu)},Ap(p,[{key:"editable",get:function(){return this.editor.editable},set:function(c){}}]),p}(Gr);v(er,{ms_ac:["filter"]});var Pr=function(c){function p(Q){return Tp(this,p),Sp(this,c.call(this,Q))}return Np(p,c),p.prototype.handleDataModelChange=function(p){c.prototype.handleDataModelChange.call(this,p),this.editor&&this.editor.fireViewEvent(this.editView,"DataModelChanged",{event:p})},p.prototype.handleDataModelPropertyChange=function(p){c.prototype.handleDataModelPropertyChange.call(this,p),this.editor&&this.editor.fireViewEvent(this.editView,"DataModelPropertyChanged",{event:p})},p.prototype.handleDataPropertyChange=function(p){c.prototype.handleDataPropertyChange.call(this,p),this.editor&&this.editor.fireViewEvent(this.editView,"DataPropertyChanged",{event:p})},p.prototype.isDroppable=function(c,p){if(this.editor.editable)return!!p.view.isDroppableToSymbolView},p.prototype.isPixelPerfect=function(c){return!0},p.prototype.initMenuItems=function(c){this.$57$(c),this.$56$(c),this.addShapeSplitItems(c,!0)},p.prototype.isVisible=function(p){var Q=this.editor.symbolStatePane.currentState,r=p.s("state");return(void 0===r||r===Q)&&c.prototype.isVisible.call(this,p)},p}(Qr),dr=function(c){function p(Q,r,i){Tp(this,p);var n=Sp(this,c.call(this));return n.setIcon("editor.func"),n.setImage("editor.func"),n.parse(Q,r,i),n}return Np(p,c),p.prototype.toLabel=function(){return this.getDisplayName()||i("editor.comptype.func")},p.prototype.getClass=function(){return p},p.prototype.parse=function(c,p,Q){c&&(this.a("type",c.type),Dc(this,c,p,Q))},p.prototype.toJSON=function(){var c={};return c.type=this.a("type"),Uc(this,c),c},Ap(p,[{key:"compType",get:function(){return"function"}}]),p}(ht.Node),Rr={rect:RQ,circle:RQ,oval:RQ,roundRect:RQ,star:RQ,triangle:RQ,hexagon:RQ,pentagon:RQ,diamond:RQ,rightTriangle:RQ,parallelogram:RQ,trapezoid:RQ,polygon:RQ,arc:RQ,image:bQ,shape:tQ,text:YQ,border:nr,pieChart:yr,oneDimensionalColumnChart:Xr,columnChart:Xr,percentageColumnChart:Xr,stackedColumnChart:Xr,lineChart:Wr,comp:ir,clip:sQ,restore:hQ,endClip:hQ};Jp.toDatas=function(c,p){var Q=[];return c.forEach(function(c){var r=Up(c);if(r){var i=Bp(r),n=Dp(i,p);n&&Q.push(n)}}),Q};var tr=function(c){function p(Q,r,i,n){Tp(this,p);var y=Sp(this,c.call(this,Q,r,Pr,"symbol"));y.graphView.vectorDataBindingDisabled=!0,y.graphView.getLabel=function(){return null},y.graphView.setVisibleFunc(function(c){return!(c instanceof hQ)}),y.list=y.symbolList=new er(y),y.dm.a({name:void 0,comps:[],width:100,height:100,boundExtend:0,fitSize:!1,scrollable:!1,interactive:!1,disableSelectedBorder:!1,pixelPerfect:!0,clip:!1,visible:!0,color:void 0,blendMode:"multiply",opacity:1});var X=Jp.config.customProperties.symbol;X&&X.length&&X.forEach(function(c){y.dm.a(c.property,c.defaultValue)}),y.dm.addIndexChangeListener(function(){y.dirty=!0}),y.dirty=!1,y.dm.enableHistoryManager(Jp.config.maxUndoRedoSteps),y.parse(i,n);var W=Q.getFileNode(i);return y.editable=!W||!1!==W.a("editable"),i?n||y.editor.fireEvent("symbolViewOpening",{symbolView:y,url:i}):y.editor.fireEvent("symbolViewCreated",{symbolView:y,json:n}),y}return Np(p,c),p.prototype.clear=function(){this.dm.beginTransaction(),c.prototype.clear.call(this),this.dm.a("connectActionType",Jp.config.symbolConnectActionType),this.dm.setAutoAdjustIndex(!1),this.dm.endTransaction()},p.prototype.resetGrid=function(){this.dm.beginTransaction(),this.dm.a("gridBlockSize",Jp.config.symbolGridBlockSize),this.dm.a("gridThickLinesEvery",Jp.config.symbolGridThickLinesEvery),this.dm.a("gridThickColor",Jp.config.symbolGridThickColor),this.dm.a("gridLightColor",Jp.config.symbolGridLightColor),this.dm.a("gridAngle",Jp.config.symbolGridAngle),this.dm.a("gridRotation",Jp.config.symbolGridRotation),this.dm.a("gridZoomThreshold",Jp.config.symbolGridZoomThreshold),this.dm.endTransaction()},p.prototype.onClosed=function(){c.prototype.onClosed.call(this),this.list.onClosed()},p.prototype.updateImpl=function(c,p){var Q=this,r=this.dm,i=a(c);this.clear(),r.setBackground(i.background),r.a("previewURL",i.previewURL),r.a("snapshotURL",i.snapshotURL),r.dataBindings=i.dataBindings,this.attrObject=i.attrObject,null!=i.gridBlockSize&&this.dm.a("gridBlockSize",i.gridBlockSize),null!=i.gridThickLinesEvery&&this.dm.a("gridThickLinesEvery",i.gridThickLinesEvery),null!=i.gridThickColor&&this.dm.a("gridThickColor",i.gridThickColor),null!=i.gridLightColor&&this.dm.a("gridLightColor",i.gridLightColor),null!=i.gridAngle&&this.dm.a("gridAngle",i.gridAngle),null!=i.gridRotation&&this.dm.a("gridRotation",i.gridRotation),null!=i.gridZoomThreshold&&this.dm.a("gridZoomThreshold",i.gridZoomThreshold),i.hasOwnProperty("connectActionType")&&this.dm.a("connectActionType",i.connectActionType),i.hasOwnProperty("rotateAsClock")&&this.dm.a("rotateAsClock",i.rotateAsClock),Cp.forEach(function(c){r.a(c,i[c])}),r.a({name:i.name,renderHTML:i.renderHTML,comps:Mc(i.comps,[]),width:Mc(i.width,100),height:Mc(i.height,100),boundExtend:Mc(i.boundExtend,0),fitSize:Mc(i.fitSize,!1),scrollable:Mc(i.scrollable,!1),interactive:Mc(i.interactive,!1),disableSelectedBorder:Mc(i.disableSelectedBorder,!1),pixelPerfect:Mc(i.pixelPerfect,!0),clip:Mc(i.clip,!1),visible:Mc(i.visible,!0),color:Mc(i.color,void 0),blendMode:Mc(i.blendMode,"multiply"),opacity:Mc(i.opacity,1),attachPoints:Mc(i.attachPoints,void 0),attachStyle:Mc(i.attachStyle,void 0),cacheRule:Mc(i.cacheRule,!1),state:Mc(i.state,void 0),stateEnum:Mc(i.stateEnum,void 0),comps_func:Kc(i.comps),width_func:Kc(i.width),height_func:Kc(i.height),fitSize_func:Kc(i.fitSize),scrollable_func:Kc(i.scrollable),interactive_func:Kc(i.interactive),disableSelectedBorder_func:Kc(i.disableSelectedBorder),pixelPerfect_func:Kc(i.pixelPerfect),visible_func:Kc(i.visible),color_func:Kc(i.color),blendMode_func:Kc(i.blendMode),opacity_func:Kc(i.opacity),attachPoints_func:Kc(i.attachPoints),attachStyle_func:Kc(i.attachStyle),cacheRule_func:Kc(i.cacheRule),state_func:Kc(i.state)});var n=Jp.config.customProperties.symbol;n&&n.length&&n.forEach(function(c){r.a(c.property,Mc(i[c.property],c.defaultValue))}),r.a("comps").forEach(function(c){Up(c,Q)}),this.dirty=!!p,!p&&Jp.config.fitContentForSymbolView&&this.graphView.fitContent(Jp.config.animate,Jp.config.fitPadding)},p.prototype.addValue=function(c,p,Q){var r=this.dm.a(p);Bc(c,p,this.dm.a(p+"_func"),r,Q)},p.prototype.createInteractor=function(c,p){var Q=this,r=Rr[c];return"shape"===c?new mr(this.tab,null,function(i,n){var y={type:"shape",background:null,borderColor:Jp.config.color_data_border,borderWidth:1};p&&p(y,i,n);var X=new r(y);return X.setPoints(i),X.setSegments(n),Q.editor.fireEvent("compInited",{type:c,data:X,symbolView:Q.editor.symbolView}),X}):new jr(this.tab,null,function(n,y){var X=void 0;X="arc"===c?{type:c,rect:[n.x,n.y,n.width,n.height],background:Jp.config.color_data_background,borderWidth:1,borderColor:Jp.config.color_data_border,arcFrom:0,arcTo:4.1888}:"border"===c?{type:c,rect:[n.x,n.y,n.width,n.height],border:1,color:Jp.config.color_data_border}:"text"===c?{type:c,rect:[n.x,n.y,n.width,n.height],text:i("editor.text")}:"comp"===c||"image"===c?y?{rect:[n.x+n.width/2,n.y+n.height/2,-1,-1]}:{rect:[n.x,n.y,n.width,n.height]}:"pieChart"===c?{type:"pieChart",values:[10,20,40,60,80],colors:["#7EB6EA","#434348","#93EB82","#F5A262","#8087E6"]}:"oneDimensionalColumnChart"===c?{type:"columnChart",series:[{values:[10,20,40,60,80],colors:["#7EB6EA","#434348","#93EB82","#F5A262","#8087E6"]}]}:"columnChart"===c?{type:"columnChart",series:[{values:[30,40,60,70,80],color:"#7EB6EA"},{values:[20,40,50,80,90],color:"#434348"}]}:"lineChart"===c?{type:"lineChart",series:[{values:[10,40,30,60,70],color:"#7EB6EA"}]}:{type:c,rect:[n.x,n.y,n.width,n.height],background:Jp.config.color_data_background,borderWidth:1,borderColor:Jp.config.color_data_border},p&&p(X,n,y);var W=new r(X);return Q.editor.fireEvent("compInited",{type:c,data:W,symbolView:Q.editor.symbolView}),W})},Ap(p,[{key:"attrObject",set:function(c){var p=this.editor.rightBottomTabView.getTabModel().sm();this._attrObject=c,p.co(this.editor.dataViewTab)&&this.editor.dataView.updateContent()},get:function(){return this._attrObject}},{key:"content",get:function(){var c=this,p=this.graphView.getEditInteractor(),Q=(p.gridGuide,this.dm),r=this.attrObject,i={modified:(new Date).toString()};void 0!==r&&(i.attrObject=r),Q.getBackground()&&(i.background=Q.getBackground()),Q.dataBindings&&(i.dataBindings=Q.dataBindings),Q.a("previewURL")&&(i.previewURL=Q.a("previewURL")),Q.a("snapshotURL")&&(i.snapshotURL=Q.a("snapshotURL")),Q.a("connectActionType")!==Jp.config.symbolConnectActionType&&(i.connectActionType=Q.a("connectActionType")),Q.a("rotateAsClock")!==Jp.config.rotateAsClock&&(i.rotateAsClock=Q.a("rotateAsClock")),Q.a("gridBlockSize")!==Jp.config.symbolGridBlockSize&&(i.gridBlockSize=Q.a("gridBlockSize")),Q.a("gridThickLinesEvery")!==Jp.config.symbolGridThickLinesEvery&&(i.gridThickLinesEvery=Q.a("gridThickLinesEvery")),Q.a("gridThickColor")!==Jp.config.symbolGridThickColor&&(i.gridThickColor=Q.a("gridThickColor")),Q.a("gridLightColor")!==Jp.config.symbolGridLightColor&&(i.gridLightColor=Q.a("gridLightColor")),Q.a("gridAngle")!==Jp.config.symbolGridAngle&&(i.gridAngle=Q.a("gridAngle")),Q.a("gridRotation")!==Jp.config.symbolGridRotation&&(i.gridRotation=Q.a("gridRotation")),Q.a("gridZoomThreshold")!==Jp.config.symbolGridZoomThreshold&&(i.gridZoomThreshold=Q.a("gridZoomThreshold")),Q.a("xAlignmentGuides")&&Q.a("xAlignmentGuides").length&&(i.xAlignmentGuides=Q.a("xAlignmentGuides")),Q.a("yAlignmentGuides")&&Q.a("yAlignmentGuides").length&&(i.yAlignmentGuides=Q.a("yAlignmentGuides")),Q.a("cacheRule")&&this.addValue(i,"cacheRule"),Q.a("stateEnum")&&Q.a("stateEnum").length&&(i.stateEnum=Q.a("stateEnum"),this.addValue(i,"state")),Cp.forEach(function(c){Q.a(c)&&(i[c]=Q.a(c))}),Q.a("renderHTML")&&(i.renderHTML=Q.a("renderHTML")),this.addValue(i,"width"),this.addValue(i,"height"),this.addValue(i,"boundExtend",0),this.addValue(i,"fitSize",!1),this.addValue(i,"scrollable",!1),this.addValue(i,"interactive",!1),this.addValue(i,"disableSelectedBorder",!1),this.addValue(i,"pixelPerfect",!0),this.addValue(i,"name"),this.addValue(i,"clip",!1),this.addValue(i,"visible",!0),this.addValue(i,"color"),this.addValue(i,"blendMode","multiply"),this.addValue(i,"opacity",1),this.addValue(i,"attachPoints"),this.addValue(i,"attachStyle");var n=Jp.config.customProperties.symbol,y=!!Jp.config.saveSymbolCustomPropertyDefaultValue;n&&n.length&&n.forEach(function(p){
y?c.addValue(i,p.property):c.addValue(i,p.property,p.defaultValue)});var X=[];return Q.a("comps_func")?i.comps={values:X,func:Q.a("comps_func")}:i.comps=X,Q.each(function(c){X.push(c.toJSON())}),i}}]),p}(or),br=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));r.editor=Q,r.getTabModel().sm().ms(function(){r.editor.$6$(r.currentTab)});var n=function(){return!!r.getTabModel().size()};return r.menu=new BQ([{id:"closeTab",label:i("editor.closetab"),action:function(){r.closeTab()},visible:n},{id:"closeOtherTabs",label:i("editor.closeothertabs"),action:function(){r.closeOtherTabs()},visible:n},{id:"closeTabsToTheRight",label:i("editor.closetabstotheright"),action:function(){r.closeTabsToTheRight()},visible:n}]),r.menu.beforeShow=function(c){r._rightClickTab=r.getTabAt(c)},r.menu.addTo(r.getTitleDiv()),r.editor.menus.push(r.menu),r}return Np(p,c),p.prototype.drawCloseIcon=function(p,Q,r,i){p.a("dirty")?(Q.fillStyle=r,Q.beginPath(),Q.arc(i.x+i.width/2,i.y+i.height/2,3,0,2*Math.PI,!0),Q.fill()):c.prototype.drawCloseIcon.call(this,p,Q,r,i)},p.prototype.open=function(c){if(c){var p=c.fileType,Q=p===nQ,r=p===iQ,i=p===WQ&&Jp.SceneView;if(Q||r||i){var n=c.url,y=this.getTabModel().getDataByTag(n);y||(y=new ht.Tab,y.setTag(n),y.setClosable(!0),y.setName(_(c.getName())),Q?(y.setIcon("editor.display"),new fr(this.editor,y,n)):r?(y.setIcon("editor.symbol"),new tr(this.editor,y,n)):i&&(y.setIcon("editor.scene"),new Jp.SceneView(this.editor,y,n)),this.editor.addTab(y)),this.getTabModel().sm().ss(y)}}},p.prototype.newDisplayView=function(c){var p=new ht.Tab;p.setClosable(!0),p.setIcon("editor.display"),p.setName(c||i("editor.untitled"));var Q=new fr(this.editor,p);return this.editor.addTab(p,!0),Q},p.prototype.newSymbolView=function(c){var p=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],Q=new ht.Tab;Q.setClosable(!0),Q.setIcon("editor.symbol"),Q.setName(c||i("editor.untitled"));var r=new tr(this.editor,Q);return this.editor.addTab(Q,!0),p&&this.editor.zoomToFit(),r},p.prototype.$101$=function(){this.getTabModel().each(function(c){c.getView().graphView.invalidateAll()})},p.prototype.reload=function(){this.currentTab&&this.currentTab.getView().reload()},p.prototype.save=function(c,p){this.currentTab&&this.currentTab.getView().save(c,p)},p.prototype.saveAll=function(c){var p=this.tabs,Q=-1,r=function(){Q++,Q<p.length?p[Q].getView().save(r):c()};r()},p.prototype.preview=function(){this.currentTab&&this.currentTab.getView().preview()},p.prototype.selectTab=function(c){c&&this.getTabModel().sm().ss(c)},p.prototype.onTabClosing=function(c,p){return this.closeTab(c),!1},p.prototype.closeTab=function(c,p,Q){(c=c||this._rightClickTab||this.currentTab)&&this.closeTabs([c],p,Q)},p.prototype.closeOtherTabs=function(c,p){var Q=this._rightClickTab||this.currentTab;this.closeTabs(this.tabs.filter(function(c){return c!==Q}),c,p)},p.prototype.closeTabsToTheRight=function(c,p){var Q=this._rightClickTab||this.currentTab;if(Q){var r=this.tabs.indexOf(Q);this.closeTabs(this.tabs.slice(r+1),c,p)}},p.prototype.closeAllTabs=function(c,p){this.closeTabs(this.tabs,c,p)},p.prototype.closeTabs=function(c,p,Q){var r=this,i=void 0,n=function(y){if("cancel"!==y&&c.length){var X=c.shift(0);void 0===i&&(i=r.tabs.indexOf(X)-1),r.$66$(X,n,Q)}else{p&&p();var W=r.tabs.length;!r.currentTab&&W&&((void 0===i||i<0)&&(i=0),i>W-1&&(i=W-1),r.selectTab(r.tabs[i]))}};n(),this._rightClickTab=null},p.prototype.removeTab=function(c){var p=c.getView(),Q={url:p.url};this.editor.fireViewEvent(p,"Closing",Q),Q.preventDefault||(p.onClosed(),this.getTabModel().remove(c),this.editor.fireEvent("tabClosed",{tab:c}),this.editor.fireViewEvent(p,"Closed",Q))},p.prototype.$66$=function(c,p,Q){var r=this,n=c.getView();if(!Q&&n.dirty&&n.editable){var y={tab:c};if(this.editor.fireEvent("tabPrompting",y),"notSave"===y.action)this.removeTab(c),p&&p("notSave");else if("save"===y.action)n.save(function(){r.removeTab(c),p&&p("save")});else if("cancel"===y.action)p&&p("cancel");else{var X=[{label:i("editor.notsave"),action:function(){W.hide(),r.removeTab(c),p&&p("notSave")}},{label:i("editor.save"),action:function(){n.save(function(){W.hide(),r.removeTab(c),p&&p("save")})}},{label:i("editor.cancel"),action:function(){W.hide(),p&&p("cancel")}}],W=new vp({title:c.getName(),contentPadding:20,width:260,draggable:!0,content:'<p style="color: '+ht.Default.labelColor+'">'+i("editor.savechange")+"</p>",buttons:X});W.$49$=X[2].action,W.$48$=X[1].action,W.show()}}else this.removeTab(c),p&&p()},Ap(p,[{key:"currentTab",get:function(){return this.getTabModel().sm().ld()}},{key:"tabs",get:function(){return this.getTabModel().getRoots().toArray()}}]),p}($Q),Yr=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));r.editor=Q,r.buttons={};var i=[];i.push(r.createItem("distributeHorizontal")),i.push(r.createItem("distributeVertical")),i.push(r.createItem("alignLeft")),i.push(r.createItem("alignHorizontal")),i.push(r.createItem("alignRight")),i.push(r.createItem("alignTop")),i.push(r.createItem("alignVertical")),i.push(r.createItem("alignBottom")),r.addSearchItem(i);var n=22,X=[n,n,n,n,n,n,n,n,.1];return y(Jp.config.compactFilter)||(r.addCompactItem(i),X.push(n)),r.addRow(i,X),r.updateItems(),r}return Np(p,c),p.prototype.createItem=function(c){var p=this,Q="editor.align."+c.toLocaleLowerCase();return this.buttons[c]=gc(null,i(Q),Q,function(){p[c]()})},p.prototype.updateItems=function(){var c=this.buttons;if(this.dataModel){var p=[];this.dataModel.sm().each(function(c){c instanceof ht.Node&&p.push(c)}),p.length>2?(c.distributeHorizontal.setDisabled(!1),c.distributeVertical.setDisabled(!1),c.alignLeft.setDisabled(!1),c.alignHorizontal.setDisabled(!1),c.alignRight.setDisabled(!1),c.alignTop.setDisabled(!1),c.alignVertical.setDisabled(!1),c.alignBottom.setDisabled(!1)):p.length>1?(c.distributeHorizontal.setDisabled(!0),c.distributeVertical.setDisabled(!0),c.alignLeft.setDisabled(!1),c.alignHorizontal.setDisabled(!1),c.alignRight.setDisabled(!1),c.alignTop.setDisabled(!1),c.alignVertical.setDisabled(!1),c.alignBottom.setDisabled(!1)):(c.distributeHorizontal.setDisabled(!0),c.distributeVertical.setDisabled(!0),c.alignLeft.setDisabled(!0),c.alignHorizontal.setDisabled(!0),c.alignRight.setDisabled(!0),c.alignTop.setDisabled(!0),c.alignVertical.setDisabled(!0),c.alignBottom.setDisabled(!0))}else c.distributeHorizontal.setDisabled(!0),c.distributeVertical.setDisabled(!0),c.alignLeft.setDisabled(!0),c.alignHorizontal.setDisabled(!0),c.alignRight.setDisabled(!0),c.alignTop.setDisabled(!0),c.alignVertical.setDisabled(!0),c.alignBottom.setDisabled(!0)},p.prototype.$6$=function(c){this.dataModel&&this.dataModel.sm().ums(this.updateItems,this),c?(this.dataModel=c.getView().dm,this.dataModel.sm().ms(this.updateItems,this)):this.dataModel=null,this.updateItems()},p.prototype.getUnionRect=function(c){return this.editor.gv?this.editor.gv.getUnionNodeRect(c):null},p.prototype.isSelected=function(c){return this.dataModel&&this.dataModel.sm().contains(c)},p.prototype.hasSelectedGroupParent=function(c){return c instanceof ht.Group&&(!!this.isSelected(c)||this.hasSelectedGroupParent(c.getParent()))},p.prototype.hasSelectedHost=function(c){var p=this,Q=function(r){return r!==c&&(r instanceof ht.Node&&(!!p.isSelected(r)||Q(r.getHost())))};return Q(c.getHost())},p.prototype.distributeHorizontal=function(){if(this.editor.editable){this.editor.beginTransaction();var c=this.editor.gv,p=this.selection,Q=this.getUnionRect(p);if(c&&Q){p.sort(function(p,Q){return c.getNodeRect(p).x-c.getNodeRect(Q).x});var r={},i=0;p.forEach(function(p){var Q=c.getNodeRect(p);r[p._id]=Q,i+=Q.width});var n=(Q.width-i)/(p.length-1),y=Q.x;p.forEach(function(p){var Q=c.getNodeRect(p);p.translate(y-Q.x,0),y+=Q.width+n})}this.editor.endTransaction()}},p.prototype.distributeVertical=function(){if(this.editor.editable){this.editor.beginTransaction();var c=this.editor.gv,p=this.selection,Q=this.getUnionRect(p);if(c&&Q){p.sort(function(p,Q){return c.getNodeRect(p).y-c.getNodeRect(Q).y});var r={},i=0;p.forEach(function(p){var Q=c.getNodeRect(p);r[p._id]=Q,i+=Q.height});var n=(Q.height-i)/(p.length-1),y=Q.y;p.forEach(function(p){var Q=c.getNodeRect(p);p.translate(0,y-Q.y),y+=Q.height+n})}this.editor.endTransaction()}},p.prototype.alignLeft=function(){if(this.editor.editable){this.editor.beginTransaction();var c=this.editor.gv,p=this.selection,Q=this.getUnionRect(p);c&&Q&&p.forEach(function(p){var r=c.getNodeRect(p);p.translate(Q.x-r.x,0)}),this.editor.endTransaction()}},p.prototype.alignHorizontal=function(){if(this.editor.editable){this.editor.beginTransaction();var c=this.editor.gv,p=this.selection,Q=this.getUnionRect(p);c&&Q&&p.forEach(function(p){var r=c.getNodeRect(p);p.translate(Q.x+Q.width/2-r.x-r.width/2,0)}),this.editor.endTransaction()}},p.prototype.alignRight=function(){if(this.editor.editable){this.editor.beginTransaction();var c=this.editor.gv,p=this.selection,Q=this.getUnionRect(p);c&&Q&&p.forEach(function(p){var r=c.getNodeRect(p);p.translate(Q.x+Q.width-r.x-r.width,0)}),this.editor.endTransaction()}},p.prototype.alignTop=function(){if(this.editor.editable){this.editor.beginTransaction();var c=this.editor.gv,p=this.selection,Q=this.getUnionRect(p);c&&Q&&p.forEach(function(p){var r=c.getNodeRect(p);p.translate(0,Q.y-r.y)}),this.editor.endTransaction()}},p.prototype.alignVertical=function(){if(this.editor.editable){this.editor.beginTransaction();var c=this.editor.gv,p=this.selection,Q=this.getUnionRect(p);c&&Q&&p.forEach(function(p){var r=c.getNodeRect(p);p.translate(0,Q.y+Q.height/2-r.y-r.height/2)}),this.editor.endTransaction()}},p.prototype.alignBottom=function(){if(this.editor.editable){this.editor.beginTransaction();var c=this.editor.gv,p=this.selection,Q=this.getUnionRect(p);c&&Q&&p.forEach(function(p){var r=c.getNodeRect(p);p.translate(0,Q.y+Q.height-r.y-r.height)}),this.editor.endTransaction()}},p.prototype.addSearchItem=function(c){var p=this;this.searchField=new ht.widget.TextField;var Q=this.searchField.getElement();Q.onkeyup=function(c){G(c)&&(Q.value=""),p.editor.filterProperties()},c.push(this.searchField)},p.prototype.addCompactItem=function(c){var p=this,Q=kc("editor.filter",function(){return p.editor.inspectorCompact}),r=function(){p.editor.inspectorCompact=!p.editor.inspectorCompact};c.push(gc(null,i("editor.inspectorcompact"),Q,r))},Ap(p,[{key:"selection",get:function(){var c=this,p=[];return this.dataModel&&this.dataModel.sm().each(function(Q){Q instanceof ht.Node&&(c.hasSelectedGroupParent(Q.getParent())||c.hasSelectedHost(Q)||p.push(Q))}),p}},{key:"filter",get:function(){return this.searchField.getElement().value}}]),p}(gp),sr=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));return r.editor=Q,r.initForm(),r.visible=!1,r.$6$(),r.oopsImageJSON=ht.Default.getImage("editor.oops"),r.oopsImage=ht.Default.toCanvas(r.oopsImageJSON,r.oopsImageJSON.width,r.oopsImageJSON.height,"fill",null,null,null,ht.Default.devicePixelRatio).toDataURL(),r}return Np(p,c),p.prototype.initForm=function(){var c=this,p=this.codeEditor=new kp({language:"JSON",lineNumbers:"off",readOnly:!0,minimap:{enabled:!1}});this.addRow([{id:"content",element:p}],[.1],.1),this.addRow([{id:"url",textField:{editable:!1}},{id:"edit",button:{onClicked:function(){c.editor.editable&&(c.editing=!c.editing)}}},{id:"commit",button:{label:i("editor.commit"),onClicked:function(){c.editor.editable&&(c.currentView.update(c.content,!0),c.editing=!1)}}}],[.1,50,50]),this.getView().style.background=Jp.config.color_pane,this.editing=!1},p.prototype.$67$=function(){var c=this;this.visible&&!this.editing&&(this._updateContentLater||(this._updateContentLater=!0,setTimeout(function(){c.updateContent()},100)))},p.prototype.updateContent=function(){this.visible&&!this.editing&&(this._updateContentLater=!1,this.content=this.currentView?U(this.currentView.content):"")},p.prototype.updateUrl=function(){this.v("url",this.tab&&this.tab.getTag()||"")},p.prototype.$6$=function(c){this.editing=!1,this.dataModel&&(this.dataModel.removeDataModelChangeListener(this.$67$,this),this.dataModel.removeDataPropertyChangeListener(this.$67$,this),this.dataModel.removePropertyChangeListener(this.$67$,this)),c?(this.currentView=c.getView(),this.dataModel=this.currentView.dm,this.dataModel.addDataModelChangeListener(this.$67$,this),this.dataModel.addDataPropertyChangeListener(this.$67$,this),this.dataModel.addPropertyChangeListener(this.$67$,this),this.setDisabled(!1)):(this.currentView=null,this.dataModel=null,this.setDisabled(!0)),this.tab=c,this.updateUrl(),this.$67$()},Ap(p,[{key:"editing",get:function(){return this._editing},set:function(c){this._editing!==c&&(this._editing=c,this.getViewById("edit").setLabel(i(c?"editor.cancel":"editor.edit")),this.getViewById("commit").setDisabled(!c),this.getViewById("content").setEditable(c),c||this.$67$())}},{key:"visible",get:function(){return this._visible},set:function(c){this._visible!==c&&(this._visible=c,c?this.updateContent():this.editing||(this.content=""))}},{key:"content",get:function(){return this.v("content")},set:function(c){this.setDisabled(!1),this.v("content",c)}}]),p}(gp);Jp.DataView=sr;var hr=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));return r.editor=Q,r.centerPane=new FQ,r.setCenterView(r.centerPane),r.controlPane=new gp,r.controlPane.addRow([{id:"filter",textField:{}}],[.1,ht.Default.isTouchable?32:18]),r.setBottomView(r.controlPane),r.setBottomHeight(ht.Default.widgetRowHeight+8),r.input=r.controlPane.getViewById("filter").getElement(),r.input.onkeyup=function(c){r.list&&(G(c)&&(r.input.value=""),r.list.setFilter(r.input.value))},r}return Np(p,c),p.prototype.$6$=function(c){this.tab=c,this.list=c?c.getView().list:null,this.controlPane.v("filter",this.list?this.list.getFilter()||"":"")},Ap(p,[{key:"list",get:function(){return this.centerPane.getCenterView()},set:function(c){this.centerPane.setCenterView(c)}}]),p}(FQ),Fr=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));r.editor=Q,r._layerNames=[],r.setDisabled(!0),r.tableModel=new ht.DataModel,r.tablePane=new wQ(r.tableModel),r.tableView=r.tablePane.getTableView(),r.tableView.setEditable(!0);var n=r.tableView.isCellEditable;return r.tableView.isCellEditable=function(){return!!Q.editable&&n.apply(this,arguments)},r.tablePane.getView().style.border=Jp.config.color_line+" solid 1px",r.tablePane.addColumns([r.$74$("name",i("editor.name"),100),r.$74$("visible",i("editor.visible"),50),r.$74$("selectable",i("editor.selectable"),50),r.$74$("movable",i("editor.movable"),50),r.$74$("editable",i("editor.editable"),50)]),r.addRow([r.tablePane],[.1],.1),r.addRow([{button:{icon:"editor.add",toolTip:i("editor.add"),onClicked:function(){r.editor.editable&&(r.addLayer(ht.Data.prototype._layer,!0,!0,!0,!0),r.updateLayers())}}},{button:{icon:"editor.delete",toolTip:i("editor.delete"),onClicked:function(){r.editor.editable&&r.tableView.sm().size()&&(r.tableView.removeSelection(),r.updateLayers())}}},null,{button:{icon:"editor.top",toolTip:i("editor.bringtofront"),onClicked:function(){r.editor.editable&&r.tableView.sm().size()&&(r.tableModel.moveSelectionToTop(),r.updateLayers())}}},{button:{icon:"editor.up",toolTip:i("editor.bringforward"),onClicked:function(){r.editor.editable&&r.tableView.sm().size()&&(r.tableModel.moveSelectionUp(),r.updateLayers())}}},{button:{icon:"editor.down",toolTip:i("editor.sendbackward"),onClicked:function(){r.editor.editable&&r.tableView.sm().size()&&(r.tableModel.moveSelectionDown(),r.updateLayers())}}},{button:{icon:"editor.bottom",toolTip:i("editor.sendtoback"),onClicked:function(){r.editor.editable&&r.tableView.sm().size()&&(r.tableModel.moveSelectionToBottom(),r.updateLayers())}}}],[20,20,.1,20,20,20,20]),r}return Np(p,c),p.prototype.addLayer=function(c,p,Q,r,i){!1!==p&&(p=!0),!1!==Q&&(Q=!0),!1!==r&&(r=!0),!1!==i&&(i=!0);var n=new ht.Data;n.a({name:c,visible:p,selectable:Q,movable:r,editable:i}),this.tableModel.add(n)},p.prototype.$74$=function(c,p,Q){var r=this;return{name:c,tag:c,accessType:"attr",width:Q,displayName:p,align:"center",editable:!0,setValue:function(p,Q,i){i!==p.a(c)&&(p.a(c,i),r.updateLayers())}}},p.prototype.$6$=function(c){this.dataModel&&this.dataModel.removePropertyChangeListener(this.handleDataModelPropertyChange,this);var p=this.editor.displayView||this.editor.sceneView;p?(this.dataModel=p.dm,this.dataModel.addPropertyChangeListener(this.handleDataModelPropertyChange,this),this.setDisabled(!1)):(this.dataModel=null,this.setDisabled(!0)),this.updateTable()},p.prototype.handleDataModelPropertyChange=function(c){var p=this;if("layers"===c.property){this.updateTable(),this._layerNames=[];var Q=this.dataModel.getLayers();Q&&Q.forEach(function(c){p._layerNames.push(Gc(c)?c.name:c)}),this.editor.inspector&&this.editor.inspector.$35$()}},p.prototype.updateLayers=function(){if(this.dataModel){var c=this.tableModel.size()?[]:null;c&&this.tableModel.getRoots().forEach(function(p){c.push({name:p.a("name"),visible:p.a("visible"),selectable:p.a("selectable"),movable:p.a("movable"),editable:p.a("editable")})}),this.isSettingLayers=!0,this.dataModel.setLayers(c),this.isSettingLayers=!1}},p.prototype.updateTable=function(){var c=this;if(!this.isSettingLayers&&(this.tableModel.clear(),this.dataModel)){var p=this.dataModel.getLayers();p&&p.forEach(function(p){Gc(p)?c.addLayer(p.name,p.visible,p.selectable,p.movable,p.editable):c.addLayer(p,!0,!0,!0,!0)})}},Ap(p,[{key:"currentLayer",get:function(){var c=this.tableModel.sm().ld();if(c)return c.a("name");var p=this.tableModel.getRoots();return p.size()?(c=p.get(p.size()-1),c.a("name")):ht.Data.prototype._layer}},{key:"layerNames",get:function(){return this._layerNames}}]),p}(gp),Br=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));r.editor=Q;var n=r.tableModel=new ht.DataModel,y=r.tablePane=new wQ(n),X=r.tableView=y.getTableView();return n.mm(r.handleUpdate,r),n.md(r.handleTableDataPropertyChange,r),n.sm().setSelectionMode("single"),X.isEditable=function(){return Q.editable},y.addColumns([{name:"stateName",displayName:i("editor.state"),accessType:"attr",editable:!0,valueType:"string",tag:"stateName"},{name:"stateDisplayName",displayName:i("editor.name"),accessType:"attr",editable:!0,valueType:"string",tag:"stateDisplayName"},{name:"isDefault",displayName:i("editor.default"),accessType:"attr",valueType:"boolean",editable:!0,width:48,setValue:function(c,p,Q,i){r.setDefaultState(c.a("stateName"))}}]),y.addViewListener(function(c){if("beginValidate"===c.kind){var p=y.getColumnModel(),Q=y.getWidth(),r=(Q-80)/2;p.getDataByTag("stateName").setWidth(r),p.getDataByTag("stateDisplayName").setWidth(r)}}),r.addRow([r.tablePane],[.1],.1),r.addRow([{button:{icon:"editor.add",toolTip:i("editor.add"),onClicked:function(){if(r.editor.editable){var c=r.addState();r.tableModel.sm().ss(c)}}}},{button:{icon:"editor.delete",toolTip:i("editor.delete"),onClicked:function(){r.editor.editable&&r.removeState()}}}],[20,20]),n.sm().ms(function(c){r.editor.gv.iv();var p=n.sm().ld();if(p){var Q=p.a("stateName"),i=r.editor.dm.toDatas(function(c){return c.s("state")===Q});r.editor.sm.ss(i)}r.updatingClear||(r.dataModel._lastState=r.currentState)}),r._index=0,r}return Np(p,c),p.prototype.handleUpdate=function(){if(!this.updatingClear){var c=[],p=void 0;this.tableModel.each(function(Q){var r=Q.a("stateName"),i=Q.a("stateDisplayName"),n={};Q.a("isDefault")&&(p=r),n.value=r,i&&(n.label=i),c.push(n)}),this.isSettingState=!0,this.editor.dm.a({stateEnum:c,state:p}),this.editor.inspector.filterPropertiesLater(),this.editor.inspector.updateProperties(),this.isSettingState=!1}},p.prototype.handleTableDataPropertyChange=function(c){if("a:stateName"!==c.property||this.renameRollback)this.handleUpdate();else{var p=c.oldValue,Q=c.newValue;this.isStateExist(Q,c.data)?(this.editor.showMessage(i("editor.statenameexist"),"error"),this.renameRollback=!0,c.data.a("stateName",p),this.renameRollback=!1):Q?(this.editor.dm.each(function(c){p===c.s("state")&&c.s("state",Q)}),this.handleUpdate()):(this.editor.showMessage(i("editor.statenameempty"),"error"),this.renameRollback=!0,c.data.a("stateName",p),this.renameRollback=!1)}},p.prototype.addState=function(c,p){var Q=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.currentState,i=this.tableView.dm(),n=new ht.Data;if(!c){for(;this.isStateExist("state"+this._index);)this._index++;c="state"+this._index}if(n.a({stateName:c,isDefault:Q,stateDisplayName:p}),i.add(n),Jp.config.isCopyCompsWhenNewState&&r){var y=this.dataModel.toDatas(function(c){return c.s("state")===r});if(y.size()){var X=this.dataModel.sm();X.cs(),y.each(function(c){X.as(c)}),this.editor.copy(),this.editor.paste(!0),X.each(function(p){p.s("state",c)})}}return n},p.prototype.removeState=function(){var c=this,p=this.tableModel.sm().ld();if(p){var Q=p.a("stateName"),r=this.editor.dm,n=r.toDatas(function(c){return Q===c.s("state")}),y=n.size();y?this.editor.showConfirm(void 0,yp(i("editor.retaincompafterdelete"),Q),function(){n.each(function(c){c.s("state",void 0)}),c.tableModel.remove(p)},function(){for(var Q=y-1;Q>=0;Q--)r.remove(n.get(Q));c.tableModel.remove(p)}):this.tableModel.remove(p)}},p.prototype.handleDataModelPropertyChange=function(c){"a:stateEnum"!==c.property&&"a:state"!==c.property||this.updateTable()},p.prototype.handleDataModelChange=function(c){var p=this.currentState;p&&"add"===c.kind&&c.data.s("state",p)},p.prototype.updateTable=function(){var c=this;if(!this.isSettingState&&this.dataModel){this.updatingClear=!0,this.tableModel.clear();var p=this.dataModel.a("state"),Q=this.dataModel.a("stateEnum");Q&&Q.forEach(function(Q){c.addState(Q.value,Q.label,Q.value===p)}),this.updatingClear=!1}},p.prototype.isStateExist=function(c,p){for(var Q=this.tableModel.toDatas(function(c){return c!==p}),r=Q.size(),i=0;i<r;i++)if(c===Q.get(i).a("stateName"))return!0},p.prototype.setDefaultState=function(c){this.tableModel.each(function(p){p.a("isDefault",p.a("stateName")===c)})},p.prototype.$6$=function(c){var p=this;this.dataModel&&(this.dataModel.ump(this.handleDataModelPropertyChange,this),this.dataModel.umm(this.handleDataModelChange,this));var Q=this.editor.symbolView;if(Q?(this.dataModel=Q.dm,this.dataModel.mp(this.handleDataModelPropertyChange,this),this.dataModel.mm(this.handleDataModelChange,this)):this.dataModel=null,this.updateTable(),Q){var r=this.dataModel._lastState;void 0!==r?this.tableModel.each(function(c){c.a("stateName")===r&&p.tableModel.sm().ss(c)}):this.tableModel.sm().cs()}},Ap(p,[{key:"currentState",get:function(){var c=this.tableModel.sm().ld();return c?c.a("stateName"):void 0}}]),p}(gp),Dr=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));return r.editor=Q,r.editor.menus.push(r),r.setItems([{id:"file",label:i("editor.file"),items:[r.createItem("newSceneView",i("editor.newsceneview"),"newSceneView",Jp.config.scenesVisible),r.createItem("newDisplayView",i("editor.newdisplayview"),"newDisplayView",Jp.config.displaysVisible),r.createItem("newSymbolView",i("editor.newsymbolview"),"newSymbolView",Jp.config.symbolsVisible),r.createItem("newComponent",i("editor.newcomponent"),"newComponent",Jp.config.componentsVisible),r.createItem("newModel",i("editor.newmodel"),"newModel",Jp.config.modelsVisible)]}]),r}return Np(p,c),p.prototype.createItem=function(c,p,Q){var r=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n={id:c,label:p,visible:!(!this.editor[Q]||!i)};return Q&&(n.action=function(){r.editor[Q]()}),n},p}(BQ),Ur=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));return r.editor=Q,r.initMenu(),r.$69$(),r.enableToolTip(),r}return Np(p,c),p.prototype.$6$=function(){this.iv()},p.prototype.initMenu=function(){var c=this;this.editor.mainMenu=new Dr(this.editor);var p=function(p){var Q=c.editor.mainMenu;Q.isShowing()&&!Q.getView().contains(p.target)&&Q.hide()};window.addEventListener("touchstart",p,!1),window.addEventListener("mousedown",p,!1)},p.prototype.$69$=function(){var c=[];this.$68$(c),this.createEditItem(c),this.createDisplayItems(c),this.createSymbolItems(c),this.createSceneItems(c),this.setItems(c)},p.prototype.$68$=function(c){var p=this,Q=Sc("menu",i("editor.menu"),"editor.menu");Q.action=function(c,Q,r){p.editor.mainMenu.isShowing()||(p.editor.mainMenu.showOnView(p,4,20),r.preventDefault(),r.stopPropagation())},c.push(Q)},p.prototype.createEditItem=function(c){var p=this,Q=function(){return p.editor.currentView&&"edit"===p.editor.currentView.$4$()},r=Sc("edit",i("editor.edit"),"editor.edit",Q);r.visible=function(){return!!p.editor.currentView},r.action=function(){var c=p.editor.currentView;c&&c.$5$("edit")},c.push(r)},p.prototype.createDisplayItems=function(c){var p=this,Q=function(c){return function(Q){"node"===c||"subgraph"===c||("edge"===c?Q.s({"edge.width":1,"edge.color":Jp.config.color_data_border}):"group"===c?Q.setExpanded(!0):"arc"===c?Q.s({shape:c,"shape.background":Jp.config.color_data_background,"shape.border.width":1,"shape.border.color":Jp.config.color_data_border,"shape.arc.from":0,"shape.arc.to":4.1888}):"shape"===c?Q.s({"shape.background":null,"shape.border.color":Jp.config.color_data_border,"shape.border.width":1}):"text"===c?Q.s("text",i("editor.text")):Q.s({shape:c,"shape.background":Jp.config.color_data_background,"shape.border.width":1,"shape.border.color":Jp.config.color_data_border})),p.editor.fireEvent("dataInited",{type:c,data:Q,displayView:p.editor.displayView})}};c.push(this.editor.createDisplayItem("Shape",i("editor.shape"),"editor.display.shape",ht.Shape,Q("shape"))),c.push(this.editor.createDisplayItem("Oval",i("editor.oval"),"editor.display.oval",ht.Node,Q("oval"))),c.push(this.editor.createDisplayItem("RoundRect",i("editor.roundrect"),"editor.display.roundrect",ht.Node,Q("roundRect"))),c.push(this.editor.createDisplayItem("Rect",i("editor.rect"),"editor.display.rect",ht.Node,Q("rect"))),c.push(this.editor.createDisplayItem("Polygon",i("editor.polygon"),"editor.display.polygon",ht.Node,Q("polygon"))),c.push(this.editor.createDisplayItem("Triangle",i("editor.triangle"),"editor.display.triangle",ht.Node,Q("triangle"))),c.push(this.editor.createDisplayItem("Star",i("editor.star"),"editor.display.star",ht.Node,Q("star"))),c.push(this.editor.createDisplayItem("Arc",i("editor.arc"),"editor.display.arc",ht.Node,Q("arc"))),c.push(this.editor.createDisplayItem("Text",i("editor.text"),"editor.display.text",ht.Text,Q("text"))),c.push(this.editor.createDisplayItem("Node",i("editor.node"),"editor.display.node",ht.Node,Q("node"))),c.push(this.editor.createDisplayItem("Group",i("editor.group"),"editor.display.group",ht.Group,Q("group"))),c.push(this.editor.createDisplayItem("SubGraph",i("editor.subgraph"),"editor.display.subgraph",ht.SubGraph,Q("subgraph"))),c.push(this.editor.createDisplayItem("Edge",i("editor.edge"),"editor.display.edge",ht.Edge,Q("edge")))},p.prototype.createSymbolItems=function(c){c.push(this.editor.createSymbolItem("shape",i("editor.shape"),"editor.symbol.shape","shape")),c.push(this.editor.createSymbolItem("oval",i("editor.oval"),"editor.symbol.oval","oval")),c.push(this.editor.createSymbolItem("roundRect",i("editor.roundrect"),"editor.symbol.roundrect","roundRect")),c.push(this.editor.createSymbolItem("rect",i("editor.rect"),"editor.symbol.rect","rect")),c.push(this.editor.createSymbolItem("polygon",i("editor.polygon"),"editor.symbol.polygon","polygon")),c.push(this.editor.createSymbolItem("triangle",i("editor.triangle"),"editor.symbol.triangle","triangle")),c.push(this.editor.createSymbolItem("star",i("editor.star"),"editor.symbol.star","star")),c.push(this.editor.createSymbolItem("arc",i("editor.arc"),"editor.symbol.arc","arc")),c.push(this.editor.createSymbolItem("text",i("editor.text"),"editor.symbol.text","text")),c.push(this.editor.createSymbolItem("border",i("editor.border"),"editor.symbol.border","border")),c.push(this.editor.createSymbolItem("piechart",i("editor.piechart"),"editor.symbol.piechart","pieChart")),c.push(this.editor.createSymbolItem("onedimensionalcolumnchart",i("editor.onedimensionalcolumnchart"),"editor.symbol.onedimensionalcolumnchart","oneDimensionalColumnChart")),c.push(this.editor.createSymbolItem("columnchart",i("editor.columnchart"),"editor.symbol.columnchart","columnChart")),c.push(this.editor.createSymbolItem("linechart",i("editor.linechart"),"editor.symbol.linechart","lineChart"))},p.prototype.createSceneItems=function(c){},p}(LQ),ar=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));return r.editor=Q,r.$69$(),r.enableToolTip(),r.setStickToRight(!0),r}return Np(p,c),p.prototype.handlePropertyChange=function(c){"zoom"===c.property&&this.$70$()},p.prototype.$70$=function(){this.label.innerHTML=this.graphView?parseInt(100*this.graphView.getZoom())+"%":""},p.prototype.$6$=function(c){this.graphView&&this.graphView.removePropertyChangeListener(this.handlePropertyChange,this),c?(this.graphView=c.getView().graphView,this.graphView.addPropertyChangeListener(this.handlePropertyChange,this)):this.graphView=null,this.iv(),this.$70$()},p.prototype.$69$=function(){var c=this,p=void 0,Q=function(){return!!c.graphView},r=[];p=Sc("undo",i("editor.undo"),"editor.undo"),p.action=function(){c.editor.undo()},p.visible=Q,r.push(p),p=Sc("redo",i("editor.redo"),"editor.redo"),p.action=function(){c.editor.redo()},p.visible=Q,r.push(p),r.push({separator:!0,visible:Q}),p=Sc("rulers",i("editor.showrulers"),"editor.rulers",function(){return c.editor.isRulerEnabled()}),p.action=function(){c.editor.toggleRulerEnabled()},p.visible=Q,r.push(p),p=Sc("grid",i("editor.showgrid"),"editor.grid",function(){return c.editor.isGridEnabled()}),p.action=function(){c.editor.toggleGridEnabled()},p.visible=Q,r.push(p),r.push({separator:!0,visible:Q}),p=Sc("save",i("editor.save"),"editor.save"),p.action=function(){c.editor.save()},p.visible=Q,r.push(p),p=Sc("preview",i("editor.preview"),"editor.preview"),p.action=function(){c.editor.preview()},p.visible=Q,r.push(p),p=Sc("reload",i("editor.reload"),"editor.reload"),p.action=function(){c.editor.reload()},p.visible=Q,r.push(p),r.push({separator:!0,visible:Q}),p=Sc("zoomOut",i("editor.zoomout"),"editor.zoomout"),p.action=function(){c.editor.zoomOut()},p.visible=Q,r.push(p),r.push(this.createZoomItem(Q)),p=Sc("zoomIn",i("editor.zoomin"),"editor.zoomin"),p.action=function(){c.editor.zoomIn()},p.visible=Q,r.push(p),p=Sc("zoomToFit",i("editor.zoomtofit"),"editor.zoomtofit"),p.action=function(){c.editor.zoomToFit()},p.visible=Q,r.push(p),r.push({separator:!0,visible:Q}),p=Sc("toggleLeft",i("editor.toggleleft"),"editor.toggleleft"),p.action=function(){c.editor.toggleLeft()},r.push(p),p=Sc("toggleBoth",i("editor.toggleboth"),"editor.toggleboth"),p.action=function(){c.editor.toggleBoth()},r.push(p),p=Sc("toggleRight",i("editor.toggleright"),"editor.toggleright"),p.action=function(){c.editor.toggleRight()},r.push(p),this.setItems(r)},p.prototype.createZoomItem=function(c){var p=this,Q=this.label=ht.Default.createDiv(!0);Q.style.font=this.getLabelFont(),Q.style.color=this.getLabelColor(),Q.style.cursor="ew-resize",Q.style.width="40px",Q.style.height=ht.Default.widgetRowHeight+"px",Q.style.lineHeight=ht.Default.widgetRowHeight+"px",Q.style.whiteSpace="nowrap",Q.style.textAlign="center";var r=function(c){c.preventDefault();var Q=p.editor.gv;if(Q){d(c)&&p.editor.zoomReset();var r=Q.getZoom(),i=t(c).x,n=function(c){c.preventDefault();var p=t(c).x-i;Q.setZoom(r*(1+.005*p))};window.addEventListener("mousemove",n,!1),window.addEventListener("touchmove",n,!1);var y=function(c){c.preventDefault(),window.removeEventListener("mousemove",n,!1),window.removeEventListener("touchmove",n,!1),window.removeEventListener("mouseup",y,!1),window.removeEventListener("touchend",y,!1)};window.addEventListener("mouseup",y,!1),window.addEventListener("touchend",y,!1)}};return Q.addEventListener("mousedown",r,!1),Q.addEventListener("touchstart",r,!1),{id:"zoom",unfocusable:!0,element:Q,visible:c}},p}(LQ),_r=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));r.editor=Q,r._errorMsg=null,r.$72$(),r.$71$(),r.$73$(),
r.splitView=new _Q(r.inspectorPane,r.graphView,"v",-200),r.mainSplitView=new _Q(r.funcPane,r.splitView,"h",-360),r._eventData=new ht.Data;var n=[];return n.push({label:i("editor.refresh"),action:function(){r.refresh()}}),n.push({label:i("editor.ok"),action:function(){r.ok()}}),n.push({label:i("editor.cancel"),action:function(){r.hide()}}),r.setConfig({closable:!0,draggable:!0,width:Jp.config.componentViewSize.width,height:Jp.config.componentViewSize.height,contentPadding:0,resizeMode:"wh",maximizable:!0,content:r.mainSplitView,buttons:n,buttonsAlign:"right"}),r}return Np(p,c),p.prototype.$49$=function(){this.hide()},p.prototype.$48$=function(){this.ok()},p.prototype.$72$=function(){var c=this;ht.Default.setCompType("_editingCompType_",{func:function(){}}),this.node=new ht.Node,this.node.setImage({width:100,height:100,fitSize:!0,comps:[{type:"_editingCompType_"}]}),this.graphView=new DQ,this.graphView.dm().add(this.node),this.graphView.sm().ss(this.node),this.graphView.mi(function(p){"doubleClickData"!==p.kind&&"doubleClickBackground"!==p.kind||c.graphView.fitContent(Jp.config.animate,Jp.config.fitPadding)});var p=this;ht.Default.drawCompType=function(c,Q,r,n,y,X){var W="_editingCompType_"===n.type;try{W&&p.beforeDrawCompType(Q),c(Q,r,n,y,X),W&&p.afterDrawCompType(Q)}catch(c){W&&(p.afterDrawCompType(Q),p._errorMsg=i("editor.compfunctionerror")),console.error(c.stack||c)}}},p.prototype.beforeDrawCompType=function(c){var p=this._restoreFlag;p||(p=this._restoreFlag=c.createLinearGradient(0,0,10,10),p.addColorStop(0,"black"),p.addColorStop(0,"black")),c.fillStyle=p,c.save(),c.fillStyle="#000000"},p.prototype.afterDrawCompType=function(c){if(c.restore(),c.fillStyle!==this._restoreFlag){for(var p=0;c.fillStyle!==this._restoreFlag&&(c.restore(),!(++p>=20)););c.fillStyle="black",this._errorMsg=i("editor.complosssaveorrestore")}else this._errorMsg=null},p.prototype.$73$=function(){this.funcPane=new gp,this.funcPane.addRow([{id:"head",element:"function(g, rect, comp, data, view) {"}],[.1]),this.funcPane.addRow([{id:"func",element:np()}],[.1],.1),this.funcPane.addRow(["}"],[.1])},p.prototype.$71$=function(){var c=this,p=Jp.config.indent;this.inspectorPane=new gp,this.inspectorPane.addRow([i("editor.name"),{id:"name",textField:{}}],[p,.1]),this.inspectorPane.addRow([i("editor.path"),{id:"path",textField:{editable:!1}}],[p,.1]),this.inspectorPane.addRow([i("editor.snapshoturl"),{id:"snapshotURL",textField:{}}],[p,.1]),this.inspectorPane.addRow([i("editor.width"),{id:"width",textField:{}},i("editor.height"),{id:"height",textField:{}}],[p,.1,Jp.config.indent2,.1]);var Q=gc(i("editor.eventhandlers"),null,null,function(){c.editor.eventView.open([c._eventData],null,c.resetEventButtonLabelColor.bind(c))});this.eventButton=Q,this.inspectorPane.addRow([i("editor.events"),{element:Q}],[p,.1]),this.inspectorPane.addLine(),this.createTable()},p.prototype.$74$=function(c,p,Q,r){return{name:c,tag:c,accessType:"attr",width:Q,displayName:p,align:"center",enum:r,editable:!0}},p.prototype.createTable=function(){var c=this;this.tableModel=new ht.DataModel,this.tablePane=new wQ(this.tableModel),this.tableView=this.tablePane.getTableView(),this.tableView.setEditable(!0),this.tableView.isEditable=function(){return c.editable},this.tablePane.getView().style.border=Jp.config.color_line+" solid 1px",this.tablePane.addColumns([this.$74$("property",i("editor.property"),90),this.$74$("valueType",i("editor.valuetype"),80,{values:Jp.consts.valueTypes,labels:Jp.consts.valueTypeLabels}),this.$74$("defaultValue",i("editor.defaultvalue"),90),this.$74$("name",i("editor.name"),80),this.$74$("group",i("editor.group"),80),this.$74$("description",i("editor.description"),120),this.$74$("extraInfo",i("editor.extrainfo"),100)]),this.$75$(),this.initExtraInfoColumn(),this.inspectorPane.addRow([this.tablePane],[.1],.1),this.inspectorPane.addRow([{button:{toolTip:i("editor.add"),icon:"editor.add",onClicked:function(){if(c.editable){var p=new ht.Data;p.a({property:"property",valueType:"String"});var Q=void 0,r=c.tableModel.sm().ld();r&&(Q=c.tableModel.getRoots().indexOf(r)+1),c.tableModel.add(p,Q)}}}},{button:{toolTip:i("editor.delete"),icon:"editor.delete",onClicked:function(){c.editable&&c.tableView.removeSelection()}}},null,{button:{icon:"editor.top",toolTip:i("editor.bringtofront"),onClicked:function(){c.editable&&c.tableView.sm().size()&&c.tableModel.moveSelectionToTop()}}},{button:{icon:"editor.up",toolTip:i("editor.bringforward"),onClicked:function(){c.editable&&c.tableView.sm().size()&&c.tableModel.moveSelectionUp()}}},{button:{icon:"editor.down",toolTip:i("editor.sendbackward"),onClicked:function(){c.editable&&c.tableView.sm().size()&&c.tableModel.moveSelectionDown()}}},{button:{icon:"editor.bottom",toolTip:i("editor.sendtoback"),onClicked:function(){c.editable&&c.tableView.sm().size()&&c.tableModel.moveSelectionToBottom()}}}],[20,20,.1,20,20,20,20])},p.prototype.$75$=function(){var c=this,p=this.tableView.getColumnModel().getDataByTag("defaultValue");p.getEnumValues=function(c){var p=c?Jp.config.valueTypes[c.a("valueType")]:null;return p&&"enum"===p.type?p.values:null},p.getEnumLabels=function(c){var p=c?Jp.config.valueTypes[c.a("valueType")]:null;return p&&"enum"===p.type?p.labels:null},p.getEnumIcons=function(c){var p=c?Jp.config.valueTypes[c.a("valueType")]:null;return p&&"enum"===p.type?p.icons:null},p.getEnumDropDownWidth=function(c){var p=c?Jp.config.valueTypes[c.a("valueType")]:null;return p&&"enum"===p.type?p.dropDownWidth:null},p.getValueType=function(c){var p=c?Jp.config.valueTypes[c.a("valueType")]:null;return p?p.type:null},p.isCellEditable=function(p,Q,r,n){var y=p?Jp.config.valueTypes[p.a("valueType")]:null,X=y?y.type:null,W=p.a("extraInfo");if("function"===X){var Z=i("editor.function")+" "+(p.a("property")||"");return c.editor.functionView.open(p.a("defaultValue"),function(c){p.a("defaultValue",c)},Z,W&&W.arguments),!1}if("multiline"===X)return c.editor.textView.open(p.a("defaultValue"),function(c){p.a("defaultValue",c)},p.a("property")||"&nbsp;"),!1;if("font"===X)return c.editor.fontView.open(p.a("defaultValue"),function(c){p.a("defaultValue",c)},p.a("property")||"&nbsp;"),!1;if("object"===X||"custom"===X||"stringArray"===X||"objectArray"===X||"numberArray"===X||"colorArray"===X){var o=i("editor.object")+" "+(p.a("property")||"");return c.editor.objectView.open(p.a("defaultValue"),function(c){p.a("defaultValue",c)},o),!1}return!0}},p.prototype.initExtraInfoColumn=function(){var c=this;this.tableView.getColumnModel().getDataByTag("extraInfo").isCellEditable=function(p,Q,r,n){var y=i("editor.extrainfo")+" "+(p.a("property")||"");return c.editor.objectView.open(p.a("extraInfo"),function(c){p.a("extraInfo",c)},y),!1}},p.prototype.open=function(c,p){var Q=this;this.fileNode=c,c?M(c.url,function(p){Q.update(c.url,c.path,_(c.getName()),p,c.a("editable"))}):this.update(void 0,p||this.editor.components.currentDir,i("editor.untitled"))},p.prototype.update=function(c,p,Q,r,n){if(this.editable=!1!==n,r){if(r=a(r),this.setTitle(i("editor.editcomponent")),this.node.setWidth(r.width||100),this.node.setHeight(r.height||100),this.inspectorPane.v("width",this.node.getWidth()),this.inspectorPane.v("height",this.node.getHeight()),this.inspectorPane.v("snapshotURL",r.snapshotURL||""),this.inspectorPane.getViewById("name").setEditable(!1),this.inspectorPane.v("name",Q||""),this.inspectorPane.v("path",p||""),this.funcPane.v("func",W(r.func)),this.tableModel.clear(),r.properties)for(var y in r.properties){var X=r.properties[y],Z=new ht.Data;Z.a({property:y,valueType:X.valueType,defaultValue:X.defaultValue,name:X.name,group:X.group,description:X.description,extraInfo:X.extraInfo}),this.tableModel.add(Z)}if(this._eventData=new ht.Data,r.events)for(var o in r.events)this._eventData.a(o,r.events[o]);this.resetEventButtonLabelColor(),this.refresh(),this.show(),this.url=c,this.editor.fireEvent("componentViewOpened",{componentView:this,url:c,json:r})}else this.setTitle(i("editor.newcomponent")),this.node.setWidth(100),this.node.setHeight(100),this.inspectorPane.v("width",this.node.getWidth()),this.inspectorPane.v("height",this.node.getHeight()),this.inspectorPane.v("snapshotURL",""),this.inspectorPane.getViewById("name").setEditable(!0),this.inspectorPane.v("name",Q),this.inspectorPane.v("path",p),this.funcPane.v("func",""),this.tableModel.clear(),this.refresh(),this.show(),this.url=c,this.editor.fireEvent("componentViewCreated",{componentView:this})},p.prototype.$76$=function(){return Z(this.funcPane.v("head")+"\n"+this.funcPane.v("func").trim()+"\n}")},p.prototype.$77$=function(){var c={};return this.tableModel.getRoots().each(function(p){c[p.a("property")]={valueType:p.a("valueType"),defaultValue:p.a("defaultValue"),name:p.a("name"),group:p.a("group"),description:p.a("description"),extraInfo:p.a("extraInfo")}}),c},p.prototype.refresh=function(c){ht.Default.setCompType("_editingCompType_",{func:this.$76$(),properties:this.$77$()}),this.node.setWidth(parseFloat(this.inspectorPane.v("width"))),this.node.setHeight(parseFloat(this.inspectorPane.v("height"))),this.node.iv(),this.graphView.fitContent(Jp.config.animate,Jp.config.fitPadding);var p=function(Q){"validate"===Q.kind&&(c&&c(!this._errorMsg),this._errorMsg&&this.editor.showMessage(this._errorMsg,"error"),this.graphView.removeViewListener(p,this))};this.graphView.addViewListener(p,this)},p.prototype.createEvents=function(){var c=this._eventData,p=null;return Cp.forEach(function(Q){c.a(Q)&&(p||(p={}),p[Q]=c.a(Q))}),p},p.prototype.resetEventButtonLabelColor=function(){for(var c=!1,p=0;p<Cp.length;p++)if(this._eventData.a(Cp[p])){c=!0;break}this.eventButton.setLabelColor(c?Jp.config.color_select:ht.Default.labelColor)},p.prototype.ok=function(){var c=this;if(!this.editable)return void this.hide();var p=this.inspectorPane.v("name").trim(),Q=this.inspectorPane.v("path");if(!this.url){var r=this.editor.components;if(r.isAccordionMode()&&r.rootDir===Q)return void this.editor.showMessage(i("editor.createFolderFirst"),"error",2e3)}var n=this.url||Q+"/"+p+".json";if(!p)return void Nc(null,i("editor.inputempty"),function(){});if(p.length>Jp.config.maxFileNameLength)return void Nc(null,i("editor.inputmax"),function(){});if(Jp.config.checkFileName&&!(p=Jp.config.checkFileName(p,n)))return void Nc(null,i("editor.invalidinput"),function(){});nc(p)&&(p=_(p));var y=this.content,X={componentView:this,url:n,json:U(y)};this.editor.fireEvent("componentViewSaving",X),X.preventDefault||(X={path:X.url,content:X.json},this.refresh(function(r){r&&c.editor.request("upload",X,function(r){!0===r&&(c.refresh(),c.graphView.sm().cs(),c.graphView.validate(),c.editor.saveImage(y.snapshotURL||c.graphView,Q+"/"+p+".png",function(){c.editor.fireEvent("componentViewSaved",X)}),c.hide(),c.editor.selectFileNode(X.path),X={componentView:c,url:X.path,json:X.content})})}))},Ap(p,[{key:"content",get:function(){var c={modified:(new Date).toString(),width:parseFloat(this.inspectorPane.v("width")),height:parseFloat(this.inspectorPane.v("height")),snapshotURL:this.inspectorPane.v("snapshotURL"),func:this.$76$()};this.tableModel.size()&&(c.properties=this.$77$());var p=this.createEvents();return p&&(c.events=p),c}}]),p}(vp),wr=460,$r=230,Lr=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));r.editor=Q;var n=[];n.push(i("editor.binding")),n.push({id:"compProperty",textField:{editable:!1}}),n.push({element:i("editor.type"),align:"right"}),n.push({id:"type",comboBox:{values:["attr","func"],onValueChanged:function(c,p){var Q="func"===p,i=Q?ht.Default.labelColor:Jp.config.color_disabled;r.getViewById("func").setEditable(Q),r.getItemById("head").color=i,r.getItemById("end").color=i,r.getViewById("property").setDisabled(Q),Q&&r.getViewById("property").setValue(""),r.iv()}}}),n.push({element:i("editor.property"),align:"right"});var y={id:"property"};Jp.config.dataBindingsForSymbol.getComboBoxValues?y.comboBox={editable:!!Jp.config.dataBindingsForSymbol.comboBoxEditable}:y.textField={},n.push(y);var X=[50,90,40,60,60,.1];if(Jp.config.dataBindingsForSymbol.onButtonClicked){var W=gc("...",void 0,void 0,function(){r.smartClose=!1,Jp.config.dataBindingsForSymbol.onButtonClicked(r,r.v("compProperty"),r.editor)});n.push(W),X.push(20)}if(r.addRow(n,X),!Jp.config.dataBindingsForSymbol.getComboBoxValues){r.getItemById("property").element.getElement().addEventListener("keydown",function(c){ht.Default.isEnter(c)&&r.hide(!0)})}r.addLine(),r.addRow([{id:"head",element:""}],[.1]),r.addRow([{id:"func",element:np()}],[.1],.1),r.addRow([{id:"end",element:"}"},{button:{label:i("editor.ok"),onClicked:function(){r.hide(!0)}}},{button:{label:i("editor.cancel"),onClicked:function(){r.hide()}}}],[.1,50,50]),r.setWidth(wr),r.setHeight($r),r.getView().className="ht-editor-databinding",r.getView().style.background=Jp.config.color_pane,r.getView().style.border=Jp.config.color_pane_dark+" solid 1px",r.getView().style.boxShadow="0px 0px 3px "+ht.Default.toolTipShadowColor,r.getView().style.overflow="visible";var Z=r.handleWindowClick.bind(r);return window.addEventListener("mousedown",Z,!1),window.addEventListener("touchstart",Z,!1),r}return Np(p,c),p.prototype.handleWindowClick=function(c){if(this.smartClose&&this.getView().parentNode&&!this.button.getView().contains(c.target)){var p=this.getViewById("type");if(!p.getListView().getView().contains(c.target)){if((p=this.getViewById("property"))instanceof ht.widget.ComboBox){if(p.getListView().getView().contains(c.target))return;if(p.getInput()&&p.getInput().contains(c.target))return}this.getView().contains(c.target)||this.hide()}}},p.prototype.toggle=function(c,p,Q,r,i,n){this.getView().parentNode?this.hide():this.show(c,p,Q,r,i,n)},p.prototype.show=function(c,p,Q,r,i,n){var y=this;Jp.config.dataBindingsForSymbol.getComboBoxValues?Jp.config.dataBindingsForSymbol.getComboBoxValues(function(X){y.getViewById("property").setValues(X),y.showImpl(c,p,Q,r,i,n)}):this.showImpl(c,p,Q,r,i,n)},p.prototype.showImpl=function(c,p,Q,r,i,n){if(!this.getView().parentNode){this.smartClose=!0;var y=c.getView().getBoundingClientRect(),X=(this.getView().style,s());ht.Default.appendToScreen(this),y.bottom+$r+1>X.height?this.getView().style.top=X.top+y.top-$r-1+"px":this.getView().style.top=X.top+y.bottom+1+"px",this.getView().style.left=X.left+y.right-wr+"px",this.iv(),this.button=c,this.name=p,this.inspector=r,this.setter=n,this.v("compProperty",Q||p);var Z=void 0,o=!1;this.inspector.global?"clip"===p?(Z=i?i():this.inspector.dataModel.a("clip"),this.v("head","function(g, width, height, data, view, image) {"),o=!0):(Z=i?i():this.inspector.dataModel.a(p+"_func"),this.v("head","function(data, view) {")):(Z=i?i():this.inspector.data.a(p),this.inspector.data instanceof dr&&"type"===p?(this.v("head","function(g, rect, comp, data, view) {"),o=!0):this.v("head","function(data, view) {"));Ic(Z)?(jQ.test(Z)?(this.v("type","attr"),this.v("property",Z.slice(5))):(this.v("type","attr"),this.v("property",Z)),this.v("func","")):ec(Z)?(this.v("type","func"),this.v("property",""),this.v("func",W(Z))):(this.v("type","attr"),this.v("property",""),this.v("func","")),o?(this.v("type","func"),this.v("property",""),this.getViewById("type").setDisabled(!0)):this.getViewById("type").setDisabled(!1)}},p.prototype.hide=function(){var c=this,p=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.getView().parentNode&&(O(this.getView()),p)){var Q=this.v("type"),r=this.v("property"),i=void 0;if("func"===Q){var n=this.v("func").trim();(n||this.inspector.data instanceof dr&&"type"===this.name)&&(i=Z(this.v("head")+"\n"+n+"\n}"))}else r&&"attr"===Q&&(i="attr@"+r);this.setter?this.setter(i):this.inspector.global?"clip"===this.name?this.inspector.dataModel.a("clip",i):this.inspector.dataModel.a(this.name+"_func",i):this.inspector.setValue(function(p,Q){p.a(c.name,Q)},i)}},p}(gp),Hr=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));r.editor=Q,r.createTabView();var n=[];return n.push({label:i("editor.ok"),action:function(){r.ok()}}),n.push({label:i("editor.cancel"),action:function(){r.hide()}}),r.setConfig({title:i("editor.eventhandlers"),closable:!0,draggable:!0,width:Jp.config.eventViewSize.width,height:Jp.config.eventViewSize.height,contentPadding:6,resizeMode:"wh",maximizable:!0,content:r.tabView,buttons:n,buttonsAlign:"right"}),r}return Np(p,c),p.prototype.$49$=function(){this.hide()},p.prototype.$48$=function(){this.ok()},p.prototype.ok=function(){var c=this;this.target&&Cp.forEach(function(p){var Q=c[p+"FormPane"],r=Q.v("body").trim();if("data"===c.inspectorType){var i=r?Z("function(event, data, view) {\n"+r+"\n}"):void 0;c.target.forEach(function(c){c.s(p,i)})}else{var n=r?Z("function(event, data, view, point, width, height) {\n"+r+"\n}"):void 0;c.target.forEach(function(c){c.a(p,n)})}}),this.callback&&this.callback(),this.hide()},p.prototype.createTabView=function(){var c=this,p=this.tabView=new $Q;Cp.forEach(function(Q){var r=c[Q+"FormPane"]=new gp;r.addRow([{id:"head",element:""}],[.1]),r.addRow([{id:"body",element:np()}],[.1],.1),r.addRow(["}"],[.1]),c[Q+"Tab"]=p.add(i("editor.event."+Q.toLowerCase()),r)}),p.getTabModel().sm().ss(p.getTabModel().getDatas().get(0))},p.prototype.open=function(c,p,Q){var r=this;c&&c.length&&(this.target=c,this.inspectorType=p,this.callback=Q,Cp.forEach(function(Q){var i=r[Q+"FormPane"];"data"===p?(i.v("head",Q+": function(event, data, view) {"),i.v("body",W(c[c.length-1].s(Q)))):(i.v("head",Q+": function(event, data, view, point, width, height) {"),i.v("body",W(c[c.length-1].a(Q))))}),this.show())},p}(vp),Or=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));r.editor=Q,r.formPane=new gp;var n=r.raws=[],y=r.formPane.addRow([{id:"head",element:"function() {"}],[.1]);n.push(y),y=r.formPane.addRow([{id:"function",element:np()}],[.1],.1),n.push(y),y=r.formPane.addRow(["}"],[.1]),n.push(y);var X=[];return X.push({label:i("editor.ok"),action:function(){r.ok()}}),X.push({label:i("editor.cancel"),action:function(){r.hide()}}),r.setConfig({title:i("editor.function"),closable:!0,draggable:!0,width:Jp.config.functionViewSize.width,height:Jp.config.functionViewSize.height,contentPadding:6,resizeMode:"wh",maximizable:!0,content:r.formPane,buttons:X,buttonsAlign:"right"}),r}return Np(p,c),p.prototype.$49$=function(){this.hide()},p.prototype.$48$=function(){this.ok()},p.prototype.parse=function(c){if(c){var p=this.getFunctionHead();return c=c.trim(),p?c=""+p+c+"}":c.startsWith("function")||(c="function() {\n"+c+"\n}"),Z(c)}},p.prototype.ok=function(){this.setValue&&this.setValue(this.parse(this.formPane.v("function"))),this.hide()},p.prototype.setFormRows=function(){var c=this.formPane,p=this.raws,Q=this._argList;this._argList?c._rows=p:c._rows=[p[1]],c.iv(),Q&&c.v("head",this.getFunctionHead())},p.prototype.getFunctionHead=function(){var c=this._argList;if(c)return"function("+(ht.Default.isArray(c)?c.join(", "):c)+") {"},p.prototype.stringifyFunction=function(c){var p=X(c);if(this._argList){var Q=p.indexOf("{"),r=p.lastIndexOf("}");p=p.substring(Q+1,r)}return p},p.prototype.open=function(c,p,Q,r){this.setValue=p,this._argList=r,this.setTitle(Q),this.setFormRows(),this.formPane.v("function",this.stringifyFunction(c)),this.show()},p}(vp),Mr=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));r.editor=Q,r.formPane=new gp,r.formPane.addRow([{id:"object",element:np()}],[.1],.1);var n=[];return n.push({label:i("editor.ok"),action:function(){r.ok()}}),n.push({label:i("editor.cancel"),action:function(){r.hide()}}),r.setConfig({title:i("editor.object"),closable:!0,draggable:!0,width:Jp.config.objectViewSize.width,height:Jp.config.objectViewSize.height,contentPadding:6,resizeMode:"wh",maximizable:!0,content:r.formPane,buttons:n,buttonsAlign:"right"}),r}return Np(p,c),p.prototype.$49$=function(){this.hide()},p.prototype.$48$=function(){this.ok()},p.prototype.ok=function(){if(this.setValue){var c=this.formPane.v("object").trim();c=new Function("return "+c)(),this.setValue(c)}this.hide()},p.prototype.open=function(c,p,Q){if(this.setValue=p,this.setTitle(Q),c=this.stringify(c,4)){this._funcMap;for(var r in this._funcMap)c=c.replace('"'+r+'"',X(this._funcMap[r]))}this.formPane.v("object",c),this.show()},p.prototype.stringify=function(c,p){var Q=this,r=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()},this._funcMap={};var i=JSON.stringify(c,function(c,p){if("function"==typeof p){var r=Math.random().toString().substring(3,16)+Date.now();return Q._funcMap[r]=p,r}return p},null==p?2:p);return Date.prototype.toJSON=r,i},p}(vp),Kr=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));r.editor=Q,r.formPane=new gp,r.formPane.addRow([{id:"text",textArea:{}}],[.1],.1);var n=[];return n.push({label:i("editor.ok"),action:function(){r.ok()}}),n.push({label:i("editor.cancel"),action:function(){r.hide()}}),r.setConfig({closable:!0,draggable:!0,width:Jp.config.textViewSize.width,height:Jp.config.textViewSize.height,contentPadding:6,resizeMode:"wh",maximizable:!0,content:r.formPane,buttons:n,buttonsAlign:"right"}),r}return Np(p,c),p.prototype.$49$=function(){this.hide()},p.prototype.$48$=function(){this.ok()},p.prototype.ok=function(){this.setValue&&this.setValue(this.formPane.v("text")),this.hide()},p.prototype.open=function(c,p,Q){this.setValue=p,this.setTitle(Q),this.formPane.v("text",c||""),this.show()},p}(vp),ur=function(){function c(){Tp(this,c)}return c.prototype.init=function(){var c=this.baseFonts=["monospace","sans-serif","serif"],p=this.testString="mmmmmmmmmmlli",Q=this.testSize="72px",r=this.h=document.getElementsByTagName("body")[0],i=this.s=document.createElement("span");i.style.fontSize=Q,i.innerHTML=p;var n=this.defaultWidth={},y=this.defaultHeight={};for(var X in c)i.style.fontFamily=c[X],r.appendChild(i),n[c[X]]=i.offsetWidth,y[c[X]]=i.offsetHeight,r.removeChild(i);this.initialized=!0},c.prototype.detect=function(c){this.initialized||this.init();var p=!1,Q=this.baseFonts,r=this.s,i=this.h,n=this.defaultWidth,y=this.defaultHeight;for(var X in Q){r.style.fontFamily=c+","+Q[X],i.appendChild(r);var W=r.offsetWidth!=n[Q[X]]||r.offsetHeight!=y[Q[X]];i.removeChild(r),p=p||W}return p},c}(),xr=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));return r.editor=Q,r}return Np(p,c),p.prototype.init=function(){var c=this;this._detector=new ur;var p=this.borderPane=new FQ,Q=this.rightBorder=new FQ,r=this.previewGraph=new ht.graph.GraphView,n=this.listView=new UQ,y=this.formPane=new gp;n.getView().style.borderRight="2px solid #f7f7f7",n.getLabelFont=function(c){return"14px "+c.getName()},p.setLeftView(n),p.setCenterView(Q),p.setLeftWidth(180),Q.setBottomView(r),Q.setBottomHeight(120),Q.setCenterView(y),r.adjustTranslateX=function(){return 0},r.adjustTranslateY=function(){return 0},r.handleScroll=function(){return!1},r.setScrollBarVisible(!1);var X=this.textNode=new ht.Text;X.s({"2d.selectable":!1,text:Jp.config.fontPreview}),X.setAnchor(0,0),X.setSize(2e3,120),X.p(4,4),r.dm().add(X);y.setVPadding(32),y.setVGap(18),y.setHGap(0),y.addRow([{element:i("editor.font.style"),align:"right"},"",{id:"normal",button:this.createStyleButton(i("editor.font.normal"))},{id:"bold",button:this.createStyleButton(i("editor.font.bold"))},{id:"oblique",button:this.createStyleButton(i("editor.font.oblique"))},{id:"obliqueBold",button:this.createStyleButton(i("editor.font.obliqueBold"))}],[60,8,.1,.1,.1,.1],32),y.addRow([{element:i("editor.font.size"),align:"right"},"",{id:"fontSize",slider:{max:72,min:12,step:1,onValueChanged:function(p,Q){y.getItemById("fontSizeLabel").element=Q+"",y.iv(),c._handleFontChange()}}},{id:"fontSizeLabel",element:"12"}],[60,8,.1,20],32),y.addRow([{element:"\u8f93\u51fa",align:"right"},"",{id:"fontOutput",textField:{editable:!1,value:this.getFontString()}}],[60,8,.1],32);var W=[];W.push({label:i("editor.ok"),action:function(){c.ok()}}),W.push({label:i("editor.cancel"),action:function(){c.hide()}}),this.initFontList(),this.setConfig({closable:!0,draggable:!0,width:Jp.config.fontViewSize.width,height:Jp.config.fontViewSize.height,contentPadding:6,resizeMode:"wh",maximizable:!0,content:p,buttons:W,buttonsAlign:"right"}),this._init=!0},p.prototype.createStyleButton=function(c){var p=this;return{label:c,groupId:"fontStyle",labelSelectColor:Jp.config.color_select,labelColor:"#2c2c2c",borderSelectColor:"red",background:"rgb(247,247,247)",selectBackground:"rgb(247,247,247)",togglable:!0,borderColor:null,onClicked:function(c){p._handleFontChange()}}},p.prototype.initFontList=function(){var c=this,p=this.listView,Q=p.getView().style,r=p.dm(),i=this._detector,n=Jp.config.fontList;return p.sm().ms(function(p){c._handleFontChange(p)}),n.forEach(function(c){if(i.detect(c)){var p=new ht.Node;p.setIcon(null),p.setName(c),r.add(p)}}),r.sm().setSelectionMode("multiple"),Q.background="white",p},p.prototype.$49$=function(){this.hide()},p.prototype.$48$=function(){this.ok()},p.prototype._handleFontChange=function(){this.textNode.s("text.font",this.getFontString()),this.formPane.v("fontOutput",this.getFontString())},p.prototype.getFontString=function(){var c=this.listView,p=this.formPane,Q=c.sm().getSelection().toArray(),r="",i=Q.map(function(c){return c.getName()});return i.length||(i=["arial"]),["bold","oblique","obliqueBold"].forEach(function(c,Q){p.getItemById(c).element.isSelected()&&(0===Q?r="bold ":1===Q?r="italic ":2===Q&&(r="italic bold "))}),""+r+p.getValue("fontSize")+"px "+i.join(", ")},p.prototype.ok=function(){this.setValue&&this.setValue(this.getFontString()),this.hide()},p.prototype.analysisFontString=function(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ht.Default.labelFont;"string"!=typeof c&&(c=ht.Default.labelFont);var p=c.split(/px\s+/);p.length<2&&(p=ht.Default.labelFont.split(/px\s+/));var Q=p[0].split(/\s+/),r=p[1].split(",").map(function(c){return c.trim()}),i=/\d+/,n=void 0,y=void 0,X=void 0;Q.forEach(function(c){"bold"===c?n=!0:"oblique"===c||"italic"===c?y=!0:i.test(c)&&(X=parseInt(c))}),this.setFormValue(X,r,n,y)},p.prototype.setFormValue=function(c,p,Q,r){var i=this.listView,n=this.formPane;i.sm().cs(),i.dm().each(function(c){p.forEach(function(p){c.getName().toLowerCase()===p.toLowerCase()&&i.sm().as(c)})});var y=0;Q&&r?y=3:Q?y=1:r&&(y=2),["normal","bold","oblique","obliqueBold"].forEach(function(c,p){n.getItemById(c).element.setSelected(y===p)}),n.getItemById("fontSizeLabel").element=c+"",n.setValue("fontSize",c)},p.prototype.open=function(c,p,Q){this._init||this.init(),this.setValue=p,this.setTitle(Q),this.analysisFontString(c),this.show()},p}(vp),qr=300,zr=230,Vr=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));r.editor=Q,r.addRow([{id:"content",textArea:{}}],[.1],.1),r.addRow([null,{button:{label:i("editor.ok"),onClicked:function(){r.hide(!0)}}},{button:{label:i("editor.cancel"),onClicked:function(){r.hide()}}}],[.1,50,50]),r.setWidth(qr),r.setHeight(zr),r.getView().className="ht-editor-styleicons",r.getView().style.background=Jp.config.color_pane,r.getView().style.border=Jp.config.color_pane_dark+" solid 1px",r.getView().style.boxShadow="0px 0px 3px "+ht.Default.toolTipShadowColor,r.getView().style.overflow="visible";var n=function(c){!r.getView().parentNode||r.button.getView().contains(c.target)||r.getView().contains(c.target)||r.hide()};return window.addEventListener("mousedown",n,!1),window.addEventListener("touchstart",n,!1),r}return Np(p,c),p.prototype.toggle=function(c,p){this.getView().parentNode?this.hide():this.show(c,p)},p.prototype.show=function(c,p){if(!this.getView().parentNode){var Q=c.getView().getBoundingClientRect(),r=(this.getView().style,s());ht.Default.appendToScreen(this),this.getView().style.top=r.top+Q.top+"px",this.getView().style.left=r.left+Q.left-qr-4+"px",this.iv(),this.button=c,this.data=p;var i=p.s("icons");this.v("content",i?U(i):"")}},p.prototype.hide=function(){var c=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.getView().parentNode&&(O(this.getView()),c)){var p=this.v("content").trim();this.data.s("icons",p?a(p):void 0)}},p}(gp),Tr=function(){function c(p){var Q=this;Tp(this,c),this.editor=p;var r=this.container=ht.Default.createDiv(),i=this.wrap=ht.Default.createDiv(),n=r.style;n.pointerEvents="none",n.position="absolute",n.left=0,n.right=0,n.top=0,n.bottom=0,r.appendChild(i),n=i.style,n.width="600px",n.position="absolute",n.left="50%",n.bottom="20px",n.marginLeft="-300px",n.pointerEvents="none",this._cache=[],this._visibleCount=0,this.layoutContainer(),window.addEventListener("resize",function(){Q.layoutContainer()})}return c.prototype.layoutContainer=function(){var c=this.container,p=ht.Default.getWindowInfo(),Q=c.style;Q.width=p.width+"px",Q.height=p.height+"px"},c.prototype.createMessage=function(c){var p=this._cache.pop();if(!p){p=document.createElement("div");var Q=p.style;Q.boxSizing="border-box",Q.padding=0,Q.backgroundColor="rgba(61,61,61,0.15)",Q.color="rgb(247,247,247)",Q.margin="5px auto",Q.textAlign="center",Q.borderRadius="19px",Q.height=0,Q.overflow="hidden",Q.pointerEvents="none",Q.webkitTransition="0.3s all",Q.mozTransition="0.3s all",Q.msTransition="0.3s all",Q.oTransition="0.3s all",Q.transition="0.3s all"}return p.innerText=c,p},c.prototype.show=function(c){var p=this,Q=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3,i=this.createMessage(c);this.wrap.appendChild(i),this._visibleCount||ht.Default.appendToScreen(this.container),this._visibleCount++,i.style.backgroundColor="normal"===Q?"rgba(61,61,61,0.15)":"#FF7C7C",setTimeout(function(){i.style.height="38px",i.style.padding="8px 20px",p.hideLater(i,r)},10)},c.prototype.hideLater=function(c,p){var Q=this;setTimeout(function(){c.style.height=0,c.style.padding=0,setTimeout(function(){if(Q.wrap.removeChild(c),Q._cache.push(c),!--Q._visibleCount){Q.container.parentNode.removeChild(Q.container)}},500)},p)},c}(),Ar=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));return r.editor=Q,r}return Np(p,c),p.prototype.init=function(){var c=this,p=this.dm=new ht.DataModel,Q=this.gv=new ht.graph.GraphView(p),r=this.rightFormPane=new gp,n=this.splitView=new _Q(Q,r,"h",.6),y=this.targetNode=new ht.Node;y.setAnchor(0,0),y.p(0,0),y.s("2d.selectable",!1),Q.dm().add(y),Q.setEditable(!0),Q.addBottomPainter(function(c){var p=this.getViewRect();c.fillStyle="#cbd3d8",c.fillRect(p.x,p.y,p.width,p.height);var Q=y.getRect();c.fillStyle="#fff",c.fillRect(Q.x,Q.y,Q.width,Q.height)});var X=[{label:i("editor.ok"),action:function(){c.editor.dm.a("attachPoints",c.toPointsData()),c.hide()}},{label:i("editor.cancel"),action:function(){c.hide()}}];this.setConfig({title:"\u5438\u9644\u70b9",content:n,closable:!0,draggable:!0,maximizable:!0,resizeMode:"wh",buttons:X,width:Jp.config.attachPointsViewSize.width,height:Jp.config.attachPointsViewSize.height}),this.$81$(),p.md(function(c){if("position"===c.property&&c.data!==y){var p=c.data,Q=p.a("offsetX"),r=p.a("offsetY"),i=c.newValue.x-Q,n=c.newValue.y-r;p.a({x:parseFloat((i/y.getWidth()).toFixed(2)),y:parseFloat((n/y.getHeight()).toFixed(2))})}}),Q.mp(function(c){if("zoom"===c.property){var r=1/Q.getZoom();p.each(function(c){c!==y&&c.setScale(r,r)})}}),this._init=!0},p.prototype.$81$=function(){var c=this,p=new wQ(this.dm),Q=this.tableView=p.getTableView();Q.isVisible=function(p){return p!==c.targetNode},Q.setEditable(!0),p.getView().style.border=Jp.config.color_line+" solid 1px",p.addColumns([this.$74$("x","X",70,function(p,Q,r,i){var n=c.targetNode.getWidth();p.setX(n*r+(p.a("offsetX")||0))}),this.$74$("y","Y",70,function(p,Q,r,i){var n=c.targetNode.getHeight();p.setY(n*r+(p.a("offsetY")||0))}),this.$74$("offsetX","Offset X",70,function(p,Q,r,i){p.a("offsetX",r);var n=c.targetNode.getWidth();p.setX(n*p.a("x")+r)}),this.$74$("offsetY","Offset Y",70,function(p,Q,r,i){p.a("offsetY",r);var n=c.targetNode.getHeight();p.setY(n*p.a("y")+r)})]);var r=Jp.config.customAttachPointsColumns;if(r&&r.length){var n=this.customColumns=r.map(function(p){
return c.$74$(p.name,p.displayName,p.width||70,p.setter,"string")});p.addColumns(n)}this.rightFormPane.addRow([p],[.1],200),this.rightFormPane.addRow([{button:{icon:"editor.add",toolTip:i("editor.add"),onClicked:function(){c.add()}}},{button:{icon:"editor.delete",toolTip:i("editor.delete"),onClicked:function(){c.remove()}}}],[20,20],20)},p.prototype.add=function(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,Q=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments[4],n=new ht.Node,y=1/this.gv.getZoom();if(n.setImage("editor.attachPoint"),n.setScale(y,y),n.a({x:c,y:p,offsetX:Q,offsetY:r}),n.s({"2d.editable":!1}),i)for(var X in i)"x"!==X&&"y"!==X&&"offsetX"!==X&&"offsetY"!==X&&n.a(X,i[X]);var W=this.targetNode.getWidth(),Z=this.targetNode.getHeight();return n.p(c*W+Q,p*Z+r),this.gv.dm().add(n),n},p.prototype.remove=function(){for(var c=this.dm.sm().getSelection().toArray(),p=c.length-1;p>=0;p--)this.dm.remove(c[p])},p.prototype.$74$=function(c,p,Q,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"number";return{name:c,tag:c,width:Q,displayName:p,align:"center",editable:!0,valueType:i,getValue:function(p){return p.a(c)},setValue:r}},p.prototype.toPointsData=function(){var c=this;return this.dm.toDatas(function(p){return p!==c.targetNode}).toArray().map(function(p){var Q={x:p.a("x"),y:p.a("y")};return p.a("offsetX")&&(Q.offsetX=p.a("offsetX")),p.a("offsetY")&&(Q.offsetY=p.a("offsetY")),c.customColumns&&c.customColumns.forEach(function(c){var r=p.a(c.name);r&&(Q[c.name]=r)}),Q})},p.prototype.$49$=function(){this.hide()},p.prototype.createNodeByPointData=function(){var c=this,p=this.editor.dm.a("attachPoints");p&&p.forEach(function(p){c.add(p.x,p.y,p.offsetX,p.offsetY,p)})},p.prototype.show=function(p){this._init||this.init(),this.dm.clear(),this.dm.add(this.targetNode),this.targetNode.setImage(p),this.createNodeByPointData(),c.prototype.show.call(this),this.gv.fitContent(!0)},p}(vp),Nr=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));return r.editor=Q,r}return Np(p,c),p.prototype.init=function(){var c=this,p=this.formPane=new gp;p.setVPadding(2),p.setVGap(8),p.setHGap(0),p.addRow([{element:i("editor.size"),background:Jp.config.color_pane_dark}],[.1],24),p.addRow([i("editor.width"),{id:"width",type:"number",textField:{value:30}},i("editor.height"),{id:"height",type:"number",textField:{value:40}}],[64,.1,64,.1],24),p.addRow([{element:i("editor.content"),background:Jp.config.color_pane_dark}],[.1],24),p.addRow([{id:"uppercase",checkBox:{label:i("editor.uppercase"),selected:!0}},{id:"lowercase",checkBox:{label:i("editor.lowercase"),selected:!0}},{id:"number",checkBox:{label:i("editor.valuetype.number"),selected:!0}}],[.1,.1,.1],24),p.addRow([i("editor.custom"),{id:"content",textField:{}}],[64,.1],24);var Q=[];Q.push({label:i("editor.ok"),action:function(){c.ok()}}),Q.push({label:i("editor.cancel"),action:function(){c.hide()}}),this.setConfig({closable:!0,draggable:!0,title:i("editor.converteroption"),width:320,height:240,contentPadding:6,resizeMode:"wh",maximizable:!0,content:p,buttons:Q,buttonsAlign:"right"}),this._init=!0},p.prototype.ok=function(){var c=this.formPane,p=c.v("width"),Q=c.v("height"),r=c.v("uppercase"),i=c.v("lowercase"),n=c.v("number"),y=c.v("content"),X="";r&&(X+="ABCDEFGHIJKLMNOPQRSTUVXWYZ"),i&&(X+="abcdefghijklmnopqrstuvxwyz"),n&&(X+="1234567890"),X+=y;var W={width:p,height:Q,texts:X};this.callback&&this.callback(W),delete this.callback,this.hide()},p.prototype.open=function(c){this._init||this.init(),this.callback=c,this.show()},p}(vp),Sr=function c(p,Q){var r=this;Tp(this,c),this.editor=p,this.inspector=Q,["isDataTitleVisible","isDataPropertyVisible","isCompTitleVisible","isCompPropertyVisible","isDisplayTitleVisible","isDisplayPropertyVisible","isSymbolTitleVisible","isSymbolPropertyVisible","isData3dTitleVisible","isData3dPropertyVisible","isSceneTitleVisible","isScenePropertyVisible"].forEach(function(c){r[c]=function(){return!(Jp.config.detailFilter[c]&&!Jp.config.detailFilter[c].apply(Q,arguments))&&!(p.inspectorCompact&&Jp.config.compactFilter[c]&&!Jp.config.compactFilter[c].apply(Q,arguments))}})},vr=function(c){function p(Q,r,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Tp(this,p);var y=Sp(this,c.call(this));return y.setHPadding(8),y.global=n,y.editor=Q,y.name=r,y.type=i,y.setVPadding(0),y.inspectorFilter=new Sr(Q,y),y.updateHandlers=[],y.propertyChangeHandlers=[],y.editor.fireEvent("inspectorInitializing",{inspector:y}),y.initForm(),y.editor.fireEvent("inspectorInitialized",{inspector:y}),y.$104$(),y.editor.fireEvent("inspectorCreated",{inspector:y}),y.$47$=y._rows,y}return Np(p,c),p.prototype.initForm=function(){},p.prototype.beginTransaction=function(){this.dataModel&&this.dataModel.beginTransaction()},p.prototype.endTransaction=function(){this.dataModel&&this.dataModel.endTransaction()},p.prototype.addUpdateHandler=function(c){this.updateHandlers.push(c)},p.prototype.removeUpdateHandler=function(c){n(this.updateHandlers,c)},p.prototype.addPropertyChangeHandler=function(c){this.propertyChangeHandlers.push(c)},p.prototype.removePropertyChangeHandler=function(c){n(this.propertyChangeHandlers,c)},p.prototype.$104$=function(){for(var c=this._rows,p=!0,Q=c.length-1;Q>=0;Q--)c[Q].title?p?this.removeRow(c[Q]):p=!0:p=!1},p.prototype.isTitleVisible=function(c){return!1!==c.visible&&(!ec(c.visible)||!1!==c.visible(this))},p.prototype.isPropertyVisible=function(c){var p=this.editor.inspectorInputFilter;if(p){if(!c.keys)return!1;p=p.toLowerCase();var Q=c.keys.name;if(Q&&Q.toLowerCase().indexOf(p)>=0)return!0;var r=c.keys.displayName;return!!(r&&r.toLowerCase().indexOf(p)>=0)}return!1!==c.visible&&!(ec(c.visible)&&!c.visible(this))},p.prototype.makeItemsHidden=function(c){var p=this;c.hidden=!0,c.forEach(function(c){var Q=p.getItemView(c);Q&&(Q.style.display="none")})},p.prototype.makeItemsVisible=function(c){var p=this;c.hidden=!1,c.forEach(function(c){var Q=p.getItemView(c);Q&&(Q.style.display="block")})},p.prototype.filterPropertiesLater=function(){var c=this;this._filterPropertiesLater||(this._filterPropertiesLater=!0,requestAnimationFrame(function(){c.filterProperties()}))},p.prototype.isTitleExpanded=function(c){return!(c&&!this.editor.inspectorInputFilter)||Jp.config.expandedTitles[c]},p.prototype.filterProperties=function(){var c=this;this._filterPropertiesLater=!1;var p=[],Q=void 0,r=!1;this.$47$.forEach(function(i){var n=i.items;i.title?(!r&&"$$HTISFUCKINGAWESOME$$"!==Q&&p.length&&p[p.length-1].title&&c.makeItemsHidden(p.pop().items),c.isTitleVisible(i)?(Q=i.title,i.button.setIcon(c.isTitleExpanded(Q)?"expandIcon":"collapseIcon"),p.push(i),c.makeItemsVisible(n)):(Q="$$HTISFUCKINGAWESOME$$",c.makeItemsHidden(n)),r=!1):"$$HTISFUCKINGAWESOME$$"===Q?c.makeItemsHidden(n):(c.isTitleExpanded(Q)&&c.isPropertyVisible(i)?(p.push(i),c.makeItemsVisible(n)):c.makeItemsHidden(n),!r&&c.isPropertyVisible(i)&&(r=!0))}),!r&&"$$HTISFUCKINGAWESOME$$"!==Q&&p.length&&p[p.length-1].title&&this.makeItemsHidden(p.pop().items),this._rows=p,this.updateProperties(),this.iv()},p.prototype.addTitle=function(c,p){var Q=this,r=this._oldTitle;this.editor.fireEvent("titleCreating",{oldTitle:r,title:c,inspector:this});var n=function(){Jp.config.expandedTitles[c]=!Jp.config.expandedTitles[c],Q.filterProperties()},y=[],X=this.addButton(y,null,null,null,n,!0);X.setBorderColor(null);var W=i("editor."+c.toLowerCase(),!0)||i(c);y.push({element:W,font:Jp.config.boldFont}),p=p||{},p.title=c,p.background=Jp.config.inspectorTitleBackground||Jp.config.color_pane_dark,p.button=X;var Z=this.addRow(y,[20,.1],Jp.config.inspectorTitleHeight||null,p);return this._oldTitle=c,this.editor.fireEvent("titleCreated",{oldTitle:r,title:c,inspector:this}),Z},p.prototype.$35$=function(c){var p=this;c&&(this.propertyChangeHandlers.forEach(function(Q){Q(c,p)}),this.$47$.forEach(function(Q){Q.onPropertyChanged&&Q.onPropertyChanged(c,p)})),this._updatePropertiesLater||(this._updatePropertiesLater=!0,requestAnimationFrame(function(){p.updateProperties()}))},p.prototype.updateProperties=function(){this._updating=!0,this.updateHandlers.forEach(function(c){c()}),this.editor.fireEvent("propertiesUpdated",{inspector:this}),this._updating=!1,this._updatePropertiesLater=!1},p.prototype.eachSelection=function(c){this.dataModel&&(this.beginTransaction(),this.dataModel.sm().each(function(p){c(p)}),this.endTransaction())},p.prototype.getPropertyValue=function(c,p){p=this.fixAccessType(p);var Q=o(p,c);return this.getValue(Q)},p.prototype.setPropertyValue=function(c,p,Q,r){Q=this.fixAccessType(Q);var i=l(Q,c);i.once=r,this.setValue(i,p)},p.prototype.getValue=function(c){if(this.dataModel)return this.global?c(this.dataModel):this.data?c(this.data):void 0},p.prototype.setValue=function(c,p,Q){!this._updating&&this.dataModel&&this.editor.editable&&(this.beginTransaction(),this.global?c(this.dataModel,Q?Q():p):c.once?this.data&&c(this.data):this.dataModel.sm().each(function(r){c(r,Q?Q():p)}),this.endTransaction())},p.prototype.addLabelArray=function(c,p,Q,r,i,n){return this.addLabel(c,p,Q,r,void 0,n),this.addArray(c,Q,r,i)},p.prototype.addLabelTextArea=function(c,p,Q,r,i){return this.addLabel(c,p,Q,r,void 0,i),this.addTextArea(c,Q,r)},p.prototype.addLabelMultiline=function(c,p,Q,r,i){var n=this;this.addLabelInput(c,p,Q,r,void 0,i),this.addButton(c,"...",null,null,function(c){var i=function(c){n.setValue(r,c)};n.editor.textView.open(n.getValue(Q),i,p)},!0)},p.prototype.addLabelInput=function(c,p,Q,r,i,n,y,X){return this.addLabel(c,p,Q,r,n,X),this.addInput(c,Q,r,i,y)},p.prototype.addLabelRange=function(c,p,Q,r,i,n,y,X,W){var Z=this,o=function(c){var p=Q(c);return null==p?n:p};return this.addLabelInput(c,p,o,r?function(c,p){void 0!==n&&p>n&&(p=n),void 0!==i&&p<i&&(p=i);var Q=o(c);r(c,p),Q===p&&Q===n&&Z.updateProperties()}:null,X,y,void 0,W)},p.prototype.addLabelColor=function(c,p,Q,r,i){return this.addLabel(c,p,Q,r,void 0,i),this.addColor(c,Q,r)},p.prototype.addLabelCheckBox=function(c,p,Q,r,i){return this.addLabel(c,p,Q,r,void 0,i),this.addCheckBox(c,Q,r)},p.prototype.addLabelFunction=function(c,p,Q,r,i,n,y){return this.addLabel(c,p,Q,r,void 0,y),this.addFunction(c,Q,r,i,n)},p.prototype.addLabelObject=function(c,p,Q,r,i,n){return this.addLabel(c,p,Q,r,void 0,n),this.addObject(c,Q,r,i)},p.prototype.addLabelComboBox=function(c,p,Q,r,i,n,y,X){return this.addLabel(c,p,Q,r,void 0,X),this.addComboBox(c,Q,r,i,n,y)},p.prototype.addLabelURL=function(c,p,Q,r,i,n){var y=this.addLabelInput(c,p,Q,r,null,null,!1,n);if(r){var X=y.getElement();y.isDroppable=i||function(c,p){return!!p.view.draggingData},y.handleCrossDrag=function(c,p,Q){"enter"===p?X.style.border="solid "+Jp.config.color_select_dark+" 2px":"exit"===p||"cancel"===p?X.style.border="":"over"===p||"drop"===p&&(X.style.border="",X.value=Q.view.draggingData.getFileUUID(),y.setFocus(),y.handleChange())}}return y},p.prototype.addLabelImage=function(c,p,Q,r,i){var n=function(c,p){if(!p.view.draggingData)return!1;var Q=p.view.draggingData.fileType;return Q===rQ||Q===iQ};return this.addLabelURL(c,p,Q,r,n,i),this.addImage(c,Q,r)},p.prototype.addLabelGradient=function(c,p,Q,r,i,n){var y=this,X=[],W=function(){return y.data&&y.data.s(i)||Jp.config.color_light},Z=function(){return y.data&&y.data.s(r)||Jp.config.color_select};Jp.consts.gradients.forEach(function(c){c?X.push({width:20,height:14,comps:[{type:"rect",rect:[0,0,20,14],gradient:c,gradientColor:{func:W},background:{func:Z}}]}):X.push({width:20,height:14,comps:[]})});var o=this.addLabelComboBox(c,p,function(c){return c.s(Q)},function(c,p){c.s(Q,p)},Jp.consts.gradients,null,X,n);this.updateHandlers.push(function(){if(!c.hidden){var p=W(),Q=Z();o._lastGradientColor===p&&o._lastBackground===Q||(o._lastGradientColor=p,o._lastBackground=Q,o.iv())}})},p.prototype.addLabelFont=function(c,p,Q,r,i){var n=this;this.addLabelInput(c,p,function(c){return Q(c)||ht.Default.labelFont},r?function(c,p){r(c,p||void 0)}:null,void 0,void 0,void 0,i),this.addButton(c,"...",null,null,function(c){var i=function(c){n.setValue(r,c)};n.editor.fontView.open(n.getValue(Q),i,p)},!0)},p.prototype.addLabelRotation=function(c,p,Q,r,i,n,y,X){return this.addLabelInput(c,p,function(c){return null==Q(c)?n:180/Math.PI*Q(c)},r?function(c,p){p=p*Math.PI/180,void 0!==n&&p>n&&(p=n),void 0!==i&&p<i&&(p=i),r(c,p)}:null,"number",y||1,void 0,X)},p.prototype.addLabelAlign=function(c,p,Q,r,i){return this.addLabelComboBox(c,p,function(c){return Q(c)||"center"},r,Jp.consts.aligns,Jp.consts.alignLabels,void 0,i)},p.prototype.addLabelVAlign=function(c,p,Q,r,i){return this.addLabelComboBox(c,p,function(c){return Q(c)||"bottom"},r,Jp.consts.vAligns,Jp.consts.vAlignLabels,void 0,i)},p.prototype.addLabelStretch=function(c,p,Q,r,i){this.addLabelComboBox(c,p,function(c){return Q(c)||"fill"},r,Jp.consts.stretchs,Jp.consts.stretchLabels,void 0,i)},p.prototype.addOrientation=function(c,p,Q,r,i){return this.addLabelComboBox(c,p,function(c){return Q(c)||"top"},r,Jp.consts.orientations,Jp.consts.orientationLabels,void 0,i)},p.prototype.addLabelLabel=function(c,p,Q,r,i){this.addLabelInput(c,p,function(c){var p=Q(c);return p&&p.replace&&(p=p.replace(/\n/g,"\\n")),p},r?function(c,p){p&&p.replace&&(p=p.replace(/\\n/g,"\n")),r(c,p)}:null,void 0,void 0,void 0,i)},p.prototype.toDisplayName=function(c){var p="";return c.forEach(function(c){if(c)if(Ic(c))p+=c;else if(Ic(c.element))p+=c.element;else{if(!c.element)return;c.element.innerHTML&&(p+=c.element.innerHTML)}}),p},p.prototype.addLabel=function(c,p,Q,r,i,n){var y=this,X=void 0,W=!1,Z=Q&&r&&i,o=Jp.config.dataBindings;if(n&&o.onButtonClicked&&(!o.filter||o.filter(n.accessType,n.name,this))&&(W=!0),W||Z){X=vc(p,c.length?"right":"left"),c.push(X),X.style.cursor=Z?"ew-resize":"pointer";var l=function(c){c.preventDefault(),y.beginTransaction();var p=Z?y.getValue(Q)||0:0,X=t(c).x,o=!1,l=function(c){if(c.preventDefault(),Z){var Q=p+(t(c).x-X)*i;y.setValue(r,Q),o=!0}};window.addEventListener("mousemove",l,!1),window.addEventListener("touchmove",l,!1);var j=function(c){y.endTransaction(),c.preventDefault(),window.removeEventListener("mousemove",l,!1),window.removeEventListener("touchmove",l,!1),window.removeEventListener("mouseup",j,!1),window.removeEventListener("touchend",j,!1),W&&!o&&Jp.config.dataBindings.onButtonClicked(y.data,n.accessType,n.name,y.editor)};window.addEventListener("mouseup",j,!1),window.addEventListener("touchend",j,!1)};X.addEventListener("mousedown",l,!1),X.addEventListener("touchstart",l,!1)}else X={element:p,align:c.length?"right":"left"},c.push(X);return W&&this.updateHandlers.push(function(){if(y.data){var c=Jp.config.isDataBound(y.data,n.accessType,n.name);X.style.color=c?Jp.config.color_select:Jp.config.color_dark}}),X},p.prototype.createHandleChange=function(c,p,Q){var r=this;return function(){var i=c.value;if("pattern"===Q)if(i=i.trim()){if(i.indexOf("[")<0||i.indexOf("]")<0)return;if(i=i.replace("[","").replace("]","").split(","),i.length){for(var n=[],y=0;y<i.length;y++){var X=parseFloat(i[y]);if(isNaN(X))return;n.push(X)}i=n}else i=void 0}else i=void 0;else if("number"===Q){if(i=parseFloat(i),isNaN(i))return}else if("int"===Q){if(i=parseInt(i),isNaN(i))return}else i||(i=void 0);r.setValue(p,i)}},p.prototype.createArrayIndexColumn=function(c,p,r,n){var y=this,X=c[p],W="object"===n?U(X):X;return{name:p,width:50,align:"center",editable:!!r,sortable:!1,clickable:!1,getValueType:function(c){return n},getValue:function(c){return W},setValue:function(i,n,X,W){y.setValue(r,void 0,function(){var r=c.slice();return r[p]=Q(X),r})},isCellEditable:function(c,Q,r,W){if(!y.editor.editable)return!1;if("object"===n){var Z=i("editor.object")+" ["+p+"]";return y.editor.objectView.open(X,function(p){Q.setValue(c,Q,p,W)},Z),!1}return!0}}},p.prototype.addArray=function(c,p,Q,r){var n=this,y=new wQ;y.getTableHeader().setMovable(!1),y.getView().style.border=Jp.config.color_line+" solid 1px";var X=y.getTableView();return X.getDataModel().add(new ht.Data),this.updateHandlers.push(function(){if(!c.hidden){var W=n.getValue(p);if(X.getColumnModel().clear(),y.addColumns([{name:i("editor.length"),width:50,align:"center",editable:!!Q,sortable:!1,clickable:!1,valueType:"int",getValue:function(c){return W?W.length:0},setValue:function(c,p,i,y){n.setValue(Q,void 0,function(){if(i>=0){var c=Qp(W,i);return"number"===r||"int"===r?cp(c):"color"===r&&pp(c),c}})}}]),W){for(var Z=[],o=0;o<W.length;o++)Z.push(n.createArrayIndexColumn(W,o,Q,r));y.addColumns(Z)}}}),c.push(y),y},p.prototype.addTextArea=function(c,p,Q){var r=this,i=new ht.widget.TextArea,n=i.getElement();return Q?(n.onblur=function(){r.setValue(Q,n.value)},n.forceOnblur=n.onblur):i.setEditable(!1),this.updateHandlers.push(function(){if(!c.hidden){var Q=r.getValue(p);null==Q&&(Q=""),n.value!==Q&&(n.value=Q)}}),c.push(i),i},p.prototype.addInput=function(c,p,Q,i,n){var y=this,X=new ht.widget.TextField;"number"!==i&&"int"!==i||X.setType("number");var W=X.getElement();if(Q){var Z=this.createHandleChange(W,Q,i);X.handleChange=Z,n?(W.onkeyup=Z,W.onchange=Z):(W.onblur=Z,W.forceOnblur=W.onblur,W.onkeydown=function(c){I(c)&&Z()})}else X.setEditable(!1);return this.updateHandlers.push(function(){if(!c.hidden){var Q=y.getValue(p);"pattern"===i?Q=Q?"["+Q.join()+"]":"":"number"===i?Q=r(parseFloat(Q||0)):"int"===i?Q=parseInt(Q||0):null==Q&&(Q=""),W.value!==Q&&(Ic(Q)&&Q.length>1e3&&Q.startsWith("data:image")&&(Q=Q.substr(0,10)+"[...]"),W.value=Q)}}),c.push(X),X},p.prototype.addColor=function(c,p,Q){var r=this,i=new ht.widget.ColorPicker;return Q?(i.setInstant(!0),i.onValueChanged=function(){r.setValue(Q,i.getValue())},i.addViewListener(function(c){"open"===c.kind?r.beginTransaction():"close"===c.kind&&r.endTransaction()})):i.setDisabled(!0),this.updateHandlers.push(function(){if(!c.hidden){var Q=r.getValue(p);void 0===Q&&(Q=null),i.getValue()!=Q&&i.setValue(Q)}}),c.push(i),i},p.prototype.addImage=function(c,p,Q){var r=this,i=new ht.widget.Image;i.vectorDataBindingDisabled=!0,this.updateHandlers.push(function(){if(!c.hidden||c.forceToUpdate){var Q=r.getValue(p);i.rawIcon=Q,Q=ht.Default.getImage(Q),Q&&Q.snapshotURL?i.setIcon(Q.snapshotURL):i.setIcon(i.rawIcon)}});var n=i.getView();n.style.cursor="pointer";var y=function(c){c.preventDefault(),d(c)?r.editor.open(i.rawIcon):r.editor.selectFileNode(i.rawIcon)};return n.addEventListener("mousedown",y,!1),n.addEventListener("touchstart",y,!1),c.push(i),i},p.prototype.addCheckBox=function(c,p,Q){var r=this,i=new ht.widget.CheckBox;return Q?(i.handleClick=function(){r.editor.editable&&i.setSelected(!i.isSelected())},i.onValueChanged=function(){r.setValue(Q,i.getValue())}):i.setDisabled(!0),this.updateHandlers.push(function(){if(!c.hidden){var Q=!!r.getValue(p);i.getValue()!==Q&&i.setValue(Q)}}),c.push(i),i},p.prototype.addFunction=function(c,p,Q,r,n){var y=this,W=function(){var c=i("editor.function")+" "+(r||""),X=function(c){y.setValue(Q,c)};y.editor.functionView.open(y.getValue(p),X,c,n)},Z=r||i("editor.function"),o=gc(Z,null,null,W);return c.push(o),this.updateHandlers.push(function(){if(!c.hidden){var Q=y.getValue(p);o.setLabel(X(Q)),o.setLabelColor(Q?Jp.config.color_select:ht.Default.labelColor)}}),o},p.prototype.addObject=function(c,p,Q,r){var n=this,y=function(){var c=i("editor.object")+" "+(r||""),y=function(c){n.setValue(Q,c)};n.editor.objectView.open(n.getValue(p),y,c)},X=gc("",null,null,y);return c.push(X),this.updateHandlers.push(function(){if(!c.hidden){var Q=n.getValue(p);X.setLabel(U(Q)),X.setLabelColor(void 0!==Q?Jp.config.color_select:ht.Default.labelColor)}}),X},p.prototype.addComboBox=function(c,p,Q,r,i,n){var y=this,X=new ht.widget.ComboBox;return X.setValues(r),X.setLabels(i),X.setIcons(n),X.setDisabled(!Q),Q&&(X.onValueChanged=function(){y.setValue(Q,X.getValue())}),this.updateHandlers.push(function(){if(!c.hidden){var Q=y.getValue(p);X.getValue()!==Q&&X.setValue(Q)}}),n&&n[0].width&&X.setIndent(n[0].width+4),c.push(X),X},p.prototype.addButton=function(c,p,Q,r,i,n){var y=this,X=function(){y.global||n?i():y.eachSelection(i)},W=gc(p,Q,r,X);return c.push(W),W},p.prototype.addFuncRow=function(c,p,Q,r){var i=this,n=r?this.getRowHeight()*r:null,y=void 0;if(!Jp.config.dataBindingsForSymbol.filter||Jp.config.dataBindingsForSymbol.filter(Q||p,this)){var X=function(){i.dataModel&&i.editor.funcView.toggle(y,p,Q,i)},W=void 0;W=Jp.config.dataBindingsForSymbol.getToolTip?Jp.config.dataBindingsForSymbol.getToolTip(Q||p,this):(Q||p)+": { func: ... }",y=this.addButton(c,null,W,null,X,!0),this.updateHandlers.push(function(){if(!c.hidden){var Q=!1;i.global?i.dataModel&&(Q="clip"===p?ec(i.dataModel.a(p)):!!i.dataModel.a(p+"_func")):i.data&&(Q=!!i.data.a(p)),y.setIcon(Q?"editor.bind.state":"editor.unbind.state")}})}var Z=c.length,o=void 0;return 2===Z?o=this.addRow(c,[Jp.config.indent,.1],n):3===Z?o=this.addRow(c,[Jp.config.indent,.1,20],n):4===Z?o=this.addRow(c,[Jp.config.indent,.1,20,20],n):5===Z?o=this.addRow(c,[Jp.config.indent,.1,20,20,20],n):6===Z&&(o=this.addRow(c,[Jp.config.indent,.1,20,20,20,20],n)),o.keys={name:Q||p,displayName:this.toDisplayName(c)},!this.addingCustomProperties&&GQ[this.type][Q||p]&&this.removeRows([o]),o},p.prototype.addNameRow=function(c,p,Q,r,i){var n=r?this.getRowHeight()*r:null,y=c.length,X=void 0;return i?X=this.addRow(c,i,n):2===y?X=this.addRow(c,[Jp.config.indent,.1],n):3===y?X=this.addRow(c,[Jp.config.indent,.1,20],n):4===y?X=this.addRow(c,[Jp.config.indent,.1,20,20],n):5===y&&(X=this.addRow(c,[Jp.config.indent,.1,20,20,20],n)),X.keys={name:p,displayName:this.toDisplayName(c),accessType:Q},p=(Q?Q+":":"")+p,!this.addingCustomProperties&&GQ[this.type][p]&&this.removeRows([X]),X},p.prototype.$78$=function(){var c=this;(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&this.addTitle("TitleGridsGuides");var p=[];this.addLabelInput(p,i("editor.gridblocksize"),function(c){return c.a("gridBlockSize")},function(c,p){p>0&&c.a("gridBlockSize",p)},"int",1),this.addNameRow(p,"gridBlockSize","a"),p=[],this.addLabelInput(p,i("editor.gridthicklinesevery"),function(c){return c.a("gridThickLinesEvery")},function(c,p){p>0&&c.a("gridThickLinesEvery",p)},"int",1),this.addNameRow(p,"gridThickLinesEvery","a"),p=[],this.addLabelColor(p,i("editor.gridlightcolor"),function(c){return c.a("gridLightColor")},function(c,p){c.a("gridLightColor",p)}),this.addNameRow(p,"gridLightColor","a"),p=[],this.addLabelColor(p,i("editor.gridthickcolor"),function(c){return c.a("gridThickColor")},function(c,p){c.a("gridThickColor",p)}),this.addNameRow(p,"gridThickColor","a"),p=[],this.addLabelInput(p,i("editor.gridangle"),function(c){return 180/Math.PI*c.a("gridAngle")},function(c,p){c.a("gridAngle",p*Math.PI/180)},"number",1),this.addNameRow(p,"gridAngle","a"),p=[],this.addLabelInput(p,i("editor.gridrotation"),function(c){return 180/Math.PI*c.a("gridRotation")},function(c,p){c.a("gridRotation",p*Math.PI/180)},"number",1),this.addNameRow(p,"gridRotation","a"),p=[],this.addLabelInput(p,i("editor.gridzoomthreshold"),function(c){return c.a("gridZoomThreshold")},function(c,p){p>0&&c.a("gridZoomThreshold",p)},"number",.01),this.addNameRow(p,"gridZoomThreshold","a"),p=[null],this.addButton(p,i("editor.skewgrid"),null,null,function(){c.editor.currentView&&c.editor.currentView.skewGrid&&c.editor.currentView.skewGrid()}),this.addButton(p,i("editor.reset"),null,null,function(){c.editor.currentView&&c.editor.currentView.resetGrid&&c.editor.currentView.resetGrid()}),this.addRow(p,[Jp.config.indent,.1,.1],this.getRowHeight())},p.prototype.$27$=function(){var c=this;this.addTitle("TitleEditingPoint");var p={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3};this.editingPointButtons=[];var Q=function(Q,r){var n=i("editor.editingpoint."+r.toLowerCase()),y="editor.point."+r.toLowerCase(),X=gc(n,null,y,function(){c.editor.editInteractor.getSubModule("Curve").setCurrentSelectionStatus(X.statusValue)});X.setOrientation("v"),X.setTogglable(!0),X.setGroupId("editingPoint"),X.statusValue=p[r],c.editingPointButtons.push(X),Q.push(X)},r=[];Q(r,"Straight"),Q(r,"Mirrored"),this.addRow(r,[.1,.1],60),r=[],Q(r,"Disconnected"),Q(r,"Asymmetric"),this.addRow(r,[.1,.1],60)},p.prototype.addCustomProperties=function(){var c=this,p=Jp.config.customProperties[this.type];p&&p.length&&(this.addTitle("TitleCustom"),p.forEach(function(p){c.addCustomProperty(p)}))},p.prototype.fixAccessType=function(c){return c=c||"a","symbol"===this.type?c="a":"comp"===this.type&&(c="s"),c},p.prototype.addEventProperties=function(){var c=this,p=[],Q=function(){var p=c.global?c.dataModel:c.data;p&&(p=c.global?[c.dataModel]:c.dataModel.sm().getSelection().toArray()),c.editor.eventView.open(p,c.type)};this.addLabel(p,i("editor.events"));var r=this.addButton(p,i("editor.eventhandlers"),null,null,Q,!0);"data"===this.type?(this.addCheckBox(p,function(c){return!!c&&c.s("interactive")},function(c,p){c&&c.s("interactive",p)}),this.addRow(p,[Jp.config.indent,.1,20]).keys={name:"eventHandlers"}):this.addRow(p,[Jp.config.indent,.1]).keys={name:"eventHandlers"},this.updateHandlers.push(function(){if(!p.hidden){var Q=!1,i=c.global?c.dataModel:c.data;Cp.forEach(function(p){Q||(Q="data"===c.type?i.s(p):i.a(p))}),r.setLabelColor(Q?Jp.config.color_select:ht.Default.labelColor)}})},p.prototype.addCustomProperty=function(c){var p=c.name,Q=c.valueType,r=!1!==c.editable,n=c.defaultValue,y=this.fixAccessType(c.accessType),X=c.dataBinding,W=c.property;if(!(Q=Jp.config.valueTypes[Q]))return!1;this.addingCustomProperties=!0;var Z=[],j=i(p)||W,E=o(y,W),m=l(y,W),f=function(c){var p=E(c);return void 0===p&&(p=n),p},I=r?m:null,G=c.extraInfo,e=void 0,P=void 0,d=void 0;G&&G.enum&&(e=G.enum.values,P=G.enum.labels,d=G.enum.icons),G&&G.buildUI?G.buildUI(this,Z,j,f,I):e?this.addLabelComboBox(Z,j,f,I,e,P,d):"int"===Q.type||"number"===Q.type?Q.angle?this.addLabelRotation(Z,j,f,I,Q.min,Q.max,Q.step):this.addLabelRange(Z,j,f,I,Q.min,Q.max,Q.step,Q.type):"color"===Q.type?this.addLabelColor(Z,j,f,I):"boolean"===Q.type?this.addLabelCheckBox(Z,j,f,I):"enum"===Q.type?this.addLabelComboBox(Z,j,f,I,Q.values,Q.labels,Q.icons):"image"===Q.type?this.addLabelImage(Z,j,f,I):"url"===Q.type?this.addLabelURL(Z,j,f,I):"multiline"===Q.type?this.addLabelMultiline(Z,j,f,I):"colorArray"===Q.type?this.addLabelArray(Z,j,f,I,"color"):"numberArray"===Q.type?this.addLabelArray(Z,j,f,I,"number"):"stringArray"===Q.type?this.addLabelArray(Z,j,f,I,"string"):"objectArray"===Q.type?this.addLabelArray(Z,j,f,I,"object"):"function"===Q.type?this.addLabelFunction(Z,j,f,I,W):"object"===Q.type?this.addLabelObject(Z,j,f,I,W):"font"===Q.type?this.addLabelFont(Z,j,f,I):"custom"===Q.type?Q.buildUI(this,Z,j,f,I):this.addLabelInput(Z,j,f,I);var R=void 0;"display"!==this.type&&"scene"!==this.type&&X?"data"===this.type?R=this.addDBRow(Z,y,W,null,Q.rows):"symbol"!==this.type&&"comp"!==this.type||(R=this.addFuncRow(Z,W,null,Q.rows)):R=this.addNameRow(Z,y+":"+W,y,Q.rows),R&&G&&(R.visible=G.visible,R.onPropertyChanged=G.onPropertyChanged),this.addingCustomProperties=!1},p.prototype.addActionLabel=function(c,p,Q,r){this.addLabel(c,p,void 0,void 0,void 0,{accessType:Q,name:r})},p.prototype.addActionLabelInput=function(c,p,Q,r,i,n,y,X,W){this.addLabelInput(c,p,X||o(Q,r),W||l(Q,r),i,n,y,{accessType:Q,name:r})},p.prototype.addActionLabelCheckBox=function(c,p,Q,r,i,n){this.addLabelCheckBox(c,p,i||o(Q,r),n||l(Q,r),{accessType:Q,name:r})},p.prototype.addActionLabelColor=function(c,p,Q,r,i,n){this.addLabelColor(c,p,i||o(Q,r),n||l(Q,r),{accessType:Q,name:r})},p.prototype.addActionLabelImage=function(c,p,Q,r,i,n){this.addLabelImage(c,p,i||o(Q,r),n||l(Q,r),{accessType:Q,name:r})},p}(gp),gr=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r,"display",!0))}return Np(p,c),p.prototype.initForm=function(){this.addCustomProperties(),this.$12$(),this.$78$(),this.$79$()},p.prototype.isTitleVisible=function(p){return!!this.inspectorFilter.isDisplayTitleVisible(this.editor,p.title)&&c.prototype.isTitleVisible.call(this,p)},p.prototype.isPropertyVisible=function(p){return!!this.inspectorFilter.isDisplayPropertyVisible(this.editor,p.keys&&p.keys.name)&&c.prototype.isPropertyVisible.call(this,p)},p.prototype.$12$=function(){this.addTitle("TitleBasic");var c=[];this.addLabelInput(c,i("editor.previewurl"),function(c){return c.a("previewURL")},function(c,p){c.a("previewURL",p)}),this.addNameRow(c,"previewURL","a"),c=[],this.addLabelImage(c,i("editor.snapshoturl"),function(c){return c.a("snapshotURL")},function(c,p){c.a("snapshotURL",p)}),this.addNameRow(c,"snapshotURL","a"),c=[],this.addLabelColor(c,i("editor.background"),function(c){return c.getBackground()},function(c,p){c.setBackground(p)}),this.addNameRow(c,"background","p"),c=[],this.addLabelInput(c,i("editor.width"),function(c){return c.a("width")},function(c,p){c.a("width",p)},"number",1),this.addNameRow(c,"width","a"),c=[],this.addLabelInput(c,i("editor.height"),function(c){return c.a("height")},function(c,p){c.a("height",p)},"number",1),this.addNameRow(c,"height","a"),c=[],this.addLabelInput(c,i("editor.datacount"),function(c){return c.size()}),this.addNameRow(c,"count"),c=[];var p=["json","dm","gv"];this.addLabelFunction(c,i("editor.onpredeserialize"),function(c){return c.a("onPreDeserialize")},function(c,p){c.a("onPreDeserialize",p)},"onPreDeserialize",p),this.addNameRow(c,"onPreDeserialize","a"),c=[],p=["json","dm","gv","datas"],this.addLabelFunction(c,i("editor.onpostdeserialize"),function(c){return c.a("onPostDeserialize")},function(c,p){c.a("onPostDeserialize",p)},"onPostDeserialize",p),this.addNameRow(c,"onPostDeserialize","a"),c=[],this.addLabelComboBox(c,i("editor.connectactiontype"),function(c){return c.a("connectActionType")},function(c,p){c.a("connectActionType",p)},Jp.consts.displayConnectActionTypes,Jp.consts.displayConnectActionTypeLabels),this.addNameRow(c,"connectActionType","a"),c=[],this.addLabelCheckBox(c,i("editor.rotateasclock"),function(c){return c.a("rotateAsClock")},function(c,p){c.a("rotateAsClock",p)}),this.addNameRow(c,"rotateAsClock","a"),c=[],this.addLabelCheckBox(c,i("editor.hierarchicalrendering"),function(c){return c.isHierarchicalRendering()},function(c,p){c.setHierarchicalRendering(p)}),this.addNameRow(c,"hierarchicalRendering","p"),c=[],this.addLabelCheckBox(c,i("editor.zoomable"),function(c){return null==c.a("zoomable")||c.a("zoomable")},function(c,p){c.a("zoomable",p)}),this.addNameRow(c,"zoomable","a"),c=[],this.addLabelCheckBox(c,i("editor.pannable"),function(c){return null==c.a("pannable")||c.a("pannable")},function(c,p){c.a("pannable",p)}),this.addNameRow(c,"pannable","a"),c=[],this.addLabelCheckBox(c,i("editor.rectSelectable"),function(c){return null==c.a("rectSelectable")||c.a("rectSelectable")},function(c,p){c.a("rectSelectable",p)}),this.addNameRow(c,"rectSelectable","a"),c=[],this.addLabelCheckBox(c,i("editor.fitContent"),function(c){return null!=c.a("fitContent")&&c.a("fitContent")},function(c,p){c.a("fitContent",p)}),this.addNameRow(c,"fitContent","a")},p.prototype.$79$=function(){this.addTitle("TitleLayout");var c=[];this.$80$(c,"circular"),this.$80$(c,"symmetric"),this.$80$(c,"hierarchical"),this.$80$(c,"towardnorth"),this.$80$(c,"towardsouth"),this.$80$(c,"towardeast"),this.$80$(c,"towardwest"),this.addRow(c,[.1,.1,.1,.1,.1,.1,.1]).keys={name:"layouts"}},p.prototype.$80$=function(c,p){var Q=this,r=function(){Q.editor.editable&&Q.dataModel&&Q.dataModel.layout(p)};return this.addButton(c,null,i("editor.layout."+p),"editor.layout."+p+".state",r)},p}(vr),kr={visible:"Boolean",selectable:"Boolean",movable:"Boolean",editable:"Boolean",opacity:"Opacity",clipPercentage:"Percentage",clipDirection:"ClipDirection",shadow:"Boolean",shadowColor:"Color",shadowBlur:"PositiveNumber",shadowOffsetX:"PositiveNumber",shadowOffsetY:"PositiveNumber",type:"String",background:"Color",repeatImage:"String",borderWidth:"PositiveNumber",borderColor:"Color",border3d:"Boolean",border3dColor:"Color",border3dAccuracy:"PositiveNumber",borderCap:"CapStyle",
borderJoin:"JoinStyle",gradient:"Gradient",gradientColor:"Color",dash:"Boolean",dashOffset:"Number",dashColor:"Color",dashWidth:"PositiveNumber",dash3d:"Boolean",dash3dColor:"Color",dash3dAccuracy:"PositiveNumber",borderWidthAbsolute:"Boolean",fillClipPercentage:"Percentage",fillClipDirection:"ClipDirection",depth:"Number",cornerRadius:"PositiveNumber",polygonSide:"Int",arcFrom:"Number",arcTo:"Number",arcClose:"Boolean",arcOval:"Boolean",displayName:"String",scaleX:"Number",scaleY:"Number",anchorX:"Number",anchorY:"Number",rotation:"Number",color:"Color",width:"PositiveNumber",label:"Boolean",labelColor:"Color",labelFont:"String",minValue:"Number",maxValue:"Number",linePoint:"Boolean",lineWidth:"PositiveNumber",line3d:"Boolean",text:"String",align:"Align",vAlign:"VAlign",closePath:"Boolean",fillRule:"FillRule",name:"String",stretch:"Stretch",values:"NumberArray",colors:"ColorArray",hollow:"Boolean",layoutV:"String",layoutH:"String"},Jr=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r,"symbol",!0))}return Np(p,c),p.prototype.initForm=function(){this.addCustomProperties(),this.$12$(),this.addDataBindingProperties(),this.$78$()},p.prototype.isTitleVisible=function(p){return!!this.inspectorFilter.isSymbolTitleVisible(this.editor,p.title)&&c.prototype.isTitleVisible.call(this,p)},p.prototype.isPropertyVisible=function(p){return!!this.inspectorFilter.isSymbolPropertyVisible(this.editor,p.keys&&p.keys.name)&&c.prototype.isPropertyVisible.call(this,p)},p.prototype.$12$=function(){var c=this,p=void 0;this.addTitle("TitleBasic"),this.addEventProperties(),this.addHTMLProperties(),p=[],this.addLabelInput(p,i("editor.previewurl"),function(c){return c.a("previewURL")},function(c,p){c.a("previewURL",p)}),this.addRow(p,[Jp.config.indent,.1]).keys={name:"previewURL"},p=[],this.addLabelImage(p,i("editor.snapshoturl"),function(c){return c.a("snapshotURL")},function(c,p){c.a("snapshotURL",p)}),this.addRow(p,[Jp.config.indent,.1,20]).keys={name:"snapshotURL"},p=[],this.addLabelColor(p,i("editor.background"),function(c){return c.getBackground()},function(c,p){c.setBackground(p)}),this.addRow(p,[Jp.config.indent,.1]).keys={name:"background"},p=[],this.addLabelInput(p,i("editor.width"),function(c){return c.a("width")},function(c,p){c.a("width",p)},"number",1),this.addFuncRow(p,"width"),p=[],this.addLabelInput(p,i("editor.height"),function(c){return c.a("height")},function(c,p){c.a("height",p)},"number",1),this.addFuncRow(p,"height"),p=[],this.addLabelInput(p,i("editor.boundextend"),function(c){return c.a("boundExtend")},function(c,p){c.a("boundExtend",p)},"number",1),this.addFuncRow(p,"boundExtend"),p=[],this.addLabelComboBox(p,i("editor.connectactiontype"),function(c){return c.a("connectActionType")},function(c,p){c.a("connectActionType",p)},Jp.consts.symbolConnectActionTypes,Jp.consts.symbolConnectActionTypeLabels),this.addRow(p,[Jp.config.indent,.1]).keys={name:"connectActionType"},p=[],this.addLabelCheckBox(p,i("editor.rotateasclock"),function(c){return c.a("rotateAsClock")},function(c,p){c.a("rotateAsClock",p)}),this.addFuncRow(p,"rotateAsClock"),p=[],this.addLabelCheckBox(p,i("editor.fitsize"),function(c){return c.a("fitSize")},function(c,p){c.a("fitSize",p)}),this.addFuncRow(p,"fitSize"),p=[],this.addLabelCheckBox(p,i("editor.scrollable"),function(c){return c.a("scrollable")},function(c,p){c.a("scrollable",p)}),this.addFuncRow(p,"scrollable"),p=[],this.addLabelCheckBox(p,i("editor.interactive"),function(c){return c.a("interactive")},function(c,p){c.a("interactive",p)}),this.addFuncRow(p,"interactive"),p=[],this.addLabelCheckBox(p,i("editor.disableselectedborder"),function(c){return c.a("disableSelectedBorder")},function(c,p){c.a("disableSelectedBorder",p)}),this.addFuncRow(p,"disableSelectedBorder"),p=[],this.addLabelCheckBox(p,i("editor.pixelperfect"),function(c){return c.a("pixelPerfect")},function(c,p){c.a("pixelPerfect",p)}),this.addFuncRow(p,"pixelPerfect"),p=[],this.addLabelCheckBox(p,i("editor.visible"),function(c){return c.a("visible")},function(c,p){c.a("visible",p)}),this.addFuncRow(p,"visible"),p=[],this.addLabelCheckBox(p,i("editor.clip"),function(c){return c.a("clip")},function(c,p){c.a("clip",p)}).onValueChanged=function(p,Q){c.dataModel&&(Q?c.dataModel.a("clip")||c.dataModel.a("clip",!0):c.dataModel.a("clip",!1))},this.addFuncRow(p,"clip"),p=[],this.addLabelCheckBox(p,i("editor.cacherule"),function(c){return c.a("cacheRule")},function(c,p){c.a("cacheRule",p)}),this.addFuncRow(p,"cacheRule"),p=[],this.addLabelComboBox(p,i("editor.blendmode"),function(c){return c.a("blendMode")},function(c,p){c.a("blendMode",p)},["multiply","override","override_rgb","override_a"],[i("editor.blendmode.multiply"),i("editor.blendmode.override"),i("editor.blendmode.override_rgb"),i("editor.blendmode.override_a")]),this.addFuncRow(p,"blendMode"),this.addAttachPointsProperties(),this.addStateProperty(),p=[],this.addLabelInput(p,i("editor.compcount"),function(c){return c.size()}),this.addNameRow(p,"count")},p.prototype.addHTMLProperties=function(){var c=this,p=[],Q=function(){c.editor.functionView.open(c.dataModel.a("renderHTML"),function(p){c.dataModel.a("renderHTML",p)},i("editor.renderhtml"),["data","gv","cache"])};this.addLabel(p,i("editor.html"));var r=this.addButton(p,i("editor.renderhtml"),null,null,Q,!0);this.addRow(p,[Jp.config.indent,.1]).keys={name:"renderHTML"},this.updateHandlers.push(function(){if(!p.hidden){var Q=c.dataModel.a("renderHTML");r.setLabelColor(Q?Jp.config.color_select:ht.Default.labelColor)}})},p.prototype.addDataBindingProperties=function(){this.addTitle("TitleDataBinding"),this.$81$(),this.$82$()},p.prototype.$74$=function(c,p,Q,r){var i=this;return{name:c,tag:c,width:Q,displayName:p,align:"center",enum:r,editable:!0,getValue:function(p){return p.dataBinding[c]},setValue:function(p,Q,r,n){p.dataBinding[c]!==r&&i.modifyDataBindings(function(){p.dataBinding[c]=r})}}},p.prototype.$75$=function(){var c=this,p=this.tableView.getColumnModel().getDataByTag("defaultValue");p.getEnumValues=function(c){var p=c?Jp.config.valueTypes[c.dataBinding.valueType]:null;return p&&"enum"===p.type?p.values:null},p.getEnumLabels=function(c){var p=c?Jp.config.valueTypes[c.dataBinding.valueType]:null;return p&&"enum"===p.type?p.labels:null},p.getEnumIcons=function(c){var p=c?Jp.config.valueTypes[c.dataBinding.valueType]:null;return p&&"enum"===p.type?p.icons:null},p.getEnumDropDownWidth=function(c){var p=c?Jp.config.valueTypes[c.dataBinding.valueType]:null;return p&&"enum"===p.type?p.dropDownWidth:null},p.getValueType=function(c){var p=c?Jp.config.valueTypes[c.dataBinding.valueType]:null;return p?p.type:null},p.isCellEditable=function(p,Q,r,n){var y=Jp.config.valueTypes[p.dataBinding.valueType],X=y?y.type:null,W=p.dataBinding.extraInfo;if("function"===X){var Z=i("editor.function")+" "+(p.dataBinding.attr||"");return c.editor.functionView.open(p.dataBinding.defaultValue,function(Q){c.modifyDataBindings(function(){p.dataBinding.defaultValue=Q,c.tableView.redraw()})},Z,W&&W.arguments),!1}if("multiline"===X)return c.editor.textView.open(p.dataBinding.defaultValue,function(Q){c.modifyDataBindings(function(){p.dataBinding.defaultValue=Q,c.tableView.redraw()})},p.dataBinding.attr||"&nbsp;"),!1;if("font"===X)return c.editor.fontView.open(p.dataBinding.defaultValue,function(Q){c.modifyDataBindings(function(){p.dataBinding.defaultValue=Q,c.tableView.redraw()})},p.dataBinding.attr||"&nbsp;"),!1;if("object"===X||"stringArray"===X||"custom"===X||"objectArray"===X||"numberArray"===X||"colorArray"===X){var o=i("editor.object")+" "+(p.dataBinding.attr||"");return c.editor.objectView.open(p.dataBinding.defaultValue,function(Q){c.modifyDataBindings(function(){p.dataBinding.defaultValue=Q,c.tableView.redraw()})},o),!1}return!0}},p.prototype.initExtraInfoColumn=function(){var c=this;this.tableView.getColumnModel().getDataByTag("extraInfo").isCellEditable=function(p,Q,r,n){var y=i("editor.object")+" "+(p.dataBinding.attr||"");return c.editor.objectView.open(p.dataBinding.extraInfo,function(Q){c.modifyDataBindings(function(){p.dataBinding.extraInfo=Q,c.tableView.redraw()})},y),!1}},p.prototype.$81$=function(){var c=this,p=this.tableModel=new ht.DataModel,Q=this.tablePane=new wQ(p),r=this.tableView=Q.getTableView();r.setEditable(!0),r.isEditable=function(){return c.editor.editable},Q.getView().style.border=Jp.config.color_line+" solid 1px",Q.addColumns([this.$74$("attr","Attr",90),this.$74$("valueType",i("editor.valuetype"),80,{values:Jp.consts.valueTypes,labels:Jp.consts.valueTypeLabels}),this.$74$("defaultValue",i("editor.defaultvalue"),90),this.$74$("name",i("editor.name"),80),this.$74$("group",i("editor.group"),80),this.$74$("description",i("editor.description"),120),this.$74$("extraInfo",i("editor.extrainfo"),100)]),this.$75$(),this.initExtraInfoColumn();var y=[Q];this.addRow(y,[.1],"120+0.1");var X=null;this.updateHandlers.push(function(){if(!y.hidden&&c.dataModel&&(!X||c.dataModel.dataBindings!==X)){X=c.dataModel.dataBindings;var Q=p.sm().toSelection().toArray();p.clear(),c.dataModel.dataBindings&&c.dataModel.dataBindings.forEach(function(c){var r=new ht.Data;r.dataBinding=c,p.add(r);for(var i=0;i<Q.length;i++)if(Fc(Q[i].dataBinding,c)){n(Q,Q[i]),p.sm().as(r);break}})}})},p.prototype.modifyDataBindings=function(c){var p=Q(this.dataModel.dataBindings);c();var r=Q(this.dataModel.dataBindings);this.dataModel.dataBindings=r,this.dataModel.fp("f:dataBindings",p,r)},p.prototype.$83$=function(c,p,Q,r,i,n){var y=new ht.Data;y.dataBinding={attr:c||"",valueType:p||"String",defaultValue:Q,name:r,description:i,extraInfo:n};var X={symbolView:this.editor.symbolView,dataBinding:y.dataBinding};if(this.editor.fireEvent("dataBindingAdding",X),X.preventDefault)return!1;y.dataBinding=X.dataBinding,this.dataModel.dataBindings||(this.dataModel.dataBindings=[]);var W=this.tableModel.sm().ld();if(W){var Z=this.tableModel.getRoots().indexOf(W);this.dataModel.dataBindings.splice(Z+1,0,y.dataBinding)}else this.dataModel.dataBindings.push(y.dataBinding)},p.prototype.add=function(){var c=this;this.modifyDataBindings(function(){c.$83$()})},p.prototype.delete=function(){var c=this;this.tableView.sm().ld()&&this.modifyDataBindings(function(){c.tableView.sm().each(function(p){n(c.dataModel.dataBindings,p.dataBinding)})})},p.prototype.reorder=function(){var c=this;this.dataModel.dataBindings=[],this.tableModel.getRoots().each(function(p){c.dataModel.dataBindings.push(p.dataBinding)})},p.prototype.import=function(){var c=this;this.modifyDataBindings(function(){Jp.config.clearDataBindingsBeforeImporting&&(c.dataModel.dataBindings=[]);var p=c.editor.symbolView.content,Q={};p.dataBindings&&p.dataBindings.forEach(function(c){Q[c.attr]=!0}),p.comps.forEach(function(p){for(var r in p){var i=p[r];if(Gc(i))if(Ic(i.func)&&jQ.test(i.func)){var n=i.func.slice(5);if(!Q[n]){var y=void 0,X=void 0,W=void 0,Z=void 0;if(nc(p.type)){var o=ht.Default.getCompType(p.type);if(o){var l=o.properties[r];l?(y=l.valueType,X=l.name,W=l.description,Z=l.extraInfo):y=kr[r]}}else y=kr[r];c.$83$(n,y,void 0,X,W,Z),Q[n]=!0}}else{var j={};ip(i,j);for(var E in j)Q[E]||c.$83$(E,kr[j[E]])}}})})},p.prototype.$82$=function(){var c=this,p=Jp.config.importDataBindingsButtonVisible?{button:{icon:"editor.import",toolTip:i("editor.import"),onClicked:function(){c.editor.editable&&c.import()}}}:null;this.addRow([{button:{icon:"editor.add",toolTip:i("editor.add"),onClicked:function(){c.editor.editable&&c.add()}}},{button:{icon:"editor.delete",toolTip:i("editor.delete"),onClicked:function(){c.editor.editable&&c.delete()}}},p,null,{button:{icon:"editor.top",toolTip:i("editor.bringtofront"),onClicked:function(){c.editor.editable&&c.tableView.sm().size()&&c.modifyDataBindings(function(){c.tableModel.moveSelectionToTop(),c.reorder()})}}},{button:{icon:"editor.up",toolTip:i("editor.bringforward"),onClicked:function(){c.editor.editable&&c.tableView.sm().size()&&c.modifyDataBindings(function(){c.tableModel.moveSelectionUp(),c.reorder()})}}},{button:{icon:"editor.down",toolTip:i("editor.sendbackward"),onClicked:function(){c.editor.editable&&c.tableView.sm().size()&&c.modifyDataBindings(function(){c.tableModel.moveSelectionDown(),c.reorder()})}}},{button:{icon:"editor.bottom",toolTip:i("editor.sendtoback"),onClicked:function(){c.editor.editable&&c.tableView.sm().size()&&c.modifyDataBindings(function(){c.tableModel.moveSelectionToBottom(),c.reorder()})}}}],[20,20,20,.1,20,20,20,20])},p.prototype.addAttachPointsProperties=function(){var c=this,p=[],Q=function(){c.editor.attachPointsView.show(c.editor.symbolView.content)};this.addLabel(p,i("editor.attach.points"));var r=this.addButton(p,i("editor.attach.edit"),null,null,Q,!0);this.addFuncRow(p,"attachPoints"),this.updateHandlers.push(function(){if(!p.hidden){var Q=c.dataModel.a("attachPoints");r.setLabelColor(Q&&Q.length?Jp.config.color_select:ht.Default.labelColor)}}),p=[],this.addLabelComboBox(p,i("editor.attach.style"),function(c){return c.a("attachStyle")||"close"},function(c,p){c.a("attachStyle",p)},["close","strict"],[i("editor.attach.close"),i("editor.attach.strict")]),this.addFuncRow(p,"attachStyle")},p.prototype.addStateProperty=function(){var c=this,p=[];this.addLabel(p,i("editor.state"));var Q=new ht.widget.ComboBox;Q.onValueChanged=function(){c.editor.dm.a("state",Q.getValue())},this.updateHandlers.push(function(){if(!p.hidden){var r=c.editor.dm.a("state"),i=c.editor.dm.a("stateEnum");if(i&&i.length){var n=i.map(function(c){return c.value}),y=i.map(function(c){return c.label||c.value});n.unshift(void 0),y.unshift(""),Q.setValues(n),Q.setLabels(y),Q.getValue()!==r&&Q.setValue(r)}}}),p.push(Q),this.addFuncRow(p,"state")},p}(vr),Cr=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r,"data"))}return Np(p,c),p.prototype.initForm=function(){this.addCustomProperties(),this.$28$()},p.prototype.isTitleVisible=function(p){return!!this.inspectorFilter.isDataTitleVisible(this.editor,this.data,p.title)&&c.prototype.isTitleVisible.call(this,p)},p.prototype.isPropertyVisible=function(p){return!!this.inspectorFilter.isDataPropertyVisible(this.editor,this.data,p.keys&&p.keys.accessType,p.keys&&p.keys.name)&&c.prototype.isPropertyVisible.call(this,p)},p.prototype.addDBRow=function(c,p,Q,r,i,n){var y=this,X=i?this.getRowHeight()*i:null,W=c.length,Z=void 0;if(!Jp.config.dataBindings.onButtonClicked||Jp.config.dataBindings.filter&&!Jp.config.dataBindings.filter(p,Q,this))n?Z=this.addRow(c,n,X,r):2===W?Z=this.addRow(c,[Jp.config.indent,.1],X,r):3===W?Z=this.addRow(c,[Jp.config.indent,.1,20],X,r):4===W?Z=this.addRow(c,[Jp.config.indent,.1,20,20],X,r):5===W?Z=this.addRow(c,[Jp.config.indent,.1,20,20,20],X,r):1===W&&(Z=this.addRow(c,[.1],X,r));else{var o=function(){Jp.config.dataBindings.onButtonClicked(y.data,p,Q,y.editor)},l=void 0;l=Jp.config.dataBindings.getToolTip?Jp.config.dataBindings.getToolTip(p,Q,this):p+":"+Q;var j=this.addButton(c,null,l,null,o,!0);this.updateHandlers.push(function(){if(!c.hidden&&y.data){var r=Jp.config.isDataBound(y.data,p,Q);j.setIcon(r?"editor.bind.state":"editor.unbind.state")}}),n?(n=n.slice(),n.push(20),Z=this.addRow(c,n,X,r)):2===W?Z=this.addRow(c,[Jp.config.indent,.1,20],X,r):3===W?Z=this.addRow(c,[Jp.config.indent,.1,20,20],X,r):4===W?Z=this.addRow(c,[Jp.config.indent,.1,20,20,20],X,r):5===W?Z=this.addRow(c,[Jp.config.indent,.1,20,20,20,20],X,r):1===W&&(Z=this.addRow(c,[.1,20],X,r))}return Z.keys={name:Q,displayName:this.toDisplayName(c),accessType:p},!this.addingCustomProperties&&GQ[this.type][p+":"+Q]&&this.removeRows([Z]),Z},p.prototype.addDBInput=function(c,p,Q,r,i){var n=[];return this.addLabelInput(n,p,o(c,Q),l(c,Q),r,i),this.addDBRow(n,c,Q)},p.prototype.addDBLabel=function(c,p,Q){var r=[];return this.addLabelLabel(r,p,o(c,Q),l(c,Q)),this.addDBRow(r,c,Q)},p.prototype.addDBCheckBox=function(c,p,Q){var r=[];return this.addLabelCheckBox(r,p,o(c,Q),l(c,Q)),this.addDBRow(r,c,Q)},p.prototype.addDBImage=function(c,p,Q){var r=[];return this.addLabelImage(r,p,o(c,Q),l(c,Q)),this.addDBRow(r,c,Q)},p.prototype.addDBColor=function(c,p,Q){var r=[];return this.addLabelColor(r,p,o(c,Q),l(c,Q)),this.addDBRow(r,c,Q)},p.prototype.addDBFont=function(c,p,Q){var r=[];return this.addLabelFont(r,p,o(c,Q),l(c,Q)),this.addDBRow(r,c,Q)},p.prototype.addDBPattern=function(c,p,Q){var r=[];return this.addLabelInput(r,p,o(c,Q),l(c,Q),"pattern"),this.addDBRow(r,c,Q)},p.prototype.addDBRotation=function(c,p,Q){var r=[];return this.addLabelRotation(r,p,o(c,Q),l(c,Q)),this.addDBRow(r,c,Q)},p.prototype.addDBAlign=function(c,p,Q){var r=[];return this.addLabelAlign(r,p,o(c,Q),l(c,Q)),this.addDBRow(r,c,Q)},p.prototype.addDBVAlign=function(c,p,Q){var r=[];return this.addLabelVAlign(r,p,o(c,Q),l(c,Q)),this.addDBRow(r,c,Q)},p.prototype.addDBOrientation=function(c,p,Q){var r=[];return this.addOrientation(r,p,o(c,Q),l(c,Q)),this.addDBRow(r,c,Q)},p.prototype.addDBComboBox=function(c,p,Q,r,i,n){var y=[];return this.addLabelComboBox(y,p,o(c,Q),l(c,Q),r,i,n),this.addDBRow(y,c,Q)},p.prototype.addDBStretch=function(c,p,Q){var r=[];return this.addLabelStretch(r,p,o(c,Q),l(c,Q)),this.addDBRow(r,c,Q)},p.prototype.addDBZeroToOne=function(c,p,Q){var r=[];return this.addLabelRange(r,p,o(c,Q),l(c,Q),0,1,.01,"number"),this.addDBRow(r,c,Q)},p.prototype.addDBPosition=function(c,p,Q){var r=[];return this.addLabelRange(r,p,o(c,Q),l(c,Q),1,55,1,"int"),this.addDBRow(r,c,Q)},p.prototype.addDBRange=function(c,p,Q,r,i,n,y){var X=[];return this.addLabelRange(X,p,o(c,Q),l(c,Q),r,i,n,y),this.addDBRow(X,c,Q)},p.prototype.addDBGradient=function(c,p,Q,r){var i=[];return this.addLabelGradient(i,c,p,Q,r),this.addDBRow(i,"s",p)},p.prototype.addDBBodyColorProperty=function(){this.addDBColor("s",i("editor.bodycolor"),"body.color")},p.prototype.addDBOpacityProperty=function(){this.addDBZeroToOne("s",i("editor.opacity"),"opacity")},p.prototype.$84$=function(){var c=this,p=[];this.addLabel(p,i("editor.icons"));var Q=function(){c.data&&c.editor.iconsView.toggle(r,c.data)},r=this.addButton(p,"Icons","s:icons",null,Q,!0);return this.updateHandlers.push(function(){p.hidden||r.setLabelColor(c.data.s("icons")?Jp.config.color_select:ht.Default.labelColor)}),this.addDBRow(p,"s","icons")},p.prototype.addDBData=function(c,p,Q,r){var i=this;r=r||l(c,Q);var n=o(c,Q),y=[],X=this.addLabelInput(y,p,function(c){var p=n(c);return p?p.toLabel()||p.getClassName():""}),W=X.getElement();X.isDroppable=function(c,p){return p.view.draggingData&&i.dataModel===p.view.draggingData.getDataModel()},X.handleCrossDrag=function(c,p,Q){"enter"===p?W.style.border="solid "+Jp.config.color_select_dark+" 2px":"exit"===p||"cancel"===p?W.style.border="":"over"===p||"drop"===p&&(W.style.border="",i.setValue(r,Q.view.draggingData),X.setFocus())},W.onkeydown=function(c){e(c)&&i.setValue(r,null)};var Z=new ht.widget.Image;return Z.drawImage=function(c,p,Q,r,n,y){var X=Z.data,W=i.editor.list;X&&W&&W.dm().contains(X)&&(p=W.getIcon(X))&&A(c,ht.Default.getImage(p),"centerUniform",Q,r,n,y,X,W)},this.updateHandlers.push(function(){if(!y.hidden){var c=Z.data;Z.data=i.getValue(n),Z.fp("data",c,Z.data)}}),y.push(Z),this.addDBRow(y,c,Q)},p.prototype.addDBMultiline=function(c,p,Q){var r=[];return this.addLabelMultiline(r,p,o(c,Q),l(c,Q)),this.addDBRow(r,c,Q)},p.prototype.$28$=function(){this.addTitle("TitleBasic"),this.addEventProperties();var c=[];this.addLabelInput(c,i("editor.class"),function(c){return c.getClassName()}),this.addRow(c,[Jp.config.indent,.1]).keys={accessType:"p",name:"className"},this.addDBInput("p",i("editor.name"),"displayName"),this.addDBInput("p",i("editor.tag"),"tag"),this.addDBImage("p",i("editor.icon"),"icon"),this.addDBData("p",i("editor.parent"),"parent")},p.prototype.$30$=function(){this.addTitle("TitleLabel"),this.addDBMultiline("s",i("editor.content"),"label"),this.addDBFont("s",i("editor.font"),"label.font"),this.addDBColor("s",i("editor.color"),"label.color"),this.addDBColor("s",i("editor.background"),"label.background"),this.addDBPosition("s",i("editor.position"),"label.position"),this.addDBInput("s",i("editor.offsetx"),"label.offset.x","number",1),this.addDBInput("s",i("editor.offsety"),"label.offset.y","number",1),this.addDBInput("s",i("editor.maxlength"),"label.max","number",1),this.addDBRotation("s",i("editor.rotation"),"label.rotation"),this.addDBZeroToOne("s",i("editor.opacity"),"label.opacity"),this.addDBRange("s",i("editor.scale"),"label.scale",.01,100,.1,"number"),this.addDBAlign("s",i("editor.align"),"label.align"),this.addDBCheckBox("s",i("editor.fixed"),"label.position.fixed")},p.prototype.$31$=function(){this.addTitle("TitleNote"),this.addDBMultiline("s",i("editor.content"),"note"),this.addDBFont("s",i("editor.font"),"note.font"),this.addDBColor("s",i("editor.color"),"note.color"),this.addDBColor("s",i("editor.background"),"note.background"),this.addDBInput("s",i("editor.borderwidth"),"note.border.width","number",1),this.addDBColor("s",i("editor.bordercolor"),"note.border.color"),this.addDBPosition("s",i("editor.position"),"note.position"),this.addDBInput("s",i("editor.offsetx"),"note.offset.x","number",1),this.addDBInput("s",i("editor.offsety"),"note.offset.y","number",1),this.addDBZeroToOne("s",i("editor.opacity"),"note.opacity"),this.addDBRange("s",i("editor.scale"),"note.scale",.01,100,.1,"number"),this.addDBInput("s",i("editor.maxlength"),"note.max","number",1),this.addDBAlign("s",i("editor.align"),"note.align"),this.addDBCheckBox("s",i("editor.toggleable"),"note.toggleable"),this.addDBCheckBox("s",i("editor.expanded"),"note.expanded")},p.prototype.addDBLayer=function(){var c=this,p=[],Q=o("p","layer"),r=l("p","layer");this.addLabel(p,i("editor.layer"),Q,r);var n=new ht.widget.ComboBox;n.onValueChanged=function(){c.setValue(r,n.getValue())},this.updateHandlers.push(function(){if(!p.hidden){n.setValues(c.editor.layerPane.layerNames);var r=c.getValue(Q);n.getValue()!==r&&n.setValue(r)}}),p.push(n);var y=this.addDBRow(p,"p","layer");return y.items.tag="layer",y},p.prototype.addDBGray=function(){this.addDBCheckBox("s",i("editor.gray"),"2d.gray")},p}(vr),ci={TitleShapeBackground:!0,TitleShapeBorder:!0,TitleShapeDash:!0},pi=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.initForm=function(){this.addCustomProperties(),this.$28$(),this.$92$(),this.addLayoutProperties(),this.$23$(),this.$29$(),this.$30$(),this.$31$(),this.$26$()},p.prototype.$28$=function(){c.prototype.$28$.call(this),this.addDBGray(),this.addDBLayer(),this.addDBInput("p",i("editor.tooltip"),"toolTip"),this.addDBBodyColorProperty(),this.addDBOpacityProperty(),this.$84$(),this.addState()},p.prototype.addState=function(){var c=this,p=[],Q=new ht.widget.ComboBox,r=function(c){var p=c.s("state");if(p)return p;if(c.getImage){var Q=ht.Default.getImage(c.getImage());return Q?Q.state:void 0}},n=l("s","state");this.addLabel(p,i("editor.state")),Q.onValueChanged=function(){c.setValue(n,Q.getValue())},this.updateHandlers.push(function(){if(!p.hidden){var i=c.getStateEnum();if(i&&0!==!i){var n=c.getValue(r),y=i.map(function(c){return c.value}),X=i.map(function(c){return c.label||c.value});y.unshift(void 0),X.unshift(""),Q.setValues(y),Q.setLabels(X),Q.getValue()!==n&&"object"!=typeof n&&Q.setValue(n)}}}),p.push(Q);var y=this.addDBRow(p,"s","state");return y.visible=function(){var p=c.getStateEnum();return p&&p.length},y},p.prototype.getStateEnum=function(){var c=ht.Default.getImage(this.data.getImage());return c?c.stateEnum:null},p.prototype.$92$=function(){var c=this;this.addDBStretch("s",i("editor.stretch"),"image.stretch").items.tag="imageRelative",this.addDBComboBox("s",i("editor.shape"),"shape",Jp.consts.shapes,Jp.consts.shapeLabels,Jp.consts.shapeIcons);var p=[];p.forceToUpdate=!0,this.addLabelImage(p,i("editor.image"),function(p){var Q=p.getImage(),r=ht.Default.getImage(Q);return c.$86$(Gc(r)?r.dataBindings:null,r),Q},function(c,p){c.setImage&&(Ic(p)&&p.endsWith("[...]")||c.setImage(p))}),this.addButton(p,null,i("editor.resetsize"),"editor.resetsize.state",function(c){c instanceof ht.Node&&c.setSize(-1,-1)}),this.imageRow=this.addDBRow(p,"p","image"),this.imageRow.items.tag="imageRelative"},p.prototype.addLayoutProperties=function(){var c=this;this.addTitle("TitleNodeLayout");var p=this.layoutGv=new ht.graph.GraphView,Q=this.layoutNode=new ht.Node,r=!1;Q.setImage("editor.layout.helper"),Q.a("selectColor",Jp.config.color_select),p.dm().add(Q),p.tx(50),p.ty(50),p.handleScroll=function(){},p.handlePinck=function(){},p.setScrollBarVisible(!1),p.setRectSelectable(!1),p.setPannable(!1),p.setMovableFunc(function(){return!1}),p.dm().md(function(p){r||(c.beginTransaction(),c.dataModel.sm().getSelection().each(function(c){"a:layout.v"===p.property?c.s("layout.v",p.newValue):"a:layout.h"===p.property&&c.s("layout.h",p.newValue)}),c.endTransaction())}),this.addRow(["",{element:p},""],[.1,100,.1],100),this.addUpdateHandler(function(){var p=c.data;r=!0,Q.a({"layout.v":p.s("layout.v"),"layout.h":p.s("layout.h")}),r=!1}),this.addDBComboBox("s",i("editor.nodeLayout.h"),"layout.h",Jp.consts.hLayoutValues,Jp.consts.hLayoutLabels),this.addDBComboBox("s",i("editor.nodeLayout.v"),"layout.v",Jp.consts.vLayoutValues,Jp.consts.vLayoutLabels)},p.prototype.$23$=function(){this.addTitle("TitleNode"),this.addDBInput("p",i("editor.posx"),"x","number",1),this.addDBInput("p",i("editor.posy"),"y","number",1),this.addDBInput("p",i("editor.width"),"width","number",1),this.addDBInput("p",i("editor.height"),"height","number",1),this.addDBRotation("p",i("editor.rotation"),"rotation");var c=[];this.addLabelInput(c,i("editor.scalex"),o("p","scaleX"),l("p","scaleX"),"number",.01),this.addButton(c,null,i("editor.flipx"),"editor.flipx",function(c){c instanceof ht.Node&&c.setScaleX(-c.getScaleX())}),this.addDBRow(c,"p","scaleX"),c=[],this.addLabelInput(c,i("editor.scaley"),o("p","scaleY"),l("p","scaleY"),"number",.01),this.addButton(c,null,i("editor.flipy"),"editor.flipy",function(c){c instanceof ht.Node&&c.setScaleY(-c.getScaleY())}),this.addDBRow(c,"p","scaleY"),c=[],this.addLabelInput(c,i("editor.anchorx"),function(c){return c.getAnchor().x},function(c,p){c instanceof ht.Node&&c.setAnchor(p,c.getAnchor().y,!0)},"number",.01),this.addDBRow(c,"p","anchorX"),c=[],this.addLabelInput(c,i("editor.anchory"),function(c){return c.getAnchor().y},function(c,p){c instanceof ht.Node&&c.setAnchor(c.getAnchor().x,p,!0)},"number",.01),this.addDBRow(c,"p","anchorY"),this.$85$(),this.addDBData("p",i("editor.host"),"host",function(c,p){c instanceof ht.Node&&(null==p||p instanceof ht.Node)&&c.setHost(p)}),this.addDBComboBox("s",i("editor.fullscreen"),"fullscreen",Jp.consts.fullscreenValues,Jp.consts.fullscreenLabels);var p=this.addDBComboBox("s",i("editor.fullscreen.lock"),"fullscreen.lock",Jp.consts.fullscreenLockValues,Jp.consts.fullscreenLockLabels);p.items.tag="fullscreen",p=this.addDBInput("s",i("editor.fullscreen.gap"),"fullscreen.gap","number",1),p.items.tag="fullscreen",this.addDBComboBox("s",i("editor.movemode"),"2d.move.mode",[void 0,"x","y"],["",i("editor.horizontal"),i("editor.vertical")]),this.addDBCheckBox("s",i("editor.ingroup"),"ingroup"),this.addDBCheckBox("s",i("editor.visible"),"2d.visible"),this.addDBCheckBox("s",i("editor.selectable"),"2d.selectable"),this.addDBCheckBox("s",i("editor.movable"),"2d.movable"),this.addDBCheckBox("s",i("editor.editable"),"2d.editable"),this.addDBCheckBox("s",i("editor.pixelperfect"),"pixelPerfect")},p.prototype.$85$=function(){this.addDBZeroToOne("s",i("editor.clippercentage"),"clip.percentage"),this.addDBComboBox("s",i("editor.clipdirection"),"clip.direction",Jp.consts.clipDirections,Jp.consts.clipDirectionLabels)},p.prototype.$29$=function(){this.$25$(),this.addShapeForegroundProperties(),this.$33$(),this.addShapeDashProperties()},p.prototype.$25$=function(){this.addTitle("TitleShapeBackground"),this.addDBColor("s",i("editor.background"),"shape.background"),this.addDBGradient(i("editor.gradient"),"shape.gradient","shape.background","shape.gradient.color"),this.addDBColor("s",i("editor.gradientcolor"),"shape.gradient.color"),this.addDBImage("s",i("editor.repeatimage"),"shape.repeat.image"),this.addDBZeroToOne("s",i("editor.clippercentage"),"shape.fill.clip.percentage"),this.addDBComboBox("s",i("editor.clipdirection"),"shape.fill.clip.direction",Jp.consts.clipDirections,Jp.consts.clipDirectionLabels)},p.prototype.addShapeForegroundProperties=function(){this.addTitle("TitleShapeForeground"),this.addDBColor("s",i("editor.foreground"),"shape.foreground"),this.addDBGradient(i("editor.gradient"),"shape.foreground.gradient","shape.foreground","shape.foreground.gradient.color"),this.addDBColor("s",i("editor.gradientcolor"),"shape.foreground.gradient.color"),this.addDBZeroToOne("s",i("editor.clippercentage"),"shape.foreground.clip.percentage"),this.addDBComboBox("s",i("editor.clipdirection"),"shape.foreground.clip.direction",Jp.consts.clipDirections,Jp.consts.clipDirectionLabels)},p.prototype.$33$=function(){this.addTitle("TitleShapeBorder"),this.addDBInput("s",i("editor.width"),"shape.border.width","number",1),this.addDBCheckBox("s",i("editor.widthabsolute"),"shape.border.width.absolute"),this.addDBPattern("s",i("editor.pattern"),"shape.border.pattern"),this.addDBColor("s",i("editor.color"),"shape.border.color"),this.addDBCheckBox("s",i("editor.threed"),"shape.border.3d"),this.addDBColor("s",i("editor.threedcolor"),"shape.border.3d.color"),this.addDBComboBox("s",i("editor.join"),"shape.border.join",Jp.consts.joins,Jp.consts.joinLabels),this.addDBComboBox("s",i("editor.cap"),"shape.border.cap",Jp.consts.caps,Jp.consts.capLabels),this.$24$()},p.prototype.$24$=function(){this.addDBInput("s",i("editor.depth"),"shape.depth","int",1).items.tag="shapeDepth",this.addDBInput("s",i("editor.sides"),"shape.polygon.side","int",1).items.tag="shapeSide",this.addDBInput("s",i("editor.radius"),"shape.corner.radius","number",1).items.tag="shapeRadius",this.addDBCheckBox("s",i("editor.arcoval"),"shape.arc.oval").items.tag="shapeArc",this.addDBCheckBox("s",i("editor.closed"),"shape.arc.close").items.tag="shapeArc",this.addDBRotation("s",i("editor.arcfrom"),"shape.arc.from").items.tag="shapeArc",this.addDBRotation("s",i("editor.arcto"),"shape.arc.to").items.tag="shapeArc"},p.prototype.addShapeDashProperties=function(){this.addTitle("TitleShapeDash"),this.addDBPattern("s",i("editor.pattern"),"shape.dash.pattern"),this.addDBCheckBox("s",i("editor.dash"),"shape.dash"),this.addDBColor("s",i("editor.color"),"shape.dash.color"),this.addDBInput("s",i("editor.offset"),"shape.dash.offset","number",1),this.addDBInput("s",i("editor.width"),"shape.dash.width","number",1),this.addDBCheckBox("s",i("editor.threed"),"shape.dash.3d"),this.addDBColor("s",i("editor.threedcolor"),"shape.dash.3d.color")},p.prototype.$35$=function(p){if(p){if("s:shape"===p.property||"host"===p.property||"s:fullscreen"===p.property)return void this.filterPropertiesLater();if("s:select.type"===p.property&&("shadow"===p.oldValue||"shadow"===p.newValue))return void this.filterPropertiesLater()}c.prototype.$35$.call(this,p)},p.prototype.isTitleVisible=function(p){if(this.data){if(!(this.data instanceof ht.Shape)&&!this.data.s("shape")&&ci[p.title])return!1;if("TitleNodeLayout"===p.title&&!this.data.getHost())return!1}return c.prototype.isTitleVisible.call(this,p)},p.prototype.isPropertyVisible=function(p){if(this.data){var Q=p.items.tag;if(Q)if("selectShadow"===Q){if("shadow"!==this.data.s("select.type"))return!1}else if("shapeDepth"===Q){if("rect"!==this.data.s("shape"))return!1}else if("shapeSide"===Q){if("polygon"!==this.data.s("shape"))return!1}else if("shapeRadius"===Q){if("roundRect"!==this.data.s("shape"))return!1}else if("shapeArc"===Q){if("arc"!==this.data.s("shape"))return!1}else if("imageRelative"===Q){if(this.data.s("shape"))return!1}else if("layer"===Q){if(!this.editor.layerPane.layerNames.length)return!1}else if("fullscreen"===Q&&!this.data.s("fullscreen"))return!1}return c.prototype.isPropertyVisible.call(this,p)},p.prototype.$86$=function(c,p){var Q=this;this.dataBindings!==c&&(this.$46$=c,this.pendingImage=p,
this._updateDataBindingsLater||(this._updateDataBindingsLater=!0,requestAnimationFrame(function(){Q.$87$()})))},p.prototype.$87$=function(){var c=this;if(this._updateDataBindingsLater=!1,this.dataBindings===this.$46$)return this.$46$=null,void(this.pendingImage=null);if(this._rows=this.$47$,this.removeRows(this.$45$),this.dataBindingHandlers&&this.dataBindingHandlers.length&&this.dataBindingHandlers.forEach(this.removeUpdateHandler,this),this.$45$=[],this.dataBindingHandlers=[],this.dataBindings=this.$46$,this.dataBindings){var p=this.updateHandlers.length,Q={},r={},i={};this.pendingImage.comps.forEach(function(c){if(nc(c.type)){var p=ht.Default.getCompType(c.type);if(p)for(var n in p.properties)Q[n]=p.properties[n].defaultValue}ip(c,r,i)});for(var n in r)void 0===i[n]&&(i[n]=Q[r[n]]);var y=void 0,X=this._rows.indexOf(this.imageRow)+1;this.dataBindings.forEach(function(p){if(p.group&&y!==p.group){y=p.group;var Q=c.addTitle(y,{index:X});Q.items.tag="imageRelative",c.$45$.push(Q),X++}c.$88$(p,X,i)&&X++}),this.dataBindingHandlers=this.updateHandlers.slice(p)}this.$47$=this._rows,this.filterProperties()},p.prototype.$88$=function(c,p,Q){var r=[],n=c.attr,y=Jp.config.valueTypes[c.valueType];if(!y)return this.editor.fireEvent("error",{message:"Wrong value type:"+c.valueType}),!1;var X=i(c.name)||n,W=function(c){var p=c.a(n);return void 0===p&&(p=Q[n]),p},Z=function(c,p){c.a(n,p)},o=c.extraInfo,l=void 0,j=void 0,E=void 0;o&&o.enum&&(l=o.enum.values,j=o.enum.labels,E=o.enum.icons),o&&o.buildUI?o.buildUI(this,r,X,W,Z):l?this.addLabelComboBox(r,X,W,Z,l,j,E):"int"===y.type||"number"===y.type?y.angle?this.addLabelRotation(r,X,W,Z,y.min,y.max,y.step):this.addLabelRange(r,X,W,Z,y.min,y.max,y.step,y.type):"color"===y.type?this.addLabelColor(r,X,W,Z):"boolean"===y.type?this.addLabelCheckBox(r,X,W,Z):"enum"===y.type?this.addLabelComboBox(r,X,W,Z,y.values,y.labels,y.icons):"multiline"===y.type?this.addLabelMultiline(r,X,W,Z):"font"===y.type?this.addLabelFont(r,X,W,Z):"image"===y.type?this.addLabelImage(r,X,W,Z):"url"===y.type?this.addLabelURL(r,X,W,Z):"colorArray"===y.type?this.addLabelArray(r,X,W,Z,"color"):"numberArray"===y.type?this.addLabelArray(r,X,W,Z,"number"):"stringArray"===y.type?this.addLabelArray(r,X,W,Z,"string"):"objectArray"===y.type?this.addLabelArray(r,X,W,Z,"object"):"function"===y.type?this.addLabelFunction(r,X,W,Z,n,o&&o.arguments):"object"===y.type?this.addLabelObject(r,X,W,Z,n):"custom"===y.type?y.buildUI(this,r,X,W,Z):this.addLabelInput(r,X,W,Z);var m=this.addDBRow(r,"a",n,{index:p},y.rows);return o&&(m.visible=o.visible,m.onPropertyChanged=o.onPropertyChanged),this.$45$.push(m),r.tag="imageRelative",!0},p.prototype.$26$=function(){this.addTitle("TitleSelect"),this.addDBColor("s",i("editor.color"),"select.color"),this.addDBInput("s",i("editor.width"),"select.width","number",1),this.addDBInput("s",i("editor.padding"),"select.padding","number",1),this.addDBComboBox("s",i("editor.selecttype"),"select.type",Jp.consts.selectTypes,Jp.consts.selectTypeLabels,Jp.consts.selectTypeIcons),this.addDBInput("s",i("editor.shadowblur"),"shadow.blur","number",1).items.tag="selectShadow",this.addDBInput("s",i("editor.shadowoffsetx"),"shadow.offset.x","number",1).items.tag="selectShadow",this.addDBInput("s",i("editor.shadowoffsety"),"shadow.offset.y","number",1).items.tag="selectShadow"},p}(Cr),Qi={"h.v":!0,"v.h":!0,ortho:!0,flex:!0,"extend.east":!0,"extend.west":!0,"extend.north":!0,"extend.south":!0,ortho2:!0,flex2:!0,"extend.north2":!0,"extend.south2":!0,"extend.west2":!0,"extend.east2":!0,"v.h2":!0,"h.v2":!0},ri={"extend.east":!0,"extend.west":!0,"extend.north":!0,"extend.south":!0,"extend.north2":!0,"extend.south2":!0,"extend.west2":!0,"extend.east2":!0},ii=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.initForm=function(){this.$27$(),c.prototype.initForm.call(this),this.addDBGray(),this.$89$(),this.$90$(),this.$91$(),this.$30$(),this.$31$(),this.$26$()},p.prototype.isTitleVisible=function(p){return!("TitleEditingPoint"===p.title&&!this.editor.pointsEditingMode)&&c.prototype.isTitleVisible.call(this,p)},p.prototype.$35$=function(p){if(p&&("s:edge.type"===p.property||"source"===p.property||"target"===p.property))return void this.filterPropertiesLater();c.prototype.$35$.call(this,p)},p.prototype.isPropertyVisible=function(p){if(this.data){var Q=p.items.tag;if(Q){var r=this.data.s("edge.type");if("edgeRipple"===Q){if("ripple"!==r)return!1}else if("edgeRadius"===Q){if(!Qi[r])return!1}else if("edgeOrtho"===Q){if("ortho"!==r&&"ortho2"!==r)return!1}else if("edgeFlex"===Q){if("flex"!==r&&"flex2"!==r)return!1}else if("edgeExtend"===Q){if(!ri[r])return!1}else if("layer"===Q){if(!this.editor.layerPane.layerNames.length)return!1}else{if("edgeSourceIsEdge"===Q)return this.data.getSource()instanceof ht.Edge;if("edgeTargetIsEdge"===Q)return this.data.getTarget()instanceof ht.Edge;if("edgeSourceIsNode"===Q)return this.data.getSource()instanceof ht.Node;if("edgeTargetIsNode"===Q)return this.data.getTarget()instanceof ht.Node}}}return c.prototype.isPropertyVisible.call(this,p)},p.prototype.$28$=function(){c.prototype.$28$.call(this),this.addDBLayer(),this.addDBInput("p",i("editor.tooltip"),"toolTip"),this.addDBOpacityProperty(),this.$84$()},p.prototype.$26$=function(){this.addTitle("TitleSelect"),this.addDBColor("s",i("editor.color"),"select.color"),this.addDBInput("s",i("editor.width"),"select.width","number",1);var c=[];this.addLabelCheckBox(c,i("editor.shadow"),function(c){return"shadow"===c.s("select.type")},function(c,p){c.s("select.type",p?"shadow":null)}),this.addDBRow(c,"s","select.type"),this.addDBInput("s",i("editor.shadowblur"),"shadow.blur","number",1),this.addDBInput("s",i("editor.shadowoffsetx"),"shadow.offset.x","number",1),this.addDBInput("s",i("editor.shadowoffsety"),"shadow.offset.y","number",1)},p.prototype.$89$=function(){this.addTitle("TitleEdgeBasic"),this.addDBInput("s",i("editor.width"),"edge.width","number",1),this.addDBCheckBox("s",i("editor.widthabsolute"),"edge.width.absolute"),this.addDBPattern("s",i("editor.pattern"),"edge.pattern"),this.addDBColor("s",i("editor.color"),"edge.color"),this.addDBCheckBox("s",i("editor.threed"),"edge.3d"),this.addDBColor("s",i("editor.threedcolor"),"edge.3d.color"),this.addDBComboBox("s",i("editor.join"),"edge.join",Jp.consts.joins,Jp.consts.joinLabels),this.addDBComboBox("s",i("editor.cap"),"edge.cap",Jp.consts.caps,Jp.consts.capLabels),this.addDBInput("s",i("editor.group"),"edge.group"),this.addDBInput("s",i("editor.offset"),"edge.offset","number",1),this.addDBInput("s",i("editor.gap"),"edge.gap","number",1),this.addDBComboBox("s",i("editor.type"),"edge.type",Jp.consts.edgeTypes,Jp.consts.edgeTypes.map(function(c){var p=i("edgeType:"+c,!0);return p||c})),this.addDBInput("s",i("editor.radius"),"edge.corner.radius","number",1).items.tag="edgeRadius",this.addDBZeroToOne("s",i("editor.ortho"),"edge.ortho").items.tag="edgeOrtho",this.addDBInput("s",i("editor.flex"),"edge.flex","number",1).items.tag="edgeFlex",this.addDBInput("s",i("editor.extend"),"edge.extend","number",1).items.tag="edgeExtend",this.addDBInput("s",i("editor.ripplesize"),"edge.ripple.size","int",1).items.tag="edgeRipple",this.addDBInput("s",i("editor.ripplelength"),"edge.ripple.length","number",1).items.tag="edgeRipple",this.addDBInput("s",i("editor.rippleelevation"),"edge.ripple.elevation","number",1).items.tag="edgeRipple",this.addDBCheckBox("s",i("editor.rippleboth"),"edge.ripple.both").items.tag="edgeRipple",this.addDBCheckBox("s",i("editor.ripplestraight"),"edge.ripple.straight").items.tag="edgeRipple",this.addDBCheckBox("s",i("editor.center"),"edge.center"),this.addDBCheckBox("s",i("editor.ingroup"),"ingroup"),this.addDBCheckBox("s",i("editor.visible"),"2d.visible"),this.addDBCheckBox("s",i("editor.selectable"),"2d.selectable"),this.addDBCheckBox("s",i("editor.editable"),"2d.editable"),this.addDBCheckBox("s",i("editor.independent"),"edge.independent"),this.addDBCheckBox("s",i("editor.toggleable"),"edge.toggleable");var c=[],p=function(c,p){c instanceof ht.Edge&&c.toggle()};p.once=!0,this.addLabelCheckBox(c,i("editor.expanded"),function(c){return c.s("edge.expanded")},p),this.addDBRow(c,"s","edge.expanded")},p.prototype.$91$=function(){this.addTitle("TitleEdgeDash"),this.addDBCheckBox("s",i("editor.dash"),"edge.dash"),this.addDBPattern("s",i("editor.pattern"),"edge.dash.pattern"),this.addDBColor("s",i("editor.color"),"edge.dash.color"),this.addDBInput("s",i("editor.offset"),"edge.dash.offset","number",1),this.addDBInput("s",i("editor.width"),"edge.dash.width","number",1),this.addDBCheckBox("s",i("editor.threed"),"edge.dash.3d"),this.addDBColor("s",i("editor.threedcolor"),"edge.dash.3d.color")},p.prototype.$90$=function(){this.addTitle("TitleEdgeEndpoint"),this.addDBData("p",i("editor.sourcenode"),"source",function(c,p){c instanceof ht.Edge&&(null==p||p instanceof ht.Node||p instanceof ht.Edge)&&(c.setSource(p),c.s("edge.source.percent",.5))}),this.addDBData("p",i("editor.targetnode"),"target",function(c,p){c instanceof ht.Edge&&(null==p||p instanceof ht.Node||p instanceof ht.Edge)&&(c.setTarget(p),c.s("edge.target.percent",.5))});var c=void 0;c=this.addDBZeroToOne("s",i("editor.sourcepercent"),"edge.source.percent"),c.items.tag="edgeSourceIsEdge",c=this.addDBRange("s",i("editor.sourceindex"),"edge.source.index",0,1/0,1,"number"),c.items.tag="edgeSourceIsEdge",c=this.addDBPosition("s",i("editor.sourceposition"),"edge.source.position"),c.items.tag="edgeSourceIsNode",c=this.addDBInput("s",i("editor.sourceoffsetx"),"edge.source.offset.x","number",1),c.items.tag="edgeSourceIsNode",c=this.addDBInput("s",i("editor.sourceoffsety"),"edge.source.offset.y","number",1),c.items.tag="edgeSourceIsNode",c=this.addDBInput("s",i("editor.sourceanchorx"),"edge.source.anchor.x","number",.01),c.items.tag="edgeSourceIsNode",c=this.addDBInput("s",i("editor.sourceanchory"),"edge.source.anchor.y","number",.01),c.items.tag="edgeSourceIsNode",c=this.addDBZeroToOne("s",i("editor.targetpercent"),"edge.target.percent"),c.items.tag="edgeTargetIsEdge",c=this.addDBRange("s",i("editor.targetindex"),"edge.target.index",0,1/0,1,"number"),c.items.tag="edgeTargetIsEdge",c=this.addDBPosition("s",i("editor.targetposition"),"edge.target.position"),c.items.tag="edgeTargetIsNode",c=this.addDBInput("s",i("editor.targetoffsetx"),"edge.target.offset.x","number",1),c.items.tag="edgeTargetIsNode",c=this.addDBInput("s",i("editor.targetoffsety"),"edge.target.offset.y","number",1),c.items.tag="edgeTargetIsNode",c=this.addDBInput("s",i("editor.targetanchorx"),"edge.target.anchor.x","number",.01),c.items.tag="edgeTargetIsNode",c=this.addDBInput("s",i("editor.targetanchory"),"edge.target.anchor.y","number",.01),c.items.tag="edgeTargetIsNode"},p}(Cr),ni=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.initForm=function(){this.addCustomProperties(),this.$28$(),this.$92$(),this.addLayoutProperties(),this.$23$(),this.$32$(),this.$94$(),this.$93$(),this.$29$(),this.$30$(),this.$31$(),this.$26$()},p.prototype.$35$=function(p){if(p&&"s:group.type"===p.property)return void this.filterPropertiesLater();c.prototype.$35$.call(this,p)},p.prototype.isTitleVisible=function(p){return(!this.data||!this.data.s("group.type")||"TitleGroupTitle"!==p.title)&&c.prototype.isTitleVisible.call(this,p)},p.prototype.isPropertyVisible=function(p){if(this.data){var Q=p.items.tag;if(Q&&"groupDepth"===Q){var r=this.data.s("group.type");if(r&&"rect"!==r)return!1}}return c.prototype.isPropertyVisible.call(this,p)},p.prototype.$32$=function(){this.addTitle("TitleGroupBasic"),this.addDBComboBox("s",i("editor.type"),"group.type",[void 0,"rect","oval","circle","roundRect"],["",i("editor.grouptype.rect"),i("editor.grouptype.oval"),i("editor.grouptype.circle"),i("editor.grouptype.roundrect")]),this.addDBPosition("s",i("editor.position"),"group.position"),this.addDBColor("s",i("editor.background"),"group.background"),this.addDBGradient(i("editor.gradient"),"group.gradient","group.background","group.gradient.color"),this.addDBColor("s",i("editor.gradientcolor"),"group.gradient.color"),this.addDBImage("s",i("editor.image"),"group.image"),this.addDBStretch("s",i("editor.stretch"),"group.image.stretch"),this.addDBImage("s",i("editor.repeatimage"),"group.repeat.image"),this.addDBCheckBox("s",i("editor.toggleable"),"group.toggleable"),this.addDBCheckBox("p",i("editor.expanded"),"expanded"),this.addDBInput("s",i("editor.depth"),"group.depth","number",1).items.tag="groupDepth"},p.prototype.$94$=function(){this.addTitle("TitleGroupTitle"),this.addDBLabel("s",i("editor.content"),"label"),this.addDBFont("s",i("editor.font"),"group.title.font"),this.addDBColor("s",i("editor.color"),"group.title.color"),this.addDBColor("s",i("editor.background"),"group.title.background"),this.addDBAlign("s",i("editor.align"),"group.title.align"),this.addDBOrientation("s",i("editor.valuetype.orientation"),"group.title.orientation"),this.addDBCheckBox("s","\u5206\u5272\u7ebf","group.splitLine")},p.prototype.$93$=function(){this.addTitle("TitleGroupBorder"),this.addDBInput("s",i("editor.width"),"group.border.width","number",1),this.addDBPattern("s",i("editor.pattern"),"group.border.pattern"),this.addDBColor("s",i("editor.color"),"group.border.color"),this.addDBComboBox("s",i("editor.join"),"group.border.join",Jp.consts.joins,Jp.consts.joinLabels),this.addDBComboBox("s",i("editor.cap"),"group.border.cap",Jp.consts.caps,Jp.consts.capLabels),this.addDBInput("s",i("editor.radius"),"group.border.radius","number",1),this.addDBInput("s",i("editor.padding"),"group.padding","number",1),this.addDBInput("s",i("editor.paddingleft"),"group.padding.left","number",1),this.addDBInput("s",i("editor.paddingright"),"group.padding.right","number",1),this.addDBInput("s",i("editor.paddingtop"),"group.padding.top","number",1),this.addDBInput("s",i("editor.paddingbottom"),"group.padding.bottom","number",1)},p}(pi),yi=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.initForm=function(){this.$27$(),this.addCustomProperties(),this.$28$(),this.addLayoutProperties(),this.$23$(),this.$29$(),this.$30$(),this.$31$(),this.$26$()},p.prototype.isTitleVisible=function(p){return!("TitleEditingPoint"===p.title&&!this.editor.pointsEditingMode)&&c.prototype.isTitleVisible.call(this,p)},p.prototype.$24$=function(){this.addDBCheckBox("p",i("editor.closed"),"closePath"),this.addDBColor("s",i("editor.outlinecolor"),"border.color"),this.addDBInput("s",i("editor.outlinewidth"),"border.width","number",1)},p.prototype.$25$=function(){c.prototype.$25$.call(this),this.addDBComboBox("s",i("editor.fillrule"),"shape.fill.rule",Jp.consts.fillRules,Jp.consts.fillRuleLabels)},p.prototype.$26$=function(){this.addTitle("TitleSelect"),this.addDBColor("s",i("editor.color"),"select.color"),this.addDBInput("s",i("editor.width"),"select.width","number",1);var c=[];this.addLabelCheckBox(c,i("editor.shadow"),function(c){return"shadow"===c.s("select.type")},function(c,p){c.s("select.type",p?"shadow":null)}),this.addDBRow(c,"s","select.type"),this.addDBInput("s",i("editor.shadowblur"),"shadow.blur","number",1),this.addDBInput("s",i("editor.shadowoffsetx"),"shadow.offset.x","number",1),this.addDBInput("s",i("editor.shadowoffsety"),"shadow.offset.y","number",1)},p}(pi),Xi=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.$23$=function(){c.prototype.$23$.call(this),this.addDBCheckBox("p",i("editor.clickthroughenabled"),"clickThroughEnabled");var p=[];this.addLabelCheckBox(p,i("editor.syncsize"),function(c){return c.isSyncSize()},function(c,p){c instanceof ht.Block&&(c.setSyncSize(p),c instanceof ht.RefGraph&&(c.p(0,0),c.setRotation(0),c.setAnchor(.5,.5),c.setScale(1,1),c.setSize(20,20),c.setRef(c.getRef())))}),this.addDBRow(p,"p","syncSize")},p.prototype.addDBGray=function(){},p.prototype.addDBBodyColorProperty=function(){},p.prototype.addDBOpacityProperty=function(){},p.prototype.$92$=function(){},p.prototype.$29$=function(){},p.prototype.$85$=function(){},p}(pi),Wi=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.$28$=function(){c.prototype.$28$.call(this),this.addDBRef()},p.prototype.addDBRef=function(){var c=this,p=[],Q=function(c){return c.getRef()},r=function(c,p){c instanceof ht.RefGraph&&(c.p(0,0),c.setRotation(0),c.setAnchor(.5,.5),c.setScale(1,1),c.setSize(20,20),c.setRef(p))},n=function(p,Q){var r=Q.view.draggingData;return!!r&&(c.editor.url!==r.url&&r.fileType===nQ)};return this.addLabelURL(p,i("editor.ref"),Q,r,n),this.addDBRow(p,"p","ref")},p.prototype.addDBGray=function(){},p}(Xi),Zi=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.initForm=function(){this.addCustomProperties(),this.$28$(),this.addLayoutProperties(),this.$22$(),this.$23$(),this.$26$()},p.prototype.$22$=function(){this.addTitle("TitleText"),this.addDBInput("s",i("editor.content"),"text"),this.addDBAlign("s",i("editor.align"),"text.align"),this.addDBVAlign("s",i("editor.valign"),"text.vAlign"),this.addDBColor("s",i("editor.color"),"text.color"),this.addDBFont("s",i("editor.font"),"text.font"),this.addDBCheckBox("s",i("editor.shadow"),"text.shadow"),this.addDBColor("s",i("editor.shadowcolor"),"text.shadow.color"),this.addDBInput("s",i("editor.shadowblur"),"text.shadow.blur","number",1),this.addDBInput("s",i("editor.shadowoffsetx"),"text.shadow.offset.x","number",1),this.addDBInput("s",i("editor.shadowoffsety"),"text.shadow.offset.y","number",1)},p}(pi),oi=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r,"comp"))}return Np(p,c),p.prototype.initForm=function(){this.addCustomProperties(),this.$12$(),this.addLayoutProperties(),this.$20$()},p.prototype.isTitleVisible=function(p){return!!this.inspectorFilter.isCompTitleVisible(this.editor,this.data?this.data.compType:null,p.title)&&c.prototype.isTitleVisible.call(this,p)},p.prototype.isPropertyVisible=function(p){return!!this.inspectorFilter.isCompPropertyVisible(this.editor,this.data?this.data.compType:null,p.keys&&p.keys.name)&&c.prototype.isPropertyVisible.call(this,p)},p.prototype.$12$=function(){this.addTitle("TitleBasic"),this.addEventProperties(),this.$14$(),this.$15$(),this.addStyleInput(i("editor.prefix"),"prefix","prefix"),this.$13$(),this.$21$(),this.$16$(),this.$17$(),this.$18$(),this.$19$(),this.addStyleCheckBox(i("editor.visible"),"2d.visible","visible"),this.addStyleCheckBox(i("editor.selectable"),"2d.selectable","selectable"),this.addStyleCheckBox(i("editor.movable"),"2d.movable","movable"),this.addStyleCheckBox(i("editor.editable"),"2d.editable","editable"),this.addStyleCheckBox(i("editor.pixelperfect"),"pixelPerfect","pixelPerfect"),this.addStyleZeroToOne(i("editor.opacity"),"opacity","opacity"),this.addState()},p.prototype.addState=function(){var c=this,p=[],Q=new ht.widget.ComboBox,r=o("s","state"),n=l("s","state");this.addLabel(p,i("editor.state"),r,n),Q.onValueChanged=function(){c.setValue(n,Q.getValue())},this.updateHandlers.push(function(){if(!p.hidden){var i=c.getValue(r),n=c.editor.dm.a("stateEnum");if(n&&n.length){var y=n.map(function(c){return c.value}),X=n.map(function(c){return c.label||c.value});y.unshift(void 0),X.unshift(""),Q.setValues(y),Q.setLabels(X),Q.getValue()!==i&&Q.setValue(i)}}}),p.push(Q);var y=this.addFuncRow(p,"state");return y.visible=function(){return c.editor.dm.a("stateEnum")&&c.editor.dm.a("stateEnum").length},y},p.prototype.$13$=function(){var c=[];this.addLabelInput(c,i("editor.area"),function(c){return"["+r(c.p().x-c.getWidth()*c.getAnchor().x)+","+r(c.p().y-c.getHeight()*c.getAnchor().y)+","+r(c.getWidth())+","+r(c.getHeight())+"]"}),this.addFuncRow(c,"rect")},p.prototype.$14$=function(){var c=[];this.addLabelInput(c,i("editor.type"),function(c){return c.compType}),this.addRow(c,[Jp.config.indent,.1]).keys={name:"type"}},p.prototype.$15$=function(){var c=[];this.addLabelInput(c,i("editor.name"),function(c){return c.getDisplayName()},function(c,p){c.setDisplayName(p)}),this.addFuncRow(c,"displayName")},p.prototype.$16$=function(){var c=[];this.addLabelInput(c,i("editor.rotation"),function(c){return 180/Math.PI*c.getRotation()},function(c,p){c instanceof ht.Node&&c.setRotation(p*Math.PI/180)},"number",1),this.addFuncRow(c,"rotation")},p.prototype.$17$=function(){var c=[];this.addLabelInput(c,i("editor.anchorx"),function(c){return c.getAnchor().x},function(c,p){c instanceof ht.Node&&c.setAnchor(p,c.getAnchor().y,!0)},"number",.01),this.addFuncRow(c,"anchorX"),c=[],this.addLabelInput(c,i("editor.anchory"),function(c){return c.getAnchor().y},function(c,p){c instanceof ht.Node&&c.setAnchor(c.getAnchor().x,p,!0)},"number",.01),this.addFuncRow(c,"anchorY")},p.prototype.$18$=function(){var c=[];this.addLabelInput(c,i("editor.scalex"),function(c){return c.getScale().x},function(c,p){c instanceof ht.Node&&c.setScale(p,c.getScale().y)},"number",.01),this.addFuncRow(c,"scaleX"),c=[],this.addLabelInput(c,i("editor.scaley"),function(c){return c.getScale().y},function(c,p){c instanceof ht.Node&&c.setScale(c.getScale().x,p)},"number",.01),this.addFuncRow(c,"scaleY")},p.prototype.$19$=function(){this.addStyleZeroToOne(i("editor.clippercentage"),"clip.percentage","clipPercentage"),this.addStyleComboBox(i("editor.clipdirection"),"clip.direction",Jp.consts.clipDirections,Jp.consts.clipDirectionLabels,null,"clipDirection")},p.prototype.$20$=function(){this.addTitle("TitleShadow"),this.addStyleCheckBox(i("editor.shadow"),"shadow","shadow"),this.addStyleColor(i("editor.shadowcolor"),"select.color","shadowColor"),this.addStyleInput(i("editor.shadowblur"),"shadow.blur","number",1,"shadowblur"),this.addStyleInput(i("editor.shadowoffsetx"),"shadow.offset.x","number",1,"shadowOffsetX"),this.addStyleInput(i("editor.shadowoffsety"),"shadow.offset.y","number",1,"shadowOffsetYs")},p.prototype.$21$=function(){var c=[];return this.addLabelInput(c,i("editor.posx"),function(c){return c.p().x},function(c,p){c instanceof ht.Node&&c.p(p,c.p().y)},"number",1),this.addLabelInput(c,i("editor.posy"),function(c){return c.p().y},function(c,p){c instanceof ht.Node&&c.p(c.p().x,p)},"number",1),this.addRow(c,[Jp.config.indent,.1,Jp.config.indent2,.1]).keys={name:"position"},c=[],this.addLabelInput(c,i("editor.width"),function(c){return c.getWidth()},function(c,p){c instanceof ht.Node&&c.setWidth(p)},"number",1),this.addLabelInput(c,i("editor.height"),function(c){return c.getHeight()},function(c,p){c instanceof ht.Node&&c.setHeight(p)},"number",1),this.addRow(c,[Jp.config.indent,.1,Jp.config.indent2,.1]).keys={name:"size"},c},p.prototype.addStyleColor=function(c,p,Q){var r=[];return this.addLabelColor(r,c,function(c){return c.s(p)},function(c,Q){c.s(p,Q)}),this.addFuncRow(r,p,Q)},p.prototype.addStyleFunction=function(c,p,Q,r){var i=[];return this.addLabelFunction(i,c,function(c){return c.s(p)},function(c,Q){c.s(p,Q)},Q,r),this.addFuncRow(i,p,Q)},p.prototype.addStyleObject=function(c,p,Q){var r=[];return this.addLabelObject(r,c,function(c){return c.s(p)},function(c,Q){c.s(p,Q)},Q),this.addFuncRow(r,p,Q)},p.prototype.addStyleLabel=function(c,p,Q){var r=[];return this.addLabelInput(r,c,function(c){var Q=c.s(p);return Q&&Q.replace&&(Q=Q.replace(/\n/g,"\\n")),Q},function(c,Q){Q&&Q.replace&&(Q=Q.replace(/\\n/g,"\n")),c.s(p,Q)}),this.addFuncRow(r,p,Q)},p.prototype.addStyleArray=function(c,p,Q,r,i){var n=[];return this.addLabelArray(n,c,function(c){return c.s(p)},function(c,Q){c.s(p,Q)},r),this.addFuncRow(n,p,Q,i)},p.prototype.addStyleMultiline=function(c,p,Q,r){var i=[];return this.addLabelMultiline(i,c,function(c){return c.s(p)},function(c,Q){c.s(p,Q)}),this.addFuncRow(i,p,Q,r)},p.prototype.addStyleFont=function(c,p,Q,r){var i=[];return this.addLabelFont(i,c,function(c){return c.s(p)},function(c,Q){c.s(p,Q)}),this.addFuncRow(i,p,Q,r)},p.prototype.addStyleTextArea=function(c,p,Q,r){var i=[];return this.addLabelTextArea(i,c,function(c){return c.s(p)},function(c,Q){c.s(p,Q)}),this.addFuncRow(i,p,r,Q)},p.prototype.addStyleInput=function(c,p,Q,r,i){var n=[];return this.addLabelInput(n,c,function(c){return c.s(p)},function(c,Q){c.s(p,Q)},Q,r),this.addFuncRow(n,p,i)},p.prototype.addStyleCheckBox=function(c,p,Q){var r=[];return this.addLabelCheckBox(r,c,function(c){return c.s(p)},function(c,Q){c.s(p,Q)}),this.addFuncRow(r,p,Q)},p.prototype.addStyleAlign=function(c,p,Q){var r=[];return this.addLabelComboBox(r,c,function(c){return c.s(p)||"center"},function(c,Q){c.s(p,Q)},["left","center","right"],[i("editor.align.left"),i("editor.align.center"),i("editor.align.right")]),this.addFuncRow(r,p,Q)},p.prototype.addStyleVAlign=function(c,p,Q){var r=[];return this.addLabelComboBox(r,c,function(c){return c.s(p)||"bottom"},function(c,Q){c.s(p,Q)},["top","middle","bottom"],[i("editor.valign.top"),i("editor.valign.middle"),i("editor.valign.bottom")]),this.addFuncRow(r,p,Q)},p.prototype.addStyleStretch=function(c,p,Q){var r=[];return this.addLabelComboBox(r,c,function(c){return c.s(p)||"fill"},function(c,Q){c.s(p,Q)},["fill","uniform","centerUniform"],[i("editor.stretch.fill"),i("editor.stretch.uniform"),i("editor.stretch.centeruniform")]),this.addFuncRow(r,p,Q)},p.prototype.addStyleComboBox=function(c,p,Q,r,i,n){var y=[];return this.addLabelComboBox(y,c,function(c){return c.s(p)},function(c,Q){c.s(p,Q)},Q,r,i),this.addFuncRow(y,p,n)},p.prototype.addStyleImage=function(c,p,Q){var r=[];return this.addLabelImage(r,c,function(c){return c.s(p)},function(c,Q){c.s(p,Q)}),this.addFuncRow(r,p,Q)},p.prototype.addStyleURL=function(c,p,Q){var r=[];return this.addLabelURL(r,c,function(c){return c.s(p)},function(c,Q){c.s(p,Q)}),this.addFuncRow(r,p,Q)},p.prototype.addStylePattern=function(c,p,Q){var r=[];return this.addLabelInput(r,c,function(c){return c.s(p)},function(c,Q){c.s(p,Q)},"pattern"),this.addFuncRow(r,p,Q)},p.prototype.addStyleZeroToOne=function(c,p,Q){return this.addStyleRange(c,p,0,1,.01,Q)},p.prototype.addStylePosition=function(c,p,Q){return this.addStyleRange(c,p,1,55,1,Q)},p.prototype.addStyleRange=function(c,p,Q,r,i,n){var y=[];return this.addLabelInput(y,c,function(c){var Q=c.s(p);return null==Q?r:Q},function(c,i){void 0!==r&&i>r&&(i=r),void 0!==Q&&i<Q&&(i=Q),c.s(p,i)},"number",i),this.addFuncRow(y,p,n)},p.prototype.addStyleRotation=function(c,p,Q,r,i,n){var y=[];return this.addLabelInput(y,c,function(c){var Q=c.s(p);return null==Q?i:180/Math.PI*Q},function(c,Q){Q=Q*Math.PI/180,void 0!==i&&Q>i&&(Q=i),void 0!==r&&Q<r&&(Q=r),c.s(p,Q)},"number",n||1),this.addFuncRow(y,p,Q)},p.prototype.addStyleGradient=function(c,p,Q,r,i){var n=[];return this.addLabelGradient(n,c,p,Q,r),this.addFuncRow(n,p,i)},p.prototype.addLayoutProperties=function(){var c=this;this.addTitle("TitleNodeLayout").visible=function(c){return!!c.dataModel.a("fitSize")};var p=this.layoutGv=new ht.graph.GraphView,Q=this.layoutNode=new ht.Node,r=!1;Q.setImage("editor.layout.helper"),Q.a("selectColor",Jp.config.color_select),p.dm().add(Q),p.tx(50),p.ty(50),p.handleScroll=function(){},p.handlePinck=function(){},p.setScrollBarVisible(!1),p.setRectSelectable(!1),p.setPannable(!1),p.setMovableFunc(function(){return!1}),p.dm().md(function(p){r||(c.beginTransaction(),c.dataModel.sm().getSelection().each(function(c){"a:layout.v"===p.property?c.s("layout.v",p.newValue):"a:layout.h"===p.property&&c.s("layout.h",p.newValue)}),c.endTransaction())}),this.addRow(["",{element:p},""],[.1,100,.1],100),this.addUpdateHandler(function(p,i){var n=c.data;r=!0,Q.a({"layout.v":n.s("layout.v"),"layout.h":n.s("layout.h")}),r=!1});var n=[];this.addLabelComboBox(n,i("editor.nodeLayout.h"),function(c){return c.s("layout.h")},function(c,p){c.s("layout.h",p)},Jp.consts.hLayoutValues,Jp.consts.hLayoutLabels),this.addFuncRow(n,"layout.h"),n=[],this.addLabelComboBox(n,i("editor.nodeLayout.v"),function(c){return c.s("layout.v")},function(c,p){c.s("layout.v",p)},Jp.consts.vLayoutValues,Jp.consts.vLayoutLabels),this.addFuncRow(n,"layout.v")},p}(vr),li=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.$35$=function(p){if(p&&"s:shape"===p.property)return void this.filterPropertiesLater();c.prototype.$35$.call(this,p)},p.prototype.isTitleVisible=function(p){if(this.data){var Q=this.data.s("shape");if("TitleArc"===p.title&&"arc"!==Q)return!1}return c.prototype.isTitleVisible.call(this,p)},p.prototype.isPropertyVisible=function(p){if(this.data){var Q=p.items.tag;if(Q){var r=this.data.s("shape");if("shapeDepth"===Q&&"rect"!==r)return!1;if("shapeCornerRadius"===Q&&"roundRect"!==r)return!1;if("shapePolygonSide"===Q&&"polygon"!==r)return!1}}return c.prototype.isPropertyVisible.call(this,p)},p.prototype.initForm=function(){c.prototype.initForm.call(this),this.$37$(),this.$38$(),this.addDashProperties(),this.addArcProperties()},p.prototype.$14$=function(){this.addStyleComboBox(i("editor.type"),"shape",Jp.consts.shapes.slice(1),Jp.consts.shapeLabels.slice(1),Jp.consts.shapeIcons.slice(1),"type")},p.prototype.$37$=function(){this.addTitle("TitleBackground"),this.addStyleColor(i("editor.background"),"shape.background","background"),this.addStyleImage(i("editor.repeatimage"),"shape.repeat.image","repeatImage"),this.addStyleGradient(i("editor.gradient"),"shape.gradient","shape.background","shape.gradient.color","gradient"),this.addStyleColor(i("editor.gradientcolor"),"shape.gradient.color","gradientColor"),this.addStyleZeroToOne(i("editor.clippercentage"),"shape.fill.clip.percentage","fillClipPercentage"),this.addStyleComboBox(i("editor.clipdirection"),"shape.fill.clip.direction",Jp.consts.clipDirections,Jp.consts.clipDirectionLabels,null,"fillClipDirection")},p.prototype.$38$=function(){this.addTitle("TitleBorder"),this.addStyleInput(i("editor.width"),"shape.border.width","number",1,"borderWidth"),this.addStyleCheckBox(i("editor.widthabsolute"),"shape.border.width.absolute","borderWidthAbsolute"),this.addStyleColor(i("editor.color"),"shape.border.color","borderColor"),this.addStylePattern(i("editor.pattern"),"shape.border.pattern","borderPattern"),this.addStyleCheckBox(i("editor.threed"),"shape.border.3d","border3d"),this.addStyleColor(i("editor.threedcolor"),"shape.border.3d.color","border3dColor"),this.addStyleComboBox(i("editor.cap"),"shape.border.cap",Jp.consts.caps,Jp.consts.capLabels,null,"borderCap"),this.addStyleComboBox(i("editor.join"),"shape.border.join",Jp.consts.joins,Jp.consts.joinLabels,null,"borderJoin"),this.addStyleInput(i("editor.depth"),"shape.depth","int",1,"depth").items.tag="shapeDepth",this.addStyleInput(i("editor.radius"),"shape.corner.radius","number",1,"cornerRadius").items.tag="shapeCornerRadius",this.addStyleInput(i("editor.sides"),"shape.polygon.side","int",1,"polygonSide").items.tag="shapePolygonSide"},p.prototype.addDashProperties=function(){this.addTitle("TitleDash"),this.addStyleCheckBox(i("editor.dash"),"shape.dash","dash"),this.addStylePattern(i("editor.pattern"),"shape.dash.pattern","dashPattern"),this.addStyleColor(i("editor.color"),"shape.dash.color","dashColor"),this.addStyleInput(i("editor.offset"),"shape.dash.offset","number",1,"dashOffset"),this.addStyleInput(i("editor.width"),"shape.dash.width","number",1,"dashWidth"),this.addStyleCheckBox(i("editor.threed"),"shape.dash.3d","dash3d"),this.addStyleColor(i("editor.threedcolor"),"shape.dash.3d.color","dash3dColor")},p.prototype.addArcProperties=function(){this.addTitle("TitleArc"),this.addStyleCheckBox(i("editor.arcoval"),"shape.arc.oval","arcOval"),this.addStyleCheckBox(i("editor.closed"),"shape.arc.close","arcClose"),this.addStyleRotation(i("editor.arcfrom"),"shape.arc.from","arcFrom"),this.addStyleRotation(i("editor.arcto"),"shape.arc.to","arcTo")},p}(oi),ji=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.initForm=function(){c.prototype.initForm.call(this),this.addTitle("TitleImage");var p=[];this.addLabelImage(p,i("editor.name"),function(c){return c.s("image")},function(c,p){Ic(p)&&p.endsWith("[...]")||c.s("image",p)}),
this.addButton(p,null,i("editor.resetsize"),"editor.resetsize.state",function(c){c instanceof ht.Node&&c.setSize(-1,-1)}),this.addFuncRow(p,"image","name"),this.addStyleColor(i("editor.color"),"body.color","color"),this.addStyleStretch(i("editor.stretch"),"image.stretch","stretch")},p}(oi),Ei=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.initForm=function(){c.prototype.initForm.call(this),this.$44$()},p.prototype.$44$=function(){this.addTitle("TitleBorder"),this.addStyleInput(i("editor.width"),"border_width","number",1,"border"),this.addStyleColor(i("editor.color"),"border_color","color")},p}(oi),mi=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.initForm=function(){c.prototype.initForm.call(this),this.addBasicChartProperties()},p.prototype.addBasicChartProperties=function(){this.addTitle("TitleChart"),this.addStyleCheckBox(i("editor.text"),"chart.label","label"),this.addStyleColor(i("editor.color"),"chart.label.color","labelColor"),this.addStyleFont(i("editor.font"),"chart.label.font","labelFont")},p}(oi),fi=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.initForm=function(){c.prototype.initForm.call(this),this.addPieChartProperties()},p.prototype.addBasicChartProperties=function(){c.prototype.addBasicChartProperties.call(this),this.addStyleRotation(i("editor.rotation"),"chart.start.angle","startAngle"),this.addStyleCheckBox(i("editor.hollow"),"chart.hollow","hollow")},p.prototype.createChartIndexColumn=function(c){var p=this;return{name:c,width:50,align:"center",editable:!0,sortable:!1,clickable:!1,getValueType:function(c){return"chart.values"===c.getTag()?"number":"color"},getValue:function(Q){if(p.data){var r=p.data.s(Q.getTag());return r?r[c]:void 0}},setValue:function(Q,r,i,n){var y=Q.getTag(),X=function(p,Q){var r=Qp(p.s(y));r[c]=Q,"chart.values"===y?cp(r):pp(r),p.s(y,r)};p.setValue(X,i)}}},p.prototype.addPieChartProperties=function(){var c=this,p=this.tableModel=new ht.DataModel,Q=this.tablePane=new wQ(p),r=this.tableView=Q.getTableView();Q.getTableHeader().setMovable(!1),r.setEditable(!0),r.isEditable=function(){return c.editor.editable},Q.getView().style.border=Jp.config.color_line+" solid 1px";var n=[Q];this.addRow(n,[.1],ht.Default.widgetRowHeight+4*r.getRowHeight()).keys={name:"chartTable"};var y=new ht.Data,X=new ht.Data;y.setTag("chart.values"),X.setTag("chart.colors"),p.add(y),p.add(X),this.updateHandlers.push(function(){if(!n.hidden&&c.data){r.getColumnModel().clear(),Q.addColumns([{name:i("editor.length"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,valueType:"int",getValue:function(p){if(!c.data)return 0;var Q=c.data.s("chart.values");return Q?Q.length:0},setValue:function(p,Q,r,i){var n=function(c,p){if(p>=0){var Q=Qp(c.s("chart.values"),p);cp(Q),c.s("chart.values",Q),Q=Qp(c.s("chart.colors"),p),pp(Q),c.s("chart.colors",Q)}};c.setValue(n,r)}},{tag:"binding",name:i("editor.binding"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,isCellEditable:function(p,r,i,n){var y="chart.values"===p.getTag()?"values":"colors";return c.editor.funcView.toggle(Q,p.getTag(),y,c),!1},drawCell:function(p,Q,r,i,n,y,X,W,Z){var o=!!c.data.a(Q.getTag());A(p,ht.Default.getImage(o?"editor.bind":"editor.unbind"),"centerUniform",n,y,X,W,Q,Z,o&&!r?Jp.config.color_select:Jp.config.color_dark)}}]);for(var p=c.data.s("chart.values"),y=p?p.length:0,X=0;X<y;X++)Q.addColumns([c.createChartIndexColumn(X)])}})},p}(mi),Ii=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.initForm=function(){c.prototype.initForm.call(this),this.addOneDimensionalProperties()},p.prototype.createChartIndexColumn=function(c){var p=this;return{name:c,width:50,align:"center",editable:!0,sortable:!1,clickable:!1,getValueType:function(c){return"values"===c.getTag()?"number":"color"},getValue:function(Q){if(p.data){var r=Mc(p.data.s("chart.series"));if(r&&r[0]){var i=Mc(r[0][Q.getTag()]);return i?i[c]:void 0}}},setValue:function(r,i,n,y){var X=r.getTag(),W=function(p,r){var i=p.s("chart.series");if(i){var n=Q(i),y=Mc(n);if(y[0]){var W=Mc(y[0][X]);W&&W[c]!==r&&(W[c]=r,"values"===X?cp(W):pp(W),p.s("chart.series",n))}}};p.setValue(W,n)}}},p.prototype.addOneDimensionalProperties=function(){var c=this,p=this.tableModel=new ht.DataModel,r=this.tablePane=new wQ(p),n=this.tableView=r.getTableView();r.getTableHeader().setMovable(!1),n.setEditable(!0),n.isEditable=function(){return c.editor.editable},r.getView().style.border=Jp.config.color_line+" solid 1px";var y=[r];this.addRow(y,[.1],ht.Default.widgetRowHeight+4*n.getRowHeight()).keys={name:"chartTable"};var X=new ht.Data,W=new ht.Data;X.setTag("values"),W.setTag("colors"),p.add(X),p.add(W),this.updateHandlers.push(function(){if(!y.hidden&&c.data){n.getColumnModel().clear(),r.addColumns([{name:i("editor.length"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,valueType:"int",getValue:function(p){if(!c.data)return 0;var Q=Mc(c.data.s("chart.series"));if(!Q)return 0;if(!Q[0])return 0;var r=Mc(Q[0].values);return r?r.length:0},setValue:function(p,r,i,n){var y=function(c,p){if(p>=0){var r=c.s("chart.series"),i=r?Q(r):[],n=Mc(i);n[0]||(n[0]={});var y=n[0];y.values||(y.values=[]),y.colors||(y.colors=[]);var X=Mc(y.values),W=Mc(y.colors);p===X.length&&p===W.length||(X.length=p,W.length=p,cp(X),pp(W),c.s("chart.series",i))}};c.setValue(y,i)}},{tag:"binding",name:i("editor.binding"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,isCellEditable:function(p,i,n,y){var X=p.getTag(),W=function(){return wp(c.data,X)},Z=function(p){c.setValue(function(c,r){var i=c.s("chart.series");if(i){var n=Q(i),y=Mc(n);if(y[0]){var W=Mc(y[0][X]);y[0][X]=p?{value:W,func:p}:W,c.s("chart.series",n)}}},p)};return c.editor.funcView.toggle(r,X,X,c,W,Z),!1},drawCell:function(p,Q,r,i,n,y,X,W,Z){var o=!!wp(c.data,Q.getTag());A(p,ht.Default.getImage(o?"editor.bind":"editor.unbind"),"centerUniform",n,y,X,W,Q,Z,o&&!r?Jp.config.color_select:Jp.config.color_dark)}}]);for(var p=_p(c.data,"values"),X=p?p.length:0,W=0;W<X;W++)r.addColumns([c.createChartIndexColumn(W)])}})},p}(mi),Gi=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.initForm=function(){c.prototype.initForm.call(this),this.addSeriesChartProperties()},p.prototype.addSeriesChartProperties=function(){var c=this,p=[],r=function(c){var p=c.s("chart.series");return p?p.length:0},n=function(c,p){if(p>=0){var r=c.s("chart.series"),i=r?Q(r):[],n=Mc(i);if(n.length!==p){n.length=p;for(var y=void 0,X=0;X<p;X++){n[X]||(n[X]={});var W=n[X];W.values||(W.values=[]),W.color||(W.color=ht.Color.chart[X%ht.Color.chart.length]);var Z=Mc(W.values);Mc(W.colors);0===X?y=Z.length:Z.length=y,cp(Z)}c.s("chart.series",i)}}};this.addLabelInput(p,i("editor.series"),r,n,"int",1),r=function(c){var p=c.s("chart.series");if(p){var Q=p[0];if(Q){var r=Mc(Q.values);return r?r.length:0}}return 0},n=function(c,p){if(p>=0){var r=c.s("chart.series"),i=r?Q(r):[],n=Mc(i);if(n.length){for(var y=0;y<n.length;y++){n[y]||(n[y]={});var X=n[y];X.values||(X.values=[]);var W=Mc(X.values);if(W.length===p)return;X.color||(X.color=ht.Color.chart[y%ht.Color.chart.length]);Mc(X.colors);W.length=p,cp(W)}c.s("chart.series",i)}}},this.addLabelInput(p,i("editor.length"),r,n,"int",1),this.addRow(p,[Jp.config.indent,.1,Jp.config.indent2,.1]).keys={name:"chartSeries"};var y=this.tableModel=new ht.DataModel,X=this.tablePane=new wQ(y),W=this.tableView=X.getTableView();X.getTableHeader().setMovable(!1),W.setEditable(!0),W.isEditable=function(){return c.editor.editable},X.getView().style.border=Jp.config.color_line+" solid 1px";var Z=[X];this.addRow(Z,[.1],160).keys={name:"chartTable"},this.updateHandlers.push(function(){if(!Z.hidden&&c.data){y.clear(),W.getColumnModel().clear();var p=c.data.s("chart.series");if(p)for(var r=0;r<p.length;r++){var n=new ht.Data;n.serie=p[r],n.index=r,y.add(n)}if(X.addColumns([{name:i("editor.index"),width:50,align:"center",sortable:!1,clickable:!1,valueType:"int",getValue:function(c){return c.index}},{tag:"binding",name:i("editor.colorbinding"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,isCellEditable:function(p,r,i,n){var y=p.index,W=function(){return Kc(p.serie.color)},Z=function(p){c.setValue(function(c,r){var i=c.s("chart.series");if(i){var n=Q(i),X=Mc(n),W=X[y];if(W){var Z=Mc(W.color);W.color=p?{value:Z,func:p}:Z,c.s("chart.series",n)}}},p)};return c.editor.funcView.toggle(X,"values","values",c,W,Z),!1},drawCell:function(c,p,Q,r,i,n,y,X,W){var Z=!!Kc(p.serie.color);A(c,ht.Default.getImage(Z?"editor.bind":"editor.unbind"),"centerUniform",i,n,y,X,p,W,Z&&!Q?Jp.config.color_select:Jp.config.color_dark)}},{name:i("editor.color"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,valueType:"color",getValue:function(c){return Mc(c.serie.color)},setValue:function(p,r,i,n){var y=p.index,X=Mc(p.serie.color);if(i&&X!==i){var W=function(c,p){var r=c.s("chart.series");if(r){var i=Q(r),n=Mc(i),X=n[y];if(X){var W=Kc(X.color);X.color=W?{value:p,func:W}:p,c.s("chart.series",i)}}};c.setValue(W,i)}}},{tag:"binding",name:i("editor.valuebinding"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,isCellEditable:function(p,r,i,n){var y=p.index,W=function(){return Kc(p.serie.values)},Z=function(p){c.setValue(function(c,r){var i=c.s("chart.series");if(i){var n=Q(i),X=Mc(n),W=X[y];if(W){var Z=Mc(W.values);W.values=p?{value:Z,func:p}:Z,c.s("chart.series",n)}}},p)};return c.editor.funcView.toggle(X,"values","values",c,W,Z),!1},drawCell:function(c,p,Q,r,i,n,y,X,W){var Z=!!Kc(p.serie.values);A(c,ht.Default.getImage(Z?"editor.bind":"editor.unbind"),"centerUniform",i,n,y,X,p,W,Z&&!Q?Jp.config.color_select:Jp.config.color_dark)}}]),p){var o=p[0];if(o){var l=Mc(o.values);if(l)for(var j=0;j<l.length;j++)X.addColumns([c.createChartIndexColumn(j)])}}}})},p.prototype.createChartIndexColumn=function(c){var p=this;return{name:c,width:50,align:"center",editable:!0,sortable:!1,clickable:!1,valueType:"number",getValue:function(p){var Q=Mc(p.serie.values);return Q?Q[c]:void 0},setValue:function(r,i,n,y){var X=r.index,W=function(p,r){var i=p.s("chart.series");if(i){var n=Q(i),y=Mc(n);if(y[X]){var W=Mc(y[X].values);W&&W[c]!==r&&(W[c]=r,p.s("chart.series",n))}}};p.setValue(W,n)}}},p}(mi),ei=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.addBasicChartProperties=function(){c.prototype.addBasicChartProperties.call(this),this.addStyleComboBox(i("editor.type"),"chart.type",Jp.consts.columnChartTypes,Jp.consts.columnChartTypeLabels,null,"type")},p.prototype.$14$=function(){},p}(Gi),Pi=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.initForm=function(){c.prototype.initForm.call(this)},p}(Gi),di=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.initForm=function(){this.$27$(),c.prototype.initForm.call(this)},p.prototype.isTitleVisible=function(p){return!("TitleEditingPoint"===p.title&&!this.editor.pointsEditingMode)&&c.prototype.isTitleVisible.call(this,p)},p.prototype.$14$=function(){var c=[];this.addLabelInput(c,i("editor.type"),function(c){return c.compType}),this.addRow(c,[Jp.config.indent,.1]).keys={name:"type"}},p.prototype.$37$=function(){c.prototype.$37$.call(this),this.addStyleComboBox(i("editor.fillrule"),"shape.fill.rule",Jp.consts.fillRules,Jp.consts.fillRuleLabels,null,"fillRule")},p.prototype.$38$=function(){c.prototype.$38$.call(this);var p=[];this.addLabelCheckBox(p,i("editor.closed"),function(c){return c.isClosePath()},function(c,p){c instanceof ht.Shape&&c.setClosePath(p)}),this.addFuncRow(p,"name")},p}(li),Ri=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.initForm=function(){c.prototype.initForm.call(this),this.addTitle("TitleText"),this.addStyleLabel(i("editor.text"),"text","text"),this.addStyleAlign(i("editor.align"),"text.align","align"),this.addStyleVAlign(i("editor.valign"),"text.vAlign","vAlign"),this.addStyleColor(i("editor.color"),"text.color","color"),this.addStyleFont(i("editor.font"),"text.font","font")},p.prototype.$20$=function(){this.addTitle("TitleShadow"),this.addStyleCheckBox(i("editor.shadow"),"text.shadow","shadow"),this.addStyleColor(i("editor.shadowcolor"),"text.shadow.color","shadowColor"),this.addStyleInput(i("editor.shadowblur"),"text.shadow.blur","number",1,"shadowblur"),this.addStyleInput(i("editor.shadowoffsetx"),"text.shadow.offset.x","number",1,"shadowOffsetX"),this.addStyleInput(i("editor.shadowoffsety"),"text.shadow.offset.y","number",1,"shadowOffsetYs")},p}(oi),ti=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.$14$=function(){var c=[];this.addLabelInput(c,i("editor.type"),function(c){return"function"}),this.addFuncRow(c,"type")},p}(oi),bi=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.initForm=function(){c.prototype.initForm.call(this),this.addComponent()},p.prototype.$14$=function(){},p.prototype.addComponent=function(){var c=this;this.addTitle("TitleComponent");var p=[];p.forceToUpdate=!0;var Q=function(c,p){return!!p.view.draggingData&&p.view.draggingData.fileType===yQ};this.addLabelURL(p,i("editor.type"),function(p){var Q=p.s("type");return c.$43$(p.properties),Q},function(c,p){c.s("type",p)},Q);var r=new ht.widget.Image;r.vectorDataBindingDisabled=!0,this.updateHandlers.push(function(){if(!p.hidden){var Q=c.data?c.data.s("type"):null;c.$43$(c.data.properties),r.setIcon(Q?fc(Q):null),r.compType=Q}});var n=r.getView();n.style.cursor="pointer";var y=function(p){p.preventDefault(),d(p)?c.editor.open(r.compType):c.editor.selectFileNode(r.compType)};n.addEventListener("mousedown",y,!1),n.addEventListener("touchstart",y,!1),p.push(r),this.addFuncRow(p,"type")},p.prototype.$43$=function(c){var p=this;this.properties!==c&&(this.pendingProperties=c,this._updateComponentLater||(this._updateComponentLater=!0,requestAnimationFrame(function(){p.$61$()})))},p.prototype.$61$=function(){if(this._updateComponentLater=!1,this.properties===this.pendingProperties)return void(this.pendingProperties=null);if(this._rows=this.$47$,this.removeRows(this.$36$),this.propertiesHandlers&&this.propertiesHandlers.length&&this.propertiesHandlers.forEach(this.removeUpdateHandler,this),this.$36$=[],this.properties=this.pendingProperties,this.properties){var c=this.updateHandlers.length,p=void 0;for(var Q in this.properties){var r=this.properties[Q];if(r.group&&p!==r.group){p=r.group;var i=this.addTitle(p);this.$36$.push(i)}this.addProperty(Q,r)}this.propertiesHandlers=this.updateHandlers.slice(c)}this.$47$=this._rows,this.filterProperties()},p.prototype.addProperty=function(c,p){var Q=Jp.config.valueTypes[p.valueType];if(!Q)return this.editor.fireEvent("error",{message:"Wrong value type:"+p.valueType}),!1;var r=i(p.name)||c,n=void 0,y=void 0,X=void 0;if(p.extraInfo&&p.extraInfo.enum&&(n=p.extraInfo.enum.values,y=p.extraInfo.enum.labels,X=p.extraInfo.enum.icons),p.extraInfo&&p.extraInfo.buildUI){var W=function(p){return p.s(c)},Z=function(p,Q){p.s(c,Q)},o=[];p.extraInfo.buildUI(this,o,displayName,W,Z),this.addFuncRow(o,c,c)}else if(n)this.addStyleComboBox(r,c,n,y,X,c);else if("int"===Q.type||"number"===Q.type){var l=(Q.max,Q.min,function(p){return p.s(c)}),j=function(p,Q){p.s(c,Q)},E=[];Q.angle?this.addLabelRotation(E,r,l,j,Q.min,Q.max,Q.step):this.addLabelRange(E,r,l,j,Q.min,Q.max,Q.step,Q.type),this.addFuncRow(E,c,c)}else if("color"===Q.type)this.addStyleColor(r,c,c);else if("boolean"===Q.type)this.addStyleCheckBox(r,c,c);else if("enum"===Q.type)this.addStyleComboBox(r,c,Q.values,Q.labels,Q.icons,c);else if("multiline"===Q.type)this.addStyleMultiline(r,c,c,Q.rows);else if("font"===Q.type)this.addStyleFont(r,c,c,Q.rows);else if("image"===Q.type)this.addStyleImage(r,c,c);else if("url"===Q.type)this.addStyleURL(r,c,c);else if("colorArray"===Q.type)this.addStyleArray(r,c,c,"color",Q.rows);else if("numberArray"===Q.type)this.addStyleArray(r,c,c,"number",Q.rows);else if("stringArray"===Q.type)this.addStyleArray(r,c,c,"string",Q.rows);else if("objectArray"===Q.type)this.addStyleArray(r,c,c,"object",Q.rows);else if("function"===Q.type){var m=void 0;p.extraInfo&&p.extraInfo.arguments&&(m=p.extraInfo.arguments),this.addStyleFunction(r,c,c,m)}else if("custom"===Q.type){var f=function(p){return p.s(c)},I=function(p,Q){p.s(c,Q)},G=[];Q.buildUI(this,G,r,f,I),this.addFuncRow(G,c,c)}else"object"===Q.type?this.addStyleObject(r,c,c):this.addStyleInput(r,c,null,null,c);return this.$36$.push(this._rows[this._rows.length-1]),!0},p}(oi),Yi=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.initForm=function(){this.$27$(),this.addTitle("TitleBasic"),this.$14$(),this.$15$()},p.prototype.isTitleVisible=function(p){return!("TitleEditingPoint"===p.title&&!this.editor.pointsEditingMode)&&c.prototype.isTitleVisible.call(this,p)},p}(oi),si=function(c){function p(Q,r){return Tp(this,p),Sp(this,c.call(this,Q,r))}return Np(p,c),p.prototype.initForm=function(){this.addTitle("TitleBasic"),this.$14$(),this.$15$()},p}(oi),hi=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));return r.editor=Q,r.getView().style.background=Jp.config.color_pane,r}return Np(p,c),p.prototype.handleDataModelPropertyChange=function(c){var p=this.inspector;p&&p.global&&p.$35$(c)},p.prototype.handleDataModelChange=function(c){var p=this.inspector;p&&p.global&&p.$35$()},p.prototype.handleDataPropertyChange=function(c){var p=this.inspector;p&&!p.global&&p.data===c.data&&p.$35$(c)},p.prototype.handleSelectionChange=function(c){this.updateInspector(),this.inspector&&this.inspector.updateProperties()},p.prototype.$42$=function(c){var p=this.inspector;p&&("pointsEditingMode"===c.property?p.filterPropertiesLater():"shapePointStatus"===c.property&&p.editingPointButtons&&p.editingPointButtons.forEach(function(p){p.setSelected(p.statusValue===c.newValue),p.setBorderColor(p.isSelected()?Jp.config.color_line:null)}))},p.prototype.$6$=function(c){this.dataModel&&(this.dataModel.removeDataModelChangeListener(this.handleDataModelChange,this),this.dataModel.removePropertyChangeListener(this.handleDataModelPropertyChange,this),this.dataModel.removeDataPropertyChangeListener(this.handleDataPropertyChange,this),this.dataModel.sm().ums(this.handleSelectionChange,this),this.currentView.graphView.getEditInteractor().ump(this.$42$,this)),c?(this.currentView=c.getView(),this.dataModel=this.currentView.dm,this.dataModel.addDataModelChangeListener(this.handleDataModelChange,this),this.dataModel.addPropertyChangeListener(this.handleDataModelPropertyChange,this),this.dataModel.addDataPropertyChangeListener(this.handleDataPropertyChange,this),this.dataModel.sm().ms(this.handleSelectionChange,this),this.currentView.graphView.getEditInteractor().mp(this.$42$,this)):(this.currentView=null,this.dataModel=null),this.$95$()},p.prototype.$95$=function(){var c=this;this._updateInspectorLater||(this._updateInspectorLater=!0,requestAnimationFrame(function(){c.updateInspector()}))},p.prototype.getDataOfDisplayInspector=function(c){return c instanceof ht.Shape?this.htShapeInspector:c instanceof ht.Edge?this.htEdgeInspector:c instanceof ht.Group?this.htGroupInspector:c instanceof ht.Text?this.htTextInspector:c instanceof ht.RefGraph?this.htRefGraphInspector:c instanceof ht.Block?this.htBlockInspector:c instanceof ht.Node?this.htNodeInspector:this.htDataInspector},p.prototype.getCompOfSymbolInspector=function(c){if(c instanceof sQ)return this.clipInspector;if(c instanceof hQ)return this.restoreInspector;if(c instanceof RQ)return this.basicInspector;if(c instanceof nr)return this.borderInspector;if(c instanceof bQ)return this.imageInspector;if(c instanceof yr)return this.pieChartInspector;if(c instanceof Xr){var p=Mc(c.s("chart.series"));return p&&p.length<=1&&p[0].colors?this.oneDimensionalColumnChartInspector:this.columnChartInspector}return c instanceof Wr?this.lineChartInspector:c instanceof tQ?this.shapeInspector:c instanceof YQ?this.textInspector:c instanceof dr?this.funcTypeInspector:c instanceof ir?this.compTypeInspector:null},p.prototype.updateInspector=function(){if(this._updateInspectorLater=!1,this.dataModel){var c=this.dataModel.sm().ld();c?this.currentView instanceof tr?this.inspector=this.getCompOfSymbolInspector(c):this.currentView instanceof fr?this.inspector=this.getDataOfDisplayInspector(c):this.currentView instanceof Jp.SceneView&&(this.inspector=this.getDataOfSceneInspector(c)):this.currentView instanceof tr?this.inspector=this.symbolInspector:this.currentView instanceof fr?this.inspector=this.displayInspector:this.currentView instanceof Jp.SceneView&&(this.inspector=this.sceneInspector)}else this.inspector=null},Ap(p,[{key:"basicInspector",get:function(){return this._basicInspector||(this._basicInspector=new li(this.editor,"basic")),this._basicInspector}},{key:"borderInspector",get:function(){return this._borderInspector||(this._borderInspector=new Ei(this.editor,"border")),this._borderInspector}},{key:"clipInspector",get:function(){return this._clipInspector||(this._clipInspector=new Yi(this.editor,"clip")),this._clipInspector}},{key:"restoreInspector",get:function(){return this._restoreInspector||(this._restoreInspector=new si(this.editor,"restore")),this._restoreInspector}},{key:"imageInspector",get:function(){return this._imageInspector||(this._imageInspector=new ji(this.editor,"image")),this._imageInspector}},{key:"pieChartInspector",get:function(){return this._pieChartInspector||(this._pieChartInspector=new fi(this.editor,"pieChart")),this._pieChartInspector}},{key:"oneDimensionalColumnChartInspector",get:function(){return this._oneDimensionalColumnChartInspector||(this._oneDimensionalColumnChartInspector=new Ii(this.editor,"oneDimensionalColumnChartInspector")),this._oneDimensionalColumnChartInspector}},{key:"columnChartInspector",get:function(){return this._columnChartInspector||(this._columnChartInspector=new ei(this.editor,"columnChart")),this._columnChartInspector}},{key:"lineChartInspector",get:function(){return this._lineChartInspector||(this._lineChartInspector=new Pi(this.editor,"lineChart")),this._lineChartInspector}},{key:"shapeInspector",get:function(){return this._shapeInspector||(this._shapeInspector=new di(this.editor,"shape")),this._shapeInspector}},{key:"textInspector",get:function(){return this._textInspector||(this._textInspector=new Ri(this.editor,"text")),this._textInspector}},{key:"funcTypeInspector",get:function(){return this._funcTypeInspector||(this._funcTypeInspector=new ti(this.editor,"func")),this._funcTypeInspector}},{key:"compTypeInspector",get:function(){return this._compTypeInspector||(this._compTypeInspector=new bi(this.editor,"comp")),this._compTypeInspector}},{key:"htShapeInspector",get:function(){return this._htShapeInspector||(this._htShapeInspector=new yi(this.editor,"Shape")),this._htShapeInspector}},{key:"htBlockInspector",get:function(){return this._htBlockInspector||(this._htBlockInspector=new Xi(this.editor,"Block")),this._htBlockInspector}},{key:"htRefGraphInspector",get:function(){return this._htRefGraphInspector||(this._htRefGraphInspector=new Wi(this.editor,"RefGraph")),this._htRefGraphInspector}},{key:"htGroupInspector",get:function(){return this._htGroupInspector||(this._htGroupInspector=new ni(this.editor,"Group")),this._htGroupInspector}},{key:"htEdgeInspector",get:function(){return this._htEdgeInspector||(this._htEdgeInspector=new ii(this.editor,"Edge")),this._htEdgeInspector}},{key:"htNodeInspector",get:function(){return this._htNodeInspector||(this._htNodeInspector=new pi(this.editor,"Node")),this._htNodeInspector}},{key:"htTextInspector",get:function(){return this._htTextInspector||(this._htTextInspector=new Zi(this.editor,"Text")),this._htTextInspector}},{key:"htDataInspector",get:function(){return this._htDataInspector||(this._htDataInspector=new Cr(this.editor,"Data")),this._htDataInspector}},{key:"displayInspector",get:function(){return this._displayInspector||(this._displayInspector=new gr(this.editor,"display")),this._displayInspector}},{key:"symbolInspector",get:function(){return this._symbolInspector||(this._symbolInspector=new Jr(this.editor,"symbol")),this._symbolInspector}},{key:"inspector",get:function(){return this.getCenterView()},set:function(c){var p=this.getCenterView();c?(c.dataModel=this.dataModel,this.dataModel&&(c.data=this.dataModel.sm().ld()),this.getCenterView()!==c&&this.setCenterView(c),c.filterPropertiesLater()):this.setCenterView(null),c===p||null==c&&null==p||this.editor.fireEvent("inspectorUpdated",{inspector:c,oldInspector:p})}}]),p}(FQ),Fi=function(){function c(p){Tp(this,c),this.editor=p}return c.prototype.showTip=function(c,p){this.tip.innerHTML=c,this.tip.parentNode!==document.body&&ht.Default.appendToScreen(this.tip);var Q=Y(p);this.tip.style.left=Q.x+15+"px",this.tip.style.top=Q.y+"px"},c.prototype.hideTip=function(){O(this.tip)},c.prototype.clearDropView=function(c,p){this._dropView&&(this._dropView.handleCrossDrag(c,"exit",p),this._dropView=null)},c.prototype.crossDrag=function(c,p){var Q=this._dropView,r=this.$96$(c,p);Q!==r?(Q&&Q.handleCrossDrag(c,"exit",p),r&&r.handleCrossDrag(c,"enter",p)):r&&r.handleCrossDrag(c,"over",p),this._dropView=r},c.prototype.crossDrop=function(c,p){this._dropView&&(this._dropView.handleCrossDrag(c,"drop",p),this._dropView=null)},c.prototype.crossCancel=function(c,p){this._dropView&&(this._dropView.handleCrossDrag(c,"cancel",p),this._dropView=null)},c.prototype.$96$=function(c,p){for(var Q=b(c);Q&&!(Q._ht&&Q._ht.isDroppable&&Q._ht.isDroppable(c,p));)Q=Q.parentNode;return Q?Q._ht:null},Ap(c,[{key:"tip",get:function(){if(!this._tip){this._tip=z(),this._tip.className="ht-editor-dnd-tip";var c=this._tip.style;c.whiteSpace="nowrap",c.color=Jp.config.color_light,c.background=Jp.config.color_transparent,c.font=ht.Default.labelFont,c.padding="4px",c.borderRadius="4px",c.position="absolute",c.zIndex=1e4}return this._tip}}]),c}(),Bi=function(){function c(p,Q){Tp(this,c),this.editor=p,this.dnd=p.dnd,this._dragInfo={view:this},Q&&(Q.addEventListener("dragenter",this.handle_dragenter.bind(this),!1),Q.addEventListener("dragover",this.handle_dragover.bind(this),!1),Q.addEventListener("dragleave",this.handle_dragleave.bind(this),!1),Q.addEventListener("drop",this.handle_drop.bind(this),!1),Q.addEventListener("dragexit",this.handle_dragexit.bind(this),!1),Q.addEventListener("dragend",this.handle_dragend.bind(this),!1)),this.isDroppableToDisplayView=!0,this.isDroppableToSymbolView=!0}return c.prototype.handle_dragenter=function(c){k(c),c.stopPropagation(),this.dnd.crossDrag(c,this._dragInfo)},c.prototype.handle_dragover=function(c){k(c),c.stopPropagation(),this.dnd.crossDrag(c,this._dragInfo)},c.prototype.handle_dragleave=function(c){k(c),c.stopPropagation(),this.dnd.crossCancel(c,this._dragInfo)},c.prototype.handle_dragexit=function(c){k(c),c.stopPropagation(),this.dnd.crossCancel(c,this._dragInfo)},c.prototype.handle_dragend=function(c){k(c),c.stopPropagation(),this.dnd.crossCancel(c,this._dragInfo)},c.prototype.handle_drop=function(c){k(c),c.stopPropagation(),this.dnd.crossDrop(c,this._dragInfo)},c}(),Di=function(c){function p(Q){Tp(this,p);var r=Sp(this,c.call(this));return r.editor=Q,r}return Np(p,c),p.prototype.init=function(){var c=this,p=this.contentDiv=ht.Default.createDiv();p.style.lineHeight="28px",p.style.textAlign="center",p.style.fontSize="14px",p.style.color=ht.Default.labelColor,this.setConfig({closable:!0,draggable:!0,width:320,height:120,content:p,buttons:[{label:i("editor.yes"),action:function(){c.onYes&&c.onYes(),c.hide()}},{label:i("editor.no"),action:function(){c.onNo&&c.onNo(),c.hide()}},{label:i("editor.cancel"),action:function(){c.hide()}}]}),this._init=!0},p.prototype.show=function(){var p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i("editor.tooltip"),Q=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments[2],n=arguments[3];this._init||this.init(),this.setTitle(p),this.contentDiv.innerHTML=Q,this.onYes=r,this.onNo=n,c.prototype.show.call(this)},p}(vp),Ui=function(){function c(p){Tp(this,c),this.params=p||{},this.$39$=this.params.$39$,this._eventNotifier=new ht.Notifier;var Q=ht.Default.getClass(Jp.config.serviceClass)||OQ;this.$40$=new Q(this.handleServiceEvent.bind(this),this),this.emptyFunc=function(){}}return c.prototype.addEventListener=function(c,p,Q){this._eventNotifier.add(c,p,Q)},c.prototype.removeEventListener=function(c,p){this._eventNotifier.remove(c,p)},c.prototype.fireViewEvent=function(c,p,Q){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];Q=Q||{},c.sceneView?(r&&(p="sceneView"+p),Q.sceneView=c.sceneView):"symbol"===c.type?(r&&(p="symbolView"+p),Q.symbolView=c):"display"===c.type?(r&&(p="displayView"+p),Q.displayView=c):"scene"===c.type&&(r&&(p="sceneView"+p),Q.sceneView=c),this.fireEvent(p,Q)},c.prototype.fireEvent=function(c,p){p=p||{},Jp.config.handleEvent&&Jp.config.handleEvent(this,c,p);var Q="on"+c.charAt(0).toUpperCase()+c.slice(1);Jp.config[Q]&&Jp.config[Q](this,p),this.params&&this.params[Q]&&this.params[Q](this,p),this._eventNotifier.fire({editor:this,type:c,params:p})},c.prototype.handleServiceEvent=function(c){if("connected"===c.type)this.init&&(this.init(),this.init=null);else if("fileChanged"===c.type){var p=c.path;B(p)&&this.$101$(),J(p)?this.requestDisplays():C(p)?this.requestSymbols():cc(p)?this.requestComponents():pc(p)?this.requestScenes():Qc(p)?this.requestModels():rc(p)&&this.requestAssets()}else"download"===c.type?this.downloadFile(c.path):"confirm"===c.type&&this.requestImport(c.path);this.fireEvent(c.type,c)},c.prototype.onPropertyChanged=function(c){"rulerEnabled"!==c.property&&"gridEnabled"!==c.property||this.rightToolbar.iv()},c.prototype.init=function(){this._inspectorCompact=!y(Jp.config.compactFilter),this.menus=[],this.cloneInfo={type:null,funcArray:[],jsonArray:[]},this.initSID(),this.$7$(),this.requestDisplays(),this.requestSymbols(),this.requestComponents(),this.requestScenes(),this.requestModels(),this.requestAssets(),this.$39$&&this.$39$.addEventListener("keydown",this.handleKeydown.bind(this),!1),this.dnd=new Fi(this),this.dndFromOutside=new Bi(this,this.$39$),this.fireEvent("editorCreated"),this.fireEvent("mainMenuCreated"),this.fireEvent("mainToolbarCreated"),this.fireEvent("rightToolbarCreated");var c=this.params.open||p("hteditor");c&&(nc(c)?this._pendingOpenJSON=c:"newdisplay"===c?this.newDisplayView():"newsymbol"===c?this.newSymbolView():"newcomponent"===c&&this.newComponent())},c.prototype.$7$=function(){this.mainTabView=new br(this),this.funcView=new Lr(this),this.eventView=new Hr(this),this.functionView=new Or(this),this.objectView=new Mr(this),this.textView=new Kr(this),this.fontView=new xr(this),this.iconsView=new Vr(this),this.componentView=new _r(this),this.messageView=new Tr(this),this.confirmView=new Di(this),this.attachPointsView=new Ar(this),this.fontConverterOptionView=new Nr(this),this.$8$(),this.$9$(),this.$11$(),this.$10$(),this.leftSplitView=new _Q(this.leftTopTabView,this.mainTabView,"h",Jp.config.leftSplitViewPosition),this.rightSplitView=new _Q(this.rightTopBorderPane,this.rightBottomTabView,"v",Jp.config.rightSplitViewPosition),this.mainSplitView=new _Q(this.leftSplitView,this.rightSplitView,"h",Jp.config.mainSplitViewPosition),this.mainPane=new FQ,this.mainPane.setTopView(this.topBorderPane),this.mainPane.setCenterView(this.mainSplitView),Cc(this.mainPane,this.$39$),this.mainPane.validateImpl()},c.prototype.initSID=function(){var c=window.location.href.match("sid=([0-9a-z-]*)");c&&(this.sid=c[1])},c.prototype.$8$=function(){var c=this;this.mainToolbar=new Ur(this),this.rightToolbar=new ar(this),this.topBorderPane=new FQ,this.topBorderPane.setCenterView(this.mainToolbar),this.topBorderPane.setRightView(this.rightToolbar),
this.topBorderPane.setHeight(28),this.rightToolbar.onSumWidthChanged=function(){c.topBorderPane.setRightWidth(c.rightToolbar.getSumWidth())}},c.prototype.$9$=function(){this.displays=new vQ(this,Jp.config.displaysEditable),this.symbols=new gQ(this,Jp.config.symbolsEditable),this.components=new kQ(this,Jp.config.componentsEditable),this.scenes=new JQ(this,Jp.config.scenesEditable),this.models=new CQ(this,Jp.config.modelsEditable),this.assets=new cr(this,Jp.config.assetsEditable),this.leftTopTabView=new $Q,this.scenesTab=this.leftTopTabView.add(i("editor.scenes"),this.scenes,!1,Jp.config.scenesVisible),this.displaysTab=this.leftTopTabView.add(i("editor.displays"),this.displays,!1,Jp.config.displaysVisible),this.symbolsTab=this.leftTopTabView.add(i("editor.symbols"),this.symbols,!1,Jp.config.symbolsVisible),this.componentsTab=this.leftTopTabView.add(i("editor.components"),this.components,!1,Jp.config.componentsVisible),this.modelsTab=this.leftTopTabView.add(i("editor.models"),this.models,!1,Jp.config.modelsVisible),this.assetsTab=this.leftTopTabView.add(i("editor.assets"),this.assets,!1,Jp.config.assetsVisible),this.leftTopTabView.select(Jp.config.scenesVisible?this.scenesTab:this.displaysTab)},c.prototype.$10$=function(){this.inspectorTool=new Yr(this),this.inspectorPane=new hi(this),this.rightTopBorderPane=new FQ,this.rightTopBorderPane.setTopView(this.inspectorTool),this.rightTopBorderPane.setCenterView(this.inspectorPane),this.rightTopBorderPane.setTopHeight(ht.Default.widgetHeaderHeight+6)},c.prototype.$11$=function(){var c=this;this.listPane=new hr(this),this.layerPane=new Fr(this),this.overview=new pr(this),this.dataView=new sr(this),this.symbolStatePane=new Br(this),this.rightBottomTabView=new $Q,this.listPaneTab=this.rightBottomTabView.add(i("editor.list"),this.listPane,!0),this.layerTab=this.rightBottomTabView.add(i("editor.layer"),this.layerPane,!1,!1),this.symbolStateTab=this.rightBottomTabView.add(i("editor.state"),this.symbolStatePane,!1,!1),this.overviewTab=this.rightBottomTabView.add(i("editor.overview"),this.overview),this.dataViewTab=this.rightBottomTabView.add(i("editor.data"),this.dataView);var p=this.rightBottomTabView.getTabModel().sm();p.ms(function(){var Q=p.ld();c.dataView.visible=Q.getView()===c.dataView,c.overview.setAutoUpdate(Q.getView()===c.overview)})},c.prototype.newFolder=function(c){var p=this,Q=this.explorer;if(Q){var r=c.sm().ld();c!==c.explorer.list||r&&r.fileType===QQ||(r=c.explorer.tree.sm().ld()),r&&!Q.isAccordionMode()||(r=c.explorer.rootNode);Ac(i("editor.inputnewfoldername"),"",{nullable:!1,trim:!0,maxLength:Jp.config.maxFileNameLength,checkFunc:Jp.config.checkFileName},function(c,n){if("ok"===n){var y=(r?r.url:Q.rootDir)+"/"+c;if(p.getFileNode(y))return void Nc(i("editor.filenameconflict"),y,function(){});p.request("mkdir",y,function(c){})}})}},c.prototype.getFileNode=function(c){for(var p=this.leftTopTabView.getTabModel().getDatas(),Q=0;Q<p.size();Q++){var r=p.get(Q);if(r.getView()instanceof SQ){var i=r.getView().dataModel.getDataById(c);if(i)return i}}return null},c.prototype.selectFileNode=function(c){for(var p=this,Q=this.leftTopTabView.getTabModel().getDatas(),r=0;r<Q.size();r++){var i=Q.get(r);if(i.isVisible()&&i.getView()instanceof SQ){var n=function(){var Q=i.getView(),r=Q.dataModel.getDataById(c);if(r)return p.leftTopTabView.getTabModel().sm().ss(i),Q.isAccordionMode()?(r.fileType===QQ?Q.accordion.sm().ss(r):(r.getParent().expanded=!0,Q.accordion.sm().ss(r)),Q.accordion.ivm()):r.fileType===QQ?(Q.tree.sm().ss(r),setTimeout(function(){Q.tree.makeVisible(r)},500)):(Q.tree.sm().ss(r.getParent()),Q.list.sm().ss(r),setTimeout(function(){Q.tree.makeVisible(r.getParent()),Q.list.makeVisible(r)},500)),delete p._pendingSelectURL,{v:void 0}}();if("object"==typeof n)return n.v}}this._pendingSelectURL=c},c.prototype.renameFile=function(c,p,r){var n=this;if(!c||c.$34$||!1===c.a("editable")||!p)return!1;var y=p;nc(c.getName())&&!nc(p)&&(p+=".json");var X=c.path+"/"+p;if(!(p=Jp.config.checkFileName(p,X)))return Nc(i("editor.invalidinput"),y,function(){}),!1;if(p.length>Jp.config.maxFileNameLength+5)return Nc(i("editor.inputmax"),p,function(){}),!1;if(c.getName()===p)return!1;if(this.getFileNode(X))return Nc(i("editor.filenameconflict"),X,function(){}),!1;c.$34$=X;var W={old:c.url,new:c.$34$,fileType:c.fileType};nc(W.old)&&this.request("rename",{old:fc(W.old),new:fc(W.new),fileType:rQ},function(c){}),this.request("rename",W,function(i){if(i){n.mainTabView.getTabModel().each(function(Q){Q.getTag()===c.url&&(Q.setTag(c.$34$),Q.getView().url=c.$34$,Q.setName(_(p)))}),r();var y=Q(W);return y.data=c,n.fireEvent("fileRenamed",y),!0}return delete c.$34$,!1})},c.prototype.moveFile=function(c,p){if(c&&!1!==c.a("editable")&&p&&!c.$34$&&!p.$34$){var Q={data:c,url:c.url,parent:p};if(this.fireEvent("fileMoving",Q),!Q.preventDefault){var r=c.getParent();if(c.setParent(p),r!==c.getParent()){c.$34$=p.url+"/"+c.getName();var i={old:c.url,new:c.$34$};nc(i.old)&&this.request("rename",{old:fc(i.old),new:fc(i.new)},function(c){}),this.request("rename",i,function(c){})}}}},c.prototype.removeFiles=function(c){var p=this;c.forEach(function(c){if(!c.$34$&&!1!==c.a("editable")){var Q=c.url||c;nc(Q)&&p.request("remove",fc(Q),function(c){}),p.request("remove",Q,function(r){p.fireEvent("fileDeleted",{data:c,url:Q})})}})},c.prototype.requestBase64=function(c,p){this.request("source",{url:c,encoding:"base64",prefix:"data:;base64,"},p)},c.prototype.request=function(c,p,Q,r){var i=this;Q=Q||this.emptyFunc,r?setTimeout(function(){i.$40$.request(c,p,Q)},r):this.$40$.request(c,p,Q)},c.prototype.requestDisplays=function(){var c=this;this._requestingDisplays||(this.request("explore","/displays",function(p){c._requestingDisplays=!1,c.displays.parse(p),c._pendingOpenJSON&&J(c._pendingOpenJSON)&&(c.displays.dataModel.getDataById(c._pendingOpenJSON)?(c.open(c._pendingOpenJSON),c.selectFileNode(c._pendingOpenJSON)):Jp.config.newIfFailToOpen&&(c.newDisplayView(),c.save(null,c._pendingOpenJSON)),delete c._pendingOpenJSON),c._pendingSelectURL&&J(c._pendingSelectURL)&&c.selectFileNode(c._pendingSelectURL)},Jp.config.requestDelay),this._requestingDisplays=!0)},c.prototype.requestSymbols=function(){var c=this;this._requestingSymbols||(this.request("explore","/symbols",function(p){c._requestingSymbols=!1,c.symbols.parse(p),c._pendingOpenJSON&&C(c._pendingOpenJSON)&&(c.symbols.dataModel.getDataById(c._pendingOpenJSON)?(c.open(c._pendingOpenJSON),c.selectFileNode(c._pendingOpenJSON)):Jp.config.newIfFailToOpen&&(c.newSymbolView(),c.save(null,c._pendingOpenJSON)),delete c._pendingOpenJSON),c._pendingSelectURL&&C(c._pendingSelectURL)&&c.selectFileNode(c._pendingSelectURL)},Jp.config.requestDelay),this._requestingSymbols=!0)},c.prototype.requestComponents=function(){var c=this;this._requestingComponents||(this.request("explore","/components",function(p){c._requestingComponents=!1,c.components.parse(p),c._pendingOpenJSON&&cc(c._pendingOpenJSON)&&(c.components.dataModel.getDataById(c._pendingOpenJSON)?c.open(c._pendingOpenJSON):Jp.config.newIfFailToOpen&&c.newComponent(),delete c._pendingOpenJSON),c._pendingSelectURL&&cc(c._pendingSelectURL)&&c.selectFileNode(c._pendingSelectURL)},Jp.config.requestDelay),this._requestingComponents=!0)},c.prototype.requestScenes=function(){var c=this;this._requestingScenes||(this.request("explore","/scenes",function(p){c._requestingScenes=!1,c.scenes.parse(p),c._pendingOpenJSON&&pc(c._pendingOpenJSON)&&(c.open(c._pendingOpenJSON),delete c._pendingOpenJSON),c._pendingSelectURL&&pc(c._pendingSelectURL)&&c.selectFileNode(c._pendingSelectURL)},Jp.config.requestDelay),this._requestingScenes=!0)},c.prototype.requestModels=function(){var c=this;this._requestingModels||(this.request("explore","/models",function(p){c._requestingModels=!1,c.models.parse(p),c._pendingOpenJSON&&Qc(c._pendingOpenJSON)&&(c.open(c._pendingOpenJSON),delete c._pendingOpenJSON),c._pendingSelectURL&&Qc(c._pendingSelectURL)&&c.selectFileNode(c._pendingSelectURL)},Jp.config.requestDelay),this._requestingModels=!0)},c.prototype.requestAssets=function(){var c=this;this._requestingAssets||(this.request("explore","/assets",function(p){c._requestingAssets=!1,c.assets.parse(p),c._pendingOpenJSON&&rc(c._pendingOpenJSON)&&(c.open(c._pendingOpenJSON),delete c._pendingOpenJSON),c._pendingSelectURL&&rc(c._pendingSelectURL)&&c.selectFileNode(c._pendingSelectURL)},Jp.config.requestDelay),this._requestingAssets=!0)},c.prototype.requestImport=function(c){var p=this;Jp.config.importConfirm?Nc("",i("editor.importconfirm"),function(){p.request("import",{path:c,move:!0})},function(){p.request("import",{path:c,move:!1})}):this.request("import",{path:c,move:!0})},c.prototype.downloadFile=function(c){try{var p=document.createElement("iframe");p.src=c,p.style.display="none",document.body.appendChild(p)}catch(c){}},c.prototype.$6$=function(c){var p=this._currentTab,Q=this.rightBottomTabView.getTabModel().sm();this._currentTab=c,this.inspectorPane.$6$(c),this.listPane.$6$(c),this.overview.$6$(c),this.dataView.$6$(c),this.layerPane.$6$(c),this.mainToolbar.$6$(c),this.rightToolbar.$6$(c),this.inspectorTool.$6$(c),this.symbolStatePane.$6$(c),this.layerTab.setVisible(!!this.displayView||!!this.sceneView),this.symbolStateTab.setVisible(!!this.symbolView),(!this.symbolView&&Q.co(this.symbolStateTab)||this.symbolView&&Q.co(this.layerTab)||!c&&(Q.co(this.symbolStateTab)||Q.co(this.layerTab)))&&Q.ss(this.listPaneTab),this.fireEvent("tabUpdated",{tab:c,oldTab:p})},c.prototype.beginTransaction=function(){this.dm&&this.dm.beginTransaction()},c.prototype.endTransaction=function(){this.dm&&this.dm.endTransaction()},c.prototype.$101$=function(){this.mainTabView.$101$()},c.prototype.dropLocalFileOnGraphView=function(c){if(this.currentView){var p={event:c};if(this.fireViewEvent(this.currentView,"OutsideDropping",p),!p.preventDefault)for(var Q=c.dataTransfer.files,r=0;r<Q.length;r++){var i=Q[r],n=i.name;ic(n)?this.insertLocalImageFile(c,i):nc(n)&&this.insertLocalJSONFile(c,i)}}},c.prototype.insertLocalImageFile=function(c,p){var Q=this,r=this.gv.lp(c);Jc(p,function(c){if(Q.displayView){var i=new ht.Node;i.setImage(c),i.p(r),i.setDisplayName(w(p.name)),Q.displayView.addData(i)}else if(Q.symbolView){var n=new bQ({type:"image",name:c,rect:[r.x,r.y,-1,-1]});n.setDisplayName(w(p.name)),Q.symbolView.addData(n)}},!0)},c.prototype.insertLocalJSONFile=function(c,p){var Q=this;Jc(p,function(p){Q.$99$(p,Q.currentView.graphView.lp(c))})},c.prototype.dropLocalFileOnDir=function(c,p){for(var Q=c.dataTransfer.files,r=p.url,n=0;n<Q.length;n++){var y=Q[n].name;if(!Jp.config.checkFileName(y,r+"/"+y))return void Nc(i("editor.invalidfilename"),y,function(){})}for(var X=0;X<Q.length;X++)this.uploadLocalFile(Q[X],r)},c.prototype.uploadLocalFile=function(c,p){var Q=this,r=Jp.config.checkFileName(c.name,p+"/"+c.name);r&&Jc(c,function(c){var i={path:p+"/"+r,content:c};Q.request("upload",i)},!0)},c.prototype.addTab=function(c,p){this.mainTabView.add(c),this.fireEvent("tabCreated",{tab:c}),p&&this.mainTabView.getTabModel().sm().ss(c),this.mainTabView.validate()},c.prototype.openByJSON=function(c,p,Q,r,i){this.mainTabView.getTabModel();if(c===nQ){var n=this.mainTabView.getTabModel().getDataByTag(p);n||(n=new ht.Tab,n.setTag(p),n.setIcon("editor.display"),n.setClosable(!0),n.setName(Q),new fr(this,n,p,r),this.addTab(n)),this.mainTabView.getTabModel().sm().ss(n)}else if(c===iQ){var y=this.mainTabView.getTabModel().getDataByTag(p);y||(y=new ht.Tab,y.setTag(p),y.setIcon("editor.symbol"),y.setClosable(!0),y.setName(Q),new tr(this,y,p,r),this.addTab(y)),this.mainTabView.getTabModel().sm().ss(y)}else c===yQ&&this.componentView.update(p,i,Q,r)},c.prototype.isOpenable=function(c){return!Jp.config.isOpenable||Jp.config.isOpenable(c)},c.prototype.open=function(c,p){var Q=this;Ic(c)&&(c=this.getFileNode(c)),c&&!c.$34$&&this.isOpenable(c)&&(c.fileType===nQ||c.fileType===iQ||c.fileType===WQ?this.mainTabView.open(c):c.fileType===yQ?this.componentView.open(c):c.fileType===rQ&&(Wc(c.url)?M(c.url,function(r){var i=ht.Default.svgToShape(r,{segments:Jp.config.svgSegments});setTimeout(function(){var r=_(c.getName());p?Q.newSymbolView(r,!1):Q.newDisplayView(r),i.output.comps.forEach(function(c){delete c.repeatImage}),Q.beginTransaction(),Jp.toDatas(i.output.comps,p).forEach(function(c){Q.currentView.addData(c,!0)}),p&&(i.output.width&&Q.dm.a("width",i.output.width),i.output.height&&Q.dm.a("height",i.output.height)),Q.zoomToFit(),Q.endTransaction()},Jp.config.svgWaitingTime)}):Zc(c.url)?M(c.url,function(r){var i=_(c.getName()),n=ht.Default.cadToShape(r,{boundingType:p?Jp.config.cadToSymbolBoundingType:Jp.config.cadToDisplayBoundingType}),y={},X=Object.keys(n.blockDef).length,W=function(){p?Q.newSymbolView(i,!1):Q.newDisplayView(i),Q.beginTransaction(),n.comps.forEach(function(c){"image"===c.type&&y[c.name]&&(c.name=y[c.name])}),Jp.toDatas(n.comps,p).forEach(function(c){Q.currentView.addData(c,!0)}),p&&(n.width&&Q.dm.a("width",n.width),n.height&&Q.dm.a("height",n.height)),Q.zoomToFit(),Q.endTransaction()};X?function(){var p=function(){0===--X&&W()},r="symbols/"+c.path.substr("assets/".length)+"/"+i+"/";for(var Z in n.blockDef){n.blockDef[Z].comps.forEach(function(c){"image"===c.type&&(c.name=r+c.name+".json")});var o={path:y[Z]=r+Z+".json",content:U(n.blockDef[Z])};Q.request("upload",o,p)}}():W()}):(jc(c.url)||Ec(c.url))&&M(c.url,function(p){Q.fontConverterOptionView.open(function(r){ht.Default.fontToShape(p,r,function(p){var r=_(c.getName());Q.newSymbolView(r,!1),Q.beginTransaction(),Q.currentView.update(ht.Default.stringify(p)),Q.endTransaction(),Q.currentView.dirty=!0})})},{responseType:"arraybuffer"})))},c.prototype.$99$=function(c,p){var Q=this;if(c){if(this.beginTransaction(),c=a(c),this.displayView&&Pc(c.d)){var r=this.displayView.graphView;this.displayView.isDeserializing=!0;var i=r.dm().deserialize(c,r.getCurrentSubGraph(),{justDatas:!0,disableOnPreDeserialize:!0,disableOnPostDeserialize:!0});if(this.displayView.isDeserializing=!1,r.sm().ss(i.toList(r.isSelectable,r)),i.each(function(c){Q.displayView.addData(c,!0,!0)}),p){var n=r.getUnionNodeRect(i.toArray());r.moveDatas(i,p.x-n.x-n.width/2,p.y-n.y-n.height/2)}}else this.symbolView&&Pc(c.comps)&&c.comps.forEach(function(c){Up(c,Q.symbolView)});this.gv.setFocus(),this.endTransaction()}},c.prototype.$100$=function(c,p){var Q=this;if(c){if(!this.tab)return void this.open(c);if(this.editable)if(c.fileType!==nQ){if(this.url!==c.url)if(c.fileType!==yQ){if(c.fileType!==iQ&&!ic(c.url))return c.fileType===WQ?void(this.displayView&&Jp.config.handleInsertSceneFileToDisplayView&&Jp.config.handleInsertSceneFileToDisplayView(this.displayView,c,p)):c.fileType===XQ?void(this.displayView&&Jp.config.handleInsertModelFileToDisplayView&&Jp.config.handleInsertModelFileToDisplayView(this.displayView,c,p)):void 0;if(this.displayView){var r=new ht.Node;if(r.setImage(c.getFileUUID()),p)r.p(p.x,p.y);else{var i=this.gv.getViewRect();i&&r.p(i.x+i.width/2,i.y+i.height/2)}r.setDisplayName(w(c.url)),this.displayView.addData(r)}else if(this.symbolView){var n=ht.Default.getImage(c.getFileUUID()),y=n?n.width:-1,X=n?n.height:-1,W=p?p.x:(this.dm.a("width")||0)/2,Z=p?p.y:(this.dm.a("height")||0)/2,o=new bQ({type:"image",name:c.getFileUUID(),rect:[W-(y>0?y/2:0),Z-(X>0?X/2:0),y,X]});o.setDisplayName(w(c.url)),this.symbolView.addData(o)}}else if(this.symbolView){var l=new ir({type:c.getFileUUID(),rect:[p?p.x:(this.dm.a("width")||0)/2,p?p.y:(this.dm.a("height")||0)/2,-1,-1]},void 0,void 0,!0);l.setDisplayName(w(c.url)),this.symbolView.addData(l)}}else if(this.displayView)if(Jp.config.insertDisplayViewAsRefGraph){var j=new ht.RefGraph;j.setRef(c.getFileUUID()),j.onPendingUpdated=function(){j.onPendingUpdated=null,j.p(p)},j.setDisplayName(w(c.url)),this.displayView.addData(j)}else M(c.url,function(c){Q.$99$(c,p)})}},c.prototype.newDisplayView=function(c){return this.mainTabView.newDisplayView(c)},c.prototype.newSymbolView=function(c,p){return this.mainTabView.newSymbolView(c,p)},c.prototype.newComponent=function(c){this.componentView.open(null,c)},c.prototype.save=function(c,p){if(mQ){var Q=document.activeElement;Q&&Q.blur&&Q.blur()}this.mainTabView.save(c,p)},c.prototype.saveAll=function(c){this.mainTabView.saveAll(c)},c.prototype.reload=function(){this.mainTabView.reload()},c.prototype.preview=function(){this.mainTabView.preview()},c.prototype.closeTab=function(c,p,Q){this.mainTabView.closeTab(c,p,Q)},c.prototype.closeOtherTabs=function(c,p){this.mainTabView.closeOtherTabs(c,p)},c.prototype.closeTabsToTheRight=function(c,p){this.mainTabView.closeTabsToTheRight(c,p)},c.prototype.closeAllTabs=function(c,p){this.mainTabView.closeAllTabs(c,p)},c.prototype.filterProperties=function(){this.inspector&&this.inspector.filterPropertiesLater()},c.prototype.isRulerEnabled=function(){return this._rulerEnabled},c.prototype.setRulerEnabled=function(c){var p=this._rulerEnabled;p!==c&&(this._rulerEnabled=c,this.tabs.forEach(function(p){p.getView().setRulerEnabled(c)}),this.fp("rulerEnabled",p,c))},c.prototype.toggleRulerEnabled=function(){this.setRulerEnabled(!this.isRulerEnabled())},c.prototype.isGridEnabled=function(){return this._gridEnabled},c.prototype.setGridEnabled=function(c){var p=this._gridEnabled;p!==c&&(this._gridEnabled=c,this.tabs.forEach(function(p){p.getView().setGridEnabled(c)}),this.fp("gridEnabled",p,c))},c.prototype.toggleGridEnabled=function(){this.setGridEnabled(!this.isGridEnabled())},c.prototype.toggleLeft=function(){"normal"===this.leftSplitView.getStatus()?this.leftSplitView.setStatus("cl"):this.leftSplitView.setStatus("normal")},c.prototype.toggleRight=function(){"normal"===this.mainSplitView.getStatus()?this.mainSplitView.setStatus("cr"):this.mainSplitView.setStatus("normal")},c.prototype.toggleBoth=function(){"normal"===this.mainSplitView.getStatus()||"normal"===this.leftSplitView.getStatus()?(this.mainSplitView.setStatus("cr"),this.leftSplitView.setStatus("cl")):(this.mainSplitView.setStatus("normal"),this.leftSplitView.setStatus("normal"))},c.prototype.zoomIn=function(){this.gv&&this.gv.zoomIn(Jp.config.animate)},c.prototype.zoomOut=function(){this.gv&&this.gv.zoomOut(Jp.config.animate)},c.prototype.zoomReset=function(){this.gv&&this.gv.zoomReset(Jp.config.animate)},c.prototype.zoomToFit=function(){this.gv&&this.gv.fitContent(Jp.config.animate,Jp.config.fitPadding)},c.prototype.delete=function(){this.gv&&this.gv.removeSelection()},c.prototype.copyFiles=function(){this.explorer.copyFiles()},c.prototype.pasteFiles=function(){this.explorer.pasteFiles()},c.prototype.copy=function(){var c=this;if(this.ld){var p=this.cloneInfo;if(p.funcArray.length=0,p.jsonArray.length=0,p.offset={x:0,y:0},p.lastCheck=null,p.lastView=this.gv,this.displayView)p.type="display";else{if(!this.symbolView)return void(p.type=null);p.type="symbol"}var Q={};this.selection.forEach(function(c){c._refGraph||(Q[c._id]=c,c instanceof ht.Block&&!(c instanceof ht.RefGraph)&&g(c,Q))});var r=[],i=void 0;this.gv.each(function(c){Q[c._id]&&(r.push(c),c instanceof ht.Node&&(i=i?ht.Default.unionRect(i,c.getRect()):c.getRect()))}),p.rect=i,this.gv.copyMap=Q,r.forEach(function(Q){var r=c.gv.isSelected(Q),i=Q.$51$(c.gv);if(0!==i.length){p.funcArray.push([Q._id,r].concat(i));var n=Bp(Q);n&&p.jsonArray.push([r,n])}}),this.fireEvent("copy",{datas:r,info:p}),this.gv.copyMap=null}},c.prototype.hasCopyInfo=function(){return this.cloneInfo.funcArray.length>0},c.prototype.paste=function(c,p){var Q=this;if(this.editable){var r=this.gv,i=this.cloneInfo;if(i.funcArray.length&&r){var n=[],y=[];if(this.beginTransaction(),ht.Default.setIsolating(!0),"display"===i.type&&this.displayView||"symbol"===i.type&&this.symbolView){var X={},W=[];i.funcArray.forEach(function(c){var p=c[0],i=c[1],Z=c[2],o=c[3],l=o(Z,r);Q.currentView.addData(l,!0),X[p]=l,n.push(l),W.push(Z),i&&y.push(l)});for(var Z=0;Z<n.length;Z++)n[Z].$50$(W[Z],r,X)}else i.jsonArray.length&&i.jsonArray.forEach(function(c){var p=c[0],i=c[1],X=Dp(i,!!Q.symbolView);X&&(X.setParent(r.getCurrentSubGraph()),Q.currentView.addData(X,!0),n.push(X),p&&y.push(X))});if(ht.Default.setIsolating(!1),y.length&&this.sm.ss(y),i.lastView!==r&&(i.offset.x=-Jp.config.pasteOffset,i.offset.y=-Jp.config.pasteOffset),!c&&n.length){if(p){var o=i.rect;i.offset.x=p.x-o.x-o.width/2,i.offset.y=p.y-o.y-o.height/2}else i.offset.x+=Jp.config.pasteOffset,i.offset.y+=Jp.config.pasteOffset;r.moveDatas(n,i.offset.x,i.offset.y);var l=r.$64$(n);l&&(i.offset.x+=l.x,i.offset.y+=l.y,i.lastCheck||(r.moveDatas(n,-Jp.config.pasteOffset,-Jp.config.pasteOffset),i.offset.x-=Jp.config.pasteOffset,i.offset.y-=Jp.config.pasteOffset)),i.lastCheck=l}i.lastView=r,this.fireEvent("paste",{datas:n,info:i}),r.setFocus(),this.endTransaction()}}},c.prototype.block=function(){if(this.editable&&this.displayView){var c=this.selection;if(c.length){this.beginTransaction();var p=new ht.Block;c.forEach(function(c){c.setParent(p)}),this.displayView.addData(p),this.endTransaction()}}},c.prototype.unblock=function(){var c=this;if(this.editable&&this.displayView){this.beginTransaction();var p=[];this.selection.forEach(function(Q){if(Q instanceof ht.Block&&!(Q instanceof ht.RefGraph)){var r=Q.getParent();Q.getChildren().toArray().forEach(function(c){c.setParent(r),p.push(c)}),c.dm.remove(Q)}}),p.length&&(this.sm.ss(p),this.gv.setFocus()),this.endTransaction()}},c.prototype.bringForward=function(){this.editable&&this.dm&&(this.dm.isHierarchicalRendering()?this.dm.moveSelectionDown():this.dm.bringSelectionForward())},c.prototype.bringToFront=function(){this.editable&&this.dm&&(this.dm.isHierarchicalRendering()?this.dm.moveSelectionToBottom():this.dm.bringSelectionToFront())},c.prototype.sendBackward=function(){this.editable&&this.dm&&(this.dm.isHierarchicalRendering()?this.dm.moveSelectionUp():this.dm.sendSelectionBackward())},c.prototype.sendToBack=function(){this.editable&&this.dm&&(this.dm.isHierarchicalRendering()?this.dm.moveSelectionToTop():this.dm.sendSelectionToBack())},c.prototype.undo=function(){this.editable&&this.dm.getHistoryManager()&&this.dm.getHistoryManager().canUndo()&&(this.dm.undo(),this.fireEvent("undo",{}))},c.prototype.redo=function(){this.editable&&this.dm.getHistoryManager()&&this.dm.getHistoryManager().canRedo()&&(this.dm.redo(),this.fireEvent("redo",{}))},c.prototype.distributeHorizontal=function(){this.editable&&this.inspectorTool.distributeHorizontal()},c.prototype.distributeVertical=function(){this.editable&&this.inspectorTool.distributeVertical()},c.prototype.alignLeft=function(){this.editable&&this.inspectorTool.alignLeft()},c.prototype.alignHorizontal=function(){this.editable&&this.inspectorTool.alignHorizontal()},c.prototype.alignRight=function(){this.editable&&this.inspectorTool.alignRight()},c.prototype.alignTop=function(){this.editable&&this.inspectorTool.alignTop()},c.prototype.alignVertical=function(){this.editable&&this.inspectorTool.alignVertical()},c.prototype.alignBottom=function(){this.editable&&this.inspectorTool.alignBottom()},c.prototype.folder=function(){if(this.editable&&this.displayView){this.beginTransaction();var c=new ht.Data;c.s("editor.folder",!0),this.dm.add(c);this.list.getTopRowOrderSelection().each(function(p){c.addChild(p)}),this.sm.ss(c),this.endTransaction()}},c.prototype.unfolder=function(){var c=this;if(this.editable&&this.displayView){this.beginTransaction();var p=this.sm.toSelection(function(c){return c.s("editor.folder")});p.forEach(function(c){c.toChildren().forEach(function(p){p.setParent(c.getParent())})}),p.forEach(function(p){c.dm.remove(p)}),this.endTransaction()}},c.prototype.locate=function(c){c&&this.request("locate",c.url||c)},c.prototype.saveImage=function(c,p,Q){var r=this,i=function(){var i={path:p,content:rp(c)};r.request("upload",i,Q)};if(Ic(c)&&!ht.Default.getImage(c))if(/.json$/.test(c))ht.Default.xhrLoad(c,function(p){p&&(ht.Default.setImage(c,ht.Default.parse(p)),i())});else{var n=new window.Image;n.onload=function(){ht.Default.setImage(c,n),i()},n.src=c}else i()},c.prototype.handleKeydown=function(c){var p=c.keyCode;if(u(c)&&83===p&&c.preventDefault(),fQ.length){if((c.target._ignore||!Tc(c.target))&&!ht.Default.popup){var Q=fQ[fQ.length-1];G(c)&&Q.$49$?Q.$49$():I(c)&&Q.$48$&&Q.$48$()}}else{var r={event:c};if(this.fireEvent("keydown",r),!r.preventDefault){if(u(c)&&83===p)return void this.save();if(!Tc(c.target)){if(c.preventDefault(),G(c)){for(var i=0;i<this.menus.length;i++)if(this.menus[i].isShowing())return void this.menus[i].hide();if(this.funcView.smartClose&&this.funcView.getView().parentNode)return void this.funcView.hide();if(this.iconsView.getView().parentNode)return void this.iconsView.hide();if(this.tab){var n=this.tab.getView().graphView.getInteractors();n&&n.each(function(p){p.$49$&&p.$49$(c)})}}80===p?this.preview():187===p?this.zoomIn():189===p?this.zoomOut():48===p?this.zoomToFit():57===p?this.zoomReset():u(c)&&67===p?this.copy():u(c)&&86===p?this.paste():u(c)&&K(c)&&90===p?this.redo():u(c)&&90===p?this.undo():c.altKey&&u(c)&&221===p?this.bringToFront():c.altKey&&u(c)&&219===p?this.sendToBack():u(c)&&221===p?this.bringForward():u(c)&&219===p&&this.sendBackward()}}}},c.prototype.createDisplayItem=function(c,p,Q,r,i){var n=this,y=function(){return n.displayView&&n.displayView.$4$()===c},X=Sc(c,p,Q,y);return X.visible=function(){return!!n.displayView},X.action=function(){n.displayView&&n.displayView.$5$(c,r,i)},X},c.prototype.createSymbolItem=function(c,p,Q,r,i){var n=this,y=function(){return n.symbolView&&n.symbolView.$4$()===c},X=Sc(c,p,Q,y);return X.visible=function(){return!!n.symbolView},X.action=function(){n.symbolView&&n.symbolView.$5$(c,r,i)},X},c.prototype.showMessage=function(c,p,Q){this.messageView.show(c,p,Q)},c.prototype.showConfirm=function(c,p,Q,r){this.confirmView.show(c,p,Q,r)},c.prototype.batchConvertSVG=function(c){var p=this,Q=[],r=[];c.forEach(function(c){Wc(c.url)&&(Q.push(c.url),r.push(c))});var n=2*Q.length,y=0,X=function(){++y===n&&p.showMessage(yp(i("editor.batchconvertsuccess"),Q.length+""))};M(Q,function(c){c.forEach(function(c,Q){var i=r[Q],n=ht.Default.svgToShape(c,{segments:Jp.config.svgSegments}),y=i.path.replace(/^assets/g,"symbols"),W=i.getName().replace(/svg$/g,"json");setTimeout(function(){p.request("upload",{path:y+"/"+W,content:U(n.output)},X),W=i.getName().replace(/svg$/g,"png"),p.request("upload",{path:y+"/"+W,content:rp(n.output)},X)},Jp.config.svgWaitingTime)})})},Ap(c,[{key:"editable",get:function(){return!!this.currentView&&this.currentView.editable},set:function(c){this.currentView&&(this.currentView.editable=c)}},{key:"dm",get:function(){return this.gv?this.gv.dm():null}},{key:"gv",get:function(){var c=this.mainTabView.getTabModel().sm().ld();return c?c.getView().graphView:null}},{key:"editInteractor",get:function(){return this.gv?this.gv.getEditInteractor():null}},{key:"pointsEditingMode",get:function(){return!!this.editInteractor&&this.editInteractor.pointsEditingMode},set:function(c){this.editInteractor&&(this.editInteractor.pointsEditingMode=c)}},{key:"anchorVisible",get:function(){return!!this.gv&&this.gv.getEditStyle("anchorVisible")},set:function(c){this.gv&&this.gv.setEditStyle("anchorVisible",c)}},{key:"sm",get:function(){return this.gv?this.gv.sm():null}},{key:"ld",get:function(){return this.sm?this.sm.ld():null}},{key:"selection",get:function(){var c=this,p=[];return this.gv&&this.gv.each(function(Q){c.gv.isSelected(Q)&&p.push(Q)}),p}},{key:"tabs",get:function(){return this.mainTabView.tabs}},{key:"inspector",get:function(){return this.inspectorPane.inspector}},{key:"list",get:function(){return this.listPane.list}},{key:"tab",get:function(){return this.mainTabView.currentTab}},{key:"url",get:function(){return this.tab?this.tab.getTag():null}},{key:"explorer",get:function(){return this.leftTopTabView.getCurrentTab().getView()}},{key:"dir",get:function(){return this.explorer?this.explorer.tree.getSelectionModel().getLastData():null}},{key:"file",get:function(){return this.explorer?this.explorer.getFileListView().getSelectionModel().getLastData():null}},{key:"currentLayer",get:function(){return this.layerPane.currentLayer}},{key:"currentView",get:function(){var c=this.tab;return c?c.getView():null}},{key:"displayTree",get:function(){return this.displayView?this.displayView.displayTree:null}},{key:"displayView",get:function(){var c=this.currentView;return c instanceof fr?c:null}},{key:"symbolList",get:function(){return this.symbolView?this.symbolView.symbolList:null}},{key:"symbolView",get:function(){var c=this.currentView;return c instanceof tr?c:null}},{key:"inspectorCompact",get:function(){return this._inspectorCompact},set:function(c){this._inspectorCompact=c,this.filterProperties(),this.inspectorTool.iv()}},{key:"inspectorInputFilter",get:function(){return this.inspectorTool.searchField.getValue()},set:function(c){this.inspectorTool.searchField.setValue(c),this.filterProperties()}}]),c}();v(Ui,{ms_fire:1,_rulerEnabled:Jp.config.rulerEnabled,_gridEnabled:Jp.config.gridEnabled}),Jp.Editor=Ui;var ai=function(){function c(p,Q){var r=this;Tp(this,c),this.editor=Q,this.handler=p,this.cookie=0,this.callbacks={},this.cmds={},this.fileChangeVersion=String((new Date).getTime());var i=Jp.config.host||window.location.hostname,n=Jp.config.port||window.location.port,y=this.url=window.location.protocol+"//"+i+":"+n;setTimeout(function(){r.handler({type:"connected",message:y})},1),Jp.config.checkForFileChanges&&Jp.config.checkForFileChangesInterval&&this.fileChangedEvent()}return c.prototype.request=function(c,p,Q){var r=++this.cookie;this.callbacks[r]=Q,this.cmds[r]=c;var i=this.editor.sid;this[c](r,p,i||null,Q);var n=c;p&&(Ic(p)?n=c+": "+p:p.path&&(n=c+": "+p.path)),this.handler({type:"request",message:n,cmd:c,data:p})},c.prototype.fileChangedEvent=function(){var c=this,p=this.url+"/fileVersion";p+="/"+c.fileChangeVersion,p+="?sid="+this.editor.sid,c.send("GET",p,null,function(p){c.fileChangeVersion=String((new Date).getTime());var Q=p.target.response;if(Q){Q=JSON.parse(Q);Object.keys(Q).forEach(function(p){c.handler({type:"fileChanged",path:p})})}}),setTimeout(function(){c.fileChangedEvent()},Jp.config.checkForFileChangesInterval)},c.prototype.export=function(c,p,Q){var r=this,i=new ht.Request,n={},y=new FormData,X=this.url+"/export";X+="?sid="+Q,y.append("dir",p),n.url=encodeURI(X),n.method="POST",n.data=y,i.setResponseType("blob"),i.onload=function(p){var Q=p.target;if(200==Q.status||0===Q.status){var i=Q.response,n=Q.getResponseHeader("Content-Disposition").split(";"),y=n[1].split("=")[1],X=new Blob([i],{type:"application/zip"}),W=document.createElement("a");W.href=window.URL.createObjectURL(X),W.download=decodeURI(y),W.click(),r.handleRespone(c,!0)}},i.send(n)},c.prototype.mkdir=function(c,p,Q){var r=this,i=new ht.Request,n={},y=new FormData,X=this.url+"/mkdir";X+="?sid="+Q,y.append("path",p),n.url=encodeURI(X),n.method="POST",n.data=y,i.onload=function(Q){var i=Q.target;if(200==i.status||0===i.status){var n=i.response||i.responseText;r.handleRespone(c,"true"===n),r.handler({type:"fileChanged",path:p})}},i.send(n)},c.prototype.explore=function(c,p,Q){var r=this,i=new ht.Request,n={},y=this.url+"/explore";y+=p,y+="?sid="+Q,n.url=encodeURI(y),i.onload=function(p){var Q=p.target;if(200==Q.status||0===Q.status){var i=Q.response||Q.responseText;r.handleRespone(c,JSON.parse(i))}},i.send(n)},c.prototype.upload=function(c,p,Q){var r=this,i=new FormData,n=this.url+"/upload",y=p.path;n+="?sid="+Q,i.append("path",p.path),i.append("content",p.content),r.send("POST",n,i,function(p){var Q=p.target;if(200==Q.status||0===Q.status){var i=Q.response;if(r.handleRespone(c,!0),i){var n=JSON.parse(i);r.handler({type:"confirm",path:n.tempName,datas:n.paths})}else r.handler({type:"fileChanged",path:y})}})},c.prototype.rename=function(c,p,Q){var r=this,i=new FormData,n=p.new,y=p.old,X=this.url+"/rename";X+="?sid="+Q,i.append("newPath",n),i.append("oldPath",y),r.send("POST",X,i,function(p){var Q=p.target;if(200==Q.status||0===Q.status){var i=Q.response||Q.responseText;r.handleRespone(c,"true"===i),"true"===i&&(r.handler({
type:"fileChanged",path:n}),r.handler({type:"fileChanged",path:y}))}})},c.prototype.remove=function(c,p,Q){var r=this,i=new FormData,n=this.url+"/remove";n+="?sid="+Q,i.append("path",p),r.send("POST",n,i,function(Q){var i=Q.target;if(200==i.status||0===i.status){var n=i.response||i.responseText;r.handleRespone(c,"true"===n),"true"===n&&r.handler({type:"fileChanged",path:p})}})},c.prototype.locate=function(c,p,Q){var r=this,i=this.url+"/locate";i+="?dir="+p,i+="&sid="+Q,r.send("GET",i,null,function(p){var Q=p.target;200!=Q.status&&0!=Q.status||r.handleRespone(c,!0)})},c.prototype.open=function(c,p,Q){var r=this,i=this.url+"/open";i+="?url="+p,i+="&sid="+Q,r.send("GET",i,null,function(p){var Q=p.target;200!=Q.status&&0!=Q.status||r.handleRespone(c,!0)})},c.prototype.source=function(c,p,Q){var r=this,i=new FormData,n=this.url+"/source";n+="?sid="+Q,i.append("url",p.url),i.append("encoding",p.encoding),i.append("prefix",p.prefix),r.send("POST",n,i,function(p){var Q=p.target;if(200==Q.status||0===Q.status){var i=Q.response||Q.responseText;r.handleRespone(c,i)}})},c.prototype.import=function(c,p,Q){var r=this,i=new FormData,n=this.url+"/import";n+="?sid="+Q,i.append("path",p.path),i.append("move",p.move),r.send("POST",n,i,function(p){var Q=p.target;200!=Q.status&&0!==Q.status||r.handleRespone(c,!0)})},c.prototype.send=function(c,p,Q,r){var i=new ht.Request,n={};n.url=encodeURI(p),n.method=c,n.data=Q,r&&(i.onload=r),i.send(n)},c.prototype.handleRespone=function(c,p){var Q=this.callbacks[c],r=this.cmds[c];delete this.callbacks[c],delete this.cmds[c],this.handler({type:"response",message:r,cmd:r,data:p}),Q&&Q(p)},c}();return Jp.config.logEditorInfo&&console.log("HT Editor v0.3.5 powered by HT for Web v"+ht.Default.getVersion()+" from www.hightopo.com"),!window.onbeforeunload&&Jp.config.promptBeforeClosing&&(window.onbeforeunload=function(c){return c.returnValue=i("editor.closetip"),c.returnValue}),Jp.version="0.3.5",Jp.getString=i,Jp.stringifyFunction=X,Jp.parseFunction=Z,Jp.createButton=gc,Jp.createItem=Sc,Jp.layoutMainView=Cc,Jp.msClass=v,Jp.initContext=S,Jp.getInput=Ac,Jp.trimExtension=_,Jp.fileNameToDisplayName=w,Jp.isJSON=nc,Jp.getter=o,Jp.setter=l,Jp.snapshot=rp,Jp.CodeEditor=kp,Jp.DND=Fi,Jp.DNDFromOutside=Bi,Jp.DNDTree=MQ,Jp.DNDIndexList=Gr,Jp.DisplayTree=xQ,Jp.DisplayView=fr,Jp.MainTabView=br,Jp.MainToolbar=Ur,Jp.MessageView=Tr,Jp.ObjectView=Mr,Jp.EditView=or,Jp.FontView=xr,Jp.FunctionView=Or,Jp.InspectorTool=Yr,Jp.Inspector=vr,Jp.InspectorPane=hi,Jp.Explorer=SQ,Jp.WebSocketService=OQ,Jp.HTTPService=ai,Jp.CreateNodeInteractor=jr,Jp.CreateEdgeInteractor=Er,Jp.CreateShapeInteractor=mr,Jp.combineShapes=Wp,Jp.splitShape=Zp,Jp.createEditor=function(c){if(window.location.host.indexOf("hightopo")>=0){var p="https:"==document.location.protocol?" https://":" http://";document.write(unescape("%3Cdiv style='display:none'%3E%3Cspan id='cnzz_stat_icon_1000279011'%3E%3C/span%3E%3Cscript src='"+p+"s23.cnzz.com/z_stat.php%3Fid%3D1000279011%26show%3Dpic' type='text/javascript'%3E%3C/script%3E%3C/div%3E")),document.body.style.margin="0px",document.body.style.padding="0px"}c&&(ht.Default.isString(c)?c={container:c}:c.tagName&&c.appendChild&&(c={container:c})),c=c||{};var Q=void 0,r=void 0===c.container?Jp.config.container:c.container;return null===r?Q=null:r?ht.Default.isString(r)?Q=document.getElementById(r):r.length?(Q=ht.Default.createDiv(),Q.style.left=r[0]+"px",Q.style.top=r[1]+"px",Q.style.width=r[2]+"px",Q.style.height=r[3]+"px",document.body.appendChild(Q)):Q=r:Q=document.body,c.$39$=Q,new Ui(c)},Jp.init=function(){Jp.consts||(Hp(),Lp(),$p())},Jp}();